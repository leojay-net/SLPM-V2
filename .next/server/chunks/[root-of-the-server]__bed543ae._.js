module.exports=[961724,(e,t,s)=>{t.exports=e.x("next/dist/compiled/next-server/app-route-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-route-turbo.runtime.prod.js"))},918622,(e,t,s)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,s)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,s)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},120635,(e,t,s)=>{t.exports=e.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},324725,(e,t,s)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},270406,(e,t,s)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},193695,(e,t,s)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},919822,e=>{"use strict";e.s(["CONFIG_STATUS",()=>i,"ENV",()=>t,"getNetworkStatus",()=>n,"getStarknetRpc",()=>s,"getTestnetStatus",()=>r]);let t={NETWORK:"MAINNET",STARKNET_RPC:"https://starknet-mainnet.g.alchemy.com/starknet/version/rpc/v0_8/kwgGr9GGk4YyLXuGfEvpITv1jpvn3PgP",STARKNET_PRIVATE_KEY:process.env.STARKNET_PRIVATE_KEY||"",SHARED_SWAP_ACCOUNT_PRIVATE_KEY:process.env.SHARED_SWAP_ACCOUNT_PRIVATE_KEY||"0x017e929b437eb038963df230f6dcc8002d06741107abfe22972e4532ba25ccaa",SHARED_SWAP_ACCOUNT_ADDRESS:process.env.SHARED_SWAP_ACCOUNT_ADDRESS||"",MIXER_CONTRACT_ADDRESS:"0x05effdcfda86066c72c108e174c55a4f8d1249ba69f80e975d7fc814199a376b",LND_URL:"https://slpm-node.t.voltageapp.io:8080",LND_MACAROON:"0201036c6e64025e030a103294bb4616a5eb95a9a935fd5183e1111207383635383234331a160a0761646472657373120472656164120577726974651a170a08696e766f69636573120472656164120577726974651a0f0a076f6e636861696e12047265616400000620bb9f424dcd1d871d56445eb2394e9f734a461bfbd8904538bb370965efd79643",LND_TLS:"LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUUyRENDQkY2Z0F3SUJBZ0lTQmRPR3lzblJnUmJaR1NON3B3ZTQ2a0NrTUFvR0NDcUdTTTQ5QkFNRE1ESXgKQ3pBSkJnTlZCQVlUQWxWVE1SWXdGQVlEVlFRS0V3MU1aWFFuY3lCRmJtTnllWEIwTVFzd0NRWURWUVFERXdKRgpPREFlRncweU5UQTVNVGt5TXpRd01EZGFGdzB5TlRFeU1UZ3lNelF3TURaYU1Cb3hHREFXQmdOVkJBTU1EeW91CmRtOXNkR0ZuWldGd2NDNXBiekJaTUJNR0J5cUdTTTQ5QWdFR0NDcUdTTTQ5QXdFSEEwSUFCQ2tTZnIyTVlzWUgKN05zYUNOVVdCY1V2NmlJMGRVUkxFL0E2UEVSRjUvZkdIU1Vneldzc0o5emdqeG1uQ29JK0tzN1llcWlvMVBHWgp0dUJoVjNJVkJNV2pnZ05xTUlJRFpqQU9CZ05WSFE4QkFmOEVCQU1DQjRBd0hRWURWUjBsQkJZd0ZBWUlLd1lCCkJRVUhBd0VHQ0NzR0FRVUZCd01DTUF3R0ExVWRFd0VCL3dRQ01BQXdIUVlEVlIwT0JCWUVGTzRVNGdScjA3djIKbUUwc1dFdmdjeFpEbk84Sk1COEdBMVVkSXdRWU1CYUFGSThORTZMMkxuN1JVR3d6R0RoZFdZNGpjcEhLTURJRwpDQ3NHQVFVRkJ3RUJCQ1l3SkRBaUJnZ3JCZ0VGQlFjd0FvWVdhSFIwY0RvdkwyVTRMbWt1YkdWdVkzSXViM0puCkx6Q0NBV1VHQTFVZEVRU0NBVnd3Z2dGWWdoRXFMbUl1ZG05c2RHRm5aV0Z3Y0M1cGI0SVJLaTVrTG5admJIUmgKWjJVdVkyeHZkV1NDRVNvdVpDNTJiMngwWVdkbFlYQndMbWx2Z2hjcUxtMHVjbVZzWVhrdWRtOXNkR0ZuWlM1agpiRzkxWklJWEtpNXRMbkpsYkdGNUxuWnZiSFJoWjJWaGNIQXVhVytDRVNvdWJTNTJiMngwWVdkbExtTnNiM1ZrCmdoRXFMbTB1ZG05c2RHRm5aV0Z3Y0M1cGI0SU9LaTV1YjNOMGNpNTJiSFF1WjJXQ0Z5b3VkQzV5Wld4aGVTNTIKYjJ4MFlXZGxMbU5zYjNWa2doY3FMblF1Y21Wc1lYa3VkbTlzZEdGblpXRndjQzVwYjRJUktpNTBMblp2YkhSaApaMlV1WTJ4dmRXU0NFU291ZEM1MmIyeDBZV2RsWVhCd0xtbHZnaEVxTG5VdWRtOXNkR0ZuWldGd2NDNXBiNElQCktpNTJiMngwWVdkbExtTnNiM1ZrZ2hBcUxuWnZiSFJoWjJWaGNHa3VZMjl0Z2c4cUxuWnZiSFJoWjJWaGNIQXUKYVcrQ0JuWnNkQzVuWllJT2RtOXNkR0ZuWldGd2FTNWpiMjB3RXdZRFZSMGdCQXd3Q2pBSUJnWm5nUXdCQWdFdwpMUVlEVlIwZkJDWXdKREFpb0NDZ0hvWWNhSFIwY0RvdkwyVTRMbU11YkdWdVkzSXViM0puTHpNM0xtTnliRENDCkFRUUdDaXNHQVFRQjFua0NCQUlFZ2ZVRWdmSUE4QUIyQU4zY3lqU1YxK0VXQmVlVk12ckhuL2c5SEZEZjJ3QTYKRkJKMkNpeXN1OGdxQUFBQm1XU1BBNVlBQUFRREFFY3dSUUlnVVV0TGtNQk9oYUtDUk1odkZpa1AwUi9DUEhLdgptZHdSNGtsMWVZT3VOSklDSVFDaS8xZmVKNVBYZmMyME9FWDBnMDVZQkxEL01Ic2xzWkZ3UXF5M3BHY3h0UUIyCkFNejdEMnFGY1FsbC9wV2JVODdwc253aTZZVmNEWmVOdHFsK1ZNRCtUQTJ3QUFBQm1XU1BBNkVBQUFRREFFY3cKUlFJaEFKM0QvTFFzR0d5cFYrT2FpSWZJekQ4bFo4bEo3TnZaT2Y3QnVveStxR00xQWlCaTFxZFVwSGdNdTgzbQo5TGxTQ2k5YVo0eFN6VW93aVp6MDBkZDhlN3g5VlRBS0JnZ3Foa2pPUFFRREF3Tm9BREJsQWpFQWpyUERRM1FuClVjYTJSRng0TkhhZ1FwdWtFcTRrV2k0VkduUHIwZFplMERWc2RBM3hnSy9QTHRpcFlDODVDeUlxQWpCNjhLT2cKQzMvb05PN1ZqcmovUjFFWVd1QjZXWDJwYlMyN25PSW10V2taMm9ldWV1dUJ6Y2QyM1pKMHp6Z01UUXM9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUVWakNDQWo2Z0F3SUJBZ0lRWTVXVFk4Sk9jSUp4V1JpL3c5ZnRWakFOQmdrcWhraUc5dzBCQVFzRkFEQlAKTVFzd0NRWURWUVFHRXdKVlV6RXBNQ2NHQTFVRUNoTWdTVzUwWlhKdVpYUWdVMlZqZFhKcGRIa2dVbVZ6WldGeQpZMmdnUjNKdmRYQXhGVEFUQmdOVkJBTVRERWxUVWtjZ1VtOXZkQ0JZTVRBZUZ3MHlOREF6TVRNd01EQXdNREJhCkZ3MHlOekF6TVRJeU16VTVOVGxhTURJeEN6QUpCZ05WQkFZVEFsVlRNUll3RkFZRFZRUUtFdzFNWlhRbmN5QkYKYm1OeWVYQjBNUXN3Q1FZRFZRUURFd0pGT0RCMk1CQUdCeXFHU000OUFnRUdCU3VCQkFBaUEySUFCTkZsOGw3YwpTN1FNQXB6U3N2cnU2V3lyT3E0NG9mVFVPVEl6eFVMVXpETU1OTWNoSUpCd1hPaGlMeHh4czBMWGViNUdEY0hiClI2RVRvTWZmZ1Naak85U05IZlk5Z2pNeTl2UXI1L1dXT3JRVFp4aDdhejZOU05ucTN1MnViVDZIVEtPQitEQ0IKOVRBT0JnTlZIUThCQWY4RUJBTUNBWVl3SFFZRFZSMGxCQll3RkFZSUt3WUJCUVVIQXdJR0NDc0dBUVVGQndNQgpNQklHQTFVZEV3RUIvd1FJTUFZQkFmOENBUUF3SFFZRFZSME9CQllFRkk4TkU2TDJMbjdSVUd3ekdEaGRXWTRqCmNwSEtNQjhHQTFVZEl3UVlNQmFBRkhtMFdlWjd0dVhrQVhPQUNJaklHbGoyNlp0dU1ESUdDQ3NHQVFVRkJ3RUIKQkNZd0pEQWlCZ2dyQmdFRkJRY3dBb1lXYUhSMGNEb3ZMM2d4TG1rdWJHVnVZM0l1YjNKbkx6QVRCZ05WSFNBRQpEREFLTUFnR0JtZUJEQUVDQVRBbkJnTlZIUjhFSURBZU1CeWdHcUFZaGhab2RIUndPaTh2ZURFdVl5NXNaVzVqCmNpNXZjbWN2TUEwR0NTcUdTSWIzRFFFQkN3VUFBNElDQVFCbkUwaEdJTktzQ1lXaTBYeDF5Z3hENXFpaEVqWjAKUkkzdFRaejF3dUFUSDNad1lQSXA5N2tXRWF5YW5EMWowY0RoSVl6eTRDa0RvMmpCOEQ1dDBhNnpaV3pscjk4ZApBUUZOaDh1S0prSUhkTFNoeStuVXllWnhjNWJOZU1wMUx1MGdTekU0TWNxZm1OTXZJcGVpd1dTWU85dzgyT2I4Cm90dlhjTzJKVVlpM3N2SElXUm0zKzcwN0RVYkw1MVhNY1kyaVpkbENxNFdhOW5idWszV1RVNGdyNkxZOE16VkEKYURRRzIrNFUzZUo2cVVGMTBiQm5SMXV1VnlEWXM5Umhyd3VjUlZuZnVEajI5Q01MVHNwbE01ZjV3U1Y1aFVwbQpVd3AvdlY3TTR3NGFHdW50NzRrb1g3MW40RWRhZ0NzTC9ZazUrbUFRVTArdHVlMEpPZkFWL1I2dDFrK1hrOXMyCkhNUUZlb3hwcGZ6QVZDMDRGZEc5TStBQzJKV3htRlN0NkJDdWgzQ0VleTNmRTUyUXJqOVlNNzVydHZJanNtLzEKSGwrdS8vV3F4bnUxWlE0anBhK1ZwdVppR09sV3JxU1A5ZW9nZE9oQ0dpc255ZXdXSndSUU9xSzE2d2lHeVplUgp4cy9CZWt3NjV2d1NJYVZrQnJ1UGlUZk1PbzBaaDRnVmE4L3FKZ01iSmJ5cnd3Rzk3ei9QUmdtTEtDRGw4ejNkCnRBMFo3cXE3ZnRhMEdsMjR1eXVCMDVkcUk1SjFMdkF6S3VXZElqVDF0UDhxQ294U0UveHBpeDhoWDJkdDNoKy8KanVqVWdGUEZaMEVWWjB4U3lCTlJGM01ib0dabllYRlV4cE5qVFdQS3BhZ0RISlFtcXJBY0RtV0puTXNGWTNqUwp1MWlndjNPZWZuV2pTUT09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K",CASHU_MINTS:"https://mint.coinos.io".split(",").map(e=>e.trim()).filter(Boolean),CASHU_DEFAULT_MINT:"https://mint.coinos.io",CASHU_SINGLE_MINT:!0,DISABLE_CASHU_SPLIT:!0,STRK_BTC_RATE:Number(process.env.NEXT_PUBLIC_STRK_BTC_RATE||process.env.STRK_BTC_RATE||"0"),STRK_SATS_RATE:(()=>{let e=process.env.NEXT_PUBLIC_STRK_SATS_RATE||process.env.STRK_SATS_RATE;if(e)return Number(e);let t=Number(process.env.NEXT_PUBLIC_STRK_BTC_RATE||process.env.STRK_BTC_RATE||"0");return t&&!isNaN(t)&&t>0?Math.floor(1e8*t):125})(),DISABLE_ATOMIQ_PRICE_FETCH:!1,ALLOW_SWAP_PRICE_FALLBACK:"true"===process.env.ALLOW_SWAP_PRICE_FALLBACK};function s(){if(t.STARKNET_RPC)return t.STARKNET_RPC;switch(t.NETWORK){case"MAINNET":default:return"https://starknet-mainnet.g.alchemy.com/starknet/version/rpc/v0_8/kwgGr9GGk4YyLXuGfEvpITv1jpvn3PgP";case"TESTNET":return"https://starknet-sepolia.public.blastapi.io/rpc/v0_7"}}function n(){let e=!!(t.LND_URL&&t.LND_MACAROON),s="MAINNET"===t.NETWORK?["MAINNET"===t.NETWORK&&t.STARKNET_RPC&&t.STARKNET_PRIVATE_KEY&&t.CASHU_DEFAULT_MINT&&t.LND_URL&&t.LND_MACAROON].every(Boolean):["TESTNET"===t.NETWORK&&t.STARKNET_RPC&&t.STARKNET_PRIVATE_KEY&&t.CASHU_DEFAULT_MINT].every(Boolean);return{network:t.NETWORK,starknetRpc:!!t.STARKNET_RPC,privateKey:!!t.STARKNET_PRIVATE_KEY,cashuMint:!!t.CASHU_DEFAULT_MINT,lightningNode:!!t.LND_URL,lightningConfigured:e,cashuMints:t.CASHU_MINTS.length,ready:s,warnings:(()=>{let e=[];return t.STARKNET_RPC||e.push("STARKNET_RPC not configured"),t.STARKNET_PRIVATE_KEY||e.push("STARKNET_PRIVATE_KEY not configured"),t.CASHU_DEFAULT_MINT||e.push("CASHU_DEFAULT_MINT not configured"),"MAINNET"===t.NETWORK&&(t.LND_URL||e.push("Lightning node (LND_URL) required for mainnet"),t.LND_MACAROON||e.push("Lightning authentication (LND_MACAROON) required for mainnet")),e})()}}function r(){return n()}let i=function(){let e=[],s=[];return t.NETWORK&&["MAINNET","TESTNET"].includes(t.NETWORK)||e.push("Invalid network configuration"),t.CASHU_DEFAULT_MINT||e.push("No Cashu mint configured"),t.STARKNET_RPC||s.push(`Using default ${t.NETWORK} Starknet RPC - configure STARKNET_RPC for better reliability`),t.LND_URL||s.push("Lightning node URL not configured - using fallback mode"),0===t.CASHU_MINTS.length&&s.push("No multi-mint configuration - using single mint mode"),t.STARKNET_PRIVATE_KEY||s.push("No Starknet private key configured for server-side operations"),s.forEach(e=>console.warn(e)),{valid:0===e.length,errors:e,warnings:s}}()},814747,(e,t,s)=>{t.exports=e.x("path",()=>require("path"))},224361,(e,t,s)=>{t.exports=e.x("util",()=>require("util"))},446786,(e,t,s)=>{t.exports=e.x("os",()=>require("os"))},254799,(e,t,s)=>{t.exports=e.x("crypto",()=>require("crypto"))},666680,(e,t,s)=>{t.exports=e.x("node:crypto",()=>require("node:crypto"))},500874,(e,t,s)=>{t.exports=e.x("buffer",()=>require("buffer"))},154259,e=>{e.v(JSON.parse('{"name":"elliptic","version":"6.6.1","description":"EC cryptography","main":"lib/elliptic.js","files":["lib"],"scripts":{"lint":"eslint lib test","lint:fix":"npm run lint -- --fix","unit":"istanbul test _mocha --reporter=spec test/index.js","test":"npm run lint && npm run unit","version":"grunt dist && git add dist/"},"repository":{"type":"git","url":"git@github.com:indutny/elliptic"},"keywords":["EC","Elliptic","curve","Cryptography"],"author":"Fedor Indutny <fedor@indutny.com>","license":"MIT","bugs":{"url":"https://github.com/indutny/elliptic/issues"},"homepage":"https://github.com/indutny/elliptic","devDependencies":{"brfs":"^2.0.2","coveralls":"^3.1.0","eslint":"^7.6.0","grunt":"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1","istanbul":"^0.4.5","mocha":"^8.0.1"},"dependencies":{"bn.js":"^4.11.9","brorand":"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1","inherits":"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}'))},522734,(e,t,s)=>{t.exports=e.x("fs",()=>require("fs"))},427699,(e,t,s)=>{t.exports=e.x("events",()=>require("events"))},873525,e=>{"use strict";e.s(["MIX_MAX_DELAY_MS",()=>s,"MIX_MIN_DELAY_MS",()=>t,"PRIVACY_MIXER",()=>i,"SHARED_SWAP_ACCOUNT_ADDRESS",()=>a,"SPLIT_MAX_PARTS",()=>n,"SPLIT_MIN_DENOM",()=>r]);let t=1e3,s=15e3,n=8,r=1n,i={CONTRACT_ADDRESS:"0x05effdcfda86066c72c108e174c55a4f8d1249ba69f80e975d7fc814199a376b",CLASS_HASH:"0x00abc35fe33a082fad61df2a88160f16202d1a08cc338f1954063320063be4d5",STRK_TOKEN:"0x04718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d",DEPLOYMENT_PARAMS:{OWNER:"0x01734203d1C5B2699B3dbC50223c86EC59E2B79E2d34CBE8363F0dCCdC1E9634",MIN_DEPOSIT:0xde0b6b3a7640000n,MAX_DEPOSIT:0x3635c9adc5dea00000n,MIN_DELAY:0n,MIN_ANONYMITY:0n,FEE_RATE:10n}},a="0x075a05264A7D0ebB864abFbE2bbFeE33D085EB77397b939bD17d55c2e69d87D3"},720689,e=>{"use strict";function t(e){let t=Array.from({length:e},()=>Math.floor(256*Math.random()));return Buffer.from(Uint8Array.from(t)).toString("hex")}e.s(["randomHex",()=>t])},491766,508930,607662,e=>{"use strict";e.s(["InMemoryStorage",()=>t],491766);class t{sessions=new Map;sessionProofs=new Map;async saveSession(e){this.sessions.set(e.id,{...e,updatedAt:Date.now()}),this.sessionProofs.has(e.id)||this.sessionProofs.set(e.id,new Map)}async getSession(e){let t=this.sessions.get(e);return t?{...t}:void 0}async listSessions(){return Array.from(this.sessions.values()).map(e=>({...e}))}async updateSessionPartial(e,t){let s=this.sessions.get(e);if(!s)return;let n={...s,...t,updatedAt:Date.now()};return this.sessions.set(e,n),{...n}}async saveProofs(e,t){let s=this.sessionProofs.get(e)??new Map;for(let e of t)s.set(e.secret,{...e});this.sessionProofs.set(e,s)}async markProofsSpent(e,t){let s=this.sessionProofs.get(e);if(s)for(let e of t){let t=s.get(e);t&&s.set(e,{...t,spent:!0})}}}e.s(["globalEventBus",()=>s],508930);let s=new class{listeners={"session.created":[],"session.updated":[],"session.state_changed":[],"session.completed":[],"deposit.received":[],"mixing.started":[],"mixing.completed":[],"withdraw.initiated":[],"withdraw.completed":[],"pipeline.created":[],"pipeline.updated":[],"pipeline.state_changed":[],"pipeline.completed":[],"pipeline.failed":[],error:[]};on(e,t){return this.listeners[e].push(t),()=>{let s=this.listeners[e],n=s.indexOf(t);n>=0&&s.splice(n,1)}}emit(e){for(let t of this.listeners[e.type])t(e)}};function n(e,t){if(!t.includes(e.state))throw Error(`Invalid session state. Current=${e.state} Allowed=${t.join(",")}`)}e.s(["assertState",()=>n],607662)},831120,e=>{"use strict";e.s(["mixerEngine",()=>l],831120);var t=e.i(491766),s=e.i(508930),n=e.i(607662),r=e.i(720689);let i=new class{split(e,t){let s=[];for(let n of e){let e=Math.min(Math.max(1,Number(n.amount/t.minAmount)),t.maxParts);if(1===e){s.push(n);continue}let r=n.amount/BigInt(e),i=n.amount-r*BigInt(e);for(let t=0;t<e;t++){let e=r;i>0n&&(e+=1n,i-=1n),s.push({...n,amount:e,secret:n.secret+"_s"+t})}}return{outputs:s}}};var a=e.i(873525);class o{tasks=new Map;schedule(e,t,s=a.MIX_MIN_DELAY_MS,n=a.MIX_MAX_DELAY_MS){let r=s+Math.floor(Math.random()*(n-s+1)),i=Date.now()+r,o=setTimeout(()=>{this.tasks.delete(e),t()},r);this.tasks.set(e,{id:e,runAt:i,timer:o})}cancel(e){let t=this.tasks.get(e);t&&(clearTimeout(t.timer),this.tasks.delete(e))}}let d=new o,l=new class{storage;bus;constructor(e={}){this.storage=e.storage??new t.InMemoryStorage,this.bus=e.bus??s.globalEventBus}async createSession(e){let t={id:(0,r.randomHex)(12),state:"AWAITING_DEPOSIT",deposits:[],outputs:[],targetAmounts:e.targetAmounts,currency:e.currency,createdAt:Date.now(),updatedAt:Date.now(),entropySeed:(0,r.randomHex)(16)};return await this.storage.saveSession(t),this.bus.emit({id:(0,r.randomHex)(8),type:"session.created",at:Date.now(),payload:{session:t}}),{session:t}}async deposit(e,t){let s=await this.storage.getSession(e);if(!s)throw Error("Session not found");(0,n.assertState)(s,["AWAITING_DEPOSIT","DEPOSITED"]),s.deposits.push(...t),s.state="DEPOSITED",s.updatedAt=Date.now(),await this.storage.saveSession(s),this.bus.emit({id:(0,r.randomHex)(8),type:"deposit.received",at:Date.now(),payload:{sessionId:e,proofs:t}});let o=i.split(s.deposits,{maxParts:a.SPLIT_MAX_PARTS,minAmount:a.SPLIT_MIN_DENOM});s.deposits=o.outputs,await this.storage.saveSession(s);let l="mix_"+s.id;return d.schedule(l,()=>{this.startMixing(s.id)}),s}async startMixing(e){let t=await this.storage.getSession(e);if(!t)throw Error("Session not found");return(0,n.assertState)(t,["DEPOSITED"]),t.state="MIXING",await this.storage.saveSession(t),this.bus.emit({id:(0,r.randomHex)(8),type:"mixing.started",at:Date.now(),payload:{sessionId:e}}),t.outputs=t.deposits.map(e=>({...e,secret:e.secret+"_mix"})),t.state="READY",t.updatedAt=Date.now(),await this.storage.saveSession(t),this.bus.emit({id:(0,r.randomHex)(8),type:"mixing.completed",at:Date.now(),payload:{sessionId:e,outputs:t.outputs}}),t}async withdraw(e,t){let s=await this.storage.getSession(e);if(!s)throw Error("Session not found");return(0,n.assertState)(s,["READY"]),s.state="WITHDRAWING",await this.storage.saveSession(s),this.bus.emit({id:(0,r.randomHex)(8),type:"withdraw.initiated",at:Date.now(),payload:{sessionId:e,destination:"redacted"}}),s.state="COMPLETED",s.updatedAt=Date.now(),await this.storage.saveSession(s),this.bus.emit({id:(0,r.randomHex)(8),type:"withdraw.completed",at:Date.now(),payload:{sessionId:e,destination:"redacted"}}),s}async getSession(e){return this.storage.getSession(e)}}},21564,e=>{"use strict";e.s(["MultiMintCashuManager",()=>n,"RealCashuClient",()=>s]);var t=e.i(662951);class s{mint;wallet;initialized=!1;mintUrl;constructor(e){this.mintUrl=e,this.mint=new t.CashuMint(e),this.wallet=new t.CashuWallet(this.mint),console.log(`ðŸª™ Initializing Cashu client for testnet mint: ${e}`)}async ensureInitialized(){if(!this.initialized)try{console.log(`ðŸ”— Connecting to Cashu mint: ${this.mintUrl}`),await this.wallet.loadMint(),this.initialized=!0,console.log(`âœ… Cashu mint connected successfully`)}catch(e){throw console.warn(`âš ï¸ Failed to connect to Cashu mint: ${e instanceof Error?e.message:String(e)}`),Error(`Cashu mint connection failed: ${e instanceof Error?e.message:"Unknown error"}`)}}async createMintQuote(e){await this.ensureInitialized();let s=await this.wallet.createMintQuote(Number(e));return{quote:s.quote,amount:BigInt(s.amount),state:s.state===t.MintQuoteState.PAID?"PAID":s.state===t.MintQuoteState.ISSUED?"ISSUED":"CREATED",request:s.request}}async checkMintQuote(e){await this.ensureInitialized();let s=await this.wallet.checkMintQuote(e);return{quote:s.quote,amount:BigInt(s.amount||0),state:s.state===t.MintQuoteState.PAID?"PAID":s.state===t.MintQuoteState.ISSUED?"ISSUED":"CREATED",request:s.request}}async mintProofs(e,t){return await this.ensureInitialized(),(await this.wallet.mintProofs(Number(e),t)).map(this.convertToEcashProof)}async createMeltQuote(e){await this.ensureInitialized();let t=await this.wallet.createMeltQuote(e);return{quote:t.quote,amount:BigInt(t.amount),fee_reserve:BigInt(t.fee_reserve),unit:t.unit,expiry:t.expiry,request:t.request}}async meltProofs(e,t){await this.ensureInitialized();let s=t.map(this.convertFromEcashProof),n={quote:e.quote,amount:Number(e.amount),fee_reserve:Number(e.fee_reserve),state:"UNPAID",expiry:Math.floor(Date.now()/1e3)+3600,payment_preimage:null,request:"",unit:"sat"},r=await this.wallet.meltProofs(n,s);return{change:r.change?.map(this.convertToEcashProof)||[]}}async send(e,t){await this.ensureInitialized();let s=t.map(this.convertFromEcashProof),{keep:n,send:r}=await this.wallet.send(Number(e),s);return{keep:n.map(this.convertToEcashProof),send:r.map(this.convertToEcashProof)}}createToken(e){let s=e.map(this.convertFromEcashProof);return(0,t.getEncodedTokenV4)({mint:this.mint.mintUrl,proofs:s})}async receive(e){return await this.ensureInitialized(),(await this.wallet.receive(e)).map(this.convertToEcashProof)}async getMintInfo(){await this.ensureInitialized();let e=await this.mint.getInfo();return{name:e.name,description:e.description,version:e.version}}getBalance(e){return e.reduce((e,t)=>e+t.amount,0n)}convertToEcashProof(e){return{secret:e.secret,signature:e.C,amount:BigInt(e.amount),currency:"SAT",keysetId:e.id}}convertFromEcashProof(e){return{secret:e.secret,C:e.signature,amount:Number(e.amount),id:e.keysetId}}}class n{clients=new Map;mintUrls;constructor(e){this.mintUrls=e,e.forEach(e=>{this.clients.set(e,new s(e))})}selectMint(){let e=Math.floor(Math.random()*this.mintUrls.length),t=this.mintUrls[e];return this.clients.get(t)}getAllMints(){return Array.from(this.clients.values())}async distributeSend(e,t,s=2){let n=this.mintUrls.slice(0,s),r=e/BigInt(s),i=[];for(let e of n){let s=this.clients.get(e),n=t.filter(e=>this.getBalance([e])<=r);i.push({mint:s,proofs:n})}return{distributions:i}}getBalance(e){return e.reduce((e,t)=>e+t.amount,0n)}}},991557,(e,t,s)=>{},395555,e=>{e.v(e=>Promise.resolve().then(()=>e(675962)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__bed543ae._.js.map
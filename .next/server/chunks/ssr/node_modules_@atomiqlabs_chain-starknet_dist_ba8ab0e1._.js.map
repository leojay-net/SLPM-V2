{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/swaps/handlers/refund/TimelockRefundHandler.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.TimelockRefundHandler = void 0;\r\nconst Utils_1 = require(\"../../../../utils/Utils\");\r\nclass TimelockRefundHandler {\r\n    constructor(address) {\r\n        this.address = address;\r\n    }\r\n    getCommitment(data) {\r\n        return data;\r\n    }\r\n    getWitness(signer, data) {\r\n        const expiry = TimelockRefundHandler.getExpiry(data);\r\n        const currentTimestamp = BigInt(Math.floor(Date.now() / 1000));\r\n        if (expiry > currentTimestamp)\r\n            throw new Error(\"Not expired yet!\");\r\n        return Promise.resolve({ initialTxns: [], witness: [] });\r\n    }\r\n    getGas() {\r\n        return TimelockRefundHandler.gas;\r\n    }\r\n    static getExpiry(data) {\r\n        return (0, Utils_1.bigNumberishToBuffer)(data.refundData, 32).readBigUInt64BE(24).valueOf();\r\n    }\r\n}\r\nexports.TimelockRefundHandler = TimelockRefundHandler;\r\nTimelockRefundHandler.gas = { l1DataGas: 0, l2Gas: 4000000, l1Gas: 0 };\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,qBAAqB,GAAG,KAAK;AACrC,MAAM;AACN,MAAM;IACF,YAAY,OAAO,CAAE;QACjB,IAAI,CAAC,OAAO,GAAG;IACnB;IACA,cAAc,IAAI,EAAE;QAChB,OAAO;IACX;IACA,WAAW,MAAM,EAAE,IAAI,EAAE;QACrB,MAAM,SAAS,sBAAsB,SAAS,CAAC;QAC/C,MAAM,mBAAmB,OAAO,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK;QACxD,IAAI,SAAS,kBACT,MAAM,IAAI,MAAM;QACpB,OAAO,QAAQ,OAAO,CAAC;YAAE,aAAa,EAAE;YAAE,SAAS,EAAE;QAAC;IAC1D;IACA,SAAS;QACL,OAAO,sBAAsB,GAAG;IACpC;IACA,OAAO,UAAU,IAAI,EAAE;QACnB,OAAO,CAAC,GAAG,QAAQ,oBAAoB,EAAE,KAAK,UAAU,EAAE,IAAI,eAAe,CAAC,IAAI,OAAO;IAC7F;AACJ;AACA,QAAQ,qBAAqB,GAAG;AAChC,sBAAsB,GAAG,GAAG;IAAE,WAAW;IAAG,OAAO;IAAS,OAAO;AAAE","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/swaps/StarknetSwapData.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetSwapData = void 0;\r\nconst base_1 = require(\"@atomiqlabs/base\");\r\nconst TimelockRefundHandler_1 = require(\"./handlers/refund/TimelockRefundHandler\");\r\nconst starknet_1 = require(\"starknet\");\r\nconst Utils_1 = require(\"../../utils/Utils\");\r\nconst FLAG_PAY_OUT = 0x01n;\r\nconst FLAG_PAY_IN = 0x02n;\r\nconst FLAG_REPUTATION = 0x04n;\r\nclass StarknetSwapData extends base_1.SwapData {\r\n    static toFlags(value) {\r\n        const val = (0, Utils_1.toBigInt)(value);\r\n        return {\r\n            sequence: val >> 64n,\r\n            payOut: (val & FLAG_PAY_OUT) === FLAG_PAY_OUT,\r\n            payIn: (val & FLAG_PAY_IN) === FLAG_PAY_IN,\r\n            reputation: (val & FLAG_REPUTATION) === FLAG_REPUTATION\r\n        };\r\n    }\r\n    getFlags() {\r\n        return (this.sequence << 64n) +\r\n            (this.payOut ? FLAG_PAY_OUT : 0n) +\r\n            (this.payIn ? FLAG_PAY_IN : 0n) +\r\n            (this.reputation ? FLAG_REPUTATION : 0n);\r\n    }\r\n    constructor(offererOrData, claimer, token, refundHandler, claimHandler, payOut, payIn, reputation, sequence, claimData, refundData, amount, feeToken, securityDeposit, claimerBounty, kind, extraData) {\r\n        super();\r\n        if (claimer != null || token != null || refundHandler != null || claimHandler != null ||\r\n            payOut != null || payIn != null || reputation != null || sequence != null || claimData != null || refundData != null ||\r\n            amount != null || feeToken != null || securityDeposit != null || claimerBounty != null) {\r\n            this.offerer = offererOrData;\r\n            this.claimer = claimer;\r\n            this.token = token;\r\n            this.refundHandler = refundHandler;\r\n            this.claimHandler = claimHandler;\r\n            this.payOut = payOut;\r\n            this.payIn = payIn;\r\n            this.reputation = reputation;\r\n            this.sequence = sequence;\r\n            this.claimData = claimData;\r\n            this.refundData = refundData;\r\n            this.amount = amount;\r\n            this.feeToken = feeToken;\r\n            this.securityDeposit = securityDeposit;\r\n            this.claimerBounty = claimerBounty;\r\n            this.kind = kind;\r\n            this.extraData = extraData;\r\n        }\r\n        else {\r\n            this.offerer = offererOrData.offerer;\r\n            this.claimer = offererOrData.claimer;\r\n            this.token = offererOrData.token;\r\n            this.refundHandler = offererOrData.refundHandler;\r\n            this.claimHandler = offererOrData.claimHandler;\r\n            this.payOut = offererOrData.payOut;\r\n            this.payIn = offererOrData.payIn;\r\n            this.reputation = offererOrData.reputation;\r\n            this.sequence = offererOrData.sequence == null ? null : BigInt(offererOrData.sequence);\r\n            this.claimData = offererOrData.claimData;\r\n            this.refundData = offererOrData.refundData;\r\n            this.amount = offererOrData.amount == null ? null : BigInt(offererOrData.amount);\r\n            this.feeToken = offererOrData.feeToken;\r\n            this.securityDeposit = offererOrData.securityDeposit == null ? null : BigInt(offererOrData.securityDeposit);\r\n            this.claimerBounty = offererOrData.claimerBounty == null ? null : BigInt(offererOrData.claimerBounty);\r\n            this.kind = offererOrData.kind;\r\n            this.extraData = offererOrData.extraData;\r\n        }\r\n    }\r\n    getOfferer() {\r\n        return this.offerer;\r\n    }\r\n    setOfferer(newOfferer) {\r\n        this.offerer = newOfferer;\r\n        this.payIn = true;\r\n    }\r\n    getClaimer() {\r\n        return this.claimer;\r\n    }\r\n    setClaimer(newClaimer) {\r\n        this.claimer = newClaimer;\r\n        this.payIn = false;\r\n        this.payOut = true;\r\n        this.reputation = false;\r\n    }\r\n    serialize() {\r\n        return {\r\n            type: \"strk\",\r\n            offerer: this.offerer,\r\n            claimer: this.claimer,\r\n            token: this.token,\r\n            refundHandler: this.refundHandler,\r\n            claimHandler: this.claimHandler,\r\n            payOut: this.payOut,\r\n            payIn: this.payIn,\r\n            reputation: this.reputation,\r\n            sequence: this.sequence == null ? null : this.sequence.toString(10),\r\n            claimData: this.claimData,\r\n            refundData: this.refundData,\r\n            amount: this.amount == null ? null : this.amount.toString(10),\r\n            feeToken: this.feeToken,\r\n            securityDeposit: this.securityDeposit == null ? null : this.securityDeposit.toString(10),\r\n            claimerBounty: this.claimerBounty == null ? null : this.claimerBounty.toString(10),\r\n            kind: this.kind,\r\n            extraData: this.extraData\r\n        };\r\n    }\r\n    getAmount() {\r\n        return this.amount;\r\n    }\r\n    getToken() {\r\n        return this.token;\r\n    }\r\n    isToken(token) {\r\n        return this.token.toLowerCase() === token.toLowerCase();\r\n    }\r\n    getType() {\r\n        return this.kind;\r\n    }\r\n    getExpiry() {\r\n        return TimelockRefundHandler_1.TimelockRefundHandler.getExpiry(this);\r\n    }\r\n    isPayIn() {\r\n        return this.payIn;\r\n    }\r\n    isPayOut() {\r\n        return this.payOut;\r\n    }\r\n    getEscrowHash() {\r\n        const amountValue = starknet_1.cairo.uint256(\"0x\" + this.amount.toString(16));\r\n        const securityDepositValue = starknet_1.cairo.uint256(\"0x\" + this.securityDeposit.toString(16));\r\n        const claimerBountyValue = starknet_1.cairo.uint256(\"0x\" + this.claimerBounty.toString(16));\r\n        let escrowHash = starknet_1.hash.computePoseidonHashOnElements([\r\n            this.offerer,\r\n            this.claimer,\r\n            this.token,\r\n            this.refundHandler,\r\n            this.claimHandler,\r\n            this.getFlags(),\r\n            this.claimData,\r\n            this.refundData,\r\n            amountValue.low,\r\n            amountValue.high,\r\n            this.feeToken,\r\n            securityDepositValue.low,\r\n            securityDepositValue.high,\r\n            claimerBountyValue.low,\r\n            claimerBountyValue.high\r\n        ]);\r\n        if (escrowHash.startsWith(\"0x\"))\r\n            escrowHash = escrowHash.slice(2);\r\n        return escrowHash.padStart(64, \"0\");\r\n    }\r\n    getClaimHash() {\r\n        let hash = this.claimData;\r\n        if (hash.startsWith(\"0x\"))\r\n            hash = hash.slice(2);\r\n        return hash.padStart(64, \"0\");\r\n    }\r\n    getSequence() {\r\n        return this.sequence;\r\n    }\r\n    getConfirmationsHint() {\r\n        if (this.extraData == null)\r\n            return null;\r\n        if (this.extraData.length != 84)\r\n            return null;\r\n        return parseInt(this.extraData.slice(80), 16);\r\n    }\r\n    getNonceHint() {\r\n        if (this.extraData == null)\r\n            return null;\r\n        if (this.extraData.length != 84)\r\n            return null;\r\n        return BigInt(\"0x\" + this.extraData.slice(64, 80));\r\n    }\r\n    getTxoHashHint() {\r\n        if (this.extraData == null)\r\n            return null;\r\n        if (this.extraData.length != 84)\r\n            return null;\r\n        return this.extraData.slice(0, 64);\r\n    }\r\n    getExtraData() {\r\n        return this.extraData;\r\n    }\r\n    setExtraData(extraData) {\r\n        this.extraData = extraData;\r\n    }\r\n    getSecurityDeposit() {\r\n        return this.securityDeposit;\r\n    }\r\n    getClaimerBounty() {\r\n        return this.claimerBounty;\r\n    }\r\n    getTotalDeposit() {\r\n        return this.claimerBounty < this.securityDeposit ? this.securityDeposit : this.claimerBounty;\r\n    }\r\n    getDepositToken() {\r\n        return this.feeToken;\r\n    }\r\n    isDepositToken(token) {\r\n        if (!token.startsWith(\"0x\"))\r\n            token = \"0x\" + token;\r\n        return (0, Utils_1.toHex)(this.feeToken) === (0, Utils_1.toHex)(token);\r\n    }\r\n    isClaimer(address) {\r\n        if (!address.startsWith(\"0x\"))\r\n            address = \"0x\" + address;\r\n        return (0, Utils_1.toHex)(this.claimer) === (0, Utils_1.toHex)(address);\r\n    }\r\n    isOfferer(address) {\r\n        if (!address.startsWith(\"0x\"))\r\n            address = \"0x\" + address;\r\n        return (0, Utils_1.toHex)(this.offerer) === (0, Utils_1.toHex)(address);\r\n    }\r\n    isRefundHandler(address) {\r\n        if (!address.startsWith(\"0x\"))\r\n            address = \"0x\" + address;\r\n        return (0, Utils_1.toHex)(this.refundHandler) === (0, Utils_1.toHex)(address);\r\n    }\r\n    isClaimHandler(address) {\r\n        if (!address.startsWith(\"0x\"))\r\n            address = \"0x\" + address;\r\n        return (0, Utils_1.toHex)(this.claimHandler) === (0, Utils_1.toHex)(address);\r\n    }\r\n    isClaimData(data) {\r\n        if (!data.startsWith(\"0x\"))\r\n            data = \"0x\" + data;\r\n        return (0, Utils_1.toHex)(this.claimData) === (0, Utils_1.toHex)(data);\r\n    }\r\n    equals(other) {\r\n        return other.offerer.toLowerCase() === this.offerer.toLowerCase() &&\r\n            other.claimer.toLowerCase() === this.claimer.toLowerCase() &&\r\n            other.token.toLowerCase() === this.token.toLowerCase() &&\r\n            other.refundHandler.toLowerCase() === this.refundHandler.toLowerCase() &&\r\n            other.claimHandler.toLowerCase() === this.claimHandler.toLowerCase() &&\r\n            other.payIn === this.payIn &&\r\n            other.payOut === this.payOut &&\r\n            other.reputation === this.reputation &&\r\n            this.sequence === other.sequence &&\r\n            other.claimData.toLowerCase() === this.claimData.toLowerCase() &&\r\n            other.refundData.toLowerCase() === this.refundData.toLowerCase() &&\r\n            other.amount === this.amount &&\r\n            other.securityDeposit === this.securityDeposit &&\r\n            other.claimerBounty === this.claimerBounty;\r\n    }\r\n    toEscrowStruct() {\r\n        return {\r\n            offerer: this.offerer,\r\n            claimer: this.claimer,\r\n            token: this.token,\r\n            refund_handler: this.refundHandler,\r\n            claim_handler: this.claimHandler,\r\n            flags: this.getFlags(),\r\n            claim_data: this.claimData,\r\n            refund_data: this.refundData,\r\n            amount: starknet_1.cairo.uint256((0, Utils_1.toBigInt)(this.amount)),\r\n            fee_token: this.feeToken,\r\n            security_deposit: starknet_1.cairo.uint256((0, Utils_1.toBigInt)(this.securityDeposit)),\r\n            claimer_bounty: starknet_1.cairo.uint256((0, Utils_1.toBigInt)(this.claimerBounty)),\r\n            success_action: new starknet_1.CairoOption(starknet_1.CairoOptionVariant.None) //For now enforce no success action\r\n        };\r\n    }\r\n    static fromSerializedFeltArray(span, claimHandlerImpl) {\r\n        const offerer = (0, Utils_1.toHex)(span.shift());\r\n        const claimer = (0, Utils_1.toHex)(span.shift());\r\n        const token = (0, Utils_1.toHex)(span.shift());\r\n        const refundHandler = (0, Utils_1.toHex)(span.shift());\r\n        const claimHandler = (0, Utils_1.toHex)(span.shift());\r\n        const { payOut, payIn, reputation, sequence } = StarknetSwapData.toFlags(span.shift());\r\n        const claimData = (0, Utils_1.toHex)(span.shift());\r\n        const refundData = (0, Utils_1.toHex)(span.shift());\r\n        const amount = (0, Utils_1.toBigInt)({ low: span.shift(), high: span.shift() });\r\n        const feeToken = (0, Utils_1.toHex)(span.shift());\r\n        const securityDeposit = (0, Utils_1.toBigInt)({ low: span.shift(), high: span.shift() });\r\n        const claimerBounty = (0, Utils_1.toBigInt)({ low: span.shift(), high: span.shift() });\r\n        const hasSuccessAction = (0, Utils_1.toBigInt)(span.shift()) === 0n;\r\n        if (hasSuccessAction) {\r\n            const executionHash = (0, Utils_1.toHex)(span.shift());\r\n            const executionExpiry = (0, Utils_1.toBigInt)(span.shift());\r\n            const executionFee = (0, Utils_1.toBigInt)({ low: span.shift(), high: span.shift() });\r\n            // throw new Error(\"Success action not allowed!\");\r\n        }\r\n        return new StarknetSwapData(offerer, claimer, token, refundHandler, claimHandler, payOut, payIn, reputation, sequence, claimData, refundData, amount, feeToken, securityDeposit, claimerBounty, claimHandlerImpl.getType(), null);\r\n    }\r\n}\r\nexports.StarknetSwapData = StarknetSwapData;\r\nbase_1.SwapData.deserializers[\"strk\"] = StarknetSwapData;\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 315, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/utils/Utils.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.findLastIndex = exports.parseInitFunctionCalldata = exports.poseidonHashRange = exports.bufferToByteArray = exports.bufferToBytes31Span = exports.bytes31SpanToBuffer = exports.toBigInt = exports.bigNumberishToBuffer = exports.u32ReverseEndianness = exports.bufferToU32Array = exports.u32ArrayToBuffer = exports.calculateHash = exports.toHex = exports.tryWithRetries = exports.getLogger = exports.onceAsync = exports.timeoutPromise = exports.isUint256 = void 0;\r\nconst starknet_types_08_1 = require(\"@starknet-io/starknet-types-08\");\r\nconst starknet_1 = require(\"starknet\");\r\nconst buffer_1 = require(\"buffer\");\r\nconst StarknetSwapData_1 = require(\"../starknet/swaps/StarknetSwapData\");\r\nfunction isUint256(val) {\r\n    return val.low != null && val.high != null;\r\n}\r\nexports.isUint256 = isUint256;\r\nfunction timeoutPromise(timeoutMillis, abortSignal) {\r\n    return new Promise((resolve, reject) => {\r\n        const timeout = setTimeout(resolve, timeoutMillis);\r\n        if (abortSignal != null)\r\n            abortSignal.addEventListener(\"abort\", () => {\r\n                clearTimeout(timeout);\r\n                reject(new Error(\"Aborted\"));\r\n            });\r\n    });\r\n}\r\nexports.timeoutPromise = timeoutPromise;\r\nfunction onceAsync(executor) {\r\n    let promise;\r\n    return () => {\r\n        if (promise == null) {\r\n            promise = executor();\r\n            return promise;\r\n        }\r\n        else {\r\n            return promise.catch(() => promise = executor());\r\n        }\r\n    };\r\n}\r\nexports.onceAsync = onceAsync;\r\nfunction getLogger(prefix) {\r\n    return {\r\n        // @ts-ignore\r\n        debug: (msg, ...args) => global.atomiqLogLevel >= 3 && console.debug(prefix + msg, ...args),\r\n        // @ts-ignore\r\n        info: (msg, ...args) => global.atomiqLogLevel >= 2 && console.info(prefix + msg, ...args),\r\n        // @ts-ignore\r\n        warn: (msg, ...args) => (global.atomiqLogLevel == null || global.atomiqLogLevel >= 1) && console.warn(prefix + msg, ...args),\r\n        // @ts-ignore\r\n        error: (msg, ...args) => (global.atomiqLogLevel == null || global.atomiqLogLevel >= 0) && console.error(prefix + msg, ...args)\r\n    };\r\n}\r\nexports.getLogger = getLogger;\r\nconst logger = getLogger(\"Utils: \");\r\nasync function tryWithRetries(func, retryPolicy, errorAllowed, abortSignal) {\r\n    retryPolicy = retryPolicy || {};\r\n    retryPolicy.maxRetries = retryPolicy.maxRetries || 5;\r\n    retryPolicy.delay = retryPolicy.delay || 500;\r\n    retryPolicy.exponential = retryPolicy.exponential == null ? true : retryPolicy.exponential;\r\n    let err = null;\r\n    for (let i = 0; i < retryPolicy.maxRetries; i++) {\r\n        try {\r\n            const resp = await func();\r\n            return resp;\r\n        }\r\n        catch (e) {\r\n            if (errorAllowed != null && errorAllowed(e))\r\n                throw e;\r\n            err = e;\r\n            logger.error(\"tryWithRetries(): error on try number: \" + i, e);\r\n        }\r\n        if (abortSignal != null && abortSignal.aborted)\r\n            throw new Error(\"Aborted\");\r\n        if (i !== retryPolicy.maxRetries - 1) {\r\n            await timeoutPromise(retryPolicy.exponential ? retryPolicy.delay * Math.pow(2, i) : retryPolicy.delay, abortSignal);\r\n        }\r\n    }\r\n    throw err;\r\n}\r\nexports.tryWithRetries = tryWithRetries;\r\nfunction toHex(value, length = 64) {\r\n    if (value == null)\r\n        return null;\r\n    switch (typeof (value)) {\r\n        case \"string\":\r\n            if (value.startsWith(\"0x\")) {\r\n                return \"0x\" + value.slice(2).padStart(length, \"0\").toLowerCase();\r\n            }\r\n            else {\r\n                return \"0x\" + BigInt(value).toString(16).padStart(length, \"0\");\r\n            }\r\n        case \"number\":\r\n        case \"bigint\":\r\n            return \"0x\" + value.toString(16).padStart(length, \"0\");\r\n    }\r\n    return \"0x\" + value.toString(\"hex\").padStart(length, \"0\");\r\n}\r\nexports.toHex = toHex;\r\nfunction calculateHash(tx) {\r\n    const commonData = {\r\n        version: tx.details.version,\r\n        maxFee: tx.details.maxFee,\r\n        chainId: tx.details.chainId,\r\n        nonce: tx.details.nonce,\r\n        accountDeploymentData: tx.details.version === \"0x3\" ? tx.details.accountDeploymentData : null,\r\n        nonceDataAvailabilityMode: tx.details.version === \"0x3\" ? starknet_types_08_1.EDAMode[tx.details.nonceDataAvailabilityMode] : null,\r\n        feeDataAvailabilityMode: tx.details.version === \"0x3\" ? starknet_types_08_1.EDAMode[tx.details.feeDataAvailabilityMode] : null,\r\n        resourceBounds: tx.details.version === \"0x3\" ? tx.details.resourceBounds : null,\r\n        tip: tx.details.version === \"0x3\" ? tx.details.tip : null,\r\n        paymasterData: tx.details.version === \"0x3\" ? tx.details.paymasterData : null\r\n    };\r\n    switch (tx.type) {\r\n        case \"INVOKE\":\r\n            const invokeData = starknet_1.CallData.compile(tx.signed.calldata);\r\n            return tx.txId = starknet_1.hash.calculateInvokeTransactionHash({\r\n                senderAddress: tx.details.walletAddress,\r\n                compiledCalldata: invokeData,\r\n                ...commonData\r\n            });\r\n        case \"DEPLOY_ACCOUNT\":\r\n            const deployAccountData = starknet_1.CallData.compile(tx.signed.constructorCalldata);\r\n            return tx.txId = starknet_1.hash.calculateDeployAccountTransactionHash({\r\n                contractAddress: tx.tx.contractAddress,\r\n                classHash: tx.signed.classHash,\r\n                constructorCalldata: deployAccountData,\r\n                compiledConstructorCalldata: deployAccountData,\r\n                salt: tx.signed.addressSalt,\r\n                ...commonData\r\n            });\r\n        default:\r\n            throw new Error(\"Unsupported tx type!\");\r\n    }\r\n}\r\nexports.calculateHash = calculateHash;\r\nfunction u32ArrayToBuffer(arr) {\r\n    const buffer = buffer_1.Buffer.alloc(4 * arr.length);\r\n    for (let i = 0; i < arr.length; i++) {\r\n        buffer.writeUInt32BE(Number(arr[i]), i * 4);\r\n    }\r\n    return buffer;\r\n}\r\nexports.u32ArrayToBuffer = u32ArrayToBuffer;\r\nfunction bufferToU32Array(buffer) {\r\n    const result = [];\r\n    for (let i = 0; i < buffer.length; i += 4) {\r\n        result.push(buffer.readUInt32BE(i));\r\n    }\r\n    return result;\r\n}\r\nexports.bufferToU32Array = bufferToU32Array;\r\nfunction u32ReverseEndianness(value) {\r\n    const valueBN = BigInt(value);\r\n    return Number(((valueBN & 0xffn) << 24n) |\r\n        ((valueBN & 0xff00n) << 8n) |\r\n        ((valueBN >> 8n) & 0xff00n) |\r\n        ((valueBN >> 24n) & 0xffn));\r\n}\r\nexports.u32ReverseEndianness = u32ReverseEndianness;\r\nfunction bigNumberishToBuffer(value, length) {\r\n    if (isUint256(value)) {\r\n        return buffer_1.Buffer.concat([bigNumberishToBuffer(value.high, 16), bigNumberishToBuffer(value.low, 16)]);\r\n    }\r\n    if (typeof (value) === \"string\") {\r\n        if (value.startsWith(\"0x\")) {\r\n            value = value.slice(2);\r\n        }\r\n        else {\r\n            value = BigInt(value).toString(16);\r\n        }\r\n    }\r\n    else {\r\n        value = value.toString(16);\r\n    }\r\n    if (length != null)\r\n        value = value.padStart(length * 2, \"0\");\r\n    const buff = buffer_1.Buffer.from(value, \"hex\");\r\n    if (buff.length > length)\r\n        return buff.slice(buff.length - length);\r\n    return buff;\r\n}\r\nexports.bigNumberishToBuffer = bigNumberishToBuffer;\r\nfunction toBigInt(value) {\r\n    if (value == null)\r\n        return null;\r\n    if (isUint256(value)) {\r\n        return (toBigInt(value.high) << 128n) | toBigInt(value.low);\r\n    }\r\n    if (typeof (value) === \"string\") {\r\n        if (!value.startsWith(\"0x\"))\r\n            value = \"0x\" + value;\r\n        return BigInt(value);\r\n    }\r\n    if (typeof (value) === \"bigint\") {\r\n        return value;\r\n    }\r\n    return BigInt(value);\r\n}\r\nexports.toBigInt = toBigInt;\r\nfunction bytes31SpanToBuffer(span, length) {\r\n    const buffers = [];\r\n    const numFullBytes31 = Math.floor(length / 31);\r\n    const additionalBytes = length - (numFullBytes31 * 31);\r\n    const requiredSpanLength = numFullBytes31 + (additionalBytes === 0 ? 0 : 1);\r\n    if (span.length < requiredSpanLength)\r\n        throw new Error(\"Not enough bytes in the felt array!\");\r\n    let i = 0;\r\n    for (; i < numFullBytes31; i++) {\r\n        buffers.push(bigNumberishToBuffer(span[i], 31));\r\n    }\r\n    if (additionalBytes !== 0)\r\n        buffers.push(bigNumberishToBuffer(span[i], additionalBytes));\r\n    return buffer_1.Buffer.concat(buffers);\r\n}\r\nexports.bytes31SpanToBuffer = bytes31SpanToBuffer;\r\nfunction bufferToBytes31Span(buffer, startIndex = 0, endIndex = buffer.length) {\r\n    const values = [];\r\n    for (let i = startIndex + 31; i < endIndex; i += 31) {\r\n        values.push(BigInt(\"0x\" + buffer.slice(i - 31, i).toString(\"hex\")));\r\n    }\r\n    if (endIndex > startIndex + (values.length * 31))\r\n        values.push(BigInt(\"0x\" + buffer.slice(startIndex + (values.length * 31), endIndex).toString(\"hex\")));\r\n    return values;\r\n}\r\nexports.bufferToBytes31Span = bufferToBytes31Span;\r\nfunction bufferToByteArray(buffer, startIndex = 0, endIndex = buffer.length) {\r\n    const values = [];\r\n    for (let i = startIndex + 31; i < endIndex; i += 31) {\r\n        values.push(BigInt(\"0x\" + buffer.slice(i - 31, i).toString(\"hex\")));\r\n    }\r\n    let pendingWord = BigInt(0);\r\n    let pendingWordLen = BigInt(endIndex - (startIndex + (values.length * 31)));\r\n    if (pendingWordLen !== BigInt(0)) {\r\n        pendingWord = BigInt(\"0x\" + buffer.slice(startIndex + (values.length * 31), endIndex).toString(\"hex\"));\r\n    }\r\n    return [\r\n        BigInt(values.length),\r\n        ...values,\r\n        pendingWord,\r\n        pendingWordLen\r\n    ];\r\n}\r\nexports.bufferToByteArray = bufferToByteArray;\r\nfunction poseidonHashRange(buffer, startIndex = 0, endIndex = buffer.length) {\r\n    return starknet_1.hash.computePoseidonHashOnElements(bufferToBytes31Span(buffer, startIndex, endIndex));\r\n}\r\nexports.poseidonHashRange = poseidonHashRange;\r\nfunction parseInitFunctionCalldata(calldata, claimHandler) {\r\n    const escrow = StarknetSwapData_1.StarknetSwapData.fromSerializedFeltArray(calldata, claimHandler);\r\n    const signatureLen = Number(toBigInt(calldata.shift()));\r\n    const signature = calldata.splice(0, signatureLen);\r\n    const timeout = toBigInt(calldata.shift());\r\n    const extraDataLen = Number(toBigInt(calldata.shift()));\r\n    const extraData = calldata.splice(0, extraDataLen);\r\n    if (calldata.length !== 0)\r\n        throw new Error(\"Calldata not read fully!\");\r\n    return { escrow, signature, timeout, extraData };\r\n}\r\nexports.parseInitFunctionCalldata = parseInitFunctionCalldata;\r\nfunction findLastIndex(array, callback) {\r\n    for (let i = array.length - 1; i >= 0; i--) {\r\n        if (callback(array[i], i))\r\n            return i;\r\n    }\r\n    return -1;\r\n}\r\nexports.findLastIndex = findLastIndex;\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 568, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/chain/StarknetModule.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetModule = void 0;\r\nconst Utils_1 = require(\"../../utils/Utils\");\r\nclass StarknetModule {\r\n    constructor(root) {\r\n        this.logger = (0, Utils_1.getLogger)(this.constructor.name + \": \");\r\n        this.provider = root.provider;\r\n        this.retryPolicy = root.retryPolicy;\r\n        this.root = root;\r\n    }\r\n}\r\nexports.StarknetModule = StarknetModule;\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,cAAc,GAAG,KAAK;AAC9B,MAAM;AACN,MAAM;IACF,YAAY,IAAI,CAAE;QACd,IAAI,CAAC,MAAM,GAAG,CAAC,GAAG,QAAQ,SAAS,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,GAAG;QAC7D,IAAI,CAAC,QAAQ,GAAG,KAAK,QAAQ;QAC7B,IAAI,CAAC,WAAW,GAAG,KAAK,WAAW;QACnC,IAAI,CAAC,IAAI,GAAG;IAChB;AACJ;AACA,QAAQ,cAAc,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 586, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/chain/modules/ERC20Abi.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ERC20Abi = void 0;\r\nexports.ERC20Abi = [\r\n    {\r\n        \"type\": \"impl\",\r\n        \"name\": \"MintableToken\",\r\n        \"interface_name\": \"src::mintable_token_interface::IMintableToken\"\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"core::integer::u256\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"low\",\r\n                \"type\": \"core::integer::u128\"\r\n            },\r\n            {\r\n                \"name\": \"high\",\r\n                \"type\": \"core::integer::u128\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"interface\",\r\n        \"name\": \"src::mintable_token_interface::IMintableToken\",\r\n        \"items\": [\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"permissioned_mint\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"account\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"amount\",\r\n                        \"type\": \"core::integer::u256\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"permissioned_burn\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"account\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"amount\",\r\n                        \"type\": \"core::integer::u256\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"impl\",\r\n        \"name\": \"MintableTokenCamelImpl\",\r\n        \"interface_name\": \"src::mintable_token_interface::IMintableTokenCamel\"\r\n    },\r\n    {\r\n        \"type\": \"interface\",\r\n        \"name\": \"src::mintable_token_interface::IMintableTokenCamel\",\r\n        \"items\": [\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"permissionedMint\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"account\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"amount\",\r\n                        \"type\": \"core::integer::u256\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"permissionedBurn\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"account\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"amount\",\r\n                        \"type\": \"core::integer::u256\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"impl\",\r\n        \"name\": \"Replaceable\",\r\n        \"interface_name\": \"src::replaceability_interface::IReplaceable\"\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"core::array::Span::<core::felt252>\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"snapshot\",\r\n                \"type\": \"@core::array::Array::<core::felt252>\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"src::replaceability_interface::EICData\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"eic_hash\",\r\n                \"type\": \"core::starknet::class_hash::ClassHash\"\r\n            },\r\n            {\r\n                \"name\": \"eic_init_data\",\r\n                \"type\": \"core::array::Span::<core::felt252>\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"enum\",\r\n        \"name\": \"core::option::Option::<src::replaceability_interface::EICData>\",\r\n        \"variants\": [\r\n            {\r\n                \"name\": \"Some\",\r\n                \"type\": \"src::replaceability_interface::EICData\"\r\n            },\r\n            {\r\n                \"name\": \"None\",\r\n                \"type\": \"()\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"enum\",\r\n        \"name\": \"core::bool\",\r\n        \"variants\": [\r\n            {\r\n                \"name\": \"False\",\r\n                \"type\": \"()\"\r\n            },\r\n            {\r\n                \"name\": \"True\",\r\n                \"type\": \"()\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"src::replaceability_interface::ImplementationData\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"impl_hash\",\r\n                \"type\": \"core::starknet::class_hash::ClassHash\"\r\n            },\r\n            {\r\n                \"name\": \"eic_data\",\r\n                \"type\": \"core::option::Option::<src::replaceability_interface::EICData>\"\r\n            },\r\n            {\r\n                \"name\": \"final\",\r\n                \"type\": \"core::bool\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"interface\",\r\n        \"name\": \"src::replaceability_interface::IReplaceable\",\r\n        \"items\": [\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"get_upgrade_delay\",\r\n                \"inputs\": [],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::integer::u64\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"get_impl_activation_time\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"implementation_data\",\r\n                        \"type\": \"src::replaceability_interface::ImplementationData\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::integer::u64\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"add_new_implementation\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"implementation_data\",\r\n                        \"type\": \"src::replaceability_interface::ImplementationData\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"remove_implementation\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"implementation_data\",\r\n                        \"type\": \"src::replaceability_interface::ImplementationData\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"replace_to\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"implementation_data\",\r\n                        \"type\": \"src::replaceability_interface::ImplementationData\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"impl\",\r\n        \"name\": \"AccessControlImplExternal\",\r\n        \"interface_name\": \"src::access_control_interface::IAccessControl\"\r\n    },\r\n    {\r\n        \"type\": \"interface\",\r\n        \"name\": \"src::access_control_interface::IAccessControl\",\r\n        \"items\": [\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"has_role\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"role\",\r\n                        \"type\": \"core::felt252\"\r\n                    },\r\n                    {\r\n                        \"name\": \"account\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::bool\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"get_role_admin\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"role\",\r\n                        \"type\": \"core::felt252\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::felt252\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"impl\",\r\n        \"name\": \"RolesImpl\",\r\n        \"interface_name\": \"src::roles_interface::IMinimalRoles\"\r\n    },\r\n    {\r\n        \"type\": \"interface\",\r\n        \"name\": \"src::roles_interface::IMinimalRoles\",\r\n        \"items\": [\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"is_governance_admin\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"account\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::bool\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"is_upgrade_governor\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"account\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::bool\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"register_governance_admin\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"account\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"remove_governance_admin\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"account\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"register_upgrade_governor\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"account\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"remove_upgrade_governor\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"account\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"renounce\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"role\",\r\n                        \"type\": \"core::felt252\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"impl\",\r\n        \"name\": \"ERC20Impl\",\r\n        \"interface_name\": \"openzeppelin::token::erc20::interface::IERC20\"\r\n    },\r\n    {\r\n        \"type\": \"interface\",\r\n        \"name\": \"openzeppelin::token::erc20::interface::IERC20\",\r\n        \"items\": [\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"name\",\r\n                \"inputs\": [],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::felt252\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"symbol\",\r\n                \"inputs\": [],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::felt252\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"decimals\",\r\n                \"inputs\": [],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::integer::u8\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"total_supply\",\r\n                \"inputs\": [],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::integer::u256\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"balance_of\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"account\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::integer::u256\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"allowance\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"owner\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"spender\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::integer::u256\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"transfer\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"recipient\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"amount\",\r\n                        \"type\": \"core::integer::u256\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::bool\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"transfer_from\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"sender\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"recipient\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"amount\",\r\n                        \"type\": \"core::integer::u256\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::bool\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"approve\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"spender\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"amount\",\r\n                        \"type\": \"core::integer::u256\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::bool\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"external\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"impl\",\r\n        \"name\": \"ERC20CamelOnlyImpl\",\r\n        \"interface_name\": \"openzeppelin::token::erc20::interface::IERC20CamelOnly\"\r\n    },\r\n    {\r\n        \"type\": \"interface\",\r\n        \"name\": \"openzeppelin::token::erc20::interface::IERC20CamelOnly\",\r\n        \"items\": [\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"totalSupply\",\r\n                \"inputs\": [],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::integer::u256\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"balanceOf\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"account\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::integer::u256\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"transferFrom\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"sender\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"recipient\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"amount\",\r\n                        \"type\": \"core::integer::u256\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::bool\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"external\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"constructor\",\r\n        \"name\": \"constructor\",\r\n        \"inputs\": [\r\n            {\r\n                \"name\": \"name\",\r\n                \"type\": \"core::felt252\"\r\n            },\r\n            {\r\n                \"name\": \"symbol\",\r\n                \"type\": \"core::felt252\"\r\n            },\r\n            {\r\n                \"name\": \"decimals\",\r\n                \"type\": \"core::integer::u8\"\r\n            },\r\n            {\r\n                \"name\": \"initial_supply\",\r\n                \"type\": \"core::integer::u256\"\r\n            },\r\n            {\r\n                \"name\": \"recipient\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            },\r\n            {\r\n                \"name\": \"permitted_minter\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            },\r\n            {\r\n                \"name\": \"provisional_governance_admin\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            },\r\n            {\r\n                \"name\": \"upgrade_delay\",\r\n                \"type\": \"core::integer::u64\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"function\",\r\n        \"name\": \"increase_allowance\",\r\n        \"inputs\": [\r\n            {\r\n                \"name\": \"spender\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            },\r\n            {\r\n                \"name\": \"added_value\",\r\n                \"type\": \"core::integer::u256\"\r\n            }\r\n        ],\r\n        \"outputs\": [\r\n            {\r\n                \"type\": \"core::bool\"\r\n            }\r\n        ],\r\n        \"state_mutability\": \"external\"\r\n    },\r\n    {\r\n        \"type\": \"function\",\r\n        \"name\": \"decrease_allowance\",\r\n        \"inputs\": [\r\n            {\r\n                \"name\": \"spender\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            },\r\n            {\r\n                \"name\": \"subtracted_value\",\r\n                \"type\": \"core::integer::u256\"\r\n            }\r\n        ],\r\n        \"outputs\": [\r\n            {\r\n                \"type\": \"core::bool\"\r\n            }\r\n        ],\r\n        \"state_mutability\": \"external\"\r\n    },\r\n    {\r\n        \"type\": \"function\",\r\n        \"name\": \"increaseAllowance\",\r\n        \"inputs\": [\r\n            {\r\n                \"name\": \"spender\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            },\r\n            {\r\n                \"name\": \"addedValue\",\r\n                \"type\": \"core::integer::u256\"\r\n            }\r\n        ],\r\n        \"outputs\": [\r\n            {\r\n                \"type\": \"core::bool\"\r\n            }\r\n        ],\r\n        \"state_mutability\": \"external\"\r\n    },\r\n    {\r\n        \"type\": \"function\",\r\n        \"name\": \"decreaseAllowance\",\r\n        \"inputs\": [\r\n            {\r\n                \"name\": \"spender\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            },\r\n            {\r\n                \"name\": \"subtractedValue\",\r\n                \"type\": \"core::integer::u256\"\r\n            }\r\n        ],\r\n        \"outputs\": [\r\n            {\r\n                \"type\": \"core::bool\"\r\n            }\r\n        ],\r\n        \"state_mutability\": \"external\"\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"openzeppelin::token::erc20_v070::erc20::ERC20::Transfer\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"from\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"to\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"value\",\r\n                \"type\": \"core::integer::u256\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"openzeppelin::token::erc20_v070::erc20::ERC20::Approval\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"owner\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"spender\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"value\",\r\n                \"type\": \"core::integer::u256\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"src::replaceability_interface::ImplementationAdded\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"implementation_data\",\r\n                \"type\": \"src::replaceability_interface::ImplementationData\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"src::replaceability_interface::ImplementationRemoved\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"implementation_data\",\r\n                \"type\": \"src::replaceability_interface::ImplementationData\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"src::replaceability_interface::ImplementationReplaced\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"implementation_data\",\r\n                \"type\": \"src::replaceability_interface::ImplementationData\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"src::replaceability_interface::ImplementationFinalized\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"impl_hash\",\r\n                \"type\": \"core::starknet::class_hash::ClassHash\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"src::access_control_interface::RoleGranted\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"role\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"account\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"sender\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"src::access_control_interface::RoleRevoked\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"role\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"account\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"sender\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"src::access_control_interface::RoleAdminChanged\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"role\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"previous_admin_role\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"new_admin_role\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"src::roles_interface::GovernanceAdminAdded\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"added_account\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"added_by\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"src::roles_interface::GovernanceAdminRemoved\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"removed_account\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"removed_by\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"src::roles_interface::UpgradeGovernorAdded\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"added_account\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"added_by\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"src::roles_interface::UpgradeGovernorRemoved\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"removed_account\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"removed_by\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"openzeppelin::token::erc20_v070::erc20::ERC20::Event\",\r\n        \"kind\": \"enum\",\r\n        \"variants\": [\r\n            {\r\n                \"name\": \"Transfer\",\r\n                \"type\": \"openzeppelin::token::erc20_v070::erc20::ERC20::Transfer\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"Approval\",\r\n                \"type\": \"openzeppelin::token::erc20_v070::erc20::ERC20::Approval\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"ImplementationAdded\",\r\n                \"type\": \"src::replaceability_interface::ImplementationAdded\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"ImplementationRemoved\",\r\n                \"type\": \"src::replaceability_interface::ImplementationRemoved\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"ImplementationReplaced\",\r\n                \"type\": \"src::replaceability_interface::ImplementationReplaced\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"ImplementationFinalized\",\r\n                \"type\": \"src::replaceability_interface::ImplementationFinalized\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"RoleGranted\",\r\n                \"type\": \"src::access_control_interface::RoleGranted\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"RoleRevoked\",\r\n                \"type\": \"src::access_control_interface::RoleRevoked\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"RoleAdminChanged\",\r\n                \"type\": \"src::access_control_interface::RoleAdminChanged\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"GovernanceAdminAdded\",\r\n                \"type\": \"src::roles_interface::GovernanceAdminAdded\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"GovernanceAdminRemoved\",\r\n                \"type\": \"src::roles_interface::GovernanceAdminRemoved\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"UpgradeGovernorAdded\",\r\n                \"type\": \"src::roles_interface::UpgradeGovernorAdded\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"UpgradeGovernorRemoved\",\r\n                \"type\": \"src::roles_interface::UpgradeGovernorRemoved\",\r\n                \"kind\": \"nested\"\r\n            }\r\n        ]\r\n    }\r\n];\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1623, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/chain/modules/StarknetAddresses.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetAddresses = void 0;\r\nconst StarknetModule_1 = require(\"../StarknetModule\");\r\nconst starknet_1 = require(\"starknet\");\r\nclass StarknetAddresses extends StarknetModule_1.StarknetModule {\r\n    ///////////////////\r\n    //// Address utils\r\n    /**\r\n     * Checks whether an address is a valid starknet address\r\n     *\r\n     * @param value\r\n     */\r\n    static isValidAddress(value) {\r\n        if (value.length !== 66)\r\n            return false;\r\n        try {\r\n            (0, starknet_1.validateAndParseAddress)(value);\r\n            return true;\r\n        }\r\n        catch (e) {\r\n            return false;\r\n        }\r\n    }\r\n}\r\nexports.StarknetAddresses = StarknetAddresses;\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,iBAAiB,GAAG,KAAK;AACjC,MAAM;AACN,MAAM;AACN,MAAM,0BAA0B,iBAAiB,cAAc;IAC3D,mBAAmB;IACnB,kBAAkB;IAClB;;;;KAIC,GACD,OAAO,eAAe,KAAK,EAAE;QACzB,IAAI,MAAM,MAAM,KAAK,IACjB,OAAO;QACX,IAAI;YACA,CAAC,GAAG,WAAW,uBAAuB,EAAE;YACxC,OAAO;QACX,EACA,OAAO,GAAG;YACN,OAAO;QACX;IACJ;AACJ;AACA,QAAQ,iBAAiB,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1651, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/chain/modules/StarknetTokens.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetTokens = void 0;\r\nconst StarknetModule_1 = require(\"../StarknetModule\");\r\nconst StarknetAction_1 = require(\"../StarknetAction\");\r\nconst ERC20Abi_1 = require(\"./ERC20Abi\");\r\nconst starknet_1 = require(\"starknet\");\r\nconst Utils_1 = require(\"../../../utils/Utils\");\r\nconst StarknetAddresses_1 = require(\"./StarknetAddresses\");\r\nclass StarknetTokens extends StarknetModule_1.StarknetModule {\r\n    getContract(address) {\r\n        return new starknet_1.Contract(ERC20Abi_1.ERC20Abi, address, this.root.provider).typedv2(ERC20Abi_1.ERC20Abi);\r\n    }\r\n    /**\r\n     * Action for transferring the erc20 token\r\n     *\r\n     * @param signer\r\n     * @param recipient\r\n     * @param token\r\n     * @param amount\r\n     * @constructor\r\n     * @private\r\n     */\r\n    Transfer(signer, recipient, token, amount) {\r\n        const erc20 = this.getContract(token);\r\n        return new StarknetAction_1.StarknetAction(signer, this.root, erc20.populateTransaction.transfer(recipient, amount), StarknetTokens.GasCosts.TRANSFER);\r\n    }\r\n    /**\r\n     * Approves spend of tokens for a specific spender\r\n     *\r\n     * @param signer\r\n     * @param spender\r\n     * @param token\r\n     * @param amount\r\n     * @constructor\r\n     * @private\r\n     */\r\n    Approve(signer, spender, token, amount) {\r\n        const erc20 = this.getContract(token);\r\n        return new StarknetAction_1.StarknetAction(signer, this.root, erc20.populateTransaction.approve(spender, amount), StarknetTokens.GasCosts.APPROVE);\r\n    }\r\n    ///////////////////\r\n    //// Tokens\r\n    /**\r\n     * Checks if the provided string is a valid starknet token\r\n     *\r\n     * @param token\r\n     */\r\n    isValidToken(token) {\r\n        return StarknetAddresses_1.StarknetAddresses.isValidAddress(token);\r\n    }\r\n    /**\r\n     * Returns the token balance of the address\r\n     *\r\n     * @param address\r\n     * @param token\r\n     */\r\n    async getTokenBalance(address, token) {\r\n        const erc20 = this.getContract(token);\r\n        const balance = await erc20.balance_of(address);\r\n        const balanceBN = (0, Utils_1.toBigInt)(balance);\r\n        this.logger.debug(\"getTokenBalance(): token balance fetched, token: \" + token +\r\n            \" address: \" + address + \" amount: \" + balanceBN.toString());\r\n        return balanceBN;\r\n    }\r\n    /**\r\n     * Returns the native currency address, return the default used by the fee module\r\n     */\r\n    getNativeCurrencyAddress() {\r\n        return this.root.Fees.getDefaultGasToken();\r\n    }\r\n    ///////////////////\r\n    //// Transfers\r\n    /**\r\n     * Creates transactions for sending the over the tokens\r\n     *\r\n     * @param signer\r\n     * @param token token to send\r\n     * @param amount amount of the token to send\r\n     * @param recipient recipient's address\r\n     * @param feeRate fee rate to use for the transactions\r\n     * @private\r\n     */\r\n    async txsTransfer(signer, token, amount, recipient, feeRate) {\r\n        const action = this.Transfer(signer, recipient, token, amount);\r\n        feeRate = feeRate ?? await this.root.Fees.getFeeRate();\r\n        this.logger.debug(\"txsTransfer(): transfer TX created, recipient: \" + recipient.toString() +\r\n            \" token: \" + token.toString() + \" amount: \" + amount.toString(10));\r\n        return [await action.tx(feeRate)];\r\n    }\r\n}\r\nexports.StarknetTokens = StarknetTokens;\r\nStarknetTokens.ERC20_ETH = \"0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7\";\r\nStarknetTokens.ERC20_STRK = \"0x04718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d\";\r\nStarknetTokens.GasCosts = {\r\n    TRANSFER: { l1DataGas: 400, l2Gas: 4000000, l1Gas: 0 },\r\n    APPROVE: { l1DataGas: 400, l2Gas: 4000000, l1Gas: 0 }\r\n};\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,cAAc,GAAG,KAAK;AAC9B,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM,uBAAuB,iBAAiB,cAAc;IACxD,YAAY,OAAO,EAAE;QACjB,OAAO,IAAI,WAAW,QAAQ,CAAC,WAAW,QAAQ,EAAE,SAAS,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,OAAO,CAAC,WAAW,QAAQ;IAChH;IACA;;;;;;;;;KASC,GACD,SAAS,MAAM,EAAE,SAAS,EAAE,KAAK,EAAE,MAAM,EAAE;QACvC,MAAM,QAAQ,IAAI,CAAC,WAAW,CAAC;QAC/B,OAAO,IAAI,iBAAiB,cAAc,CAAC,QAAQ,IAAI,CAAC,IAAI,EAAE,MAAM,mBAAmB,CAAC,QAAQ,CAAC,WAAW,SAAS,eAAe,QAAQ,CAAC,QAAQ;IACzJ;IACA;;;;;;;;;KASC,GACD,QAAQ,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,EAAE;QACpC,MAAM,QAAQ,IAAI,CAAC,WAAW,CAAC;QAC/B,OAAO,IAAI,iBAAiB,cAAc,CAAC,QAAQ,IAAI,CAAC,IAAI,EAAE,MAAM,mBAAmB,CAAC,OAAO,CAAC,SAAS,SAAS,eAAe,QAAQ,CAAC,OAAO;IACrJ;IACA,mBAAmB;IACnB,WAAW;IACX;;;;KAIC,GACD,aAAa,KAAK,EAAE;QAChB,OAAO,oBAAoB,iBAAiB,CAAC,cAAc,CAAC;IAChE;IACA;;;;;KAKC,GACD,MAAM,gBAAgB,OAAO,EAAE,KAAK,EAAE;QAClC,MAAM,QAAQ,IAAI,CAAC,WAAW,CAAC;QAC/B,MAAM,UAAU,MAAM,MAAM,UAAU,CAAC;QACvC,MAAM,YAAY,CAAC,GAAG,QAAQ,QAAQ,EAAE;QACxC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,sDAAsD,QACpE,eAAe,UAAU,cAAc,UAAU,QAAQ;QAC7D,OAAO;IACX;IACA;;KAEC,GACD,2BAA2B;QACvB,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,kBAAkB;IAC5C;IACA,mBAAmB;IACnB,cAAc;IACd;;;;;;;;;KASC,GACD,MAAM,YAAY,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE;QACzD,MAAM,SAAS,IAAI,CAAC,QAAQ,CAAC,QAAQ,WAAW,OAAO;QACvD,UAAU,WAAW,MAAM,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU;QACpD,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,oDAAoD,UAAU,QAAQ,KACpF,aAAa,MAAM,QAAQ,KAAK,cAAc,OAAO,QAAQ,CAAC;QAClE,OAAO;YAAC,MAAM,OAAO,EAAE,CAAC;SAAS;IACrC;AACJ;AACA,QAAQ,cAAc,GAAG;AACzB,eAAe,SAAS,GAAG;AAC3B,eAAe,UAAU,GAAG;AAC5B,eAAe,QAAQ,GAAG;IACtB,UAAU;QAAE,WAAW;QAAK,OAAO;QAAS,OAAO;IAAE;IACrD,SAAS;QAAE,WAAW;QAAK,OAAO;QAAS,OAAO;IAAE;AACxD","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1756, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/chain/modules/StarknetFees.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetFees = exports.starknetGasAdd = exports.starknetGasMul = void 0;\r\nconst Utils_1 = require(\"../../../utils/Utils\");\r\nconst StarknetTokens_1 = require(\"./StarknetTokens\");\r\nconst MAX_FEE_AGE = 5000;\r\nfunction starknetGasMul(gas, scalar) {\r\n    return { l1Gas: gas.l1Gas * scalar, l2Gas: gas.l2Gas * scalar, l1DataGas: gas.l1DataGas * scalar };\r\n}\r\nexports.starknetGasMul = starknetGasMul;\r\nfunction starknetGasAdd(a, b) {\r\n    return { l1Gas: a.l1Gas + b.l1Gas, l2Gas: a.l2Gas + b.l2Gas, l1DataGas: a.l1DataGas + b.l1DataGas };\r\n}\r\nexports.starknetGasAdd = starknetGasAdd;\r\nclass StarknetFees {\r\n    constructor(provider, maxFeeRate = { l1GasCost: 20000000000000000n, l2GasCost: 4000000000000000n, l1DataGasCost: 10000000000000000n }, feeMultiplier = 1.25, da) {\r\n        this.logger = (0, Utils_1.getLogger)(\"StarknetFees: \");\r\n        this.blockFeeCache = null;\r\n        this.provider = provider;\r\n        this.maxFeeRate = maxFeeRate;\r\n        this.feeDA = da?.fee ?? \"L1\";\r\n        this.nonceDA = da?.nonce ?? \"L1\";\r\n        this.feeMultiplierPPM = BigInt(Math.floor(feeMultiplier * 1000000));\r\n    }\r\n    /**\r\n     * Gets starknet fee rate\r\n     *\r\n     * @private\r\n     * @returns {Promise<StarknetFeeRate>} L1 gas price denominated in Wei\r\n     */\r\n    async _getFeeRate() {\r\n        const block = await this.provider.getBlock(\"latest\");\r\n        let l1GasCost = (0, Utils_1.toBigInt)(block.l1_gas_price.price_in_fri) * this.feeMultiplierPPM / 1000000n;\r\n        let l1DataGasCost = (0, Utils_1.toBigInt)(block.l1_data_gas_price.price_in_fri) * this.feeMultiplierPPM / 1000000n;\r\n        let l2GasCost = (0, Utils_1.toBigInt)(block.l2_gas_price.price_in_fri) * this.feeMultiplierPPM / 1000000n;\r\n        this.logger.debug(\"_getFeeRate(): L1 fee rate: \", [l1GasCost.toString(10), l1DataGasCost.toString(10), l2GasCost.toString(10)]);\r\n        return {\r\n            l1GasCost, l2GasCost, l1DataGasCost\r\n        };\r\n    }\r\n    /**\r\n     * Gets the gas price with caching, format: <gas price in Wei>;<transaction version: v1/v3>\r\n     *\r\n     * @private\r\n     */\r\n    async getFeeRate() {\r\n        if (this.blockFeeCache == null || Date.now() - this.blockFeeCache.timestamp > MAX_FEE_AGE) {\r\n            let obj = {\r\n                timestamp: Date.now(),\r\n                feeRate: null\r\n            };\r\n            obj.feeRate = this._getFeeRate().catch(e => {\r\n                if (this.blockFeeCache === obj)\r\n                    this.blockFeeCache = null;\r\n                throw e;\r\n            });\r\n            this.blockFeeCache = obj;\r\n        }\r\n        let { l1GasCost, l2GasCost, l1DataGasCost } = await this.blockFeeCache.feeRate;\r\n        if (l1GasCost > this.maxFeeRate.l1GasCost)\r\n            l1GasCost = this.maxFeeRate.l1GasCost;\r\n        if (l2GasCost > this.maxFeeRate.l2GasCost)\r\n            l2GasCost = this.maxFeeRate.l2GasCost;\r\n        if (l1DataGasCost > this.maxFeeRate.l1DataGasCost)\r\n            l1DataGasCost = this.maxFeeRate.l1DataGasCost;\r\n        const fee = l1GasCost.toString(10) + \",\" + l2GasCost.toString(10) + \",\" + l1DataGasCost.toString(10) + \";v3\";\r\n        this.logger.debug(\"getFeeRate(): calculated fee: \" + fee);\r\n        return fee;\r\n    }\r\n    getDefaultGasToken() {\r\n        return StarknetTokens_1.StarknetTokens.ERC20_STRK;\r\n    }\r\n    /**\r\n     * Calculates the total gas fee paid for a given gas limit at a given fee rate\r\n     *\r\n     * @param gas\r\n     * @param feeRate\r\n     */\r\n    static getGasFee(gas, feeRate) {\r\n        if (feeRate == null)\r\n            return 0n;\r\n        const arr = feeRate.split(\";\");\r\n        const [l1GasCostStr, l2GasCostStr, l1DataGasCostStr] = arr[0].split(\",\");\r\n        return (BigInt(gas.l1Gas) * BigInt(l1GasCostStr)) +\r\n            (BigInt(gas.l2Gas) * BigInt(l2GasCostStr)) +\r\n            (BigInt(gas.l1DataGas) * BigInt(l1DataGasCostStr));\r\n    }\r\n    static getGasToken(feeRate) {\r\n        if (feeRate == null)\r\n            return null;\r\n        const arr = feeRate.split(\";\");\r\n        const txVersion = arr[1];\r\n        return txVersion === \"v1\" ? StarknetTokens_1.StarknetTokens.ERC20_ETH : StarknetTokens_1.StarknetTokens.ERC20_STRK;\r\n    }\r\n    getFeeDetails(gas, feeRate) {\r\n        if (feeRate == null)\r\n            return null;\r\n        const arr = feeRate.split(\";\");\r\n        const [l1GasCostStr, l2GasCostStr, l1DataGasCostStr] = arr[0].split(\",\");\r\n        return {\r\n            version: \"0x3\",\r\n            resourceBounds: {\r\n                l1_gas: { max_amount: (0, Utils_1.toHex)(gas.l1Gas, 16), max_price_per_unit: (0, Utils_1.toHex)(BigInt(l1GasCostStr), 16) },\r\n                l2_gas: { max_amount: (0, Utils_1.toHex)(gas.l2Gas, 16), max_price_per_unit: (0, Utils_1.toHex)(BigInt(l2GasCostStr), 16) },\r\n                l1_data_gas: { max_amount: (0, Utils_1.toHex)(gas.l1DataGas, 16), max_price_per_unit: (0, Utils_1.toHex)(BigInt(l1DataGasCostStr), 16) }\r\n            },\r\n            tip: \"0x0\",\r\n            paymasterData: [],\r\n            nonceDataAvailabilityMode: this.nonceDA,\r\n            feeDataAvailabilityMode: this.feeDA\r\n        };\r\n    }\r\n}\r\nexports.StarknetFees = StarknetFees;\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1890, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/chain/StarknetAction.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetAction = void 0;\r\nconst StarknetFees_1 = require(\"./modules/StarknetFees\");\r\nclass StarknetAction {\r\n    constructor(mainSigner, root, instructions = [], gasLimit, feeRate) {\r\n        this.mainSigner = mainSigner;\r\n        this.root = root;\r\n        this.instructions = Array.isArray(instructions) ? instructions : [instructions];\r\n        this.gas = {\r\n            l1Gas: gasLimit?.l1Gas ?? 0,\r\n            l2Gas: gasLimit?.l2Gas ?? 0,\r\n            l1DataGas: gasLimit?.l1DataGas ?? 0,\r\n        };\r\n        this.feeRate = feeRate;\r\n    }\r\n    estimateFeeRate() {\r\n        return this.root.Fees.getFeeRate();\r\n    }\r\n    addIx(instruction, gasLimit) {\r\n        this.instructions.push(instruction);\r\n        this.gas = (0, StarknetFees_1.starknetGasAdd)(this.gas, gasLimit);\r\n    }\r\n    add(action) {\r\n        return this.addAction(action);\r\n    }\r\n    addAction(action, index = this.instructions.length) {\r\n        if (action.mainSigner !== this.mainSigner)\r\n            throw new Error(\"Actions need to have the same signer!\");\r\n        if (this.gas.l1Gas == null && action.gas.l1Gas != null)\r\n            this.gas.l1Gas = action.gas.l1Gas;\r\n        if (this.gas.l2Gas == null && action.gas.l2Gas != null)\r\n            this.gas.l2Gas = action.gas.l2Gas;\r\n        if (this.gas.l1DataGas == null && action.gas.l1DataGas != null)\r\n            this.gas.l1DataGas = action.gas.l1DataGas;\r\n        if (this.gas.l1Gas != null && action.gas.l1Gas != null)\r\n            this.gas.l1Gas += action.gas.l1Gas;\r\n        if (this.gas.l2Gas != null && action.gas.l2Gas != null)\r\n            this.gas.l2Gas += action.gas.l2Gas;\r\n        if (this.gas.l1DataGas != null && action.gas.l1DataGas != null)\r\n            this.gas.l1DataGas += action.gas.l1DataGas;\r\n        this.instructions.splice(index, 0, ...action.instructions);\r\n        if (this.feeRate == null)\r\n            this.feeRate = action.feeRate;\r\n        return this;\r\n    }\r\n    async tx(feeRate) {\r\n        if (feeRate == null)\r\n            feeRate = this.feeRate;\r\n        if (feeRate == null)\r\n            feeRate = await this.estimateFeeRate();\r\n        return {\r\n            type: \"INVOKE\",\r\n            tx: this.instructions,\r\n            details: {\r\n                ...this.root.Fees.getFeeDetails(this.gas, feeRate),\r\n                walletAddress: this.mainSigner,\r\n                cairoVersion: \"1\",\r\n                chainId: this.root.starknetChainId,\r\n                nonce: null,\r\n                accountDeploymentData: [],\r\n                skipValidate: false\r\n            }\r\n        };\r\n    }\r\n    async addToTxs(txs, feeRate) {\r\n        txs.push(await this.tx(feeRate));\r\n    }\r\n    ixsLength() {\r\n        return this.instructions.length;\r\n    }\r\n}\r\nexports.StarknetAction = StarknetAction;\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1960, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/chain/modules/StarknetTransactions.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetTransactions = void 0;\r\nconst StarknetModule_1 = require(\"../StarknetModule\");\r\nconst Utils_1 = require(\"../../../utils/Utils\");\r\nclass StarknetTransactions extends StarknetModule_1.StarknetModule {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.latestConfirmedNonces = {};\r\n    }\r\n    /**\r\n     * Waits for transaction confirmation using WS subscription and occasional HTTP polling, also re-sends\r\n     *  the transaction at regular interval\r\n     *\r\n     * @param tx starknet transaction to wait for confirmation for & keep re-sending until it confirms\r\n     * @param abortSignal signal to abort waiting for tx confirmation\r\n     * @private\r\n     */\r\n    async confirmTransaction(tx, abortSignal) {\r\n        let state = \"pending\";\r\n        while (state === \"pending\" || state === \"not_found\") {\r\n            await (0, Utils_1.timeoutPromise)(3000, abortSignal);\r\n            state = await this._getTxIdStatus(tx.txId);\r\n            if (state === \"not_found\" && tx.signed != null)\r\n                await this.sendSignedTransaction(tx).catch(e => {\r\n                    if (e.baseError?.code === 59)\r\n                        return; //Transaction already in the mempool\r\n                    this.logger.error(\"confirmTransaction(): Error on transaction re-send: \", e);\r\n                });\r\n        }\r\n        if (state === \"rejected\")\r\n            throw new Error(\"Transaction rejected!\");\r\n        const nextAccountNonce = (0, Utils_1.toBigInt)(tx.details.nonce) + 1n;\r\n        const currentNonce = this.latestConfirmedNonces[tx.details.walletAddress];\r\n        if (currentNonce == null || nextAccountNonce > currentNonce) {\r\n            this.latestConfirmedNonces[tx.details.walletAddress] = nextAccountNonce;\r\n        }\r\n        if (state === \"reverted\")\r\n            throw new Error(\"Transaction reverted!\");\r\n    }\r\n    /**\r\n     * Prepares starknet transactions, checks if the account is deployed, assigns nonces if needed & calls beforeTxSigned callback\r\n     *\r\n     * @param signer\r\n     * @param txs\r\n     * @private\r\n     */\r\n    async prepareTransactions(signer, txs) {\r\n        let nonce = await signer.getNonce();\r\n        const latestConfirmedNonce = this.latestConfirmedNonces[signer.getAddress()];\r\n        if (latestConfirmedNonce != null && latestConfirmedNonce > nonce) {\r\n            this.logger.debug(\"prepareTransactions(): Using nonce from local cache!\");\r\n            nonce = latestConfirmedNonce;\r\n        }\r\n        if (nonce === BigInt(0) && signer.isWalletAccount()) {\r\n            //Just increment the nonce by one and hope the wallet is smart enough to deploy account first\r\n            nonce = BigInt(1);\r\n        }\r\n        const deployPayload = await signer.checkAndGetDeployPayload(nonce);\r\n        if (deployPayload != null) {\r\n            txs.unshift(await this.root.Accounts.getAccountDeployTransaction(deployPayload));\r\n        }\r\n        for (let i = 0; i < txs.length; i++) {\r\n            const tx = txs[i];\r\n            if (tx.details.nonce != null)\r\n                nonce = BigInt(tx.details.nonce); //Take the nonce from last tx\r\n            if (nonce == null)\r\n                nonce = BigInt(await this.root.provider.getNonceForAddress(signer.getAddress())); //Fetch the nonce\r\n            if (tx.details.nonce == null)\r\n                tx.details.nonce = nonce;\r\n            this.logger.debug(\"sendAndConfirm(): transaction prepared (\" + (i + 1) + \"/\" + txs.length + \"), nonce: \" + tx.details.nonce);\r\n            nonce += BigInt(1);\r\n            if (this.cbkBeforeTxSigned != null)\r\n                await this.cbkBeforeTxSigned(tx);\r\n        }\r\n    }\r\n    /**\r\n     * Sends out a signed transaction to the RPC\r\n     *\r\n     * @param tx Starknet tx to send\r\n     * @param onBeforePublish a callback called before every transaction is published\r\n     * @param signer\r\n     * @private\r\n     */\r\n    async sendSignedTransaction(tx, onBeforePublish, signer) {\r\n        if (onBeforePublish != null)\r\n            await onBeforePublish(tx.txId, await this.serializeTx(tx));\r\n        this.logger.debug(\"sendSignedTransaction(): sending transaction: \", tx.txId);\r\n        if (tx.signed == null) {\r\n            let txHash;\r\n            switch (tx.type) {\r\n                case \"INVOKE\":\r\n                    txHash = (await signer.account.execute(tx.tx, tx.details)).transaction_hash;\r\n                    break;\r\n                case \"DEPLOY_ACCOUNT\":\r\n                    txHash = (await signer.account.deployAccount(tx.tx, tx.details)).transaction_hash;\r\n                    break;\r\n                default:\r\n                    throw new Error(\"Unsupported tx type!\");\r\n            }\r\n            tx.txId = txHash;\r\n            return txHash;\r\n        }\r\n        let txResult;\r\n        switch (tx.type) {\r\n            case \"INVOKE\":\r\n                txResult = await this.provider.channel.invoke(tx.signed, tx.details).then(res => res.transaction_hash);\r\n                break;\r\n            case \"DEPLOY_ACCOUNT\":\r\n                txResult = await this.provider.channel.deployAccount(tx.signed, tx.details).then((res) => res.transaction_hash);\r\n                break;\r\n            default:\r\n                throw new Error(\"Unsupported tx type!\");\r\n        }\r\n        if (tx.txId !== txResult)\r\n            this.logger.warn(\"sendSignedTransaction(): sent tx hash not matching the precomputed hash!\");\r\n        this.logger.info(\"sendSignedTransaction(): tx sent, expected txHash: \" + tx.txId + \", txHash: \" + txResult);\r\n        return txResult;\r\n    }\r\n    /**\r\n     * Prepares, signs , sends (in parallel or sequentially) & optionally waits for confirmation\r\n     *  of a batch of starknet transactions\r\n     *\r\n     * @param signer\r\n     * @param txs transactions to send\r\n     * @param waitForConfirmation whether to wait for transaction confirmations (this also makes sure the transactions\r\n     *  are re-sent at regular intervals)\r\n     * @param abortSignal abort signal to abort waiting for transaction confirmations\r\n     * @param parallel whether the send all the transaction at once in parallel or sequentially (such that transactions\r\n     *  are executed in order)\r\n     * @param onBeforePublish a callback called before every transaction is published\r\n     */\r\n    async sendAndConfirm(signer, txs, waitForConfirmation, abortSignal, parallel, onBeforePublish) {\r\n        await this.prepareTransactions(signer, txs);\r\n        if (!signer.isWalletAccount()) {\r\n            for (let i = 0; i < txs.length; i++) {\r\n                const tx = txs[i];\r\n                switch (tx.type) {\r\n                    case \"INVOKE\":\r\n                        tx.signed = await signer.account.buildInvocation(tx.tx, tx.details);\r\n                        (0, Utils_1.calculateHash)(tx);\r\n                        break;\r\n                    case \"DEPLOY_ACCOUNT\":\r\n                        tx.signed = await signer.account.buildAccountDeployPayload(tx.tx, tx.details);\r\n                        (0, Utils_1.calculateHash)(tx);\r\n                        break;\r\n                    default:\r\n                        throw new Error(\"Unsupported tx type!\");\r\n                }\r\n                this.logger.debug(\"sendAndConfirm(): transaction signed (\" + (i + 1) + \"/\" + txs.length + \"): \" + tx.txId);\r\n            }\r\n        }\r\n        this.logger.debug(\"sendAndConfirm(): sending transactions, count: \" + txs.length +\r\n            \" waitForConfirmation: \" + waitForConfirmation + \" parallel: \" + parallel);\r\n        const txIds = [];\r\n        if (parallel) {\r\n            const promises = [];\r\n            for (let i = 0; i < txs.length; i++) {\r\n                const signedTx = txs[i];\r\n                const txId = await this.sendSignedTransaction(signedTx, onBeforePublish, signer);\r\n                if (waitForConfirmation)\r\n                    promises.push(this.confirmTransaction(signedTx, abortSignal));\r\n                txIds.push(txId);\r\n                this.logger.debug(\"sendAndConfirm(): transaction sent (\" + (i + 1) + \"/\" + txs.length + \"): \" + signedTx.txId);\r\n            }\r\n            if (promises.length > 0)\r\n                await Promise.all(promises);\r\n        }\r\n        else {\r\n            for (let i = 0; i < txs.length; i++) {\r\n                const signedTx = txs[i];\r\n                const txId = await this.sendSignedTransaction(signedTx, onBeforePublish, signer);\r\n                const confirmPromise = this.confirmTransaction(signedTx, abortSignal);\r\n                this.logger.debug(\"sendAndConfirm(): transaction sent (\" + (i + 1) + \"/\" + txs.length + \"): \" + signedTx.txId);\r\n                //Don't await the last promise when !waitForConfirmation\r\n                if (i < txs.length - 1 || waitForConfirmation)\r\n                    await confirmPromise;\r\n                txIds.push(txId);\r\n            }\r\n        }\r\n        this.logger.info(\"sendAndConfirm(): sent transactions, count: \" + txs.length +\r\n            \" waitForConfirmation: \" + waitForConfirmation + \" parallel: \" + parallel);\r\n        return txIds;\r\n    }\r\n    /**\r\n     * Serializes the solana transaction, saves the transaction, signers & last valid blockheight\r\n     *\r\n     * @param tx\r\n     */\r\n    serializeTx(tx) {\r\n        return Promise.resolve(JSON.stringify(tx, (key, value) => {\r\n            if (typeof (value) === \"bigint\")\r\n                return (0, Utils_1.toHex)(value);\r\n            return value;\r\n        }));\r\n    }\r\n    /**\r\n     * Deserializes saved solana transaction, extracting the transaction, signers & last valid blockheight\r\n     *\r\n     * @param txData\r\n     */\r\n    deserializeTx(txData) {\r\n        return Promise.resolve(JSON.parse(txData));\r\n    }\r\n    /**\r\n     * Gets the status of the raw starknet transaction\r\n     *\r\n     * @param tx\r\n     */\r\n    async getTxStatus(tx) {\r\n        const parsedTx = await this.deserializeTx(tx);\r\n        return await this.getTxIdStatus(parsedTx.txId);\r\n    }\r\n    /**\r\n     * Gets the status of the starknet transaction with a specific txId\r\n     *\r\n     * @param txId\r\n     */\r\n    async _getTxIdStatus(txId) {\r\n        const status = await this.provider.getTransactionStatus(txId).catch(e => {\r\n            if (e.message != null && e.message.includes(\"29: Transaction hash not found\"))\r\n                return null;\r\n            throw e;\r\n        });\r\n        if (status == null)\r\n            return \"not_found\";\r\n        if (status.finality_status === \"RECEIVED\")\r\n            return \"pending\";\r\n        if (status.finality_status === \"REJECTED\")\r\n            return \"rejected\";\r\n        if (status.execution_status === \"SUCCEEDED\") {\r\n            return \"success\";\r\n        }\r\n        return \"reverted\";\r\n    }\r\n    /**\r\n     * Gets the status of the starknet transaction with a specific txId\r\n     *\r\n     * @param txId\r\n     */\r\n    async getTxIdStatus(txId) {\r\n        const status = await this._getTxIdStatus(txId);\r\n        if (status === \"rejected\")\r\n            return \"reverted\";\r\n        return status;\r\n    }\r\n    onBeforeTxSigned(callback) {\r\n        this.cbkBeforeTxSigned = callback;\r\n    }\r\n    offBeforeTxSigned(callback) {\r\n        this.cbkBeforeTxSigned = null;\r\n        return true;\r\n    }\r\n}\r\nexports.StarknetTransactions = StarknetTransactions;\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2189, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/chain/modules/StarknetEvents.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetEvents = void 0;\r\nconst StarknetModule_1 = require(\"../StarknetModule\");\r\nclass StarknetEvents extends StarknetModule_1.StarknetModule {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.EVENTS_LIMIT = 100;\r\n        this.FORWARD_BLOCK_RANGE = 2000;\r\n    }\r\n    /**\r\n     * Returns the all the events occuring in a block range as identified by the contract and keys\r\n     *\r\n     * @param contract\r\n     * @param keys\r\n     * @param startBlock\r\n     * @param endBlock\r\n     * @param abortSignal\r\n     */\r\n    async getBlockEvents(contract, keys, startBlock, endBlock = startBlock, abortSignal) {\r\n        const events = [];\r\n        let result = null;\r\n        while (result == null || result?.continuation_token != null) {\r\n            result = await this.root.provider.getEvents({\r\n                address: contract,\r\n                from_block: startBlock == null ? \"pending\" : { block_number: startBlock },\r\n                to_block: endBlock == null ? \"pending\" : { block_number: endBlock },\r\n                keys,\r\n                chunk_size: this.EVENTS_LIMIT,\r\n                continuation_token: result?.continuation_token\r\n            });\r\n            if (abortSignal != null)\r\n                abortSignal.throwIfAborted();\r\n            events.push(...result.events);\r\n        }\r\n        return events;\r\n    }\r\n    /**\r\n     * Runs a search backwards in time, processing events from a specific contract and keys\r\n     *\r\n     * @param contract\r\n     * @param keys\r\n     * @param processor called for every batch of returned signatures, should return a value if the correct signature\r\n     *  was found, or null if the search should continue\r\n     * @param abortSignal\r\n     */\r\n    async findInEvents(contract, keys, processor, abortSignal) {\r\n        const latestBlockNumber = await this.provider.getBlockNumber();\r\n        for (let blockNumber = latestBlockNumber; blockNumber >= 0; blockNumber -= this.FORWARD_BLOCK_RANGE) {\r\n            const eventsResult = await this.getBlockEvents(contract, keys, Math.max(blockNumber - this.FORWARD_BLOCK_RANGE, 0), blockNumber === latestBlockNumber ? null : blockNumber, abortSignal);\r\n            const result = await processor(eventsResult.reverse());\r\n            if (result != null)\r\n                return result;\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Runs a search forwards in time, processing events from a specific contract and keys\r\n     *\r\n     * @param contract\r\n     * @param keys\r\n     * @param processor called for every batch of returned signatures, should return a value if the correct signature\r\n     *  was found, or null if the search should continue\r\n     * @param abortSignal\r\n     * @param logFetchLimit\r\n     */\r\n    async findInEventsForward(contract, keys, processor, abortSignal, logFetchLimit) {\r\n        if (logFetchLimit == null || logFetchLimit > this.EVENTS_LIMIT)\r\n            logFetchLimit = this.EVENTS_LIMIT;\r\n        let eventsResult = null;\r\n        while (eventsResult == null || eventsResult?.continuation_token != null) {\r\n            eventsResult = await this.root.provider.getEvents({\r\n                address: contract,\r\n                to_block: \"latest\",\r\n                keys,\r\n                chunk_size: logFetchLimit ?? this.EVENTS_LIMIT,\r\n                continuation_token: eventsResult?.continuation_token\r\n            });\r\n            if (abortSignal != null)\r\n                abortSignal.throwIfAborted();\r\n            const result = await processor(eventsResult.events);\r\n            if (result != null)\r\n                return result;\r\n        }\r\n        return null;\r\n    }\r\n}\r\nexports.StarknetEvents = StarknetEvents;\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,cAAc,GAAG,KAAK;AAC9B,MAAM;AACN,MAAM,uBAAuB,iBAAiB,cAAc;IACxD,aAAc;QACV,KAAK,IAAI;QACT,IAAI,CAAC,YAAY,GAAG;QACpB,IAAI,CAAC,mBAAmB,GAAG;IAC/B;IACA;;;;;;;;KAQC,GACD,MAAM,eAAe,QAAQ,EAAE,IAAI,EAAE,UAAU,EAAE,WAAW,UAAU,EAAE,WAAW,EAAE;QACjF,MAAM,SAAS,EAAE;QACjB,IAAI,SAAS;QACb,MAAO,UAAU,QAAQ,QAAQ,sBAAsB,KAAM;YACzD,SAAS,MAAM,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC;gBACxC,SAAS;gBACT,YAAY,cAAc,OAAO,YAAY;oBAAE,cAAc;gBAAW;gBACxE,UAAU,YAAY,OAAO,YAAY;oBAAE,cAAc;gBAAS;gBAClE;gBACA,YAAY,IAAI,CAAC,YAAY;gBAC7B,oBAAoB,QAAQ;YAChC;YACA,IAAI,eAAe,MACf,YAAY,cAAc;YAC9B,OAAO,IAAI,IAAI,OAAO,MAAM;QAChC;QACA,OAAO;IACX;IACA;;;;;;;;KAQC,GACD,MAAM,aAAa,QAAQ,EAAE,IAAI,EAAE,SAAS,EAAE,WAAW,EAAE;QACvD,MAAM,oBAAoB,MAAM,IAAI,CAAC,QAAQ,CAAC,cAAc;QAC5D,IAAK,IAAI,cAAc,mBAAmB,eAAe,GAAG,eAAe,IAAI,CAAC,mBAAmB,CAAE;YACjG,MAAM,eAAe,MAAM,IAAI,CAAC,cAAc,CAAC,UAAU,MAAM,KAAK,GAAG,CAAC,cAAc,IAAI,CAAC,mBAAmB,EAAE,IAAI,gBAAgB,oBAAoB,OAAO,aAAa;YAC5K,MAAM,SAAS,MAAM,UAAU,aAAa,OAAO;YACnD,IAAI,UAAU,MACV,OAAO;QACf;QACA,OAAO;IACX;IACA;;;;;;;;;KASC,GACD,MAAM,oBAAoB,QAAQ,EAAE,IAAI,EAAE,SAAS,EAAE,WAAW,EAAE,aAAa,EAAE;QAC7E,IAAI,iBAAiB,QAAQ,gBAAgB,IAAI,CAAC,YAAY,EAC1D,gBAAgB,IAAI,CAAC,YAAY;QACrC,IAAI,eAAe;QACnB,MAAO,gBAAgB,QAAQ,cAAc,sBAAsB,KAAM;YACrE,eAAe,MAAM,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC;gBAC9C,SAAS;gBACT,UAAU;gBACV;gBACA,YAAY,iBAAiB,IAAI,CAAC,YAAY;gBAC9C,oBAAoB,cAAc;YACtC;YACA,IAAI,eAAe,MACf,YAAY,cAAc;YAC9B,MAAM,SAAS,MAAM,UAAU,aAAa,MAAM;YAClD,IAAI,UAAU,MACV,OAAO;QACf;QACA,OAAO;IACX;AACJ;AACA,QAAQ,cAAc,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2278, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/chain/modules/StarknetSignatures.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetSignatures = void 0;\r\nconst buffer_1 = require(\"buffer\");\r\nconst StarknetModule_1 = require(\"../StarknetModule\");\r\nconst starknet_1 = require(\"starknet\");\r\nconst Utils_1 = require(\"../../../utils/Utils\");\r\nconst sha2_1 = require(\"@noble/hashes/sha2\");\r\nconst StarknetDomain = [\r\n    { name: 'name', type: 'shortstring' },\r\n    { name: 'version', type: 'shortstring' },\r\n    { name: 'chainId', type: 'shortstring' },\r\n    { name: 'revision', type: 'shortstring' },\r\n];\r\nconst DataHash = [\r\n    { name: 'Data hash', type: 'u256' }\r\n];\r\nclass StarknetSignatures extends StarknetModule_1.StarknetModule {\r\n    constructor(root, domainName = \"atomiq.exchange\") {\r\n        super(root);\r\n        this.domain = {\r\n            name: domainName,\r\n            version: '1',\r\n            chainId: starknet_1.shortString.decodeShortString(root.starknetChainId),\r\n            revision: '1'\r\n        };\r\n    }\r\n    getTypedMessage(type, typeName, message) {\r\n        return {\r\n            types: {\r\n                StarknetDomain,\r\n                [typeName]: type,\r\n            },\r\n            primaryType: typeName,\r\n            domain: this.domain,\r\n            message\r\n        };\r\n    }\r\n    async signTypedMessage(signer, type, typeName, message) {\r\n        const signature = await signer.account.signMessage(this.getTypedMessage(type, typeName, message));\r\n        return JSON.stringify(starknet_1.stark.formatSignature(signature));\r\n    }\r\n    async isValidSignature(signature, address, type, typeName, message) {\r\n        return this.provider.verifyMessageInStarknet(this.getTypedMessage(type, typeName, message), JSON.parse(signature), address);\r\n    }\r\n    ///////////////////\r\n    //// Data signatures\r\n    /**\r\n     * Produces a signature over the sha256 of a specified data Buffer, only works with providers which\r\n     *  expose their private key (i.e. backend based, not browser wallet based)\r\n     *\r\n     * @param signer\r\n     * @param data data to sign\r\n     */\r\n    getDataSignature(signer, data) {\r\n        const buff = buffer_1.Buffer.from((0, sha2_1.sha256)(data));\r\n        return this.signTypedMessage(signer, DataHash, 'DataHash', { \"Data hash\": starknet_1.cairo.uint256((0, Utils_1.toHex)(buff)) });\r\n    }\r\n    /**\r\n     * Checks whether a signature is a valid signature produced by the account over a data message (computes\r\n     *  sha256 hash of the message)\r\n     *\r\n     * @param data signed data\r\n     * @param signature data signature\r\n     * @param address public key of the signer\r\n     */\r\n    isValidDataSignature(data, signature, address) {\r\n        const buff = buffer_1.Buffer.from((0, sha2_1.sha256)(data));\r\n        return this.isValidSignature(signature, address, DataHash, 'DataHash', { \"Data hash\": starknet_1.cairo.uint256((0, Utils_1.toHex)(buff)) });\r\n    }\r\n}\r\nexports.StarknetSignatures = StarknetSignatures;\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,kBAAkB,GAAG,KAAK;AAClC,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM,iBAAiB;IACnB;QAAE,MAAM;QAAQ,MAAM;IAAc;IACpC;QAAE,MAAM;QAAW,MAAM;IAAc;IACvC;QAAE,MAAM;QAAW,MAAM;IAAc;IACvC;QAAE,MAAM;QAAY,MAAM;IAAc;CAC3C;AACD,MAAM,WAAW;IACb;QAAE,MAAM;QAAa,MAAM;IAAO;CACrC;AACD,MAAM,2BAA2B,iBAAiB,cAAc;IAC5D,YAAY,IAAI,EAAE,aAAa,iBAAiB,CAAE;QAC9C,KAAK,CAAC;QACN,IAAI,CAAC,MAAM,GAAG;YACV,MAAM;YACN,SAAS;YACT,SAAS,WAAW,WAAW,CAAC,iBAAiB,CAAC,KAAK,eAAe;YACtE,UAAU;QACd;IACJ;IACA,gBAAgB,IAAI,EAAE,QAAQ,EAAE,OAAO,EAAE;QACrC,OAAO;YACH,OAAO;gBACH;gBACA,CAAC,SAAS,EAAE;YAChB;YACA,aAAa;YACb,QAAQ,IAAI,CAAC,MAAM;YACnB;QACJ;IACJ;IACA,MAAM,iBAAiB,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,EAAE;QACpD,MAAM,YAAY,MAAM,OAAO,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,eAAe,CAAC,MAAM,UAAU;QACxF,OAAO,KAAK,SAAS,CAAC,WAAW,KAAK,CAAC,eAAe,CAAC;IAC3D;IACA,MAAM,iBAAiB,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,EAAE;QAChE,OAAO,IAAI,CAAC,QAAQ,CAAC,uBAAuB,CAAC,IAAI,CAAC,eAAe,CAAC,MAAM,UAAU,UAAU,KAAK,KAAK,CAAC,YAAY;IACvH;IACA,mBAAmB;IACnB,oBAAoB;IACpB;;;;;;KAMC,GACD,iBAAiB,MAAM,EAAE,IAAI,EAAE;QAC3B,MAAM,OAAO,SAAS,MAAM,CAAC,IAAI,CAAC,CAAC,GAAG,OAAO,MAAM,EAAE;QACrD,OAAO,IAAI,CAAC,gBAAgB,CAAC,QAAQ,UAAU,YAAY;YAAE,aAAa,WAAW,KAAK,CAAC,OAAO,CAAC,CAAC,GAAG,QAAQ,KAAK,EAAE;QAAO;IACjI;IACA;;;;;;;KAOC,GACD,qBAAqB,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE;QAC3C,MAAM,OAAO,SAAS,MAAM,CAAC,IAAI,CAAC,CAAC,GAAG,OAAO,MAAM,EAAE;QACrD,OAAO,IAAI,CAAC,gBAAgB,CAAC,WAAW,SAAS,UAAU,YAAY;YAAE,aAAa,WAAW,KAAK,CAAC,OAAO,CAAC,CAAC,GAAG,QAAQ,KAAK,EAAE;QAAO;IAC7I;AACJ;AACA,QAAQ,kBAAkB,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2372, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/chain/modules/StarknetAccounts.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetAccounts = void 0;\r\nconst StarknetModule_1 = require(\"../StarknetModule\");\r\nclass StarknetAccounts extends StarknetModule_1.StarknetModule {\r\n    async getAccountDeployTransaction(deploymentData) {\r\n        const feeDetails = this.root.Fees.getFeeDetails({ l1DataGas: 500, l2Gas: 5000 * 40000, l1Gas: 0 }, await this.root.Fees.getFeeRate());\r\n        const details = {\r\n            ...feeDetails,\r\n            walletAddress: deploymentData.contractAddress,\r\n            cairoVersion: \"1\",\r\n            chainId: this.root.starknetChainId,\r\n            nonce: 0,\r\n            accountDeploymentData: [],\r\n            skipValidate: false\r\n        };\r\n        return {\r\n            type: \"DEPLOY_ACCOUNT\",\r\n            tx: deploymentData,\r\n            details\r\n        };\r\n    }\r\n}\r\nexports.StarknetAccounts = StarknetAccounts;\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,gBAAgB,GAAG,KAAK;AAChC,MAAM;AACN,MAAM,yBAAyB,iBAAiB,cAAc;IAC1D,MAAM,4BAA4B,cAAc,EAAE;QAC9C,MAAM,aAAa,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC;YAAE,WAAW;YAAK,OAAO,OAAO;YAAO,OAAO;QAAE,GAAG,MAAM,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU;QAClI,MAAM,UAAU;YACZ,GAAG,UAAU;YACb,eAAe,eAAe,eAAe;YAC7C,cAAc;YACd,SAAS,IAAI,CAAC,IAAI,CAAC,eAAe;YAClC,OAAO;YACP,uBAAuB,EAAE;YACzB,cAAc;QAClB;QACA,OAAO;YACH,MAAM;YACN,IAAI;YACJ;QACJ;IACJ;AACJ;AACA,QAAQ,gBAAgB,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2405, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/chain/modules/StarknetBlocks.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetBlocks = void 0;\r\nconst StarknetModule_1 = require(\"../StarknetModule\");\r\nclass StarknetBlocks extends StarknetModule_1.StarknetModule {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.BLOCK_CACHE_TIME = 5 * 1000;\r\n        this.blockCache = {};\r\n    }\r\n    /**\r\n     * Initiates fetch of a given block & saves it to cache\r\n     *\r\n     * @private\r\n     * @param blockTag\r\n     */\r\n    fetchAndSaveBlockTime(blockTag) {\r\n        const blockTagStr = blockTag.toString(10);\r\n        const blockTimePromise = this.provider.getBlockWithTxHashes(blockTag).then(result => result.timestamp);\r\n        const timestamp = Date.now();\r\n        this.blockCache[blockTagStr] = {\r\n            blockTime: blockTimePromise,\r\n            timestamp\r\n        };\r\n        blockTimePromise.catch(e => {\r\n            if (this.blockCache[blockTagStr] != null && this.blockCache[blockTagStr].blockTime === blockTimePromise)\r\n                delete this.blockCache[blockTagStr];\r\n            throw e;\r\n        });\r\n        return {\r\n            blockTime: blockTimePromise,\r\n            timestamp\r\n        };\r\n    }\r\n    cleanupBlocks() {\r\n        const currentTime = Date.now();\r\n        //Keys are in order that they were added, so we can stop at the first non-expired block\r\n        for (let key in this.blockCache) {\r\n            const block = this.blockCache[key];\r\n            if (currentTime - block.timestamp > this.BLOCK_CACHE_TIME) {\r\n                delete this.blockCache[key];\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    ///////////////////\r\n    //// Blocks\r\n    /**\r\n     * Gets the block for a given blocktag, with caching\r\n     *\r\n     * @param blockTag\r\n     */\r\n    getBlockTime(blockTag) {\r\n        this.cleanupBlocks();\r\n        let cachedBlockData = this.blockCache[blockTag.toString(10)];\r\n        if (cachedBlockData == null || Date.now() - cachedBlockData.timestamp > this.BLOCK_CACHE_TIME) {\r\n            cachedBlockData = this.fetchAndSaveBlockTime(blockTag);\r\n        }\r\n        return cachedBlockData.blockTime;\r\n    }\r\n}\r\nexports.StarknetBlocks = StarknetBlocks;\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,cAAc,GAAG,KAAK;AAC9B,MAAM;AACN,MAAM,uBAAuB,iBAAiB,cAAc;IACxD,aAAc;QACV,KAAK,IAAI;QACT,IAAI,CAAC,gBAAgB,GAAG,IAAI;QAC5B,IAAI,CAAC,UAAU,GAAG,CAAC;IACvB;IACA;;;;;KAKC,GACD,sBAAsB,QAAQ,EAAE;QAC5B,MAAM,cAAc,SAAS,QAAQ,CAAC;QACtC,MAAM,mBAAmB,IAAI,CAAC,QAAQ,CAAC,oBAAoB,CAAC,UAAU,IAAI,CAAC,CAAA,SAAU,OAAO,SAAS;QACrG,MAAM,YAAY,KAAK,GAAG;QAC1B,IAAI,CAAC,UAAU,CAAC,YAAY,GAAG;YAC3B,WAAW;YACX;QACJ;QACA,iBAAiB,KAAK,CAAC,CAAA;YACnB,IAAI,IAAI,CAAC,UAAU,CAAC,YAAY,IAAI,QAAQ,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,SAAS,KAAK,kBACnF,OAAO,IAAI,CAAC,UAAU,CAAC,YAAY;YACvC,MAAM;QACV;QACA,OAAO;YACH,WAAW;YACX;QACJ;IACJ;IACA,gBAAgB;QACZ,MAAM,cAAc,KAAK,GAAG;QAC5B,uFAAuF;QACvF,IAAK,IAAI,OAAO,IAAI,CAAC,UAAU,CAAE;YAC7B,MAAM,QAAQ,IAAI,CAAC,UAAU,CAAC,IAAI;YAClC,IAAI,cAAc,MAAM,SAAS,GAAG,IAAI,CAAC,gBAAgB,EAAE;gBACvD,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI;YAC/B,OACK;gBACD;YACJ;QACJ;IACJ;IACA,mBAAmB;IACnB,WAAW;IACX;;;;KAIC,GACD,aAAa,QAAQ,EAAE;QACnB,IAAI,CAAC,aAAa;QAClB,IAAI,kBAAkB,IAAI,CAAC,UAAU,CAAC,SAAS,QAAQ,CAAC,IAAI;QAC5D,IAAI,mBAAmB,QAAQ,KAAK,GAAG,KAAK,gBAAgB,SAAS,GAAG,IAAI,CAAC,gBAAgB,EAAE;YAC3F,kBAAkB,IAAI,CAAC,qBAAqB,CAAC;QACjD;QACA,OAAO,gBAAgB,SAAS;IACpC;AACJ;AACA,QAAQ,cAAc,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2470, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/wallet/StarknetSigner.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetSigner = void 0;\r\nconst Utils_1 = require(\"../../utils/Utils\");\r\nclass StarknetSigner {\r\n    constructor(account) {\r\n        this.isDeployed = null;\r\n        this.account = account;\r\n    }\r\n    getPublicKey() {\r\n        return this.account.signer.getPubKey();\r\n    }\r\n    getAddress() {\r\n        return (0, Utils_1.toHex)(this.account.address);\r\n    }\r\n    isWalletAccount() {\r\n        return this.account.walletProvider != null;\r\n    }\r\n    //TODO: Introduce proper nonce management!\r\n    async getNonce() {\r\n        try {\r\n            return BigInt(await this.account.getNonceForAddress(this.getAddress(), \"pending\"));\r\n        }\r\n        catch (e) {\r\n            if (e.message != null && e.message.includes(\"20: Contract not found\")) {\r\n                return BigInt(0);\r\n            }\r\n            throw e;\r\n        }\r\n    }\r\n    async checkAndGetDeployPayload(nonce) {\r\n        if (this.isDeployed)\r\n            return null;\r\n        const _account = this.account;\r\n        if (_account.getDeploymentData != null) {\r\n            //Check if deployed\r\n            nonce ?? (nonce = BigInt(await this.getNonce()));\r\n            this.isDeployed = nonce != BigInt(0);\r\n            if (!this.isDeployed) {\r\n                return _account.getDeploymentData();\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n}\r\nexports.StarknetSigner = StarknetSigner;\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,cAAc,GAAG,KAAK;AAC9B,MAAM;AACN,MAAM;IACF,YAAY,OAAO,CAAE;QACjB,IAAI,CAAC,UAAU,GAAG;QAClB,IAAI,CAAC,OAAO,GAAG;IACnB;IACA,eAAe;QACX,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,SAAS;IACxC;IACA,aAAa;QACT,OAAO,CAAC,GAAG,QAAQ,KAAK,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO;IAClD;IACA,kBAAkB;QACd,OAAO,IAAI,CAAC,OAAO,CAAC,cAAc,IAAI;IAC1C;IACA,0CAA0C;IAC1C,MAAM,WAAW;QACb,IAAI;YACA,OAAO,OAAO,MAAM,IAAI,CAAC,OAAO,CAAC,kBAAkB,CAAC,IAAI,CAAC,UAAU,IAAI;QAC3E,EACA,OAAO,GAAG;YACN,IAAI,EAAE,OAAO,IAAI,QAAQ,EAAE,OAAO,CAAC,QAAQ,CAAC,2BAA2B;gBACnE,OAAO,OAAO;YAClB;YACA,MAAM;QACV;IACJ;IACA,MAAM,yBAAyB,KAAK,EAAE;QAClC,IAAI,IAAI,CAAC,UAAU,EACf,OAAO;QACX,MAAM,WAAW,IAAI,CAAC,OAAO;QAC7B,IAAI,SAAS,iBAAiB,IAAI,MAAM;YACpC,mBAAmB;YACnB,SAAS,CAAC,QAAQ,OAAO,MAAM,IAAI,CAAC,QAAQ,GAAG;YAC/C,IAAI,CAAC,UAAU,GAAG,SAAS,OAAO;YAClC,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;gBAClB,OAAO,SAAS,iBAAiB;YACrC;QACJ;QACA,OAAO;IACX;AACJ;AACA,QAAQ,cAAc,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2519, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/wallet/StarknetKeypairWallet.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetKeypairWallet = void 0;\r\nconst starknet_1 = require(\"starknet\");\r\nconst Utils_1 = require(\"../../utils/Utils\");\r\nconst buffer_1 = require(\"buffer\");\r\nconst OZaccountClassHash = '0x00261c293c8084cd79086214176b33e5911677cec55104fddc8d25b0b736dcad';\r\n//Openzeppelin Account wallet\r\nclass StarknetKeypairWallet extends starknet_1.Account {\r\n    constructor(provider, privateKey) {\r\n        const publicKey = starknet_1.ec.starkCurve.getStarkKey((0, Utils_1.toHex)(privateKey));\r\n        // Calculate future address of the account\r\n        const OZaccountConstructorCallData = starknet_1.CallData.compile({ publicKey });\r\n        const OZcontractAddress = starknet_1.hash.calculateContractAddressFromHash(publicKey, OZaccountClassHash, OZaccountConstructorCallData, 0);\r\n        super(provider, OZcontractAddress, privateKey, \"1\");\r\n        this.publicKey = publicKey;\r\n    }\r\n    getDeploymentData() {\r\n        return {\r\n            classHash: OZaccountClassHash,\r\n            constructorCalldata: starknet_1.CallData.compile({ publicKey: this.publicKey }),\r\n            addressSalt: this.publicKey,\r\n            contractAddress: this.address\r\n        };\r\n    }\r\n    static generateRandomPrivateKey() {\r\n        return \"0x\" + buffer_1.Buffer.from(starknet_1.ec.starkCurve.utils.randomPrivateKey()).toString(\"hex\");\r\n    }\r\n}\r\nexports.StarknetKeypairWallet = StarknetKeypairWallet;\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,qBAAqB,GAAG,KAAK;AACrC,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM,qBAAqB;AAC3B,6BAA6B;AAC7B,MAAM,8BAA8B,WAAW,OAAO;IAClD,YAAY,QAAQ,EAAE,UAAU,CAAE;QAC9B,MAAM,YAAY,WAAW,EAAE,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,GAAG,QAAQ,KAAK,EAAE;QAC1E,0CAA0C;QAC1C,MAAM,+BAA+B,WAAW,QAAQ,CAAC,OAAO,CAAC;YAAE;QAAU;QAC7E,MAAM,oBAAoB,WAAW,IAAI,CAAC,gCAAgC,CAAC,WAAW,oBAAoB,8BAA8B;QACxI,KAAK,CAAC,UAAU,mBAAmB,YAAY;QAC/C,IAAI,CAAC,SAAS,GAAG;IACrB;IACA,oBAAoB;QAChB,OAAO;YACH,WAAW;YACX,qBAAqB,WAAW,QAAQ,CAAC,OAAO,CAAC;gBAAE,WAAW,IAAI,CAAC,SAAS;YAAC;YAC7E,aAAa,IAAI,CAAC,SAAS;YAC3B,iBAAiB,IAAI,CAAC,OAAO;QACjC;IACJ;IACA,OAAO,2BAA2B;QAC9B,OAAO,OAAO,SAAS,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,UAAU,CAAC,KAAK,CAAC,gBAAgB,IAAI,QAAQ,CAAC;IACnG;AACJ;AACA,QAAQ,qBAAqB,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2558, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/chain/StarknetChainInterface.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetChainInterface = void 0;\r\nconst starknet_1 = require(\"starknet\");\r\nconst Utils_1 = require(\"../../utils/Utils\");\r\nconst StarknetTransactions_1 = require(\"./modules/StarknetTransactions\");\r\nconst StarknetFees_1 = require(\"./modules/StarknetFees\");\r\nconst StarknetAddresses_1 = require(\"./modules/StarknetAddresses\");\r\nconst StarknetTokens_1 = require(\"./modules/StarknetTokens\");\r\nconst StarknetEvents_1 = require(\"./modules/StarknetEvents\");\r\nconst StarknetSignatures_1 = require(\"./modules/StarknetSignatures\");\r\nconst StarknetAccounts_1 = require(\"./modules/StarknetAccounts\");\r\nconst StarknetBlocks_1 = require(\"./modules/StarknetBlocks\");\r\nconst StarknetSigner_1 = require(\"../wallet/StarknetSigner\");\r\nconst buffer_1 = require(\"buffer\");\r\nconst StarknetKeypairWallet_1 = require(\"../wallet/StarknetKeypairWallet\");\r\nclass StarknetChainInterface {\r\n    constructor(chainId, provider, retryPolicy, solanaFeeEstimator = new StarknetFees_1.StarknetFees(provider)) {\r\n        this.chainId = \"STARKNET\";\r\n        this.logger = (0, Utils_1.getLogger)(\"StarknetChainInterface: \");\r\n        this.starknetChainId = chainId;\r\n        this.provider = provider;\r\n        this.retryPolicy = retryPolicy;\r\n        this.Fees = solanaFeeEstimator;\r\n        this.Tokens = new StarknetTokens_1.StarknetTokens(this);\r\n        this.Transactions = new StarknetTransactions_1.StarknetTransactions(this);\r\n        this.Signatures = new StarknetSignatures_1.StarknetSignatures(this);\r\n        this.Events = new StarknetEvents_1.StarknetEvents(this);\r\n        this.Accounts = new StarknetAccounts_1.StarknetAccounts(this);\r\n        this.Blocks = new StarknetBlocks_1.StarknetBlocks(this);\r\n    }\r\n    async getBalance(signer, tokenAddress) {\r\n        //TODO: For native token we should discount the cost of deploying an account if it is not deployed yet\r\n        return await this.Tokens.getTokenBalance(signer, tokenAddress);\r\n    }\r\n    getNativeCurrencyAddress() {\r\n        return this.Tokens.getNativeCurrencyAddress();\r\n    }\r\n    isValidToken(tokenIdentifier) {\r\n        return this.Tokens.isValidToken(tokenIdentifier);\r\n    }\r\n    isValidAddress(address) {\r\n        return StarknetAddresses_1.StarknetAddresses.isValidAddress(address);\r\n    }\r\n    ///////////////////////////////////\r\n    //// Callbacks & handlers\r\n    offBeforeTxReplace(callback) {\r\n        return true;\r\n    }\r\n    onBeforeTxReplace(callback) { }\r\n    onBeforeTxSigned(callback) {\r\n        this.Transactions.onBeforeTxSigned(callback);\r\n    }\r\n    offBeforeTxSigned(callback) {\r\n        return this.Transactions.offBeforeTxSigned(callback);\r\n    }\r\n    randomAddress() {\r\n        return (0, Utils_1.toHex)(starknet_1.stark.randomAddress());\r\n    }\r\n    randomSigner() {\r\n        const privateKey = \"0x\" + buffer_1.Buffer.from(starknet_1.ec.starkCurve.utils.randomPrivateKey()).toString(\"hex\");\r\n        const wallet = new StarknetKeypairWallet_1.StarknetKeypairWallet(this.provider, privateKey);\r\n        return new StarknetSigner_1.StarknetSigner(wallet);\r\n    }\r\n    ////////////////////////////////////////////\r\n    //// Transactions\r\n    sendAndConfirm(signer, txs, waitForConfirmation, abortSignal, parallel, onBeforePublish) {\r\n        return this.Transactions.sendAndConfirm(signer, txs, waitForConfirmation, abortSignal, parallel, onBeforePublish);\r\n    }\r\n    serializeTx(tx) {\r\n        return this.Transactions.serializeTx(tx);\r\n    }\r\n    deserializeTx(txData) {\r\n        return this.Transactions.deserializeTx(txData);\r\n    }\r\n    getTxIdStatus(txId) {\r\n        return this.Transactions.getTxIdStatus(txId);\r\n    }\r\n    getTxStatus(tx) {\r\n        return this.Transactions.getTxStatus(tx);\r\n    }\r\n    txsTransfer(signer, token, amount, dstAddress, feeRate) {\r\n        return this.Tokens.txsTransfer(signer, token, amount, dstAddress, feeRate);\r\n    }\r\n    async transfer(signer, token, amount, dstAddress, txOptions) {\r\n        const txs = await this.Tokens.txsTransfer(signer.getAddress(), token, amount, dstAddress, txOptions?.feeRate);\r\n        const [txId] = await this.Transactions.sendAndConfirm(signer, txs, txOptions?.waitForConfirmation, txOptions?.abortSignal, false);\r\n        return txId;\r\n    }\r\n}\r\nexports.StarknetChainInterface = StarknetChainInterface;\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2654, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/btcrelay/headers/StarknetBtcHeader.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetBtcHeader = void 0;\r\nconst buffer_1 = require(\"buffer\");\r\nconst Utils_1 = require(\"../../../utils/Utils\");\r\nconst sha2_1 = require(\"@noble/hashes/sha2\");\r\nclass StarknetBtcHeader {\r\n    constructor(obj) {\r\n        this.reversed_version = Number(obj.reversed_version);\r\n        this.previous_blockhash = obj.previous_blockhash.map(val => Number(val));\r\n        this.merkle_root = obj.merkle_root.map(val => Number(val));\r\n        this.reversed_timestamp = Number(obj.reversed_timestamp);\r\n        this.nbits = Number(obj.nbits);\r\n        this.nonce = Number(obj.nonce);\r\n        this.hash = obj.hash;\r\n    }\r\n    getMerkleRoot() {\r\n        return (0, Utils_1.u32ArrayToBuffer)(this.merkle_root);\r\n    }\r\n    getNbits() {\r\n        return (0, Utils_1.u32ReverseEndianness)(this.nbits);\r\n    }\r\n    getNonce() {\r\n        return (0, Utils_1.u32ReverseEndianness)(this.nonce);\r\n    }\r\n    getReversedPrevBlockhash() {\r\n        return (0, Utils_1.u32ArrayToBuffer)(this.previous_blockhash);\r\n    }\r\n    getTimestamp() {\r\n        return (0, Utils_1.u32ReverseEndianness)(this.reversed_timestamp);\r\n    }\r\n    getVersion() {\r\n        return (0, Utils_1.u32ReverseEndianness)(this.reversed_version);\r\n    }\r\n    getHash() {\r\n        if (this.hash != null)\r\n            return this.hash;\r\n        const buffer = buffer_1.Buffer.alloc(80);\r\n        buffer.writeUInt32BE(this.reversed_version, 0);\r\n        (0, Utils_1.u32ArrayToBuffer)(this.previous_blockhash).copy(buffer, 4);\r\n        (0, Utils_1.u32ArrayToBuffer)(this.merkle_root).copy(buffer, 36);\r\n        buffer.writeUInt32BE(this.reversed_timestamp, 68);\r\n        buffer.writeUInt32BE(this.nbits, 72);\r\n        buffer.writeUInt32BE(this.nonce, 76);\r\n        return buffer_1.Buffer.from((0, sha2_1.sha256)((0, sha2_1.sha256)(buffer)));\r\n    }\r\n    serialize() {\r\n        return [\r\n            this.reversed_version,\r\n            ...this.previous_blockhash,\r\n            ...this.merkle_root,\r\n            this.reversed_timestamp,\r\n            this.nbits,\r\n            this.nonce\r\n        ];\r\n    }\r\n    static fromSerializedFeltArray(span) {\r\n        const reversed_version = (0, Utils_1.toHex)(span.shift());\r\n        const previous_blockhash = span.splice(0, 8).map(Utils_1.toHex);\r\n        const merkle_root = span.splice(0, 8).map(Utils_1.toHex);\r\n        const reversed_timestamp = (0, Utils_1.toHex)(span.shift());\r\n        const nbits = (0, Utils_1.toHex)(span.shift());\r\n        const nonce = (0, Utils_1.toHex)(span.shift());\r\n        return new StarknetBtcHeader({\r\n            reversed_version,\r\n            previous_blockhash,\r\n            merkle_root,\r\n            reversed_timestamp,\r\n            nbits,\r\n            nonce\r\n        });\r\n    }\r\n}\r\nexports.StarknetBtcHeader = StarknetBtcHeader;\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,iBAAiB,GAAG,KAAK;AACjC,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;IACF,YAAY,GAAG,CAAE;QACb,IAAI,CAAC,gBAAgB,GAAG,OAAO,IAAI,gBAAgB;QACnD,IAAI,CAAC,kBAAkB,GAAG,IAAI,kBAAkB,CAAC,GAAG,CAAC,CAAA,MAAO,OAAO;QACnE,IAAI,CAAC,WAAW,GAAG,IAAI,WAAW,CAAC,GAAG,CAAC,CAAA,MAAO,OAAO;QACrD,IAAI,CAAC,kBAAkB,GAAG,OAAO,IAAI,kBAAkB;QACvD,IAAI,CAAC,KAAK,GAAG,OAAO,IAAI,KAAK;QAC7B,IAAI,CAAC,KAAK,GAAG,OAAO,IAAI,KAAK;QAC7B,IAAI,CAAC,IAAI,GAAG,IAAI,IAAI;IACxB;IACA,gBAAgB;QACZ,OAAO,CAAC,GAAG,QAAQ,gBAAgB,EAAE,IAAI,CAAC,WAAW;IACzD;IACA,WAAW;QACP,OAAO,CAAC,GAAG,QAAQ,oBAAoB,EAAE,IAAI,CAAC,KAAK;IACvD;IACA,WAAW;QACP,OAAO,CAAC,GAAG,QAAQ,oBAAoB,EAAE,IAAI,CAAC,KAAK;IACvD;IACA,2BAA2B;QACvB,OAAO,CAAC,GAAG,QAAQ,gBAAgB,EAAE,IAAI,CAAC,kBAAkB;IAChE;IACA,eAAe;QACX,OAAO,CAAC,GAAG,QAAQ,oBAAoB,EAAE,IAAI,CAAC,kBAAkB;IACpE;IACA,aAAa;QACT,OAAO,CAAC,GAAG,QAAQ,oBAAoB,EAAE,IAAI,CAAC,gBAAgB;IAClE;IACA,UAAU;QACN,IAAI,IAAI,CAAC,IAAI,IAAI,MACb,OAAO,IAAI,CAAC,IAAI;QACpB,MAAM,SAAS,SAAS,MAAM,CAAC,KAAK,CAAC;QACrC,OAAO,aAAa,CAAC,IAAI,CAAC,gBAAgB,EAAE;QAC5C,CAAC,GAAG,QAAQ,gBAAgB,EAAE,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,QAAQ;QACpE,CAAC,GAAG,QAAQ,gBAAgB,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,QAAQ;QAC7D,OAAO,aAAa,CAAC,IAAI,CAAC,kBAAkB,EAAE;QAC9C,OAAO,aAAa,CAAC,IAAI,CAAC,KAAK,EAAE;QACjC,OAAO,aAAa,CAAC,IAAI,CAAC,KAAK,EAAE;QACjC,OAAO,SAAS,MAAM,CAAC,IAAI,CAAC,CAAC,GAAG,OAAO,MAAM,EAAE,CAAC,GAAG,OAAO,MAAM,EAAE;IACtE;IACA,YAAY;QACR,OAAO;YACH,IAAI,CAAC,gBAAgB;eAClB,IAAI,CAAC,kBAAkB;eACvB,IAAI,CAAC,WAAW;YACnB,IAAI,CAAC,kBAAkB;YACvB,IAAI,CAAC,KAAK;YACV,IAAI,CAAC,KAAK;SACb;IACL;IACA,OAAO,wBAAwB,IAAI,EAAE;QACjC,MAAM,mBAAmB,CAAC,GAAG,QAAQ,KAAK,EAAE,KAAK,KAAK;QACtD,MAAM,qBAAqB,KAAK,MAAM,CAAC,GAAG,GAAG,GAAG,CAAC,QAAQ,KAAK;QAC9D,MAAM,cAAc,KAAK,MAAM,CAAC,GAAG,GAAG,GAAG,CAAC,QAAQ,KAAK;QACvD,MAAM,qBAAqB,CAAC,GAAG,QAAQ,KAAK,EAAE,KAAK,KAAK;QACxD,MAAM,QAAQ,CAAC,GAAG,QAAQ,KAAK,EAAE,KAAK,KAAK;QAC3C,MAAM,QAAQ,CAAC,GAAG,QAAQ,KAAK,EAAE,KAAK,KAAK;QAC3C,OAAO,IAAI,kBAAkB;YACzB;YACA;YACA;YACA;YACA;YACA;QACJ;IACJ;AACJ;AACA,QAAQ,iBAAiB,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2732, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/btcrelay/headers/StarknetBtcStoredHeader.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetBtcStoredHeader = void 0;\r\nconst base_1 = require(\"@atomiqlabs/base\");\r\nconst StarknetBtcHeader_1 = require(\"./StarknetBtcHeader\");\r\nconst buffer_1 = require(\"buffer\");\r\nconst starknet_1 = require(\"starknet\");\r\nconst Utils_1 = require(\"../../../utils/Utils\");\r\nclass StarknetBtcStoredHeader {\r\n    constructor(obj) {\r\n        this.blockheader = obj.blockheader instanceof StarknetBtcHeader_1.StarknetBtcHeader ? obj.blockheader : new StarknetBtcHeader_1.StarknetBtcHeader(obj.blockheader);\r\n        this.block_hash = obj.block_hash.map(val => Number(val));\r\n        this.chain_work = (0, Utils_1.isUint256)(obj.chain_work) ? obj.chain_work : starknet_1.cairo.uint256(obj.chain_work);\r\n        this.block_height = Number(obj.block_height);\r\n        this.last_diff_adjustment = Number(obj.last_diff_adjustment);\r\n        this.prev_block_timestamps = obj.prev_block_timestamps.map(val => Number(val));\r\n    }\r\n    getBlockheight() {\r\n        return this.block_height;\r\n    }\r\n    getChainWork() {\r\n        return (0, Utils_1.bigNumberishToBuffer)(this.chain_work, 32);\r\n    }\r\n    getHeader() {\r\n        return this.blockheader;\r\n    }\r\n    getLastDiffAdjustment() {\r\n        return this.last_diff_adjustment;\r\n    }\r\n    getPrevBlockTimestamps() {\r\n        return this.prev_block_timestamps;\r\n    }\r\n    getBlockHash() {\r\n        return (0, Utils_1.u32ArrayToBuffer)(this.block_hash).reverse();\r\n    }\r\n    /**\r\n     * Computes prevBlockTimestamps for a next block, shifting the old block timestamps to the left & appending\r\n     *  this block's timestamp to the end\r\n     *\r\n     * @private\r\n     */\r\n    computeNextBlockTimestamps() {\r\n        const prevBlockTimestamps = [...this.prev_block_timestamps];\r\n        for (let i = 1; i < 10; i++) {\r\n            prevBlockTimestamps[i - 1] = prevBlockTimestamps[i];\r\n        }\r\n        prevBlockTimestamps[9] = this.blockheader.getTimestamp();\r\n        return prevBlockTimestamps;\r\n    }\r\n    /**\r\n     * Computes total chain work after a new header with \"nbits\" is added to the chain\r\n     *\r\n     * @param nbits\r\n     * @private\r\n     */\r\n    computeNextChainWork(nbits) {\r\n        const chainWork = [...this.getChainWork()];\r\n        base_1.StatePredictorUtils.addInPlace(chainWork, [...base_1.StatePredictorUtils.getChainwork(nbits)]);\r\n        return buffer_1.Buffer.from(chainWork);\r\n    }\r\n    /**\r\n     * Computes lastDiffAdjustment, this changes only once every DIFF_ADJUSTMENT_PERIOD blocks\r\n     *\r\n     * @param headerTimestamp\r\n     * @private\r\n     */\r\n    computeNextLastDiffAdjustment(headerTimestamp) {\r\n        const blockheight = this.block_height + 1;\r\n        let lastDiffAdjustment = this.last_diff_adjustment;\r\n        if (blockheight % base_1.StatePredictorUtils.DIFF_ADJUSTMENT_PERIOD === 0) {\r\n            lastDiffAdjustment = headerTimestamp;\r\n        }\r\n        return lastDiffAdjustment;\r\n    }\r\n    computeNext(header) {\r\n        return new StarknetBtcStoredHeader({\r\n            chain_work: \"0x\" + this.computeNextChainWork(header.getNbits()).toString(\"hex\"),\r\n            prev_block_timestamps: this.computeNextBlockTimestamps(),\r\n            block_height: this.block_height + 1,\r\n            last_diff_adjustment: this.computeNextLastDiffAdjustment(header.getTimestamp()),\r\n            block_hash: (0, Utils_1.bufferToU32Array)(header.getHash()),\r\n            blockheader: header\r\n        });\r\n    }\r\n    serialize() {\r\n        return [\r\n            ...this.blockheader.serialize(),\r\n            ...this.block_hash,\r\n            this.chain_work.low,\r\n            this.chain_work.high,\r\n            this.block_height,\r\n            this.last_diff_adjustment,\r\n            ...this.prev_block_timestamps\r\n        ];\r\n    }\r\n    static fromSerializedFeltArray(span) {\r\n        const blockheader = StarknetBtcHeader_1.StarknetBtcHeader.fromSerializedFeltArray(span);\r\n        const block_hash = span.splice(0, 8).map(Utils_1.toHex);\r\n        const chain_work = { low: span.shift(), high: span.shift() };\r\n        const block_height = (0, Utils_1.toHex)(span.shift());\r\n        const last_diff_adjustment = (0, Utils_1.toHex)(span.shift());\r\n        const prev_block_timestamps = span.splice(0, 10).map(Utils_1.toHex);\r\n        return new StarknetBtcStoredHeader({\r\n            blockheader,\r\n            block_hash,\r\n            chain_work,\r\n            block_height,\r\n            last_diff_adjustment,\r\n            prev_block_timestamps\r\n        });\r\n    }\r\n}\r\nexports.StarknetBtcStoredHeader = StarknetBtcStoredHeader;\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2856, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/contract/modules/StarknetContractEvents.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetContractEvents = void 0;\r\nconst StarknetEvents_1 = require(\"../../chain/modules/StarknetEvents\");\r\nconst starknet_1 = require(\"starknet\");\r\nconst Utils_1 = require(\"../../../utils/Utils\");\r\nclass StarknetContractEvents extends StarknetEvents_1.StarknetEvents {\r\n    constructor(chainInterface, contract, abi) {\r\n        super(chainInterface);\r\n        this.contract = contract;\r\n        this.abi = abi;\r\n    }\r\n    toStarknetAbiEvents(blockEvents) {\r\n        const abiEvents = starknet_1.events.getAbiEvents(this.abi);\r\n        const abiStructs = starknet_1.CallData.getAbiStruct(this.abi);\r\n        const abiEnums = starknet_1.CallData.getAbiEnum(this.abi);\r\n        const result = starknet_1.events.parseEvents(blockEvents, abiEvents, abiStructs, abiEnums);\r\n        if (result.length !== blockEvents.length)\r\n            throw new Error(\"Invalid event detected, please check provided ABI\");\r\n        return result.map((value, index) => {\r\n            const starknetEvent = blockEvents[index];\r\n            const name = Object.keys(value)[0];\r\n            return {\r\n                name: name,\r\n                txHash: starknetEvent.transaction_hash,\r\n                params: value[name],\r\n                blockNumber: starknetEvent.block_number,\r\n                blockHash: starknetEvent.block_hash,\r\n                data: starknetEvent.data,\r\n                keys: starknetEvent.keys\r\n            };\r\n        });\r\n    }\r\n    toFilter(events, keys) {\r\n        const filterArray = [];\r\n        filterArray.push(events.map(name => {\r\n            const arr = name.split(\":\");\r\n            const eventName = arr[arr.length - 1];\r\n            return (0, Utils_1.toHex)(starknet_1.hash.starknetKeccak(eventName));\r\n        }));\r\n        if (keys != null)\r\n            keys.forEach(key => filterArray.push(key == null ? [] : [key]));\r\n        return filterArray;\r\n    }\r\n    /**\r\n     * Returns the events occuring in a range of starknet block as identified by the contract and keys,\r\n     *  returns pending events if no startHeight & endHeight is passed\r\n     *\r\n     * @param events\r\n     * @param keys\r\n     * @param startBlockHeight\r\n     * @param endBlockHeight\r\n     */\r\n    async getContractBlockEvents(events, keys, startBlockHeight, endBlockHeight = startBlockHeight) {\r\n        const blockEvents = await super.getBlockEvents(this.contract.contract.address, this.toFilter(events, keys), startBlockHeight, endBlockHeight);\r\n        return this.toStarknetAbiEvents(blockEvents);\r\n    }\r\n    /**\r\n     * Runs a search backwards in time, processing the events for a specific topic public key\r\n     *\r\n     * @param events\r\n     * @param keys\r\n     * @param processor called for every event, should return a value if the correct event was found, or null\r\n     *  if the search should continue\r\n     * @param abortSignal\r\n     */\r\n    async findInContractEvents(events, keys, processor, abortSignal) {\r\n        return this.findInEvents(this.contract.contract.address, this.toFilter(events, keys), async (events) => {\r\n            const parsedEvents = this.toStarknetAbiEvents(events);\r\n            for (let event of parsedEvents) {\r\n                const result = await processor(event);\r\n                if (result != null)\r\n                    return result;\r\n            }\r\n        }, abortSignal);\r\n    }\r\n    /**\r\n     * Runs a search forwards in time, processing the events for a specific topic public key\r\n     *\r\n     * @param events\r\n     * @param keys\r\n     * @param processor called for every event, should return a value if the correct event was found, or null\r\n     *  if the search should continue\r\n     * @param abortSignal\r\n     */\r\n    async findInContractEventsForward(events, keys, processor, abortSignal) {\r\n        return this.findInEventsForward(this.contract.contract.address, this.toFilter(events, keys), async (events) => {\r\n            const parsedEvents = this.toStarknetAbiEvents(events);\r\n            for (let event of parsedEvents) {\r\n                const result = await processor(event);\r\n                if (result != null)\r\n                    return result;\r\n            }\r\n        }, abortSignal);\r\n    }\r\n}\r\nexports.StarknetContractEvents = StarknetContractEvents;\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2953, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/contract/StarknetContractBase.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetContractBase = void 0;\r\nconst starknet_1 = require(\"starknet\");\r\nconst StarknetContractEvents_1 = require(\"./modules/StarknetContractEvents\");\r\n/**\r\n * Base class providing program specific utilities\r\n */\r\nclass StarknetContractBase {\r\n    constructor(chainInterface, contractAddress, contractAbi) {\r\n        this.Chain = chainInterface;\r\n        this.contract = new starknet_1.Contract(contractAbi, contractAddress, chainInterface.provider).typedv2(contractAbi);\r\n        this.Events = new StarknetContractEvents_1.StarknetContractEvents(chainInterface, this, contractAbi);\r\n    }\r\n}\r\nexports.StarknetContractBase = StarknetContractBase;\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,oBAAoB,GAAG,KAAK;AACpC,MAAM;AACN,MAAM;AACN;;CAEC,GACD,MAAM;IACF,YAAY,cAAc,EAAE,eAAe,EAAE,WAAW,CAAE;QACtD,IAAI,CAAC,KAAK,GAAG;QACb,IAAI,CAAC,QAAQ,GAAG,IAAI,WAAW,QAAQ,CAAC,aAAa,iBAAiB,eAAe,QAAQ,EAAE,OAAO,CAAC;QACvG,IAAI,CAAC,MAAM,GAAG,IAAI,yBAAyB,sBAAsB,CAAC,gBAAgB,IAAI,EAAE;IAC5F;AACJ;AACA,QAAQ,oBAAoB,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2973, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/btcrelay/BtcRelayAbi.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BtcRelayAbi = void 0;\r\nexports.BtcRelayAbi = [\r\n    {\r\n        \"type\": \"impl\",\r\n        \"name\": \"BtcRelayImpl\",\r\n        \"interface_name\": \"btc_relay::IBtcRelay\"\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"btc_relay::structs::blockheader::BlockHeader\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"reversed_version\",\r\n                \"type\": \"core::integer::u32\"\r\n            },\r\n            {\r\n                \"name\": \"previous_blockhash\",\r\n                \"type\": \"[core::integer::u32; 8]\"\r\n            },\r\n            {\r\n                \"name\": \"merkle_root\",\r\n                \"type\": \"[core::integer::u32; 8]\"\r\n            },\r\n            {\r\n                \"name\": \"reversed_timestamp\",\r\n                \"type\": \"core::integer::u32\"\r\n            },\r\n            {\r\n                \"name\": \"nbits\",\r\n                \"type\": \"core::integer::u32\"\r\n            },\r\n            {\r\n                \"name\": \"nonce\",\r\n                \"type\": \"core::integer::u32\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"core::array::Span::<btc_relay::structs::blockheader::BlockHeader>\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"snapshot\",\r\n                \"type\": \"@core::array::Array::<btc_relay::structs::blockheader::BlockHeader>\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"core::integer::u256\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"low\",\r\n                \"type\": \"core::integer::u128\"\r\n            },\r\n            {\r\n                \"name\": \"high\",\r\n                \"type\": \"core::integer::u128\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"btc_relay::structs::stored_blockheader::StoredBlockHeader\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"blockheader\",\r\n                \"type\": \"btc_relay::structs::blockheader::BlockHeader\"\r\n            },\r\n            {\r\n                \"name\": \"block_hash\",\r\n                \"type\": \"[core::integer::u32; 8]\"\r\n            },\r\n            {\r\n                \"name\": \"chain_work\",\r\n                \"type\": \"core::integer::u256\"\r\n            },\r\n            {\r\n                \"name\": \"block_height\",\r\n                \"type\": \"core::integer::u32\"\r\n            },\r\n            {\r\n                \"name\": \"last_diff_adjustment\",\r\n                \"type\": \"core::integer::u32\"\r\n            },\r\n            {\r\n                \"name\": \"prev_block_timestamps\",\r\n                \"type\": \"[core::integer::u32; 10]\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"interface\",\r\n        \"name\": \"btc_relay::IBtcRelay\",\r\n        \"items\": [\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"submit_main_blockheaders\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"block_headers\",\r\n                        \"type\": \"core::array::Span::<btc_relay::structs::blockheader::BlockHeader>\"\r\n                    },\r\n                    {\r\n                        \"name\": \"stored_header\",\r\n                        \"type\": \"btc_relay::structs::stored_blockheader::StoredBlockHeader\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"submit_short_fork_blockheaders\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"block_headers\",\r\n                        \"type\": \"core::array::Span::<btc_relay::structs::blockheader::BlockHeader>\"\r\n                    },\r\n                    {\r\n                        \"name\": \"stored_header\",\r\n                        \"type\": \"btc_relay::structs::stored_blockheader::StoredBlockHeader\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"submit_fork_blockheaders\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"fork_id\",\r\n                        \"type\": \"core::felt252\"\r\n                    },\r\n                    {\r\n                        \"name\": \"block_headers\",\r\n                        \"type\": \"core::array::Span::<btc_relay::structs::blockheader::BlockHeader>\"\r\n                    },\r\n                    {\r\n                        \"name\": \"stored_header\",\r\n                        \"type\": \"btc_relay::structs::stored_blockheader::StoredBlockHeader\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"impl\",\r\n        \"name\": \"BtcRelayReadOnlyImpl\",\r\n        \"interface_name\": \"btc_relay::IBtcRelayReadOnly\"\r\n    },\r\n    {\r\n        \"type\": \"interface\",\r\n        \"name\": \"btc_relay::IBtcRelayReadOnly\",\r\n        \"items\": [\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"get_chainwork\",\r\n                \"inputs\": [],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::integer::u256\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"get_blockheight\",\r\n                \"inputs\": [],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::integer::u32\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"verify_blockheader\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"stored_header\",\r\n                        \"type\": \"btc_relay::structs::stored_blockheader::StoredBlockHeader\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::integer::u32\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"get_commit_hash\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"height\",\r\n                        \"type\": \"core::integer::u32\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::felt252\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"get_tip_commit_hash\",\r\n                \"inputs\": [],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::felt252\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"constructor\",\r\n        \"name\": \"constructor\",\r\n        \"inputs\": [\r\n            {\r\n                \"name\": \"stored_header\",\r\n                \"type\": \"btc_relay::structs::stored_blockheader::StoredBlockHeader\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"btc_relay::events::StoreHeader\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"commit_hash\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"block_hash_poseidon\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"header\",\r\n                \"type\": \"btc_relay::structs::stored_blockheader::StoredBlockHeader\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"btc_relay::events::StoreForkHeader\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"commit_hash\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"block_hash_poseidon\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"fork_id\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"header\",\r\n                \"type\": \"btc_relay::structs::stored_blockheader::StoredBlockHeader\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"btc_relay::events::ChainReorg\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"fork_submitter\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"fork_id\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"tip_block_hash_poseidon\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"tip_commit_hash\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"start_height\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"btc_relay::BtcRelay::Event\",\r\n        \"kind\": \"enum\",\r\n        \"variants\": [\r\n            {\r\n                \"name\": \"StoreHeader\",\r\n                \"type\": \"btc_relay::events::StoreHeader\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"StoreForkHeader\",\r\n                \"type\": \"btc_relay::events::StoreForkHeader\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"ChainReorg\",\r\n                \"type\": \"btc_relay::events::ChainReorg\",\r\n                \"kind\": \"nested\"\r\n            }\r\n        ]\r\n    }\r\n];\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3319, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/btcrelay/StarknetBtcRelay.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetBtcRelay = void 0;\r\nconst buffer_1 = require(\"buffer\");\r\nconst StarknetBtcHeader_1 = require(\"./headers/StarknetBtcHeader\");\r\nconst base_1 = require(\"@atomiqlabs/base\");\r\nconst Utils_1 = require(\"../../utils/Utils\");\r\nconst StarknetContractBase_1 = require(\"../contract/StarknetContractBase\");\r\nconst StarknetBtcStoredHeader_1 = require(\"./headers/StarknetBtcStoredHeader\");\r\nconst BtcRelayAbi_1 = require(\"./BtcRelayAbi\");\r\nconst starknet_1 = require(\"starknet\");\r\nconst StarknetFees_1 = require(\"../chain/modules/StarknetFees\");\r\nconst StarknetAction_1 = require(\"../chain/StarknetAction\");\r\nfunction serializeBlockHeader(e) {\r\n    return new StarknetBtcHeader_1.StarknetBtcHeader({\r\n        reversed_version: (0, Utils_1.u32ReverseEndianness)(e.getVersion()),\r\n        previous_blockhash: (0, Utils_1.bufferToU32Array)(buffer_1.Buffer.from(e.getPrevBlockhash(), \"hex\").reverse()),\r\n        merkle_root: (0, Utils_1.bufferToU32Array)(buffer_1.Buffer.from(e.getMerkleRoot(), \"hex\").reverse()),\r\n        reversed_timestamp: (0, Utils_1.u32ReverseEndianness)(e.getTimestamp()),\r\n        nbits: (0, Utils_1.u32ReverseEndianness)(e.getNbits()),\r\n        nonce: (0, Utils_1.u32ReverseEndianness)(e.getNonce()),\r\n        hash: buffer_1.Buffer.from(e.getHash(), \"hex\").reverse()\r\n    });\r\n}\r\nconst GAS_PER_BLOCKHEADER = { l1DataGas: 600, l2Gas: 24000000, l1Gas: 0 };\r\nconst GAS_PER_BLOCKHEADER_FORK = { l1DataGas: 1000, l2Gas: 40000000, l1Gas: 0 };\r\nconst btcRelayAddreses = {\r\n    [base_1.BitcoinNetwork.TESTNET4]: \"0x0099b63f39f0cabb767361de3d8d3e97212351a51540e2687c2571f4da490dbe\",\r\n    [base_1.BitcoinNetwork.TESTNET]: \"0x068601c79da2231d21e015ccfd59c243861156fa523a12c9f987ec28eb8dbc8c\",\r\n    [base_1.BitcoinNetwork.MAINNET]: \"0x057b14a4231b82f1e525ff35a722d893ca3dd2bde0baa6cee97937c5be861dbc\"\r\n};\r\nfunction serializeCalldata(headers, storedHeader, span) {\r\n    span.push((0, Utils_1.toHex)(headers.length));\r\n    headers.forEach(header => {\r\n        span.push(...header.serialize());\r\n    });\r\n    span.push(...storedHeader.serialize());\r\n    return span;\r\n}\r\nconst logger = (0, Utils_1.getLogger)(\"StarknetBtcRelay: \");\r\nclass StarknetBtcRelay extends StarknetContractBase_1.StarknetContractBase {\r\n    SaveMainHeaders(signer, mainHeaders, storedHeader) {\r\n        return new StarknetAction_1.StarknetAction(signer, this.Chain, {\r\n            contractAddress: this.contract.address,\r\n            entrypoint: \"submit_main_blockheaders\",\r\n            calldata: serializeCalldata(mainHeaders, storedHeader, [])\r\n        }, (0, StarknetFees_1.starknetGasMul)(GAS_PER_BLOCKHEADER, mainHeaders.length));\r\n    }\r\n    SaveShortForkHeaders(signer, forkHeaders, storedHeader) {\r\n        return new StarknetAction_1.StarknetAction(signer, this.Chain, {\r\n            contractAddress: this.contract.address,\r\n            entrypoint: \"submit_short_fork_blockheaders\",\r\n            calldata: serializeCalldata(forkHeaders, storedHeader, [])\r\n        }, (0, StarknetFees_1.starknetGasMul)(GAS_PER_BLOCKHEADER, forkHeaders.length));\r\n    }\r\n    SaveLongForkHeaders(signer, forkId, forkHeaders, storedHeader, totalForkHeaders = 100) {\r\n        return new StarknetAction_1.StarknetAction(signer, this.Chain, {\r\n            contractAddress: this.contract.address,\r\n            entrypoint: \"submit_fork_blockheaders\",\r\n            calldata: serializeCalldata(forkHeaders, storedHeader, [(0, Utils_1.toHex)(forkId)])\r\n        }, (0, StarknetFees_1.starknetGasAdd)((0, StarknetFees_1.starknetGasMul)(GAS_PER_BLOCKHEADER, forkHeaders.length), (0, StarknetFees_1.starknetGasMul)(GAS_PER_BLOCKHEADER_FORK, totalForkHeaders)));\r\n    }\r\n    constructor(chainInterface, bitcoinRpc, bitcoinNetwork, contractAddress = btcRelayAddreses[bitcoinNetwork]) {\r\n        super(chainInterface, contractAddress, BtcRelayAbi_1.BtcRelayAbi);\r\n        this.maxHeadersPerTx = 100;\r\n        this.maxForkHeadersPerTx = 100;\r\n        this.maxShortForkHeadersPerTx = 100;\r\n        this.bitcoinRpc = bitcoinRpc;\r\n    }\r\n    /**\r\n     * Computes subsequent commited headers as they will appear on the blockchain when transactions\r\n     *  are submitted & confirmed\r\n     *\r\n     * @param initialStoredHeader\r\n     * @param syncedHeaders\r\n     * @private\r\n     */\r\n    computeCommitedHeaders(initialStoredHeader, syncedHeaders) {\r\n        const computedCommitedHeaders = [initialStoredHeader];\r\n        for (let blockHeader of syncedHeaders) {\r\n            computedCommitedHeaders.push(computedCommitedHeaders[computedCommitedHeaders.length - 1].computeNext(blockHeader));\r\n        }\r\n        return computedCommitedHeaders;\r\n    }\r\n    /**\r\n     * A common logic for submitting blockheaders in a transaction\r\n     *\r\n     * @param signer\r\n     * @param headers headers to sync to the btc relay\r\n     * @param storedHeader current latest stored block header for a given fork\r\n     * @param tipWork work of the current tip in a given fork\r\n     * @param forkId forkId to submit to, forkId=0 means main chain, forkId=-1 means short fork\r\n     * @param feeRate feeRate for the transaction\r\n     * @private\r\n     */\r\n    async _saveHeaders(signer, headers, storedHeader, tipWork, forkId, feeRate) {\r\n        const blockHeaderObj = headers.map(serializeBlockHeader);\r\n        let starknetAction;\r\n        switch (forkId) {\r\n            case -1:\r\n                starknetAction = this.SaveShortForkHeaders(signer, blockHeaderObj, storedHeader);\r\n                break;\r\n            case 0:\r\n                starknetAction = this.SaveMainHeaders(signer, blockHeaderObj, storedHeader);\r\n                break;\r\n            default:\r\n                starknetAction = this.SaveLongForkHeaders(signer, forkId, blockHeaderObj, storedHeader);\r\n                break;\r\n        }\r\n        const tx = await starknetAction.tx(feeRate);\r\n        const computedCommitedHeaders = this.computeCommitedHeaders(storedHeader, blockHeaderObj);\r\n        const lastStoredHeader = computedCommitedHeaders[computedCommitedHeaders.length - 1];\r\n        if (forkId !== 0 && base_1.StatePredictorUtils.gtBuffer(lastStoredHeader.getBlockHash(), tipWork)) {\r\n            //Fork's work is higher than main chain's work, this fork will become a main chain\r\n            forkId = 0;\r\n        }\r\n        return {\r\n            forkId: forkId,\r\n            lastStoredHeader,\r\n            tx,\r\n            computedCommitedHeaders\r\n        };\r\n    }\r\n    getBlock(commitHash, blockHash) {\r\n        const keys = [commitHash == null ? null : (0, Utils_1.toHex)(commitHash)];\r\n        if (blockHash != null) {\r\n            const starknetBlockHash = starknet_1.hash.computePoseidonHashOnElements((0, Utils_1.bufferToU32Array)(buffer_1.Buffer.from([...blockHash]).reverse()));\r\n            keys.push(starknetBlockHash);\r\n        }\r\n        return this.Events.findInContractEvents([\"btc_relay::events::StoreHeader\", \"btc_relay::events::StoreForkHeader\"], keys, (event) => {\r\n            return Promise.resolve([StarknetBtcStoredHeader_1.StarknetBtcStoredHeader.fromSerializedFeltArray(event.data), BigInt(event.params.commit_hash)]);\r\n        });\r\n    }\r\n    async getBlockHeight() {\r\n        return Number(await this.contract.get_blockheight());\r\n    }\r\n    /**\r\n     * Returns data about current main chain tip stored in the btc relay\r\n     */\r\n    async getTipData() {\r\n        const commitHash = await this.contract.get_tip_commit_hash();\r\n        if (commitHash == null || BigInt(commitHash) === BigInt(0))\r\n            return null;\r\n        const result = await this.getBlock(commitHash);\r\n        if (result == null)\r\n            return null;\r\n        const [storedBlockHeader] = result;\r\n        return {\r\n            blockheight: storedBlockHeader.getBlockheight(),\r\n            commitHash: (0, Utils_1.bigNumberishToBuffer)(commitHash, 32).toString(\"hex\"),\r\n            blockhash: storedBlockHeader.getBlockHash().toString(\"hex\"),\r\n            chainWork: storedBlockHeader.getChainWork()\r\n        };\r\n    }\r\n    /**\r\n     * Retrieves blockheader with a specific blockhash, returns null if requiredBlockheight is provided and\r\n     *  btc relay contract is not synced up to the desired blockheight\r\n     *\r\n     * @param blockData\r\n     * @param requiredBlockheight\r\n     */\r\n    async retrieveLogAndBlockheight(blockData, requiredBlockheight) {\r\n        //TODO: we can fetch the blockheight and events in parallel\r\n        const blockHeight = await this.getBlockHeight();\r\n        if (requiredBlockheight != null && blockHeight < requiredBlockheight) {\r\n            return null;\r\n        }\r\n        const result = await this.getBlock(null, buffer_1.Buffer.from(blockData.blockhash, \"hex\"));\r\n        if (result == null)\r\n            return null;\r\n        const [storedBlockHeader, commitHash] = result;\r\n        //Check if block is part of the main chain\r\n        const chainCommitment = await this.contract.get_commit_hash(storedBlockHeader.block_height);\r\n        if (BigInt(chainCommitment) !== BigInt(commitHash))\r\n            return null;\r\n        logger.debug(\"retrieveLogAndBlockheight(): block found,\" +\r\n            \" commit hash: \" + (0, Utils_1.toHex)(commitHash) + \" blockhash: \" + blockData.blockhash + \" current btc relay height: \" + blockHeight);\r\n        return { header: storedBlockHeader, height: blockHeight };\r\n    }\r\n    /**\r\n     * Retrieves blockheader data by blockheader's commit hash,\r\n     *\r\n     * @param commitmentHashStr\r\n     * @param blockData\r\n     */\r\n    async retrieveLogByCommitHash(commitmentHashStr, blockData) {\r\n        const result = await this.getBlock(commitmentHashStr, buffer_1.Buffer.from(blockData.blockhash, \"hex\"));\r\n        if (result == null)\r\n            return null;\r\n        const [storedBlockHeader, commitHash] = result;\r\n        //Check if block is part of the main chain\r\n        const chainCommitment = await this.contract.get_commit_hash(storedBlockHeader.block_height);\r\n        if (BigInt(chainCommitment) !== BigInt(commitHash))\r\n            return null;\r\n        logger.debug(\"retrieveLogByCommitHash(): block found,\" +\r\n            \" commit hash: \" + commitmentHashStr + \" blockhash: \" + blockData.blockhash + \" height: \" + storedBlockHeader.block_height);\r\n        return storedBlockHeader;\r\n    }\r\n    /**\r\n     * Retrieves latest known stored blockheader & blockheader from bitcoin RPC that is in the main chain\r\n     */\r\n    async retrieveLatestKnownBlockLog() {\r\n        const data = await this.Events.findInContractEvents([\"btc_relay::events::StoreHeader\", \"btc_relay::events::StoreForkHeader\"], null, async (event) => {\r\n            const storedHeader = StarknetBtcStoredHeader_1.StarknetBtcStoredHeader.fromSerializedFeltArray(event.data);\r\n            const blockHashHex = storedHeader.getBlockHash().toString(\"hex\");\r\n            const commitHash = event.params.commit_hash;\r\n            const [isInBtcMainChain, btcRelayCommitHash] = await Promise.all([\r\n                this.bitcoinRpc.isInMainChain(blockHashHex).catch(() => false),\r\n                this.contract.get_commit_hash(storedHeader.block_height)\r\n            ]);\r\n            if (!isInBtcMainChain)\r\n                return null;\r\n            if (BigInt(commitHash) !== BigInt(btcRelayCommitHash))\r\n                return null;\r\n            return {\r\n                resultStoredHeader: storedHeader,\r\n                resultBitcoinHeader: await this.bitcoinRpc.getBlockHeader(blockHashHex),\r\n                commitHash: commitHash\r\n            };\r\n        });\r\n        if (data != null)\r\n            logger.debug(\"retrieveLatestKnownBlockLog(): block found,\" +\r\n                \" commit hash: \" + (0, Utils_1.toHex)(data.commitHash) + \" blockhash: \" + data.resultBitcoinHeader.getHash() +\r\n                \" height: \" + data.resultStoredHeader.getBlockheight());\r\n        return data;\r\n    }\r\n    /**\r\n     * Saves blockheaders as a bitcoin main chain to the btc relay\r\n     *\r\n     * @param signer\r\n     * @param mainHeaders\r\n     * @param storedHeader\r\n     * @param feeRate\r\n     */\r\n    saveMainHeaders(signer, mainHeaders, storedHeader, feeRate) {\r\n        logger.debug(\"saveMainHeaders(): submitting main blockheaders, count: \" + mainHeaders.length);\r\n        return this._saveHeaders(signer, mainHeaders, storedHeader, null, 0, feeRate);\r\n    }\r\n    /**\r\n     * Creates a new long fork and submits the headers to it\r\n     *\r\n     * @param signer\r\n     * @param forkHeaders\r\n     * @param storedHeader\r\n     * @param tipWork\r\n     * @param feeRate\r\n     */\r\n    async saveNewForkHeaders(signer, forkHeaders, storedHeader, tipWork, feeRate) {\r\n        let forkId = Math.floor(Math.random() * 0xFFFFFFFFFFFF);\r\n        logger.debug(\"saveNewForkHeaders(): submitting new fork & blockheaders,\" +\r\n            \" count: \" + forkHeaders.length + \" forkId: 0x\" + forkId.toString(16));\r\n        return await this._saveHeaders(signer, forkHeaders, storedHeader, tipWork, forkId, feeRate);\r\n    }\r\n    /**\r\n     * Continues submitting blockheaders to a given fork\r\n     *\r\n     * @param signer\r\n     * @param forkHeaders\r\n     * @param storedHeader\r\n     * @param forkId\r\n     * @param tipWork\r\n     * @param feeRate\r\n     */\r\n    saveForkHeaders(signer, forkHeaders, storedHeader, forkId, tipWork, feeRate) {\r\n        logger.debug(\"saveForkHeaders(): submitting blockheaders to existing fork,\" +\r\n            \" count: \" + forkHeaders.length + \" forkId: 0x\" + forkId.toString(16));\r\n        return this._saveHeaders(signer, forkHeaders, storedHeader, tipWork, forkId, feeRate);\r\n    }\r\n    /**\r\n     * Submits short fork with given blockheaders\r\n     *\r\n     * @param signer\r\n     * @param forkHeaders\r\n     * @param storedHeader\r\n     * @param tipWork\r\n     * @param feeRate\r\n     */\r\n    saveShortForkHeaders(signer, forkHeaders, storedHeader, tipWork, feeRate) {\r\n        logger.debug(\"saveShortForkHeaders(): submitting short fork blockheaders,\" +\r\n            \" count: \" + forkHeaders.length);\r\n        return this._saveHeaders(signer, forkHeaders, storedHeader, tipWork, -1, feeRate);\r\n    }\r\n    /**\r\n     * Estimate required synchronization fee (worst case) to synchronize btc relay to the required blockheight\r\n     *\r\n     * @param requiredBlockheight\r\n     * @param feeRate\r\n     */\r\n    async estimateSynchronizeFee(requiredBlockheight, feeRate) {\r\n        const tipData = await this.getTipData();\r\n        const currBlockheight = tipData.blockheight;\r\n        const blockheightDelta = requiredBlockheight - currBlockheight;\r\n        if (blockheightDelta <= 0)\r\n            return 0n;\r\n        const synchronizationFee = BigInt(blockheightDelta) * await this.getFeePerBlock(feeRate);\r\n        logger.debug(\"estimateSynchronizeFee(): required blockheight: \" + requiredBlockheight +\r\n            \" blockheight delta: \" + blockheightDelta + \" fee: \" + synchronizationFee.toString(10));\r\n        return synchronizationFee;\r\n    }\r\n    /**\r\n     * Returns fee required (in SOL) to synchronize a single block to btc relay\r\n     *\r\n     * @param feeRate\r\n     */\r\n    async getFeePerBlock(feeRate) {\r\n        feeRate ?? (feeRate = await this.Chain.Fees.getFeeRate());\r\n        return StarknetFees_1.StarknetFees.getGasFee(GAS_PER_BLOCKHEADER, feeRate);\r\n    }\r\n    /**\r\n     * Gets fee rate required for submitting blockheaders to the main chain\r\n     */\r\n    getMainFeeRate(signer) {\r\n        return this.Chain.Fees.getFeeRate();\r\n    }\r\n    /**\r\n     * Gets fee rate required for submitting blockheaders to the specific fork\r\n     */\r\n    getForkFeeRate(signer, forkId) {\r\n        return this.Chain.Fees.getFeeRate();\r\n    }\r\n    saveInitialHeader(signer, header, epochStart, pastBlocksTimestamps, feeRate) {\r\n        throw new Error(\"Not supported, starknet contract is initialized with constructor!\");\r\n    }\r\n    /**\r\n     * Gets committed header, identified by blockhash & blockheight, determines required BTC relay blockheight based on\r\n     *  requiredConfirmations\r\n     * If synchronizer is passed & blockhash is not found, it produces transactions to sync up the btc relay to the\r\n     *  current chain tip & adds them to the txs array\r\n     *\r\n     * @param signer\r\n     * @param btcRelay\r\n     * @param btcTxs\r\n     * @param txs solana transaction array, in case we need to synchronize the btc relay ourselves the synchronization\r\n     *  txns are added here\r\n     * @param synchronizer optional synchronizer to use to synchronize the btc relay in case it is not yet synchronized\r\n     *  to the required blockheight\r\n     * @param feeRate Fee rate to use for synchronization transactions\r\n     * @private\r\n     */\r\n    static async getCommitedHeadersAndSynchronize(signer, btcRelay, btcTxs, txs, synchronizer, feeRate) {\r\n        const leavesTxs = [];\r\n        const blockheaders = {};\r\n        for (let btcTx of btcTxs) {\r\n            const requiredBlockheight = btcTx.blockheight + btcTx.requiredConfirmations - 1;\r\n            const result = await (0, Utils_1.tryWithRetries)(() => btcRelay.retrieveLogAndBlockheight({\r\n                blockhash: btcTx.blockhash\r\n            }, requiredBlockheight));\r\n            if (result != null) {\r\n                blockheaders[result.header.getBlockHash().toString(\"hex\")] = result.header;\r\n            }\r\n            else {\r\n                leavesTxs.push(btcTx);\r\n            }\r\n        }\r\n        if (leavesTxs.length === 0)\r\n            return blockheaders;\r\n        //Need to synchronize\r\n        if (synchronizer == null)\r\n            return null;\r\n        //TODO: We don't have to synchronize to tip, only to our required blockheight\r\n        const resp = await synchronizer.syncToLatestTxs(signer.toString(), feeRate);\r\n        logger.debug(\"getCommitedHeaderAndSynchronize(): BTC Relay not synchronized to required blockheight, \" +\r\n            \"synchronizing ourselves in \" + resp.txs.length + \" txs\");\r\n        logger.debug(\"getCommitedHeaderAndSynchronize(): BTC Relay computed header map: \", resp.computedHeaderMap);\r\n        txs.push(...resp.txs);\r\n        for (let key in resp.computedHeaderMap) {\r\n            const header = resp.computedHeaderMap[key];\r\n            blockheaders[header.getBlockHash().toString(\"hex\")] = header;\r\n        }\r\n        //Check that blockhashes of all the rest txs are included\r\n        for (let btcTx of leavesTxs) {\r\n            if (blockheaders[btcTx.blockhash] == null)\r\n                return null;\r\n        }\r\n        //Retrieve computed headers\r\n        return blockheaders;\r\n    }\r\n}\r\nexports.StarknetBtcRelay = StarknetBtcRelay;\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3693, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/swaps/EscrowManagerAbi.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.EscrowManagerAbi = void 0;\r\nexports.EscrowManagerAbi = [\r\n    {\r\n        \"type\": \"impl\",\r\n        \"name\": \"EscrowManagerImpl\",\r\n        \"interface_name\": \"escrow_manager::IEscrowManager\"\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"core::integer::u256\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"low\",\r\n                \"type\": \"core::integer::u128\"\r\n            },\r\n            {\r\n                \"name\": \"high\",\r\n                \"type\": \"core::integer::u128\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"escrow_manager::structs::escrow::EscrowExecution\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"hash\",\r\n                \"type\": \"core::felt252\"\r\n            },\r\n            {\r\n                \"name\": \"expiry\",\r\n                \"type\": \"core::integer::u64\"\r\n            },\r\n            {\r\n                \"name\": \"fee\",\r\n                \"type\": \"core::integer::u256\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"enum\",\r\n        \"name\": \"core::option::Option::<escrow_manager::structs::escrow::EscrowExecution>\",\r\n        \"variants\": [\r\n            {\r\n                \"name\": \"Some\",\r\n                \"type\": \"escrow_manager::structs::escrow::EscrowExecution\"\r\n            },\r\n            {\r\n                \"name\": \"None\",\r\n                \"type\": \"()\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"escrow_manager::structs::escrow::EscrowData\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"offerer\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            },\r\n            {\r\n                \"name\": \"claimer\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            },\r\n            {\r\n                \"name\": \"token\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            },\r\n            {\r\n                \"name\": \"refund_handler\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            },\r\n            {\r\n                \"name\": \"claim_handler\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            },\r\n            {\r\n                \"name\": \"flags\",\r\n                \"type\": \"core::integer::u128\"\r\n            },\r\n            {\r\n                \"name\": \"claim_data\",\r\n                \"type\": \"core::felt252\"\r\n            },\r\n            {\r\n                \"name\": \"refund_data\",\r\n                \"type\": \"core::felt252\"\r\n            },\r\n            {\r\n                \"name\": \"amount\",\r\n                \"type\": \"core::integer::u256\"\r\n            },\r\n            {\r\n                \"name\": \"fee_token\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            },\r\n            {\r\n                \"name\": \"security_deposit\",\r\n                \"type\": \"core::integer::u256\"\r\n            },\r\n            {\r\n                \"name\": \"claimer_bounty\",\r\n                \"type\": \"core::integer::u256\"\r\n            },\r\n            {\r\n                \"name\": \"success_action\",\r\n                \"type\": \"core::option::Option::<escrow_manager::structs::escrow::EscrowExecution>\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"core::array::Span::<core::felt252>\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"snapshot\",\r\n                \"type\": \"@core::array::Array::<core::felt252>\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"interface\",\r\n        \"name\": \"escrow_manager::IEscrowManager\",\r\n        \"items\": [\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"initialize\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"escrow\",\r\n                        \"type\": \"escrow_manager::structs::escrow::EscrowData\"\r\n                    },\r\n                    {\r\n                        \"name\": \"signature\",\r\n                        \"type\": \"core::array::Array::<core::felt252>\"\r\n                    },\r\n                    {\r\n                        \"name\": \"timeout\",\r\n                        \"type\": \"core::integer::u64\"\r\n                    },\r\n                    {\r\n                        \"name\": \"extra_data\",\r\n                        \"type\": \"core::array::Span::<core::felt252>\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"claim\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"escrow\",\r\n                        \"type\": \"escrow_manager::structs::escrow::EscrowData\"\r\n                    },\r\n                    {\r\n                        \"name\": \"witness\",\r\n                        \"type\": \"core::array::Array::<core::felt252>\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"refund\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"escrow\",\r\n                        \"type\": \"escrow_manager::structs::escrow::EscrowData\"\r\n                    },\r\n                    {\r\n                        \"name\": \"witness\",\r\n                        \"type\": \"core::array::Array::<core::felt252>\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"cooperative_refund\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"escrow\",\r\n                        \"type\": \"escrow_manager::structs::escrow::EscrowData\"\r\n                    },\r\n                    {\r\n                        \"name\": \"signature\",\r\n                        \"type\": \"core::array::Array::<core::felt252>\"\r\n                    },\r\n                    {\r\n                        \"name\": \"timeout\",\r\n                        \"type\": \"core::integer::u64\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"impl\",\r\n        \"name\": \"LPVaultImpl\",\r\n        \"interface_name\": \"escrow_manager::components::lp_vault::ILPVault\"\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"core::array::Span::<(core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress)>\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"snapshot\",\r\n                \"type\": \"@core::array::Array::<(core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress)>\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"interface\",\r\n        \"name\": \"escrow_manager::components::lp_vault::ILPVault\",\r\n        \"items\": [\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"deposit\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"token\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"amount\",\r\n                        \"type\": \"core::integer::u256\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"withdraw\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"token\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"amount\",\r\n                        \"type\": \"core::integer::u256\"\r\n                    },\r\n                    {\r\n                        \"name\": \"destination\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"get_balance\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"data\",\r\n                        \"type\": \"core::array::Span::<(core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress)>\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::array::Array::<core::integer::u256>\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"impl\",\r\n        \"name\": \"ReputationTrackerImpl\",\r\n        \"interface_name\": \"escrow_manager::components::reputation::IReputationTracker\"\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"core::array::Span::<(core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress)>\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"snapshot\",\r\n                \"type\": \"@core::array::Array::<(core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress)>\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"escrow_manager::state::reputation::Reputation\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"amount\",\r\n                \"type\": \"core::integer::u256\"\r\n            },\r\n            {\r\n                \"name\": \"count\",\r\n                \"type\": \"core::integer::u128\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"interface\",\r\n        \"name\": \"escrow_manager::components::reputation::IReputationTracker\",\r\n        \"items\": [\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"get_reputation\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"data\",\r\n                        \"type\": \"core::array::Span::<(core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress)>\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::array::Array::<[escrow_manager::state::reputation::Reputation; 3]>\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"impl\",\r\n        \"name\": \"EscrowStorageImpl\",\r\n        \"interface_name\": \"escrow_manager::components::escrow_storage::IEscrowStorage\"\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"escrow_manager::state::escrow::EscrowState\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"init_blockheight\",\r\n                \"type\": \"core::integer::u64\"\r\n            },\r\n            {\r\n                \"name\": \"finish_blockheight\",\r\n                \"type\": \"core::integer::u64\"\r\n            },\r\n            {\r\n                \"name\": \"state\",\r\n                \"type\": \"core::integer::u8\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"core::array::Span::<escrow_manager::state::escrow::EscrowState>\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"snapshot\",\r\n                \"type\": \"@core::array::Array::<escrow_manager::state::escrow::EscrowState>\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"interface\",\r\n        \"name\": \"escrow_manager::components::escrow_storage::IEscrowStorage\",\r\n        \"items\": [\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"get_state\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"escrow\",\r\n                        \"type\": \"escrow_manager::structs::escrow::EscrowData\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"escrow_manager::state::escrow::EscrowState\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"get_hash_state\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"escrow_hash\",\r\n                        \"type\": \"core::felt252\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"escrow_manager::state::escrow::EscrowState\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"get_hash_state_multiple\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"escrow_hashes\",\r\n                        \"type\": \"core::array::Span::<core::felt252>\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::array::Span::<escrow_manager::state::escrow::EscrowState>\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"escrow_manager::components::lp_vault::lp_vault::Event\",\r\n        \"kind\": \"enum\",\r\n        \"variants\": []\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"escrow_manager::components::reputation::reputation::Event\",\r\n        \"kind\": \"enum\",\r\n        \"variants\": []\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"escrow_manager::components::escrow_storage::escrow_storage::Event\",\r\n        \"kind\": \"enum\",\r\n        \"variants\": []\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"escrow_manager::events::Initialize\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"offerer\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"claimer\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"claim_data\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"escrow_hash\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"claim_handler\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"refund_handler\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"escrow_manager::events::Claim\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"offerer\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"claimer\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"claim_data\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"escrow_hash\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"witness_result\",\r\n                \"type\": \"core::array::Span::<core::felt252>\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"claim_handler\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"escrow_manager::events::Refund\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"offerer\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"claimer\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"claim_data\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"escrow_hash\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"witness_result\",\r\n                \"type\": \"core::array::Span::<core::felt252>\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"refund_handler\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"escrow_manager::EscrowManager::Event\",\r\n        \"kind\": \"enum\",\r\n        \"variants\": [\r\n            {\r\n                \"name\": \"LPVaultEvent\",\r\n                \"type\": \"escrow_manager::components::lp_vault::lp_vault::Event\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"ReputationTrackerEvent\",\r\n                \"type\": \"escrow_manager::components::reputation::reputation::Event\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"EscrowStorageEvent\",\r\n                \"type\": \"escrow_manager::components::escrow_storage::escrow_storage::Event\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"Initialize\",\r\n                \"type\": \"escrow_manager::events::Initialize\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"Claim\",\r\n                \"type\": \"escrow_manager::events::Claim\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"Refund\",\r\n                \"type\": \"escrow_manager::events::Refund\",\r\n                \"kind\": \"nested\"\r\n            }\r\n        ]\r\n    }\r\n];\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,gBAAgB,GAAG,KAAK;AAChC,QAAQ,gBAAgB,GAAG;IACvB;QACI,QAAQ;QACR,QAAQ;QACR,kBAAkB;IACtB;IACA;QACI,QAAQ;QACR,QAAQ;QACR,WAAW;YACP;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;SACH;IACL;IACA;QACI,QAAQ;QACR,QAAQ;QACR,WAAW;YACP;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;SACH;IACL;IACA;QACI,QAAQ;QACR,QAAQ;QACR,YAAY;YACR;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;SACH;IACL;IACA;QACI,QAAQ;QACR,QAAQ;QACR,WAAW;YACP;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;SACH;IACL;IACA;QACI,QAAQ;QACR,QAAQ;QACR,WAAW;YACP;gBACI,QAAQ;gBACR,QAAQ;YACZ;SACH;IACL;IACA;QACI,QAAQ;QACR,QAAQ;QACR,SAAS;YACL;gBACI,QAAQ;gBACR,QAAQ;gBACR,UAAU;oBACN;wBACI,QAAQ;wBACR,QAAQ;oBACZ;oBACA;wBACI,QAAQ;wBACR,QAAQ;oBACZ;oBACA;wBACI,QAAQ;wBACR,QAAQ;oBACZ;oBACA;wBACI,QAAQ;wBACR,QAAQ;oBACZ;iBACH;gBACD,WAAW,EAAE;gBACb,oBAAoB;YACxB;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,UAAU;oBACN;wBACI,QAAQ;wBACR,QAAQ;oBACZ;oBACA;wBACI,QAAQ;wBACR,QAAQ;oBACZ;iBACH;gBACD,WAAW,EAAE;gBACb,oBAAoB;YACxB;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,UAAU;oBACN;wBACI,QAAQ;wBACR,QAAQ;oBACZ;oBACA;wBACI,QAAQ;wBACR,QAAQ;oBACZ;iBACH;gBACD,WAAW,EAAE;gBACb,oBAAoB;YACxB;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,UAAU;oBACN;wBACI,QAAQ;wBACR,QAAQ;oBACZ;oBACA;wBACI,QAAQ;wBACR,QAAQ;oBACZ;oBACA;wBACI,QAAQ;wBACR,QAAQ;oBACZ;iBACH;gBACD,WAAW,EAAE;gBACb,oBAAoB;YACxB;SACH;IACL;IACA;QACI,QAAQ;QACR,QAAQ;QACR,kBAAkB;IACtB;IACA;QACI,QAAQ;QACR,QAAQ;QACR,WAAW;YACP;gBACI,QAAQ;gBACR,QAAQ;YACZ;SACH;IACL;IACA;QACI,QAAQ;QACR,QAAQ;QACR,SAAS;YACL;gBACI,QAAQ;gBACR,QAAQ;gBACR,UAAU;oBACN;wBACI,QAAQ;wBACR,QAAQ;oBACZ;oBACA;wBACI,QAAQ;wBACR,QAAQ;oBACZ;iBACH;gBACD,WAAW,EAAE;gBACb,oBAAoB;YACxB;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,UAAU;oBACN;wBACI,QAAQ;wBACR,QAAQ;oBACZ;oBACA;wBACI,QAAQ;wBACR,QAAQ;oBACZ;oBACA;wBACI,QAAQ;wBACR,QAAQ;oBACZ;iBACH;gBACD,WAAW,EAAE;gBACb,oBAAoB;YACxB;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,UAAU;oBACN;wBACI,QAAQ;wBACR,QAAQ;oBACZ;iBACH;gBACD,WAAW;oBACP;wBACI,QAAQ;oBACZ;iBACH;gBACD,oBAAoB;YACxB;SACH;IACL;IACA;QACI,QAAQ;QACR,QAAQ;QACR,kBAAkB;IACtB;IACA;QACI,QAAQ;QACR,QAAQ;QACR,WAAW;YACP;gBACI,QAAQ;gBACR,QAAQ;YACZ;SACH;IACL;IACA;QACI,QAAQ;QACR,QAAQ;QACR,WAAW;YACP;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;SACH;IACL;IACA;QACI,QAAQ;QACR,QAAQ;QACR,SAAS;YACL;gBACI,QAAQ;gBACR,QAAQ;gBACR,UAAU;oBACN;wBACI,QAAQ;wBACR,QAAQ;oBACZ;iBACH;gBACD,WAAW;oBACP;wBACI,QAAQ;oBACZ;iBACH;gBACD,oBAAoB;YACxB;SACH;IACL;IACA;QACI,QAAQ;QACR,QAAQ;QACR,kBAAkB;IACtB;IACA;QACI,QAAQ;QACR,QAAQ;QACR,WAAW;YACP;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;YACZ;SACH;IACL;IACA;QACI,QAAQ;QACR,QAAQ;QACR,WAAW;YACP;gBACI,QAAQ;gBACR,QAAQ;YACZ;SACH;IACL;IACA;QACI,QAAQ;QACR,QAAQ;QACR,SAAS;YACL;gBACI,QAAQ;gBACR,QAAQ;gBACR,UAAU;oBACN;wBACI,QAAQ;wBACR,QAAQ;oBACZ;iBACH;gBACD,WAAW;oBACP;wBACI,QAAQ;oBACZ;iBACH;gBACD,oBAAoB;YACxB;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,UAAU;oBACN;wBACI,QAAQ;wBACR,QAAQ;oBACZ;iBACH;gBACD,WAAW;oBACP;wBACI,QAAQ;oBACZ;iBACH;gBACD,oBAAoB;YACxB;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,UAAU;oBACN;wBACI,QAAQ;wBACR,QAAQ;oBACZ;iBACH;gBACD,WAAW;oBACP;wBACI,QAAQ;oBACZ;iBACH;gBACD,oBAAoB;YACxB;SACH;IACL;IACA;QACI,QAAQ;QACR,QAAQ;QACR,QAAQ;QACR,YAAY,EAAE;IAClB;IACA;QACI,QAAQ;QACR,QAAQ;QACR,QAAQ;QACR,YAAY,EAAE;IAClB;IACA;QACI,QAAQ;QACR,QAAQ;QACR,QAAQ;QACR,YAAY,EAAE;IAClB;IACA;QACI,QAAQ;QACR,QAAQ;QACR,QAAQ;QACR,WAAW;YACP;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;SACH;IACL;IACA;QACI,QAAQ;QACR,QAAQ;QACR,QAAQ;QACR,WAAW;YACP;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;SACH;IACL;IACA;QACI,QAAQ;QACR,QAAQ;QACR,QAAQ;QACR,WAAW;YACP;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;SACH;IACL;IACA;QACI,QAAQ;QACR,QAAQ;QACR,QAAQ;QACR,YAAY;YACR;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;YACA;gBACI,QAAQ;gBACR,QAAQ;gBACR,QAAQ;YACZ;SACH;IACL;CACH","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4281, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/contract/StarknetContractModule.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetContractModule = void 0;\r\nconst StarknetModule_1 = require(\"../chain/StarknetModule\");\r\nclass StarknetContractModule extends StarknetModule_1.StarknetModule {\r\n    constructor(chainInterface, contract) {\r\n        super(chainInterface);\r\n        this.contract = contract;\r\n    }\r\n}\r\nexports.StarknetContractModule = StarknetContractModule;\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,sBAAsB,GAAG,KAAK;AACtC,MAAM;AACN,MAAM,+BAA+B,iBAAiB,cAAc;IAChE,YAAY,cAAc,EAAE,QAAQ,CAAE;QAClC,KAAK,CAAC;QACN,IAAI,CAAC,QAAQ,GAAG;IACpB;AACJ;AACA,QAAQ,sBAAsB,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4297, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/swaps/StarknetSwapModule.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetSwapModule = void 0;\r\nconst StarknetContractModule_1 = require(\"../contract/StarknetContractModule\");\r\nclass StarknetSwapModule extends StarknetContractModule_1.StarknetContractModule {\r\n    constructor(chainInterface, contract) {\r\n        super(chainInterface, contract);\r\n        this.swapContract = contract.contract;\r\n    }\r\n}\r\nexports.StarknetSwapModule = StarknetSwapModule;\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,kBAAkB,GAAG,KAAK;AAClC,MAAM;AACN,MAAM,2BAA2B,yBAAyB,sBAAsB;IAC5E,YAAY,cAAc,EAAE,QAAQ,CAAE;QAClC,KAAK,CAAC,gBAAgB;QACtB,IAAI,CAAC,YAAY,GAAG,SAAS,QAAQ;IACzC;AACJ;AACA,QAAQ,kBAAkB,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4313, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/swaps/modules/StarknetLpVault.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetLpVault = void 0;\r\nconst Utils_1 = require(\"../../../utils/Utils\");\r\nconst StarknetSwapModule_1 = require(\"../StarknetSwapModule\");\r\nconst StarknetAction_1 = require(\"../../chain/StarknetAction\");\r\nconst starknet_1 = require(\"starknet\");\r\nclass StarknetLpVault extends StarknetSwapModule_1.StarknetSwapModule {\r\n    /**\r\n     * Action for withdrawing funds from the LP vault\r\n     *\r\n     * @param signer\r\n     * @param token\r\n     * @param amount\r\n     * @constructor\r\n     * @private\r\n     */\r\n    Withdraw(signer, token, amount) {\r\n        return new StarknetAction_1.StarknetAction(signer, this.root, this.swapContract.populateTransaction.withdraw(token, starknet_1.cairo.uint256(amount), signer), StarknetLpVault.GasCosts.WITHDRAW);\r\n    }\r\n    /**\r\n     * Action for depositing funds to the LP vault\r\n     *\r\n     * @param signer\r\n     * @param token\r\n     * @param amount\r\n     * @constructor\r\n     * @private\r\n     */\r\n    Deposit(signer, token, amount) {\r\n        return new StarknetAction_1.StarknetAction(signer, this.root, this.swapContract.populateTransaction.deposit(token, starknet_1.cairo.uint256(amount)), StarknetLpVault.GasCosts.WITHDRAW);\r\n    }\r\n    /**\r\n     * Returns intermediary's reputation & vault balance for a specific token\r\n     *\r\n     * @param address\r\n     * @param token\r\n     */\r\n    async getIntermediaryData(address, token) {\r\n        const [balance, reputation] = await Promise.all([\r\n            this.getIntermediaryBalance(address, token),\r\n            this.getIntermediaryReputation(address, token)\r\n        ]);\r\n        return { balance, reputation };\r\n    }\r\n    /**\r\n     * Returns intermediary's reputation for a specific token\r\n     *\r\n     * @param address\r\n     * @param token\r\n     */\r\n    async getIntermediaryReputation(address, token) {\r\n        const filter = Object.keys(this.contract.claimHandlersByAddress).map(claimHandler => starknet_1.cairo.tuple(address, token, claimHandler));\r\n        const rawReputation = await this.provider.callContract(this.swapContract.populateTransaction.get_reputation(filter));\r\n        const length = (0, Utils_1.toBigInt)(rawReputation.shift());\r\n        if (Number(length) !== filter.length)\r\n            throw new Error(\"getIntermediaryReputation(): Invalid response length\");\r\n        const result = {};\r\n        Object.keys(this.contract.claimHandlersByAddress).forEach((address) => {\r\n            const handler = this.contract.claimHandlersByAddress[address];\r\n            result[handler.getType()] = {\r\n                successVolume: (0, Utils_1.toBigInt)({ low: rawReputation.shift(), high: rawReputation.shift() }),\r\n                successCount: (0, Utils_1.toBigInt)(rawReputation.shift()),\r\n                coopCloseVolume: (0, Utils_1.toBigInt)({ low: rawReputation.shift(), high: rawReputation.shift() }),\r\n                coopCloseCount: (0, Utils_1.toBigInt)(rawReputation.shift()),\r\n                failVolume: (0, Utils_1.toBigInt)({ low: rawReputation.shift(), high: rawReputation.shift() }),\r\n                failCount: (0, Utils_1.toBigInt)(rawReputation.shift()),\r\n            };\r\n        });\r\n        return result;\r\n    }\r\n    /**\r\n     * Returns the balance of the token an intermediary has in his LP vault\r\n     *\r\n     * @param address\r\n     * @param token\r\n     */\r\n    async getIntermediaryBalance(address, token) {\r\n        const balance = (0, Utils_1.toBigInt)((await this.swapContract.get_balance([starknet_1.cairo.tuple(address, token)]))[0]);\r\n        this.logger.debug(\"getIntermediaryBalance(): token LP balance fetched, token: \" + token.toString() +\r\n            \" address: \" + address + \" amount: \" + (balance == null ? \"null\" : balance.toString()));\r\n        return balance;\r\n    }\r\n    /**\r\n     * Creates transactions for withdrawing funds from the LP vault, creates ATA if it doesn't exist and unwraps\r\n     *  WSOL to SOL if required\r\n     *\r\n     * @param signer\r\n     * @param token\r\n     * @param amount\r\n     * @param feeRate\r\n     */\r\n    async txsWithdraw(signer, token, amount, feeRate) {\r\n        const action = await this.Withdraw(signer, token, amount);\r\n        feeRate ?? (feeRate = await this.root.Fees.getFeeRate());\r\n        this.logger.debug(\"txsWithdraw(): withdraw TX created, token: \" + token.toString() +\r\n            \" amount: \" + amount.toString(10));\r\n        return [await action.tx(feeRate)];\r\n    }\r\n    /**\r\n     * Creates transaction for depositing funds into the LP vault, wraps SOL to WSOL if required\r\n     *\r\n     * @param signer\r\n     * @param token\r\n     * @param amount\r\n     * @param feeRate\r\n     */\r\n    async txsDeposit(signer, token, amount, feeRate) {\r\n        //Approve first\r\n        const action = await this.root.Tokens.Approve(signer, this.swapContract.address, token, amount);\r\n        action.add(this.Deposit(signer, token, amount));\r\n        feeRate ?? (feeRate = await this.root.Fees.getFeeRate());\r\n        this.logger.debug(\"txsDeposit(): deposit TX created, token: \" + token.toString() +\r\n            \" amount: \" + amount.toString(10));\r\n        return [await action.tx(feeRate)];\r\n    }\r\n}\r\nexports.StarknetLpVault = StarknetLpVault;\r\nStarknetLpVault.GasCosts = {\r\n    WITHDRAW: { l1DataGas: 500, l2Gas: 3200000, l1Gas: 0 },\r\n    DEPOSIT: { l1: 500, l2Gas: 4000000, l1Gas: 0 }\r\n};\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4455, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/swaps/modules/StarknetSwapInit.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetSwapInit = void 0;\r\nconst base_1 = require(\"@atomiqlabs/base\");\r\nconst Utils_1 = require(\"../../../utils/Utils\");\r\nconst buffer_1 = require(\"buffer\");\r\nconst StarknetAction_1 = require(\"../../chain/StarknetAction\");\r\nconst StarknetSwapModule_1 = require(\"../StarknetSwapModule\");\r\nconst starknet_1 = require(\"starknet\");\r\nconst StarknetFees_1 = require(\"../../chain/modules/StarknetFees\");\r\nconst Initialize = [\r\n    { name: 'Swap hash', type: 'felt' },\r\n    { name: 'Offerer', type: 'ContractAddress' },\r\n    { name: 'Claimer', type: 'ContractAddress' },\r\n    { name: 'Token amount', type: 'TokenAmount' },\r\n    { name: 'Pay in', type: 'bool' },\r\n    { name: 'Pay out', type: 'bool' },\r\n    { name: 'Tracking reputation', type: 'bool' },\r\n    { name: 'Claim handler', type: 'ContractAddress' },\r\n    { name: 'Claim data', type: 'felt' },\r\n    { name: 'Refund handler', type: 'ContractAddress' },\r\n    { name: 'Refund data', type: 'felt' },\r\n    { name: 'Security deposit', type: 'TokenAmount' },\r\n    { name: 'Claimer bounty', type: 'TokenAmount' },\r\n    { name: 'Claim action hash', type: 'felt' },\r\n    { name: 'Deadline', type: 'timestamp' }\r\n];\r\nclass StarknetSwapInit extends StarknetSwapModule_1.StarknetSwapModule {\r\n    /**\r\n     * bare Init action based on the data passed in swapData\r\n     *\r\n     * @param swapData\r\n     * @param timeout\r\n     * @param signature\r\n     * @private\r\n     */\r\n    Init(swapData, timeout, signature) {\r\n        return new StarknetAction_1.StarknetAction(swapData.payIn ? swapData.offerer : swapData.claimer, this.root, this.swapContract.populateTransaction.initialize(swapData.toEscrowStruct(), signature, timeout, swapData.extraData == null || swapData.extraData === \"\" ? [] : (0, Utils_1.bufferToBytes31Span)(buffer_1.Buffer.from(swapData.extraData, \"hex\")).map(Utils_1.toHex)), swapData.payIn ? StarknetSwapInit.GasCosts.INIT_PAY_IN : StarknetSwapInit.GasCosts.INIT);\r\n    }\r\n    /**\r\n     * Returns auth prefix to be used with a specific swap, payIn=true & payIn=false use different prefixes (these\r\n     *  actually have no meaning for the smart contract/solana program in the Solana case)\r\n     *\r\n     * @param swapData\r\n     * @private\r\n     */\r\n    getAuthPrefix(swapData) {\r\n        return swapData.isPayIn() ? \"claim_initialize\" : \"initialize\";\r\n    }\r\n    async preFetchForInitSignatureVerification() {\r\n        return {\r\n            pendingBlockTime: await this.root.Blocks.getBlockTime(\"pending\")\r\n        };\r\n    }\r\n    /**\r\n     * Signs swap initialization authorization, using data from preFetchedBlockData if provided & still valid (subject\r\n     *  to SIGNATURE_PREFETCH_DATA_VALIDITY)\r\n     *\r\n     * @param signer\r\n     * @param swapData\r\n     * @param authorizationTimeout\r\n     * @public\r\n     */\r\n    async signSwapInitialization(signer, swapData, authorizationTimeout) {\r\n        const authTimeout = Math.floor(Date.now() / 1000) + authorizationTimeout;\r\n        const signature = await this.root.Signatures.signTypedMessage(signer, Initialize, \"Initialize\", {\r\n            \"Swap hash\": \"0x\" + swapData.getEscrowHash(),\r\n            \"Offerer\": swapData.offerer,\r\n            \"Claimer\": swapData.claimer,\r\n            \"Token amount\": {\r\n                token_address: swapData.token,\r\n                amount: starknet_1.cairo.uint256(swapData.amount)\r\n            },\r\n            \"Pay in\": swapData.isPayIn(),\r\n            \"Pay out\": swapData.isPayOut(),\r\n            \"Tracking reputation\": swapData.reputation,\r\n            \"Refund handler\": swapData.refundHandler,\r\n            \"Claim handler\": swapData.claimHandler,\r\n            \"Claim data\": \"0x\" + swapData.getClaimHash(),\r\n            \"Refund data\": swapData.refundData.startsWith(\"0x\") ? swapData.refundData : \"0x\" + swapData.refundData,\r\n            \"Security deposit\": {\r\n                token_address: swapData.feeToken,\r\n                amount: starknet_1.cairo.uint256(swapData.securityDeposit)\r\n            },\r\n            \"Claimer bounty\": {\r\n                token_address: swapData.feeToken,\r\n                amount: starknet_1.cairo.uint256(swapData.claimerBounty)\r\n            },\r\n            \"Claim action hash\": 0n,\r\n            \"Deadline\": (0, Utils_1.toHex)(authTimeout)\r\n        });\r\n        return {\r\n            prefix: this.getAuthPrefix(swapData),\r\n            timeout: authTimeout.toString(10),\r\n            signature\r\n        };\r\n    }\r\n    /**\r\n     * Checks whether the provided signature data is valid, using preFetchedData if provided and still valid\r\n     *\r\n     * @param swapData\r\n     * @param timeout\r\n     * @param prefix\r\n     * @param signature\r\n     * @param preFetchData\r\n     * @public\r\n     */\r\n    async isSignatureValid(sender, swapData, timeout, prefix, signature, preFetchData) {\r\n        if (!swapData.isOfferer(sender) && !swapData.isClaimer(sender))\r\n            throw new base_1.SignatureVerificationError(\"TX sender not offerer nor claimer\");\r\n        const signer = swapData.isOfferer(sender) ? swapData.claimer : swapData.offerer;\r\n        if (!swapData.isPayIn() && await this.contract.isExpired(sender.toString(), swapData)) {\r\n            throw new base_1.SignatureVerificationError(\"Swap will expire too soon!\");\r\n        }\r\n        if (prefix !== this.getAuthPrefix(swapData))\r\n            throw new base_1.SignatureVerificationError(\"Invalid prefix\");\r\n        const currentTimestamp = BigInt(Math.floor(Date.now() / 1000));\r\n        const timeoutBN = BigInt(timeout);\r\n        const isExpired = (timeoutBN - currentTimestamp) < BigInt(this.contract.authGracePeriod);\r\n        if (isExpired)\r\n            throw new base_1.SignatureVerificationError(\"Authorization expired!\");\r\n        if (await this.isSignatureExpired(timeout, preFetchData))\r\n            throw new base_1.SignatureVerificationError(\"Authorization expired!\");\r\n        const valid = await this.root.Signatures.isValidSignature(signature, signer, Initialize, \"Initialize\", {\r\n            \"Swap hash\": \"0x\" + swapData.getEscrowHash(),\r\n            \"Offerer\": swapData.offerer,\r\n            \"Claimer\": swapData.claimer,\r\n            \"Token amount\": {\r\n                token_address: swapData.token,\r\n                amount: starknet_1.cairo.uint256(swapData.amount)\r\n            },\r\n            \"Pay in\": swapData.isPayIn(),\r\n            \"Pay out\": swapData.isPayOut(),\r\n            \"Tracking reputation\": swapData.reputation,\r\n            \"Refund handler\": swapData.refundHandler,\r\n            \"Claim handler\": swapData.claimHandler,\r\n            \"Claim data\": \"0x\" + swapData.getClaimHash(),\r\n            \"Refund data\": swapData.refundData.startsWith(\"0x\") ? swapData.refundData : \"0x\" + swapData.refundData,\r\n            \"Security deposit\": {\r\n                token_address: swapData.feeToken,\r\n                amount: starknet_1.cairo.uint256(swapData.securityDeposit)\r\n            },\r\n            \"Claimer bounty\": {\r\n                token_address: swapData.feeToken,\r\n                amount: starknet_1.cairo.uint256(swapData.claimerBounty)\r\n            },\r\n            \"Claim action hash\": 0n,\r\n            \"Deadline\": (0, Utils_1.toHex)(timeoutBN)\r\n        });\r\n        if (!valid)\r\n            throw new base_1.SignatureVerificationError(\"Invalid signature!\");\r\n        return null;\r\n    }\r\n    /**\r\n     * Gets expiry of the provided signature data, this is a minimum of slot expiry & swap signature expiry\r\n     *\r\n     * @param timeout\r\n     * @public\r\n     */\r\n    async getSignatureExpiry(timeout) {\r\n        const now = Date.now();\r\n        const timeoutExpiryTime = (parseInt(timeout) - this.contract.authGracePeriod) * 1000;\r\n        if (timeoutExpiryTime < now)\r\n            return 0;\r\n        return timeoutExpiryTime;\r\n    }\r\n    /**\r\n     * Checks whether signature is expired for good, compares the timestamp to the current \"pending\" block timestamp\r\n     *\r\n     * @param timeout\r\n     * @param preFetchData\r\n     * @public\r\n     */\r\n    async isSignatureExpired(timeout, preFetchData) {\r\n        if (preFetchData == null || preFetchData.pendingBlockTime == null) {\r\n            preFetchData = await this.preFetchForInitSignatureVerification();\r\n        }\r\n        return preFetchData.pendingBlockTime > parseInt(timeout);\r\n    }\r\n    /**\r\n     * Creates init transaction with a valid signature from an LP\r\n     *\r\n     * @param sender\r\n     * @param swapData swap to initialize\r\n     * @param timeout init signature timeout\r\n     * @param prefix init signature prefix\r\n     * @param signature init signature\r\n     * @param skipChecks whether to skip signature validity checks\r\n     * @param feeRate fee rate to use for the transaction\r\n     */\r\n    async txsInit(sender, swapData, timeout, prefix, signature, skipChecks, feeRate) {\r\n        if (!skipChecks) {\r\n            const [_, payStatus] = await Promise.all([\r\n                (0, Utils_1.tryWithRetries)(() => this.isSignatureValid(sender, swapData, timeout, prefix, signature), this.retryPolicy, (e) => e instanceof base_1.SignatureVerificationError),\r\n                (0, Utils_1.tryWithRetries)(() => this.contract.getCommitStatus(sender, swapData), this.retryPolicy)\r\n            ]);\r\n            if (payStatus.type !== base_1.SwapCommitStateType.NOT_COMMITED)\r\n                throw new base_1.SwapDataVerificationError(\"Invoice already being paid for or paid\");\r\n        }\r\n        feeRate ?? (feeRate = await this.root.Fees.getFeeRate());\r\n        const initAction = this.Init(swapData, BigInt(timeout), JSON.parse(signature));\r\n        if (swapData.payIn && swapData.isOfferer(sender))\r\n            initAction.addAction(this.root.Tokens.Approve(sender, this.swapContract.address, swapData.token, swapData.amount), 0); //Add erc20 approve\r\n        if (swapData.getTotalDeposit() !== 0n)\r\n            initAction.addAction(this.root.Tokens.Approve(sender, this.swapContract.address, swapData.feeToken, swapData.getTotalDeposit()), 0); //Add deposit erc20 approve\r\n        this.logger.debug(\"txsInitPayIn(): create swap init TX, swap: \" + swapData.getClaimHash() +\r\n            \" feerate: \" + feeRate);\r\n        return [await initAction.tx(feeRate)];\r\n    }\r\n    /**\r\n     * Get the estimated solana fee of the init transaction, this includes the required deposit for creating swap PDA\r\n     *  and also deposit for ATAs\r\n     */\r\n    async getInitFee(swapData, feeRate) {\r\n        feeRate ?? (feeRate = await this.root.Fees.getFeeRate());\r\n        return StarknetFees_1.StarknetFees.getGasFee(swapData.payIn ? StarknetSwapInit.GasCosts.INIT_PAY_IN : StarknetSwapInit.GasCosts.INIT, feeRate);\r\n    }\r\n}\r\nexports.StarknetSwapInit = StarknetSwapInit;\r\nStarknetSwapInit.GasCosts = {\r\n    INIT: { l1DataGas: 750, l2Gas: 8000000, l1Gas: 0 },\r\n    INIT_PAY_IN: { l1DataGas: 500, l2Gas: 4800000, l1Gas: 0 },\r\n};\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4720, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/swaps/modules/StarknetSwapRefund.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetSwapRefund = void 0;\r\nconst base_1 = require(\"@atomiqlabs/base\");\r\nconst Utils_1 = require(\"../../../utils/Utils\");\r\nconst StarknetSwapModule_1 = require(\"../StarknetSwapModule\");\r\nconst StarknetAction_1 = require(\"../../chain/StarknetAction\");\r\nconst StarknetFees_1 = require(\"../../chain/modules/StarknetFees\");\r\nconst Refund = [\r\n    { name: 'Swap hash', type: 'felt' },\r\n    { name: 'Timeout', type: 'timestamp' }\r\n];\r\nclass StarknetSwapRefund extends StarknetSwapModule_1.StarknetSwapModule {\r\n    /**\r\n     * Action for generic Refund instruction\r\n     *\r\n     * @param signer\r\n     * @param swapData\r\n     * @param witness\r\n     * @param handlerGas\r\n     * @constructor\r\n     * @private\r\n     */\r\n    Refund(signer, swapData, witness, handlerGas) {\r\n        return new StarknetAction_1.StarknetAction(signer, this.root, this.swapContract.populateTransaction.refund(swapData.toEscrowStruct(), witness), (0, StarknetFees_1.starknetGasAdd)(swapData.payIn ? StarknetSwapRefund.GasCosts.REFUND_PAY_OUT : StarknetSwapRefund.GasCosts.REFUND, handlerGas));\r\n    }\r\n    /**\r\n     * Action for cooperative refunding with signature\r\n     *\r\n     * @param sender\r\n     * @param swapData\r\n     * @param timeout\r\n     * @param signature\r\n     * @constructor\r\n     * @private\r\n     */\r\n    RefundWithSignature(sender, swapData, timeout, signature) {\r\n        return new StarknetAction_1.StarknetAction(sender, this.root, this.swapContract.populateTransaction.cooperative_refund(swapData.toEscrowStruct(), signature, BigInt(timeout)), swapData.payIn ? StarknetSwapRefund.GasCosts.REFUND_PAY_OUT : StarknetSwapRefund.GasCosts.REFUND);\r\n    }\r\n    async signSwapRefund(signer, swapData, authorizationTimeout) {\r\n        const authPrefix = \"refund\";\r\n        const authTimeout = Math.floor(Date.now() / 1000) + authorizationTimeout;\r\n        const signature = await this.root.Signatures.signTypedMessage(signer, Refund, \"Refund\", {\r\n            \"Swap hash\": \"0x\" + swapData.getEscrowHash(),\r\n            \"Timeout\": (0, Utils_1.toHex)(authTimeout)\r\n        });\r\n        return {\r\n            prefix: authPrefix,\r\n            timeout: authTimeout.toString(10),\r\n            signature: signature\r\n        };\r\n    }\r\n    async isSignatureValid(swapData, timeout, prefix, signature) {\r\n        if (prefix !== \"refund\")\r\n            throw new base_1.SignatureVerificationError(\"Invalid prefix\");\r\n        const expiryTimestamp = BigInt(timeout);\r\n        const currentTimestamp = BigInt(Math.floor(Date.now() / 1000));\r\n        const isExpired = (expiryTimestamp - currentTimestamp) < BigInt(this.contract.authGracePeriod);\r\n        if (isExpired)\r\n            throw new base_1.SignatureVerificationError(\"Authorization expired!\");\r\n        const valid = await this.root.Signatures.isValidSignature(signature, swapData.claimer, Refund, \"Refund\", {\r\n            \"Swap hash\": \"0x\" + swapData.getEscrowHash(),\r\n            \"Timeout\": (0, Utils_1.toHex)(expiryTimestamp)\r\n        });\r\n        if (!valid) {\r\n            throw new base_1.SignatureVerificationError(\"Invalid signature!\");\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Creates transactions required for refunding timed out swap\r\n     *\r\n     * @param signer\r\n     * @param swapData swap data to refund\r\n     * @param check whether to check if swap is already expired and refundable\r\n     * @param feeRate fee rate to be used for the transactions\r\n     * @param witnessData\r\n     */\r\n    async txsRefund(signer, swapData, check, feeRate, witnessData) {\r\n        const refundHandler = this.contract.refundHandlersByAddress[swapData.refundHandler.toLowerCase()];\r\n        if (refundHandler == null)\r\n            throw new Error(\"Invalid refund handler\");\r\n        if (check && !await (0, Utils_1.tryWithRetries)(() => this.contract.isRequestRefundable(swapData.offerer.toString(), swapData), this.retryPolicy)) {\r\n            throw new base_1.SwapDataVerificationError(\"Not refundable yet!\");\r\n        }\r\n        feeRate ?? (feeRate = await this.root.Fees.getFeeRate());\r\n        const { initialTxns, witness } = await refundHandler.getWitness(signer, swapData, witnessData, feeRate);\r\n        const action = this.Refund(signer, swapData, witness, refundHandler.getGas(swapData));\r\n        await action.addToTxs(initialTxns, feeRate);\r\n        this.logger.debug(\"txsRefund(): creating refund transaction, swap: \" + swapData.getClaimHash());\r\n        return initialTxns;\r\n    }\r\n    /**\r\n     * Creates transactions required for refunding the swap with authorization signature, also unwraps WSOL to SOL\r\n     *\r\n     * @param signer\r\n     * @param swapData swap data to refund\r\n     * @param timeout signature timeout\r\n     * @param prefix signature prefix of the counterparty\r\n     * @param signature signature of the counterparty\r\n     * @param check whether to check if swap is committed before attempting refund\r\n     * @param feeRate fee rate to be used for the transactions\r\n     */\r\n    async txsRefundWithAuthorization(signer, swapData, timeout, prefix, signature, check, feeRate) {\r\n        if (check && !await (0, Utils_1.tryWithRetries)(() => this.contract.isCommited(swapData), this.retryPolicy)) {\r\n            throw new base_1.SwapDataVerificationError(\"Not correctly committed\");\r\n        }\r\n        await (0, Utils_1.tryWithRetries)(() => this.isSignatureValid(swapData, timeout, prefix, signature), this.retryPolicy, (e) => e instanceof base_1.SignatureVerificationError);\r\n        const action = this.RefundWithSignature(signer, swapData, timeout, JSON.parse(signature));\r\n        feeRate ?? (feeRate = await this.root.Fees.getFeeRate());\r\n        this.logger.debug(\"txsRefundWithAuthorization(): creating refund transaction, swap: \" + swapData.getClaimHash() +\r\n            \" auth expiry: \" + timeout + \" signature: \" + signature);\r\n        return [await action.tx(feeRate)];\r\n    }\r\n    /**\r\n     * Get the estimated solana transaction fee of the refund transaction, in the worst case scenario in case where the\r\n     *  ATA needs to be initialized again (i.e. adding the ATA rent exempt lamports to the fee)\r\n     */\r\n    async getRefundFee(swapData, feeRate) {\r\n        feeRate ?? (feeRate = await this.root.Fees.getFeeRate());\r\n        return StarknetFees_1.StarknetFees.getGasFee(swapData.payIn ? StarknetSwapRefund.GasCosts.REFUND_PAY_OUT : StarknetSwapRefund.GasCosts.REFUND, feeRate);\r\n    }\r\n}\r\nexports.StarknetSwapRefund = StarknetSwapRefund;\r\nStarknetSwapRefund.GasCosts = {\r\n    REFUND: { l1DataGas: 750, l2Gas: 4000000, l1Gas: 0 },\r\n    REFUND_PAY_OUT: { l1DataGas: 900, l2Gas: 6000000, l1Gas: 0 }\r\n};\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4860, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/swaps/handlers/claim/HashlockClaimHandler.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.HashlockClaimHandler = void 0;\r\nconst Utils_1 = require(\"../../../../utils/Utils\");\r\nconst starknet_1 = require(\"starknet\");\r\nconst base_1 = require(\"@atomiqlabs/base\");\r\nconst buffer_1 = require(\"buffer\");\r\nconst sha2_1 = require(\"@noble/hashes/sha2\");\r\nclass HashlockClaimHandler {\r\n    constructor(address) {\r\n        this.address = address;\r\n    }\r\n    getCommitment(data) {\r\n        if (data.length !== 32)\r\n            throw new Error(\"Invalid swap hash\");\r\n        return starknet_1.hash.computePoseidonHashOnElements((0, Utils_1.bufferToU32Array)(data));\r\n    }\r\n    getWitness(signer, data, witnessData) {\r\n        if (!data.isClaimHandler(this.address))\r\n            throw new Error(\"Invalid claim handler\");\r\n        if (witnessData.length !== 64)\r\n            throw new Error(\"Invalid hash secret: string length\");\r\n        const buffer = buffer_1.Buffer.from(witnessData, \"hex\");\r\n        if (buffer.length !== 32)\r\n            throw new Error(\"Invalid hash secret: buff length\");\r\n        const witnessSha256 = buffer_1.Buffer.from((0, sha2_1.sha256)(buffer));\r\n        if (!data.isClaimData((0, Utils_1.toHex)(this.getCommitment(witnessSha256))))\r\n            throw new Error(\"Invalid hash secret: poseidon hash doesn't match\");\r\n        const witnessArray = (0, Utils_1.bufferToU32Array)(buffer);\r\n        return Promise.resolve({ initialTxns: [], witness: witnessArray });\r\n    }\r\n    getGas() {\r\n        return HashlockClaimHandler.gas;\r\n    }\r\n    getType() {\r\n        return HashlockClaimHandler.type;\r\n    }\r\n    parseWitnessResult(result) {\r\n        return (0, Utils_1.u32ArrayToBuffer)(result).toString(\"hex\");\r\n    }\r\n}\r\nexports.HashlockClaimHandler = HashlockClaimHandler;\r\nHashlockClaimHandler.type = base_1.ChainSwapType.HTLC;\r\nHashlockClaimHandler.gas = { l1DataGas: 0, l2Gas: 16000000, l1Gas: 0 };\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,oBAAoB,GAAG,KAAK;AACpC,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;IACF,YAAY,OAAO,CAAE;QACjB,IAAI,CAAC,OAAO,GAAG;IACnB;IACA,cAAc,IAAI,EAAE;QAChB,IAAI,KAAK,MAAM,KAAK,IAChB,MAAM,IAAI,MAAM;QACpB,OAAO,WAAW,IAAI,CAAC,6BAA6B,CAAC,CAAC,GAAG,QAAQ,gBAAgB,EAAE;IACvF;IACA,WAAW,MAAM,EAAE,IAAI,EAAE,WAAW,EAAE;QAClC,IAAI,CAAC,KAAK,cAAc,CAAC,IAAI,CAAC,OAAO,GACjC,MAAM,IAAI,MAAM;QACpB,IAAI,YAAY,MAAM,KAAK,IACvB,MAAM,IAAI,MAAM;QACpB,MAAM,SAAS,SAAS,MAAM,CAAC,IAAI,CAAC,aAAa;QACjD,IAAI,OAAO,MAAM,KAAK,IAClB,MAAM,IAAI,MAAM;QACpB,MAAM,gBAAgB,SAAS,MAAM,CAAC,IAAI,CAAC,CAAC,GAAG,OAAO,MAAM,EAAE;QAC9D,IAAI,CAAC,KAAK,WAAW,CAAC,CAAC,GAAG,QAAQ,KAAK,EAAE,IAAI,CAAC,aAAa,CAAC,kBACxD,MAAM,IAAI,MAAM;QACpB,MAAM,eAAe,CAAC,GAAG,QAAQ,gBAAgB,EAAE;QACnD,OAAO,QAAQ,OAAO,CAAC;YAAE,aAAa,EAAE;YAAE,SAAS;QAAa;IACpE;IACA,SAAS;QACL,OAAO,qBAAqB,GAAG;IACnC;IACA,UAAU;QACN,OAAO,qBAAqB,IAAI;IACpC;IACA,mBAAmB,MAAM,EAAE;QACvB,OAAO,CAAC,GAAG,QAAQ,gBAAgB,EAAE,QAAQ,QAAQ,CAAC;IAC1D;AACJ;AACA,QAAQ,oBAAoB,GAAG;AAC/B,qBAAqB,IAAI,GAAG,OAAO,aAAa,CAAC,IAAI;AACrD,qBAAqB,GAAG,GAAG;IAAE,WAAW;IAAG,OAAO;IAAU,OAAO;AAAE","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4911, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/swaps/handlers/claim/btc/IBitcoinClaimHandler.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.IBitcoinClaimHandler = void 0;\r\nconst base_1 = require(\"@atomiqlabs/base\");\r\nconst starknet_1 = require(\"starknet\");\r\nconst StarknetBtcRelay_1 = require(\"../../../../btcrelay/StarknetBtcRelay\");\r\nconst Utils_1 = require(\"../../../../../utils/Utils\");\r\nconst logger = (0, Utils_1.getLogger)(\"IBitcoinClaimHandler: \");\r\nclass IBitcoinClaimHandler {\r\n    constructor(address) {\r\n        this.address = address;\r\n    }\r\n    serializeCommitment(data) {\r\n        return [\r\n            data.confirmations,\r\n            data.btcRelay.contract.address\r\n        ];\r\n    }\r\n    getCommitment(data) {\r\n        return starknet_1.hash.computePoseidonHashOnElements(this.serializeCommitment(data));\r\n    }\r\n    async _getWitness(signer, swapData, { tx, btcRelay, commitedHeader, synchronizer, requiredConfirmations }, commitment, feeRate) {\r\n        const serializedData = this.serializeCommitment({\r\n            ...commitment,\r\n            btcRelay,\r\n            confirmations: requiredConfirmations\r\n        });\r\n        const commitmentHash = starknet_1.hash.computePoseidonHashOnElements(serializedData);\r\n        if (!swapData.isClaimData(commitmentHash))\r\n            throw new Error(\"Invalid commit data\");\r\n        const merkleProof = await btcRelay.bitcoinRpc.getMerkleProof(tx.txid, tx.blockhash);\r\n        logger.debug(\"getWitness(): merkle proof computed: \", merkleProof);\r\n        const txs = [];\r\n        if (commitedHeader == null) {\r\n            const headers = await StarknetBtcRelay_1.StarknetBtcRelay.getCommitedHeadersAndSynchronize(signer, btcRelay, [{ blockheight: tx.height, requiredConfirmations, blockhash: tx.blockhash }], txs, synchronizer, feeRate);\r\n            if (headers == null)\r\n                throw new Error(\"Cannot fetch committed header!\");\r\n            commitedHeader = headers[tx.blockhash];\r\n        }\r\n        serializedData.push(...commitedHeader.serialize());\r\n        serializedData.push(merkleProof.merkle.length, ...merkleProof.merkle.map(Utils_1.bufferToU32Array).flat());\r\n        serializedData.push(merkleProof.pos);\r\n        return { initialTxns: txs, witness: serializedData };\r\n    }\r\n    parseWitnessResult(result) {\r\n        return (0, Utils_1.u32ArrayToBuffer)(result).toString(\"hex\");\r\n    }\r\n}\r\nexports.IBitcoinClaimHandler = IBitcoinClaimHandler;\r\nIBitcoinClaimHandler.address = \"\";\r\nIBitcoinClaimHandler.type = base_1.ChainSwapType.CHAIN_TXID;\r\nIBitcoinClaimHandler.gas = { l1DataGas: 0, l2Gas: 10000 * 40000, l1Gas: 0 };\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,oBAAoB,GAAG,KAAK;AACpC,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM,SAAS,CAAC,GAAG,QAAQ,SAAS,EAAE;AACtC,MAAM;IACF,YAAY,OAAO,CAAE;QACjB,IAAI,CAAC,OAAO,GAAG;IACnB;IACA,oBAAoB,IAAI,EAAE;QACtB,OAAO;YACH,KAAK,aAAa;YAClB,KAAK,QAAQ,CAAC,QAAQ,CAAC,OAAO;SACjC;IACL;IACA,cAAc,IAAI,EAAE;QAChB,OAAO,WAAW,IAAI,CAAC,6BAA6B,CAAC,IAAI,CAAC,mBAAmB,CAAC;IAClF;IACA,MAAM,YAAY,MAAM,EAAE,QAAQ,EAAE,EAAE,EAAE,EAAE,QAAQ,EAAE,cAAc,EAAE,YAAY,EAAE,qBAAqB,EAAE,EAAE,UAAU,EAAE,OAAO,EAAE;QAC5H,MAAM,iBAAiB,IAAI,CAAC,mBAAmB,CAAC;YAC5C,GAAG,UAAU;YACb;YACA,eAAe;QACnB;QACA,MAAM,iBAAiB,WAAW,IAAI,CAAC,6BAA6B,CAAC;QACrE,IAAI,CAAC,SAAS,WAAW,CAAC,iBACtB,MAAM,IAAI,MAAM;QACpB,MAAM,cAAc,MAAM,SAAS,UAAU,CAAC,cAAc,CAAC,GAAG,IAAI,EAAE,GAAG,SAAS;QAClF,OAAO,KAAK,CAAC,yCAAyC;QACtD,MAAM,MAAM,EAAE;QACd,IAAI,kBAAkB,MAAM;YACxB,MAAM,UAAU,MAAM,mBAAmB,gBAAgB,CAAC,gCAAgC,CAAC,QAAQ,UAAU;gBAAC;oBAAE,aAAa,GAAG,MAAM;oBAAE;oBAAuB,WAAW,GAAG,SAAS;gBAAC;aAAE,EAAE,KAAK,cAAc;YAC9M,IAAI,WAAW,MACX,MAAM,IAAI,MAAM;YACpB,iBAAiB,OAAO,CAAC,GAAG,SAAS,CAAC;QAC1C;QACA,eAAe,IAAI,IAAI,eAAe,SAAS;QAC/C,eAAe,IAAI,CAAC,YAAY,MAAM,CAAC,MAAM,KAAK,YAAY,MAAM,CAAC,GAAG,CAAC,QAAQ,gBAAgB,EAAE,IAAI;QACvG,eAAe,IAAI,CAAC,YAAY,GAAG;QACnC,OAAO;YAAE,aAAa;YAAK,SAAS;QAAe;IACvD;IACA,mBAAmB,MAAM,EAAE;QACvB,OAAO,CAAC,GAAG,QAAQ,gBAAgB,EAAE,QAAQ,QAAQ,CAAC;IAC1D;AACJ;AACA,QAAQ,oBAAoB,GAAG;AAC/B,qBAAqB,OAAO,GAAG;AAC/B,qBAAqB,IAAI,GAAG,OAAO,aAAa,CAAC,UAAU;AAC3D,qBAAqB,GAAG,GAAG;IAAE,WAAW;IAAG,OAAO,QAAQ;IAAO,OAAO;AAAE","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4979, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/swaps/handlers/claim/btc/BitcoinTxIdClaimHandler.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BitcoinTxIdClaimHandler = void 0;\r\nconst base_1 = require(\"@atomiqlabs/base\");\r\nconst Utils_1 = require(\"../../../../../utils/Utils\");\r\nconst IBitcoinClaimHandler_1 = require(\"./IBitcoinClaimHandler\");\r\nconst buffer_1 = require(\"buffer\");\r\nconst logger = (0, Utils_1.getLogger)(\"BitcoinTxIdClaimHandler: \");\r\nclass BitcoinTxIdClaimHandler extends IBitcoinClaimHandler_1.IBitcoinClaimHandler {\r\n    serializeCommitment(data) {\r\n        return [\r\n            ...(0, Utils_1.bufferToU32Array)(buffer_1.Buffer.from(data.txId, \"hex\").reverse()),\r\n            ...super.serializeCommitment(data)\r\n        ];\r\n    }\r\n    getWitness(signer, swapData, witnessData, feeRate) {\r\n        if (!swapData.isClaimHandler(this.address))\r\n            throw new Error(\"Invalid claim handler\");\r\n        return this._getWitness(signer, swapData, witnessData, { txId: witnessData.tx.txid });\r\n    }\r\n    getGas(data) {\r\n        return BitcoinTxIdClaimHandler.gas;\r\n    }\r\n    getType() {\r\n        return BitcoinTxIdClaimHandler.type;\r\n    }\r\n}\r\nexports.BitcoinTxIdClaimHandler = BitcoinTxIdClaimHandler;\r\nBitcoinTxIdClaimHandler.type = base_1.ChainSwapType.CHAIN_TXID;\r\nBitcoinTxIdClaimHandler.gas = { l1DataGas: 0, l2Gas: 10000 * 40000, l1Gas: 0 };\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,uBAAuB,GAAG,KAAK;AACvC,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM,SAAS,CAAC,GAAG,QAAQ,SAAS,EAAE;AACtC,MAAM,gCAAgC,uBAAuB,oBAAoB;IAC7E,oBAAoB,IAAI,EAAE;QACtB,OAAO;eACA,CAAC,GAAG,QAAQ,gBAAgB,EAAE,SAAS,MAAM,CAAC,IAAI,CAAC,KAAK,IAAI,EAAE,OAAO,OAAO;eAC5E,KAAK,CAAC,oBAAoB;SAChC;IACL;IACA,WAAW,MAAM,EAAE,QAAQ,EAAE,WAAW,EAAE,OAAO,EAAE;QAC/C,IAAI,CAAC,SAAS,cAAc,CAAC,IAAI,CAAC,OAAO,GACrC,MAAM,IAAI,MAAM;QACpB,OAAO,IAAI,CAAC,WAAW,CAAC,QAAQ,UAAU,aAAa;YAAE,MAAM,YAAY,EAAE,CAAC,IAAI;QAAC;IACvF;IACA,OAAO,IAAI,EAAE;QACT,OAAO,wBAAwB,GAAG;IACtC;IACA,UAAU;QACN,OAAO,wBAAwB,IAAI;IACvC;AACJ;AACA,QAAQ,uBAAuB,GAAG;AAClC,wBAAwB,IAAI,GAAG,OAAO,aAAa,CAAC,UAAU;AAC9D,wBAAwB,GAAG,GAAG;IAAE,WAAW;IAAG,OAAO,QAAQ;IAAO,OAAO;AAAE","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5019, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/swaps/handlers/claim/btc/BitcoinOutputClaimHandler.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BitcoinOutputClaimHandler = void 0;\r\nconst base_1 = require(\"@atomiqlabs/base\");\r\nconst starknet_1 = require(\"starknet\");\r\nconst Utils_1 = require(\"../../../../../utils/Utils\");\r\nconst IBitcoinClaimHandler_1 = require(\"./IBitcoinClaimHandler\");\r\nconst btc_signer_1 = require(\"@scure/btc-signer\");\r\nconst buffer_1 = require(\"buffer\");\r\nconst logger = (0, Utils_1.getLogger)(\"BitcoinOutputClaimHandler: \");\r\nclass BitcoinOutputClaimHandler extends IBitcoinClaimHandler_1.IBitcoinClaimHandler {\r\n    serializeCommitment(data) {\r\n        return [\r\n            starknet_1.hash.computePoseidonHashOnElements([(0, Utils_1.toBigInt)(data.amount), (0, Utils_1.poseidonHashRange)(data.output)]),\r\n            ...super.serializeCommitment(data)\r\n        ];\r\n    }\r\n    async getWitness(signer, swapData, witnessData, feeRate) {\r\n        if (!swapData.isClaimHandler(this.address))\r\n            throw new Error(\"Invalid claim handler\");\r\n        const parsedBtcTx = btc_signer_1.Transaction.fromRaw(buffer_1.Buffer.from(witnessData.tx.hex, \"hex\"));\r\n        const out = parsedBtcTx.getOutput(witnessData.vout);\r\n        const { initialTxns, witness } = await this._getWitness(signer, swapData, witnessData, {\r\n            output: buffer_1.Buffer.from(out.script),\r\n            amount: out.amount\r\n        });\r\n        witness.push(...(0, Utils_1.bufferToByteArray)(buffer_1.Buffer.from(witnessData.tx.hex, \"hex\")));\r\n        witness.push(BigInt(witnessData.vout));\r\n        return { initialTxns, witness };\r\n    }\r\n    getGas(data) {\r\n        return BitcoinOutputClaimHandler.gas;\r\n    }\r\n    getType() {\r\n        return BitcoinOutputClaimHandler.type;\r\n    }\r\n}\r\nexports.BitcoinOutputClaimHandler = BitcoinOutputClaimHandler;\r\nBitcoinOutputClaimHandler.type = base_1.ChainSwapType.CHAIN;\r\nBitcoinOutputClaimHandler.gas = { l1DataGas: 0, l2Gas: 10000 * 40000, l1Gas: 0 };\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,yBAAyB,GAAG,KAAK;AACzC,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM,SAAS,CAAC,GAAG,QAAQ,SAAS,EAAE;AACtC,MAAM,kCAAkC,uBAAuB,oBAAoB;IAC/E,oBAAoB,IAAI,EAAE;QACtB,OAAO;YACH,WAAW,IAAI,CAAC,6BAA6B,CAAC;gBAAC,CAAC,GAAG,QAAQ,QAAQ,EAAE,KAAK,MAAM;gBAAG,CAAC,GAAG,QAAQ,iBAAiB,EAAE,KAAK,MAAM;aAAE;eAC5H,KAAK,CAAC,oBAAoB;SAChC;IACL;IACA,MAAM,WAAW,MAAM,EAAE,QAAQ,EAAE,WAAW,EAAE,OAAO,EAAE;QACrD,IAAI,CAAC,SAAS,cAAc,CAAC,IAAI,CAAC,OAAO,GACrC,MAAM,IAAI,MAAM;QACpB,MAAM,cAAc,aAAa,WAAW,CAAC,OAAO,CAAC,SAAS,MAAM,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC,GAAG,EAAE;QAC9F,MAAM,MAAM,YAAY,SAAS,CAAC,YAAY,IAAI;QAClD,MAAM,EAAE,WAAW,EAAE,OAAO,EAAE,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,QAAQ,UAAU,aAAa;YACnF,QAAQ,SAAS,MAAM,CAAC,IAAI,CAAC,IAAI,MAAM;YACvC,QAAQ,IAAI,MAAM;QACtB;QACA,QAAQ,IAAI,IAAI,CAAC,GAAG,QAAQ,iBAAiB,EAAE,SAAS,MAAM,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC,GAAG,EAAE;QACxF,QAAQ,IAAI,CAAC,OAAO,YAAY,IAAI;QACpC,OAAO;YAAE;YAAa;QAAQ;IAClC;IACA,OAAO,IAAI,EAAE;QACT,OAAO,0BAA0B,GAAG;IACxC;IACA,UAAU;QACN,OAAO,0BAA0B,IAAI;IACzC;AACJ;AACA,QAAQ,yBAAyB,GAAG;AACpC,0BAA0B,IAAI,GAAG,OAAO,aAAa,CAAC,KAAK;AAC3D,0BAA0B,GAAG,GAAG;IAAE,WAAW;IAAG,OAAO,QAAQ;IAAO,OAAO;AAAE","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5073, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/swaps/handlers/claim/btc/BitcoinNoncedOutputClaimHandler.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BitcoinNoncedOutputClaimHandler = void 0;\r\nconst base_1 = require(\"@atomiqlabs/base\");\r\nconst starknet_1 = require(\"starknet\");\r\nconst Utils_1 = require(\"../../../../../utils/Utils\");\r\nconst IBitcoinClaimHandler_1 = require(\"./IBitcoinClaimHandler\");\r\nconst btc_signer_1 = require(\"@scure/btc-signer\");\r\nconst buffer_1 = require(\"buffer\");\r\nconst logger = (0, Utils_1.getLogger)(\"BitcoinNoncedOutputClaimHandler: \");\r\nfunction getTransactionNonce(btcTx) {\r\n    const locktimeSub500M = BigInt(btcTx.lockTime - 500000000);\r\n    if (locktimeSub500M < 0n)\r\n        throw new Error(\"Locktime too low!\");\r\n    const nSequence = BigInt(btcTx.getInput(0).sequence);\r\n    return (locktimeSub500M << 24n) | (nSequence & 0x00ffffffn);\r\n}\r\nclass BitcoinNoncedOutputClaimHandler extends IBitcoinClaimHandler_1.IBitcoinClaimHandler {\r\n    serializeCommitment(data) {\r\n        return [\r\n            starknet_1.hash.computePoseidonHashOnElements([(0, Utils_1.toBigInt)(data.nonce), (0, Utils_1.toBigInt)(data.amount), (0, Utils_1.poseidonHashRange)(data.output)]),\r\n            ...super.serializeCommitment(data)\r\n        ];\r\n    }\r\n    async getWitness(signer, swapData, witnessData, feeRate) {\r\n        if (!swapData.isClaimHandler(this.address))\r\n            throw new Error(\"Invalid claim handler\");\r\n        const parsedBtcTx = btc_signer_1.Transaction.fromRaw(buffer_1.Buffer.from(witnessData.tx.hex, \"hex\"));\r\n        const out = parsedBtcTx.getOutput(witnessData.vout);\r\n        const { initialTxns, witness } = await this._getWitness(signer, swapData, witnessData, {\r\n            output: buffer_1.Buffer.from(out.script),\r\n            amount: out.amount,\r\n            nonce: getTransactionNonce(parsedBtcTx)\r\n        });\r\n        witness.push(...(0, Utils_1.bufferToByteArray)(buffer_1.Buffer.from(witnessData.tx.hex, \"hex\")));\r\n        witness.push(BigInt(witnessData.vout));\r\n        return { initialTxns, witness };\r\n    }\r\n    getGas(data) {\r\n        return BitcoinNoncedOutputClaimHandler.gas;\r\n    }\r\n    getType() {\r\n        return BitcoinNoncedOutputClaimHandler.type;\r\n    }\r\n}\r\nexports.BitcoinNoncedOutputClaimHandler = BitcoinNoncedOutputClaimHandler;\r\nBitcoinNoncedOutputClaimHandler.type = base_1.ChainSwapType.CHAIN_NONCED;\r\nBitcoinNoncedOutputClaimHandler.gas = { l1DataGas: 0, l2Gas: 10000 * 40000, l1Gas: 0 };\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,+BAA+B,GAAG,KAAK;AAC/C,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM,SAAS,CAAC,GAAG,QAAQ,SAAS,EAAE;AACtC,SAAS,oBAAoB,KAAK;IAC9B,MAAM,kBAAkB,OAAO,MAAM,QAAQ,GAAG;IAChD,IAAI,kBAAkB,EAAE,EACpB,MAAM,IAAI,MAAM;IACpB,MAAM,YAAY,OAAO,MAAM,QAAQ,CAAC,GAAG,QAAQ;IACnD,OAAO,AAAC,mBAAmB,GAAG,GAAK,YAAY,WAAW;AAC9D;AACA,MAAM,wCAAwC,uBAAuB,oBAAoB;IACrF,oBAAoB,IAAI,EAAE;QACtB,OAAO;YACH,WAAW,IAAI,CAAC,6BAA6B,CAAC;gBAAC,CAAC,GAAG,QAAQ,QAAQ,EAAE,KAAK,KAAK;gBAAG,CAAC,GAAG,QAAQ,QAAQ,EAAE,KAAK,MAAM;gBAAG,CAAC,GAAG,QAAQ,iBAAiB,EAAE,KAAK,MAAM;aAAE;eAC/J,KAAK,CAAC,oBAAoB;SAChC;IACL;IACA,MAAM,WAAW,MAAM,EAAE,QAAQ,EAAE,WAAW,EAAE,OAAO,EAAE;QACrD,IAAI,CAAC,SAAS,cAAc,CAAC,IAAI,CAAC,OAAO,GACrC,MAAM,IAAI,MAAM;QACpB,MAAM,cAAc,aAAa,WAAW,CAAC,OAAO,CAAC,SAAS,MAAM,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC,GAAG,EAAE;QAC9F,MAAM,MAAM,YAAY,SAAS,CAAC,YAAY,IAAI;QAClD,MAAM,EAAE,WAAW,EAAE,OAAO,EAAE,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,QAAQ,UAAU,aAAa;YACnF,QAAQ,SAAS,MAAM,CAAC,IAAI,CAAC,IAAI,MAAM;YACvC,QAAQ,IAAI,MAAM;YAClB,OAAO,oBAAoB;QAC/B;QACA,QAAQ,IAAI,IAAI,CAAC,GAAG,QAAQ,iBAAiB,EAAE,SAAS,MAAM,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC,GAAG,EAAE;QACxF,QAAQ,IAAI,CAAC,OAAO,YAAY,IAAI;QACpC,OAAO;YAAE;YAAa;QAAQ;IAClC;IACA,OAAO,IAAI,EAAE;QACT,OAAO,gCAAgC,GAAG;IAC9C;IACA,UAAU;QACN,OAAO,gCAAgC,IAAI;IAC/C;AACJ;AACA,QAAQ,+BAA+B,GAAG;AAC1C,gCAAgC,IAAI,GAAG,OAAO,aAAa,CAAC,YAAY;AACxE,gCAAgC,GAAG,GAAG;IAAE,WAAW;IAAG,OAAO,QAAQ;IAAO,OAAO;AAAE","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5135, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/swaps/handlers/claim/ClaimHandlers.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.claimHandlersList = void 0;\r\nconst HashlockClaimHandler_1 = require(\"./HashlockClaimHandler\");\r\nconst BitcoinTxIdClaimHandler_1 = require(\"./btc/BitcoinTxIdClaimHandler\");\r\nconst BitcoinOutputClaimHandler_1 = require(\"./btc/BitcoinOutputClaimHandler\");\r\nconst BitcoinNoncedOutputClaimHandler_1 = require(\"./btc/BitcoinNoncedOutputClaimHandler\");\r\nexports.claimHandlersList = [\r\n    HashlockClaimHandler_1.HashlockClaimHandler,\r\n    BitcoinTxIdClaimHandler_1.BitcoinTxIdClaimHandler,\r\n    BitcoinOutputClaimHandler_1.BitcoinOutputClaimHandler,\r\n    BitcoinNoncedOutputClaimHandler_1.BitcoinNoncedOutputClaimHandler\r\n];\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,iBAAiB,GAAG,KAAK;AACjC,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,QAAQ,iBAAiB,GAAG;IACxB,uBAAuB,oBAAoB;IAC3C,0BAA0B,uBAAuB;IACjD,4BAA4B,yBAAyB;IACrD,kCAAkC,+BAA+B;CACpE","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5153, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/swaps/modules/StarknetSwapClaim.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetSwapClaim = void 0;\r\nconst base_1 = require(\"@atomiqlabs/base\");\r\nconst Utils_1 = require(\"../../../utils/Utils\");\r\nconst StarknetSwapModule_1 = require(\"../StarknetSwapModule\");\r\nconst StarknetAction_1 = require(\"../../chain/StarknetAction\");\r\nconst StarknetFees_1 = require(\"../../chain/modules/StarknetFees\");\r\nclass StarknetSwapClaim extends StarknetSwapModule_1.StarknetSwapModule {\r\n    /**\r\n     * Claim action which uses the provided witness for claiming the swap\r\n     *\r\n     * @param signer\r\n     * @param swapData\r\n     * @param witness\r\n     * @param claimHandlerGas\r\n     * @constructor\r\n     * @private\r\n     */\r\n    Claim(signer, swapData, witness, claimHandlerGas) {\r\n        return new StarknetAction_1.StarknetAction(signer, this.root, this.swapContract.populateTransaction.claim(swapData.toEscrowStruct(), witness), (0, StarknetFees_1.starknetGasAdd)(swapData.payOut ? StarknetSwapClaim.GasCosts.CLAIM_PAY_OUT : StarknetSwapClaim.GasCosts.CLAIM, claimHandlerGas));\r\n    }\r\n    /**\r\n     * Creates transactions claiming the swap using a secret (for HTLC swaps)\r\n     *\r\n     * @param signer\r\n     * @param swapData swap to claim\r\n     * @param secret hex encoded secret pre-image to the HTLC hash\r\n     * @param checkExpiry whether to check if the swap is already expired (trying to claim an expired swap with a secret\r\n     *  is dangerous because we might end up revealing the secret to the counterparty without being able to claim the swap)\r\n     * @param feeRate fee rate to use for the transaction\r\n     */\r\n    async txsClaimWithSecret(signer, swapData, secret, checkExpiry, feeRate) {\r\n        //We need to be sure that this transaction confirms in time, otherwise we reveal the secret to the counterparty\r\n        // and won't claim the funds\r\n        if (checkExpiry && await this.contract.isExpired(swapData.claimer.toString(), swapData)) {\r\n            throw new base_1.SwapDataVerificationError(\"Not enough time to reliably pay the invoice\");\r\n        }\r\n        const claimHandler = this.contract.claimHandlersByAddress[(0, Utils_1.toHex)(swapData.claimHandler)];\r\n        if (claimHandler == null)\r\n            throw new base_1.SwapDataVerificationError(\"Unknown claim handler!\");\r\n        if (claimHandler.getType() !== base_1.ChainSwapType.HTLC)\r\n            throw new base_1.SwapDataVerificationError(\"Invalid claim handler!\");\r\n        feeRate ?? (feeRate = await this.root.Fees.getFeeRate());\r\n        const { initialTxns, witness } = await claimHandler.getWitness(signer, swapData, secret, feeRate);\r\n        const action = this.Claim(signer, swapData, witness, claimHandler.getGas(swapData));\r\n        await action.addToTxs(initialTxns, feeRate);\r\n        this.logger.debug(\"txsClaimWithSecret(): creating claim transaction, swap: \" + swapData.getClaimHash() + \" witness: \", witness.map(Utils_1.toHex));\r\n        return initialTxns;\r\n    }\r\n    /**\r\n     * Creates transaction claiming the swap using a confirmed transaction data (for BTC on-chain swaps)\r\n     *\r\n     * @param signer\r\n     * @param swapData swap to claim\r\n     * @param tx bitcoin transaction that satisfies the swap condition\r\n     * @param requiredConfirmations\r\n     * @param vout vout of the bitcoin transaction that satisfies the swap condition\r\n     * @param commitedHeader commited header data from btc relay (fetched internally if null)\r\n     * @param synchronizer optional synchronizer to use in case we need to sync up the btc relay ourselves\r\n     * @param feeRate fee rate to be used for the transactions\r\n     */\r\n    async txsClaimWithTxData(signer, swapData, tx, requiredConfirmations, vout, commitedHeader, synchronizer, feeRate) {\r\n        const claimHandler = this.contract.claimHandlersByAddress[(0, Utils_1.toHex)(swapData.claimHandler)];\r\n        if (claimHandler == null)\r\n            throw new base_1.SwapDataVerificationError(\"Unknown claim handler!\");\r\n        if (claimHandler.getType() !== base_1.ChainSwapType.CHAIN_NONCED &&\r\n            claimHandler.getType() !== base_1.ChainSwapType.CHAIN_TXID &&\r\n            claimHandler.getType() !== base_1.ChainSwapType.CHAIN)\r\n            throw new base_1.SwapDataVerificationError(\"Invalid claim handler!\");\r\n        feeRate ?? (feeRate = await this.root.Fees.getFeeRate());\r\n        const { initialTxns, witness } = await claimHandler.getWitness(signer, swapData, {\r\n            tx,\r\n            vout,\r\n            requiredConfirmations,\r\n            commitedHeader,\r\n            btcRelay: this.contract.btcRelay,\r\n            synchronizer,\r\n        }, feeRate);\r\n        const action = this.Claim(signer, swapData, witness, claimHandler.getGas(swapData));\r\n        await action.addToTxs(initialTxns, feeRate);\r\n        return initialTxns;\r\n    }\r\n    /**\r\n     * Get the estimated starknet transaction fee of the claim transaction\r\n     */\r\n    async getClaimFee(swapData, feeRate) {\r\n        feeRate ?? (feeRate = await this.root.Fees.getFeeRate());\r\n        let gasRequired = swapData.payOut ? StarknetSwapClaim.GasCosts.CLAIM_PAY_OUT : StarknetSwapClaim.GasCosts.CLAIM;\r\n        const claimHandler = this.contract.claimHandlersByAddress[(0, Utils_1.toHex)(swapData.claimHandler)];\r\n        if (claimHandler != null)\r\n            gasRequired = (0, StarknetFees_1.starknetGasAdd)(gasRequired, claimHandler.getGas(swapData));\r\n        return StarknetFees_1.StarknetFees.getGasFee(gasRequired, feeRate);\r\n    }\r\n}\r\nexports.StarknetSwapClaim = StarknetSwapClaim;\r\nStarknetSwapClaim.GasCosts = {\r\n    CLAIM: { l1DataGas: 750, l2Gas: 4000000, l1Gas: 0 },\r\n    CLAIM_PAY_OUT: { l1DataGas: 900, l2Gas: 6000000, l1Gas: 0 }\r\n};\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5255, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/swaps/StarknetSwapContract.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetSwapContract = void 0;\r\nconst base_1 = require(\"@atomiqlabs/base\");\r\nconst buffer_1 = require(\"buffer\");\r\nconst EscrowManagerAbi_1 = require(\"./EscrowManagerAbi\");\r\nconst StarknetContractBase_1 = require(\"../contract/StarknetContractBase\");\r\nconst starknet_1 = require(\"starknet\");\r\nconst StarknetSwapData_1 = require(\"./StarknetSwapData\");\r\nconst Utils_1 = require(\"../../utils/Utils\");\r\nconst TimelockRefundHandler_1 = require(\"./handlers/refund/TimelockRefundHandler\");\r\nconst StarknetLpVault_1 = require(\"./modules/StarknetLpVault\");\r\nconst StarknetSwapInit_1 = require(\"./modules/StarknetSwapInit\");\r\nconst StarknetSwapRefund_1 = require(\"./modules/StarknetSwapRefund\");\r\nconst ClaimHandlers_1 = require(\"./handlers/claim/ClaimHandlers\");\r\nconst StarknetSwapClaim_1 = require(\"./modules/StarknetSwapClaim\");\r\nconst sha2_1 = require(\"@noble/hashes/sha2\");\r\nconst ESCROW_STATE_COMMITTED = 1;\r\nconst ESCROW_STATE_CLAIMED = 2;\r\nconst ESCROW_STATE_REFUNDED = 3;\r\nconst swapContractAddreses = {\r\n    [starknet_1.constants.StarknetChainId.SN_SEPOLIA]: \"0x017bf50dd28b6d823a231355bb25813d4396c8e19d2df03026038714a22f0413\",\r\n    [starknet_1.constants.StarknetChainId.SN_MAIN]: \"0x04f278e1f19e495c3b1dd35ef307c4f7510768ed95481958fbae588bd173f79a\"\r\n};\r\nconst defaultClaimAddresses = {\r\n    [starknet_1.constants.StarknetChainId.SN_SEPOLIA]: {\r\n        [base_1.ChainSwapType.HTLC]: \"0x04a57ea54d4637c352aad1bbee046868926a11702216a0aaf7eeec1568be2d7b\",\r\n        [base_1.ChainSwapType.CHAIN_TXID]: \"0x04c7cde88359e14b6f6f779f8b9d8310cee37e91a6f143f855ae29fab33c396e\",\r\n        [base_1.ChainSwapType.CHAIN]: \"0x051bef6f5fd12e2832a7d38653bdfc8eb84ba7eb7a4aada5b87ef38a9999cf17\",\r\n        [base_1.ChainSwapType.CHAIN_NONCED]: \"0x050e50eacd16da414f2c3a7c3570fd5e248974c6fe757d41acbf72d2836fa0a1\"\r\n    },\r\n    [starknet_1.constants.StarknetChainId.SN_MAIN]: {\r\n        [base_1.ChainSwapType.HTLC]: \"0x07b74b50a883ebee262b6db0e3c0c697670c6f30e3d610e75faf33a89c46aa2a\",\r\n        [base_1.ChainSwapType.CHAIN_TXID]: \"0x016c2db2b03f39cf4fd7f871035000f66b62307d9983056e33a38315da8a44dc\",\r\n        [base_1.ChainSwapType.CHAIN]: \"0x02c45a81c4a48d0645a0a199e620061e8a55dcc9c2b5946d050eaeeddba64e9a\",\r\n        [base_1.ChainSwapType.CHAIN_NONCED]: \"0x0019b5480dd7ed8ded10a09437b0a7a30b8997b4ef139deb24ff8c86f995d84f\"\r\n    }\r\n};\r\nconst defaultRefundAddresses = {\r\n    [starknet_1.constants.StarknetChainId.SN_SEPOLIA]: {\r\n        timelock: \"0x034b8f28b3ca979036cb2849cfa3af7f67207459224b6ca5ce2474aa398ec3e7\"\r\n    },\r\n    [starknet_1.constants.StarknetChainId.SN_MAIN]: {\r\n        timelock: \"0x06a59659990c2aefbf7239f6d911617b3ae60b79cb3364f3bd242a6ca8f4f4f7\"\r\n    }\r\n};\r\nclass StarknetSwapContract extends StarknetContractBase_1.StarknetContractBase {\r\n    constructor(chainInterface, btcRelay, contractAddress = swapContractAddreses[chainInterface.starknetChainId], handlerAddresses) {\r\n        super(chainInterface, contractAddress, EscrowManagerAbi_1.EscrowManagerAbi);\r\n        ////////////////////////\r\n        //// Constants\r\n        this.chainId = \"STARKNET\";\r\n        ////////////////////////\r\n        //// Timeouts\r\n        this.claimWithSecretTimeout = 180;\r\n        this.claimWithTxDataTimeout = 180;\r\n        this.refundTimeout = 180;\r\n        this.claimGracePeriod = 10 * 60;\r\n        this.refundGracePeriod = 10 * 60;\r\n        this.authGracePeriod = 30;\r\n        ////////////////////////\r\n        //// Handlers\r\n        this.claimHandlersByAddress = {};\r\n        this.claimHandlersBySwapType = {};\r\n        this.refundHandlersByAddress = {};\r\n        this.Init = new StarknetSwapInit_1.StarknetSwapInit(chainInterface, this);\r\n        this.Refund = new StarknetSwapRefund_1.StarknetSwapRefund(chainInterface, this);\r\n        this.Claim = new StarknetSwapClaim_1.StarknetSwapClaim(chainInterface, this);\r\n        this.LpVault = new StarknetLpVault_1.StarknetLpVault(chainInterface, this);\r\n        this.btcRelay = btcRelay;\r\n        handlerAddresses ?? (handlerAddresses = {});\r\n        handlerAddresses.refund ?? (handlerAddresses.refund = {});\r\n        handlerAddresses.refund = { ...defaultRefundAddresses[chainInterface.starknetChainId], ...handlerAddresses.refund };\r\n        handlerAddresses.claim ?? (handlerAddresses.claim = {});\r\n        handlerAddresses.claim = { ...defaultClaimAddresses[chainInterface.starknetChainId], ...handlerAddresses.claim };\r\n        ClaimHandlers_1.claimHandlersList.forEach(handlerCtor => {\r\n            const handler = new handlerCtor(handlerAddresses.claim[handlerCtor.type]);\r\n            this.claimHandlersByAddress[(0, Utils_1.toHex)(handler.address)] = handler;\r\n            this.claimHandlersBySwapType[handlerCtor.type] = handler;\r\n        });\r\n        this.timelockRefundHandler = new TimelockRefundHandler_1.TimelockRefundHandler(handlerAddresses.refund.timelock);\r\n        this.refundHandlersByAddress[this.timelockRefundHandler.address] = this.timelockRefundHandler;\r\n    }\r\n    async start() {\r\n    }\r\n    ////////////////////////////////////////////\r\n    //// Signatures\r\n    preFetchForInitSignatureVerification() {\r\n        return this.Init.preFetchForInitSignatureVerification();\r\n    }\r\n    getInitSignature(signer, swapData, authorizationTimeout, preFetchedBlockData, feeRate) {\r\n        return this.Init.signSwapInitialization(signer, swapData, authorizationTimeout);\r\n    }\r\n    isValidInitAuthorization(sender, swapData, { timeout, prefix, signature }, feeRate, preFetchedData) {\r\n        return this.Init.isSignatureValid(sender, swapData, timeout, prefix, signature, preFetchedData);\r\n    }\r\n    getInitAuthorizationExpiry(swapData, { timeout, prefix, signature }, preFetchedData) {\r\n        return this.Init.getSignatureExpiry(timeout);\r\n    }\r\n    isInitAuthorizationExpired(swapData, { timeout, prefix, signature }) {\r\n        return this.Init.isSignatureExpired(timeout);\r\n    }\r\n    getRefundSignature(signer, swapData, authorizationTimeout) {\r\n        return this.Refund.signSwapRefund(signer, swapData, authorizationTimeout);\r\n    }\r\n    isValidRefundAuthorization(swapData, { timeout, prefix, signature }) {\r\n        return this.Refund.isSignatureValid(swapData, timeout, prefix, signature);\r\n    }\r\n    getDataSignature(signer, data) {\r\n        return this.Chain.Signatures.getDataSignature(signer, data);\r\n    }\r\n    isValidDataSignature(data, signature, publicKey) {\r\n        return this.Chain.Signatures.isValidDataSignature(data, signature, publicKey);\r\n    }\r\n    ////////////////////////////////////////////\r\n    //// Swap data utils\r\n    /**\r\n     * Checks whether the claim is claimable by us, that means not expired, we are claimer & the swap is commited\r\n     *\r\n     * @param signer\r\n     * @param data\r\n     */\r\n    async isClaimable(signer, data) {\r\n        if (!data.isClaimer(signer))\r\n            return false;\r\n        if (await this.isExpired(signer, data))\r\n            return false;\r\n        return await this.isCommited(data);\r\n    }\r\n    /**\r\n     * Checks whether a swap is commited, i.e. the swap still exists on-chain and was not claimed nor refunded\r\n     *\r\n     * @param swapData\r\n     */\r\n    async isCommited(swapData) {\r\n        const data = await this.contract.get_hash_state(\"0x\" + swapData.getEscrowHash());\r\n        return Number(data.state) === ESCROW_STATE_COMMITTED;\r\n    }\r\n    /**\r\n     * Checks whether the swap is expired, takes into consideration possible on-chain time skew, therefore for claimer\r\n     *  the swap expires a bit sooner than it should've & for the offerer it expires a bit later\r\n     *\r\n     * @param signer\r\n     * @param data\r\n     */\r\n    isExpired(signer, data) {\r\n        let currentTimestamp = BigInt(Math.floor(Date.now() / 1000));\r\n        if (data.isClaimer(signer))\r\n            currentTimestamp = currentTimestamp + BigInt(this.claimGracePeriod);\r\n        if (data.isOfferer(signer))\r\n            currentTimestamp = currentTimestamp - BigInt(this.refundGracePeriod);\r\n        return Promise.resolve(data.getExpiry() < currentTimestamp);\r\n    }\r\n    /**\r\n     * Checks if the swap is refundable by us, checks if we are offerer, if the swap is already expired & if the swap\r\n     *  is still commited\r\n     *\r\n     * @param signer\r\n     * @param data\r\n     */\r\n    async isRequestRefundable(signer, data) {\r\n        //Swap can only be refunded by the offerer\r\n        if (!data.isOfferer(signer))\r\n            return false;\r\n        if (!(await this.isExpired(signer, data)))\r\n            return false;\r\n        return await this.isCommited(data);\r\n    }\r\n    getHashForTxId(txId, confirmations) {\r\n        return (0, Utils_1.bigNumberishToBuffer)(this.claimHandlersBySwapType[base_1.ChainSwapType.CHAIN_TXID].getCommitment({\r\n            txId,\r\n            confirmations,\r\n            btcRelay: this.btcRelay\r\n        }), 32);\r\n    }\r\n    /**\r\n     * Get the swap payment hash to be used for an on-chain swap, uses poseidon hash of the value\r\n     *\r\n     * @param outputScript output script required to claim the swap\r\n     * @param amount sats sent required to claim the swap\r\n     * @param confirmations\r\n     * @param nonce swap nonce uniquely identifying the transaction to prevent replay attacks\r\n     */\r\n    getHashForOnchain(outputScript, amount, confirmations, nonce) {\r\n        let result;\r\n        if (nonce == null || nonce === 0n) {\r\n            result = this.claimHandlersBySwapType[base_1.ChainSwapType.CHAIN].getCommitment({\r\n                output: outputScript,\r\n                amount,\r\n                confirmations,\r\n                btcRelay: this.btcRelay\r\n            });\r\n        }\r\n        else {\r\n            result = this.claimHandlersBySwapType[base_1.ChainSwapType.CHAIN_NONCED].getCommitment({\r\n                output: outputScript,\r\n                amount,\r\n                nonce,\r\n                confirmations,\r\n                btcRelay: this.btcRelay\r\n            });\r\n        }\r\n        return (0, Utils_1.bigNumberishToBuffer)(result, 32);\r\n    }\r\n    /**\r\n     * Get the swap payment hash to be used for a lightning htlc swap, uses poseidon hash of the sha256 hash of the preimage\r\n     *\r\n     * @param paymentHash payment hash of the HTLC\r\n     */\r\n    getHashForHtlc(paymentHash) {\r\n        return (0, Utils_1.bigNumberishToBuffer)(this.claimHandlersBySwapType[base_1.ChainSwapType.HTLC].getCommitment(paymentHash), 32);\r\n    }\r\n    getExtraData(outputScript, amount, confirmations, nonce) {\r\n        if (nonce == null)\r\n            nonce = 0n;\r\n        const txoHash = buffer_1.Buffer.from((0, sha2_1.sha256)(buffer_1.Buffer.concat([\r\n            base_1.BigIntBufferUtils.toBuffer(amount, \"le\", 8),\r\n            outputScript\r\n        ])));\r\n        return buffer_1.Buffer.concat([\r\n            txoHash,\r\n            base_1.BigIntBufferUtils.toBuffer(nonce, \"be\", 8),\r\n            base_1.BigIntBufferUtils.toBuffer(BigInt(confirmations), \"be\", 2)\r\n        ]);\r\n    }\r\n    ////////////////////////////////////////////\r\n    //// Swap data getters\r\n    /**\r\n     * Gets the status of the specific swap, this also checks if we are offerer/claimer & checks for expiry (to see\r\n     *  if swap is refundable)\r\n     *\r\n     * @param signer\r\n     * @param data\r\n     */\r\n    async getCommitStatus(signer, data) {\r\n        const escrowHash = data.getEscrowHash();\r\n        const stateData = await this.contract.get_hash_state(\"0x\" + escrowHash);\r\n        const state = Number(stateData.state);\r\n        const blockHeight = Number(stateData.finish_blockheight);\r\n        switch (state) {\r\n            case ESCROW_STATE_COMMITTED:\r\n                if (data.isOfferer(signer) && await this.isExpired(signer, data))\r\n                    return { type: base_1.SwapCommitStateType.REFUNDABLE };\r\n                return { type: base_1.SwapCommitStateType.COMMITED };\r\n            case ESCROW_STATE_CLAIMED:\r\n                return {\r\n                    type: base_1.SwapCommitStateType.PAID,\r\n                    getTxBlock: async () => {\r\n                        return {\r\n                            blockTime: await this.Chain.Blocks.getBlockTime(blockHeight),\r\n                            blockHeight: blockHeight\r\n                        };\r\n                    },\r\n                    getClaimTxId: async () => {\r\n                        const events = await this.Events.getContractBlockEvents([\"escrow_manager::events::Claim\"], [null, null, null, \"0x\" + escrowHash], blockHeight, blockHeight);\r\n                        return events.length === 0 ? null : events[0].txHash;\r\n                    },\r\n                    getClaimResult: async () => {\r\n                        const events = await this.Events.getContractBlockEvents([\"escrow_manager::events::Claim\"], [null, null, null, \"0x\" + escrowHash], blockHeight, blockHeight);\r\n                        if (events.length === 0)\r\n                            return null;\r\n                        const event = events[0];\r\n                        const claimHandlerHex = (0, Utils_1.toHex)(event.params.claim_handler);\r\n                        const claimHandler = this.claimHandlersByAddress[claimHandlerHex];\r\n                        if (claimHandler == null) {\r\n                            starknet_1.logger.warn(\"getCommitStatus(): getClaimResult(\" + escrowHash + \"): Unknown claim handler with claim: \" + claimHandlerHex);\r\n                            return null;\r\n                        }\r\n                        const witnessResult = claimHandler.parseWitnessResult(event.params.witness_result);\r\n                        return witnessResult;\r\n                    }\r\n                };\r\n            default:\r\n                return {\r\n                    type: await this.isExpired(signer, data) ? base_1.SwapCommitStateType.EXPIRED : base_1.SwapCommitStateType.NOT_COMMITED,\r\n                    getTxBlock: async () => {\r\n                        return {\r\n                            blockTime: await this.Chain.Blocks.getBlockTime(blockHeight),\r\n                            blockHeight: blockHeight\r\n                        };\r\n                    },\r\n                    getClaimTxId: async () => {\r\n                        const events = await this.Events.getContractBlockEvents([\"escrow_manager::events::Refund\"], [null, null, null, \"0x\" + escrowHash], blockHeight, blockHeight);\r\n                        return events.length === 0 ? null : events[0].txHash;\r\n                    }\r\n                };\r\n        }\r\n    }\r\n    /**\r\n     * Returns the data committed for a specific payment hash, or null if no data is currently commited for\r\n     *  the specific swap\r\n     *\r\n     * @param paymentHashHex\r\n     */\r\n    async getCommitedData(paymentHashHex) {\r\n        //TODO: Noop\r\n        return null;\r\n    }\r\n    ////////////////////////////////////////////\r\n    //// Swap data initializer\r\n    createSwapData(type, offerer, claimer, token, amount, paymentHash, sequence, expiry, payIn, payOut, securityDeposit, claimerBounty, depositToken = this.Chain.Tokens.getNativeCurrencyAddress()) {\r\n        return Promise.resolve(new StarknetSwapData_1.StarknetSwapData(offerer, claimer, token, this.timelockRefundHandler.address, this.claimHandlersBySwapType?.[type]?.address, payOut, payIn, payIn, //For now track reputation for all payIn swaps\r\n        sequence, \"0x\" + paymentHash, (0, Utils_1.toHex)(expiry), amount, depositToken, securityDeposit, claimerBounty, type, null));\r\n    }\r\n    ////////////////////////////////////////////\r\n    //// Utils\r\n    async getBalance(signer, tokenAddress, inContract) {\r\n        if (inContract)\r\n            return await this.getIntermediaryBalance(signer, tokenAddress);\r\n        //TODO: For native token we should discount the cost of deploying an account if it is not deployed yet\r\n        return await this.Chain.getBalance(signer, tokenAddress);\r\n    }\r\n    getIntermediaryData(address, token) {\r\n        return this.LpVault.getIntermediaryData(address, token);\r\n    }\r\n    getIntermediaryReputation(address, token) {\r\n        return this.LpVault.getIntermediaryReputation(address, token);\r\n    }\r\n    getIntermediaryBalance(address, token) {\r\n        return this.LpVault.getIntermediaryBalance(address, token);\r\n    }\r\n    ////////////////////////////////////////////\r\n    //// Transaction initializers\r\n    async txsClaimWithSecret(signer, swapData, secret, checkExpiry, initAta, feeRate, skipAtaCheck) {\r\n        return this.Claim.txsClaimWithSecret(typeof (signer) === \"string\" ? signer : signer.getAddress(), swapData, secret, checkExpiry, feeRate);\r\n    }\r\n    async txsClaimWithTxData(signer, swapData, tx, requiredConfirmations, vout, commitedHeader, synchronizer, initAta, feeRate) {\r\n        return this.Claim.txsClaimWithTxData(typeof (signer) === \"string\" ? signer : signer.getAddress(), swapData, tx, requiredConfirmations, vout, commitedHeader, synchronizer, feeRate);\r\n    }\r\n    txsRefund(signer, swapData, check, initAta, feeRate) {\r\n        return this.Refund.txsRefund(signer, swapData, check, feeRate);\r\n    }\r\n    txsRefundWithAuthorization(signer, swapData, { timeout, prefix, signature }, check, initAta, feeRate) {\r\n        return this.Refund.txsRefundWithAuthorization(signer, swapData, timeout, prefix, signature, check, feeRate);\r\n    }\r\n    txsInit(sender, swapData, { timeout, prefix, signature }, skipChecks, feeRate) {\r\n        return this.Init.txsInit(sender, swapData, timeout, prefix, signature, skipChecks, feeRate);\r\n    }\r\n    txsWithdraw(signer, token, amount, feeRate) {\r\n        return this.LpVault.txsWithdraw(signer, token, amount, feeRate);\r\n    }\r\n    txsDeposit(signer, token, amount, feeRate) {\r\n        return this.LpVault.txsDeposit(signer, token, amount, feeRate);\r\n    }\r\n    ////////////////////////////////////////////\r\n    //// Executors\r\n    async claimWithSecret(signer, swapData, secret, checkExpiry, initAta, txOptions) {\r\n        const result = await this.Claim.txsClaimWithSecret(signer.getAddress(), swapData, secret, checkExpiry, txOptions?.feeRate);\r\n        const [signature] = await this.Chain.sendAndConfirm(signer, result, txOptions?.waitForConfirmation, txOptions?.abortSignal);\r\n        return signature;\r\n    }\r\n    async claimWithTxData(signer, swapData, tx, requiredConfirmations, vout, commitedHeader, synchronizer, initAta, txOptions) {\r\n        const txs = await this.Claim.txsClaimWithTxData(signer.getAddress(), swapData, tx, requiredConfirmations, vout, commitedHeader, synchronizer, txOptions?.feeRate);\r\n        if (txs === null)\r\n            throw new Error(\"Btc relay not synchronized to required blockheight!\");\r\n        //TODO: This doesn't return proper tx signature\r\n        const [signature] = await this.Chain.sendAndConfirm(signer, txs, txOptions?.waitForConfirmation, txOptions?.abortSignal);\r\n        return signature;\r\n    }\r\n    async refund(signer, swapData, check, initAta, txOptions) {\r\n        let result = await this.txsRefund(signer.getAddress(), swapData, check, initAta, txOptions?.feeRate);\r\n        const [signature] = await this.Chain.sendAndConfirm(signer, result, txOptions?.waitForConfirmation, txOptions?.abortSignal);\r\n        return signature;\r\n    }\r\n    async refundWithAuthorization(signer, swapData, signature, check, initAta, txOptions) {\r\n        let result = await this.txsRefundWithAuthorization(signer.getAddress(), swapData, signature, check, initAta, txOptions?.feeRate);\r\n        const [txSignature] = await this.Chain.sendAndConfirm(signer, result, txOptions?.waitForConfirmation, txOptions?.abortSignal);\r\n        return txSignature;\r\n    }\r\n    async init(signer, swapData, signature, skipChecks, txOptions) {\r\n        if (swapData.isPayIn()) {\r\n            if (!swapData.isOfferer(signer.getAddress()))\r\n                throw new Error(\"Invalid signer provided!\");\r\n        }\r\n        else {\r\n            if (!swapData.isClaimer(signer.getAddress()))\r\n                throw new Error(\"Invalid signer provided!\");\r\n        }\r\n        let result = await this.txsInit(signer.getAddress(), swapData, signature, skipChecks, txOptions?.feeRate);\r\n        const [txSignature] = await this.Chain.sendAndConfirm(signer, result, txOptions?.waitForConfirmation, txOptions?.abortSignal);\r\n        return txSignature;\r\n    }\r\n    async withdraw(signer, token, amount, txOptions) {\r\n        const txs = await this.LpVault.txsWithdraw(signer.getAddress(), token, amount, txOptions?.feeRate);\r\n        const [txId] = await this.Chain.sendAndConfirm(signer, txs, txOptions?.waitForConfirmation, txOptions?.abortSignal, false);\r\n        return txId;\r\n    }\r\n    async deposit(signer, token, amount, txOptions) {\r\n        const txs = await this.LpVault.txsDeposit(signer.getAddress(), token, amount, txOptions?.feeRate);\r\n        const [txId] = await this.Chain.sendAndConfirm(signer, txs, txOptions?.waitForConfirmation, txOptions?.abortSignal, false);\r\n        return txId;\r\n    }\r\n    ////////////////////////////////////////////\r\n    //// Fees\r\n    getInitPayInFeeRate(offerer, claimer, token, paymentHash) {\r\n        return this.Chain.Fees.getFeeRate();\r\n    }\r\n    getInitFeeRate(offerer, claimer, token, paymentHash) {\r\n        return this.Chain.Fees.getFeeRate();\r\n    }\r\n    getRefundFeeRate(swapData) {\r\n        return this.Chain.Fees.getFeeRate();\r\n    }\r\n    getClaimFeeRate(signer, swapData) {\r\n        return this.Chain.Fees.getFeeRate();\r\n    }\r\n    getClaimFee(signer, swapData, feeRate) {\r\n        return this.Claim.getClaimFee(swapData, feeRate);\r\n    }\r\n    /**\r\n     * Get the estimated solana fee of the commit transaction\r\n     */\r\n    getCommitFee(swapData, feeRate) {\r\n        return this.Init.getInitFee(swapData, feeRate);\r\n    }\r\n    /**\r\n     * Get the estimated solana transaction fee of the refund transaction\r\n     */\r\n    getRefundFee(swapData, feeRate) {\r\n        return this.Refund.getRefundFee(swapData, feeRate);\r\n    }\r\n}\r\nexports.StarknetSwapContract = StarknetSwapContract;\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,oBAAoB,GAAG,KAAK;AACpC,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM,yBAAyB;AAC/B,MAAM,uBAAuB;AAC7B,MAAM,wBAAwB;AAC9B,MAAM,uBAAuB;IACzB,CAAC,WAAW,SAAS,CAAC,eAAe,CAAC,UAAU,CAAC,EAAE;IACnD,CAAC,WAAW,SAAS,CAAC,eAAe,CAAC,OAAO,CAAC,EAAE;AACpD;AACA,MAAM,wBAAwB;IAC1B,CAAC,WAAW,SAAS,CAAC,eAAe,CAAC,UAAU,CAAC,EAAE;QAC/C,CAAC,OAAO,aAAa,CAAC,IAAI,CAAC,EAAE;QAC7B,CAAC,OAAO,aAAa,CAAC,UAAU,CAAC,EAAE;QACnC,CAAC,OAAO,aAAa,CAAC,KAAK,CAAC,EAAE;QAC9B,CAAC,OAAO,aAAa,CAAC,YAAY,CAAC,EAAE;IACzC;IACA,CAAC,WAAW,SAAS,CAAC,eAAe,CAAC,OAAO,CAAC,EAAE;QAC5C,CAAC,OAAO,aAAa,CAAC,IAAI,CAAC,EAAE;QAC7B,CAAC,OAAO,aAAa,CAAC,UAAU,CAAC,EAAE;QACnC,CAAC,OAAO,aAAa,CAAC,KAAK,CAAC,EAAE;QAC9B,CAAC,OAAO,aAAa,CAAC,YAAY,CAAC,EAAE;IACzC;AACJ;AACA,MAAM,yBAAyB;IAC3B,CAAC,WAAW,SAAS,CAAC,eAAe,CAAC,UAAU,CAAC,EAAE;QAC/C,UAAU;IACd;IACA,CAAC,WAAW,SAAS,CAAC,eAAe,CAAC,OAAO,CAAC,EAAE;QAC5C,UAAU;IACd;AACJ;AACA,MAAM,6BAA6B,uBAAuB,oBAAoB;IAC1E,YAAY,cAAc,EAAE,QAAQ,EAAE,kBAAkB,oBAAoB,CAAC,eAAe,eAAe,CAAC,EAAE,gBAAgB,CAAE;QAC5H,KAAK,CAAC,gBAAgB,iBAAiB,mBAAmB,gBAAgB;QAC1E,wBAAwB;QACxB,cAAc;QACd,IAAI,CAAC,OAAO,GAAG;QACf,wBAAwB;QACxB,aAAa;QACb,IAAI,CAAC,sBAAsB,GAAG;QAC9B,IAAI,CAAC,sBAAsB,GAAG;QAC9B,IAAI,CAAC,aAAa,GAAG;QACrB,IAAI,CAAC,gBAAgB,GAAG,KAAK;QAC7B,IAAI,CAAC,iBAAiB,GAAG,KAAK;QAC9B,IAAI,CAAC,eAAe,GAAG;QACvB,wBAAwB;QACxB,aAAa;QACb,IAAI,CAAC,sBAAsB,GAAG,CAAC;QAC/B,IAAI,CAAC,uBAAuB,GAAG,CAAC;QAChC,IAAI,CAAC,uBAAuB,GAAG,CAAC;QAChC,IAAI,CAAC,IAAI,GAAG,IAAI,mBAAmB,gBAAgB,CAAC,gBAAgB,IAAI;QACxE,IAAI,CAAC,MAAM,GAAG,IAAI,qBAAqB,kBAAkB,CAAC,gBAAgB,IAAI;QAC9E,IAAI,CAAC,KAAK,GAAG,IAAI,oBAAoB,iBAAiB,CAAC,gBAAgB,IAAI;QAC3E,IAAI,CAAC,OAAO,GAAG,IAAI,kBAAkB,eAAe,CAAC,gBAAgB,IAAI;QACzE,IAAI,CAAC,QAAQ,GAAG;QAChB,oBAAoB,CAAC,mBAAmB,CAAC,CAAC;QAC1C,iBAAiB,MAAM,IAAI,CAAC,iBAAiB,MAAM,GAAG,CAAC,CAAC;QACxD,iBAAiB,MAAM,GAAG;YAAE,GAAG,sBAAsB,CAAC,eAAe,eAAe,CAAC;YAAE,GAAG,iBAAiB,MAAM;QAAC;QAClH,iBAAiB,KAAK,IAAI,CAAC,iBAAiB,KAAK,GAAG,CAAC,CAAC;QACtD,iBAAiB,KAAK,GAAG;YAAE,GAAG,qBAAqB,CAAC,eAAe,eAAe,CAAC;YAAE,GAAG,iBAAiB,KAAK;QAAC;QAC/G,gBAAgB,iBAAiB,CAAC,OAAO,CAAC,CAAA;YACtC,MAAM,UAAU,IAAI,YAAY,iBAAiB,KAAK,CAAC,YAAY,IAAI,CAAC;YACxE,IAAI,CAAC,sBAAsB,CAAC,CAAC,GAAG,QAAQ,KAAK,EAAE,QAAQ,OAAO,EAAE,GAAG;YACnE,IAAI,CAAC,uBAAuB,CAAC,YAAY,IAAI,CAAC,GAAG;QACrD;QACA,IAAI,CAAC,qBAAqB,GAAG,IAAI,wBAAwB,qBAAqB,CAAC,iBAAiB,MAAM,CAAC,QAAQ;QAC/G,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,GAAG,IAAI,CAAC,qBAAqB;IACjG;IACA,MAAM,QAAQ,CACd;IACA,4CAA4C;IAC5C,eAAe;IACf,uCAAuC;QACnC,OAAO,IAAI,CAAC,IAAI,CAAC,oCAAoC;IACzD;IACA,iBAAiB,MAAM,EAAE,QAAQ,EAAE,oBAAoB,EAAE,mBAAmB,EAAE,OAAO,EAAE;QACnF,OAAO,IAAI,CAAC,IAAI,CAAC,sBAAsB,CAAC,QAAQ,UAAU;IAC9D;IACA,yBAAyB,MAAM,EAAE,QAAQ,EAAE,EAAE,OAAO,EAAE,MAAM,EAAE,SAAS,EAAE,EAAE,OAAO,EAAE,cAAc,EAAE;QAChG,OAAO,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,QAAQ,UAAU,SAAS,QAAQ,WAAW;IACpF;IACA,2BAA2B,QAAQ,EAAE,EAAE,OAAO,EAAE,MAAM,EAAE,SAAS,EAAE,EAAE,cAAc,EAAE;QACjF,OAAO,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC;IACxC;IACA,2BAA2B,QAAQ,EAAE,EAAE,OAAO,EAAE,MAAM,EAAE,SAAS,EAAE,EAAE;QACjE,OAAO,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC;IACxC;IACA,mBAAmB,MAAM,EAAE,QAAQ,EAAE,oBAAoB,EAAE;QACvD,OAAO,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,QAAQ,UAAU;IACxD;IACA,2BAA2B,QAAQ,EAAE,EAAE,OAAO,EAAE,MAAM,EAAE,SAAS,EAAE,EAAE;QACjE,OAAO,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,UAAU,SAAS,QAAQ;IACnE;IACA,iBAAiB,MAAM,EAAE,IAAI,EAAE;QAC3B,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,gBAAgB,CAAC,QAAQ;IAC1D;IACA,qBAAqB,IAAI,EAAE,SAAS,EAAE,SAAS,EAAE;QAC7C,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,oBAAoB,CAAC,MAAM,WAAW;IACvE;IACA,4CAA4C;IAC5C,oBAAoB;IACpB;;;;;KAKC,GACD,MAAM,YAAY,MAAM,EAAE,IAAI,EAAE;QAC5B,IAAI,CAAC,KAAK,SAAS,CAAC,SAChB,OAAO;QACX,IAAI,MAAM,IAAI,CAAC,SAAS,CAAC,QAAQ,OAC7B,OAAO;QACX,OAAO,MAAM,IAAI,CAAC,UAAU,CAAC;IACjC;IACA;;;;KAIC,GACD,MAAM,WAAW,QAAQ,EAAE;QACvB,MAAM,OAAO,MAAM,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,OAAO,SAAS,aAAa;QAC7E,OAAO,OAAO,KAAK,KAAK,MAAM;IAClC;IACA;;;;;;KAMC,GACD,UAAU,MAAM,EAAE,IAAI,EAAE;QACpB,IAAI,mBAAmB,OAAO,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK;QACtD,IAAI,KAAK,SAAS,CAAC,SACf,mBAAmB,mBAAmB,OAAO,IAAI,CAAC,gBAAgB;QACtE,IAAI,KAAK,SAAS,CAAC,SACf,mBAAmB,mBAAmB,OAAO,IAAI,CAAC,iBAAiB;QACvE,OAAO,QAAQ,OAAO,CAAC,KAAK,SAAS,KAAK;IAC9C;IACA;;;;;;KAMC,GACD,MAAM,oBAAoB,MAAM,EAAE,IAAI,EAAE;QACpC,0CAA0C;QAC1C,IAAI,CAAC,KAAK,SAAS,CAAC,SAChB,OAAO;QACX,IAAI,CAAE,MAAM,IAAI,CAAC,SAAS,CAAC,QAAQ,OAC/B,OAAO;QACX,OAAO,MAAM,IAAI,CAAC,UAAU,CAAC;IACjC;IACA,eAAe,IAAI,EAAE,aAAa,EAAE;QAChC,OAAO,CAAC,GAAG,QAAQ,oBAAoB,EAAE,IAAI,CAAC,uBAAuB,CAAC,OAAO,aAAa,CAAC,UAAU,CAAC,CAAC,aAAa,CAAC;YACjH;YACA;YACA,UAAU,IAAI,CAAC,QAAQ;QAC3B,IAAI;IACR;IACA;;;;;;;KAOC,GACD,kBAAkB,YAAY,EAAE,MAAM,EAAE,aAAa,EAAE,KAAK,EAAE;QAC1D,IAAI;QACJ,IAAI,SAAS,QAAQ,UAAU,EAAE,EAAE;YAC/B,SAAS,IAAI,CAAC,uBAAuB,CAAC,OAAO,aAAa,CAAC,KAAK,CAAC,CAAC,aAAa,CAAC;gBAC5E,QAAQ;gBACR;gBACA;gBACA,UAAU,IAAI,CAAC,QAAQ;YAC3B;QACJ,OACK;YACD,SAAS,IAAI,CAAC,uBAAuB,CAAC,OAAO,aAAa,CAAC,YAAY,CAAC,CAAC,aAAa,CAAC;gBACnF,QAAQ;gBACR;gBACA;gBACA;gBACA,UAAU,IAAI,CAAC,QAAQ;YAC3B;QACJ;QACA,OAAO,CAAC,GAAG,QAAQ,oBAAoB,EAAE,QAAQ;IACrD;IACA;;;;KAIC,GACD,eAAe,WAAW,EAAE;QACxB,OAAO,CAAC,GAAG,QAAQ,oBAAoB,EAAE,IAAI,CAAC,uBAAuB,CAAC,OAAO,aAAa,CAAC,IAAI,CAAC,CAAC,aAAa,CAAC,cAAc;IACjI;IACA,aAAa,YAAY,EAAE,MAAM,EAAE,aAAa,EAAE,KAAK,EAAE;QACrD,IAAI,SAAS,MACT,QAAQ,EAAE;QACd,MAAM,UAAU,SAAS,MAAM,CAAC,IAAI,CAAC,CAAC,GAAG,OAAO,MAAM,EAAE,SAAS,MAAM,CAAC,MAAM,CAAC;YAC3E,OAAO,iBAAiB,CAAC,QAAQ,CAAC,QAAQ,MAAM;YAChD;SACH;QACD,OAAO,SAAS,MAAM,CAAC,MAAM,CAAC;YAC1B;YACA,OAAO,iBAAiB,CAAC,QAAQ,CAAC,OAAO,MAAM;YAC/C,OAAO,iBAAiB,CAAC,QAAQ,CAAC,OAAO,gBAAgB,MAAM;SAClE;IACL;IACA,4CAA4C;IAC5C,sBAAsB;IACtB;;;;;;KAMC,GACD,MAAM,gBAAgB,MAAM,EAAE,IAAI,EAAE;QAChC,MAAM,aAAa,KAAK,aAAa;QACrC,MAAM,YAAY,MAAM,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,OAAO;QAC5D,MAAM,QAAQ,OAAO,UAAU,KAAK;QACpC,MAAM,cAAc,OAAO,UAAU,kBAAkB;QACvD,OAAQ;YACJ,KAAK;gBACD,IAAI,KAAK,SAAS,CAAC,WAAW,MAAM,IAAI,CAAC,SAAS,CAAC,QAAQ,OACvD,OAAO;oBAAE,MAAM,OAAO,mBAAmB,CAAC,UAAU;gBAAC;gBACzD,OAAO;oBAAE,MAAM,OAAO,mBAAmB,CAAC,QAAQ;gBAAC;YACvD,KAAK;gBACD,OAAO;oBACH,MAAM,OAAO,mBAAmB,CAAC,IAAI;oBACrC,YAAY;wBACR,OAAO;4BACH,WAAW,MAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,YAAY,CAAC;4BAChD,aAAa;wBACjB;oBACJ;oBACA,cAAc;wBACV,MAAM,SAAS,MAAM,IAAI,CAAC,MAAM,CAAC,sBAAsB,CAAC;4BAAC;yBAAgC,EAAE;4BAAC;4BAAM;4BAAM;4BAAM,OAAO;yBAAW,EAAE,aAAa;wBAC/I,OAAO,OAAO,MAAM,KAAK,IAAI,OAAO,MAAM,CAAC,EAAE,CAAC,MAAM;oBACxD;oBACA,gBAAgB;wBACZ,MAAM,SAAS,MAAM,IAAI,CAAC,MAAM,CAAC,sBAAsB,CAAC;4BAAC;yBAAgC,EAAE;4BAAC;4BAAM;4BAAM;4BAAM,OAAO;yBAAW,EAAE,aAAa;wBAC/I,IAAI,OAAO,MAAM,KAAK,GAClB,OAAO;wBACX,MAAM,QAAQ,MAAM,CAAC,EAAE;wBACvB,MAAM,kBAAkB,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,aAAa;wBACrE,MAAM,eAAe,IAAI,CAAC,sBAAsB,CAAC,gBAAgB;wBACjE,IAAI,gBAAgB,MAAM;4BACtB,WAAW,MAAM,CAAC,IAAI,CAAC,uCAAuC,aAAa,0CAA0C;4BACrH,OAAO;wBACX;wBACA,MAAM,gBAAgB,aAAa,kBAAkB,CAAC,MAAM,MAAM,CAAC,cAAc;wBACjF,OAAO;oBACX;gBACJ;YACJ;gBACI,OAAO;oBACH,MAAM,MAAM,IAAI,CAAC,SAAS,CAAC,QAAQ,QAAQ,OAAO,mBAAmB,CAAC,OAAO,GAAG,OAAO,mBAAmB,CAAC,YAAY;oBACvH,YAAY;wBACR,OAAO;4BACH,WAAW,MAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,YAAY,CAAC;4BAChD,aAAa;wBACjB;oBACJ;oBACA,cAAc;wBACV,MAAM,SAAS,MAAM,IAAI,CAAC,MAAM,CAAC,sBAAsB,CAAC;4BAAC;yBAAiC,EAAE;4BAAC;4BAAM;4BAAM;4BAAM,OAAO;yBAAW,EAAE,aAAa;wBAChJ,OAAO,OAAO,MAAM,KAAK,IAAI,OAAO,MAAM,CAAC,EAAE,CAAC,MAAM;oBACxD;gBACJ;QACR;IACJ;IACA;;;;;KAKC,GACD,MAAM,gBAAgB,cAAc,EAAE;QAClC,YAAY;QACZ,OAAO;IACX;IACA,4CAA4C;IAC5C,0BAA0B;IAC1B,eAAe,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,EAAE,WAAW,EAAE,QAAQ,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,eAAe,EAAE,aAAa,EAAE,eAAe,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,wBAAwB,EAAE,EAAE;QAC7L,OAAO,QAAQ,OAAO,CAAC,IAAI,mBAAmB,gBAAgB,CAAC,SAAS,SAAS,OAAO,IAAI,CAAC,qBAAqB,CAAC,OAAO,EAAE,IAAI,CAAC,uBAAuB,EAAE,CAAC,KAAK,EAAE,SAAS,QAAQ,OAAO,OAC1L,UAAU,OAAO,aAAa,CAAC,GAAG,QAAQ,KAAK,EAAE,SAAS,QAAQ,cAAc,iBAAiB,eAAe,MAAM;IAC1H;IACA,4CAA4C;IAC5C,UAAU;IACV,MAAM,WAAW,MAAM,EAAE,YAAY,EAAE,UAAU,EAAE;QAC/C,IAAI,YACA,OAAO,MAAM,IAAI,CAAC,sBAAsB,CAAC,QAAQ;QACrD,sGAAsG;QACtG,OAAO,MAAM,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ;IAC/C;IACA,oBAAoB,OAAO,EAAE,KAAK,EAAE;QAChC,OAAO,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,SAAS;IACrD;IACA,0BAA0B,OAAO,EAAE,KAAK,EAAE;QACtC,OAAO,IAAI,CAAC,OAAO,CAAC,yBAAyB,CAAC,SAAS;IAC3D;IACA,uBAAuB,OAAO,EAAE,KAAK,EAAE;QACnC,OAAO,IAAI,CAAC,OAAO,CAAC,sBAAsB,CAAC,SAAS;IACxD;IACA,4CAA4C;IAC5C,6BAA6B;IAC7B,MAAM,mBAAmB,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,WAAW,EAAE,OAAO,EAAE,OAAO,EAAE,YAAY,EAAE;QAC5F,OAAO,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,OAAQ,WAAY,WAAW,SAAS,OAAO,UAAU,IAAI,UAAU,QAAQ,aAAa;IACrI;IACA,MAAM,mBAAmB,MAAM,EAAE,QAAQ,EAAE,EAAE,EAAE,qBAAqB,EAAE,IAAI,EAAE,cAAc,EAAE,YAAY,EAAE,OAAO,EAAE,OAAO,EAAE;QACxH,OAAO,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,OAAQ,WAAY,WAAW,SAAS,OAAO,UAAU,IAAI,UAAU,IAAI,uBAAuB,MAAM,gBAAgB,cAAc;IAC/K;IACA,UAAU,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE;QACjD,OAAO,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,QAAQ,UAAU,OAAO;IAC1D;IACA,2BAA2B,MAAM,EAAE,QAAQ,EAAE,EAAE,OAAO,EAAE,MAAM,EAAE,SAAS,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE;QAClG,OAAO,IAAI,CAAC,MAAM,CAAC,0BAA0B,CAAC,QAAQ,UAAU,SAAS,QAAQ,WAAW,OAAO;IACvG;IACA,QAAQ,MAAM,EAAE,QAAQ,EAAE,EAAE,OAAO,EAAE,MAAM,EAAE,SAAS,EAAE,EAAE,UAAU,EAAE,OAAO,EAAE;QAC3E,OAAO,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,UAAU,SAAS,QAAQ,WAAW,YAAY;IACvF;IACA,YAAY,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE;QACxC,OAAO,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,QAAQ,OAAO,QAAQ;IAC3D;IACA,WAAW,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE;QACvC,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,QAAQ,OAAO,QAAQ;IAC1D;IACA,4CAA4C;IAC5C,cAAc;IACd,MAAM,gBAAgB,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,WAAW,EAAE,OAAO,EAAE,SAAS,EAAE;QAC7E,MAAM,SAAS,MAAM,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,OAAO,UAAU,IAAI,UAAU,QAAQ,aAAa,WAAW;QAClH,MAAM,CAAC,UAAU,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,QAAQ,QAAQ,WAAW,qBAAqB,WAAW;QAC/G,OAAO;IACX;IACA,MAAM,gBAAgB,MAAM,EAAE,QAAQ,EAAE,EAAE,EAAE,qBAAqB,EAAE,IAAI,EAAE,cAAc,EAAE,YAAY,EAAE,OAAO,EAAE,SAAS,EAAE;QACvH,MAAM,MAAM,MAAM,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,OAAO,UAAU,IAAI,UAAU,IAAI,uBAAuB,MAAM,gBAAgB,cAAc,WAAW;QACzJ,IAAI,QAAQ,MACR,MAAM,IAAI,MAAM;QACpB,+CAA+C;QAC/C,MAAM,CAAC,UAAU,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,QAAQ,KAAK,WAAW,qBAAqB,WAAW;QAC5G,OAAO;IACX;IACA,MAAM,OAAO,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,OAAO,EAAE,SAAS,EAAE;QACtD,IAAI,SAAS,MAAM,IAAI,CAAC,SAAS,CAAC,OAAO,UAAU,IAAI,UAAU,OAAO,SAAS,WAAW;QAC5F,MAAM,CAAC,UAAU,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,QAAQ,QAAQ,WAAW,qBAAqB,WAAW;QAC/G,OAAO;IACX;IACA,MAAM,wBAAwB,MAAM,EAAE,QAAQ,EAAE,SAAS,EAAE,KAAK,EAAE,OAAO,EAAE,SAAS,EAAE;QAClF,IAAI,SAAS,MAAM,IAAI,CAAC,0BAA0B,CAAC,OAAO,UAAU,IAAI,UAAU,WAAW,OAAO,SAAS,WAAW;QACxH,MAAM,CAAC,YAAY,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,QAAQ,QAAQ,WAAW,qBAAqB,WAAW;QACjH,OAAO;IACX;IACA,MAAM,KAAK,MAAM,EAAE,QAAQ,EAAE,SAAS,EAAE,UAAU,EAAE,SAAS,EAAE;QAC3D,IAAI,SAAS,OAAO,IAAI;YACpB,IAAI,CAAC,SAAS,SAAS,CAAC,OAAO,UAAU,KACrC,MAAM,IAAI,MAAM;QACxB,OACK;YACD,IAAI,CAAC,SAAS,SAAS,CAAC,OAAO,UAAU,KACrC,MAAM,IAAI,MAAM;QACxB;QACA,IAAI,SAAS,MAAM,IAAI,CAAC,OAAO,CAAC,OAAO,UAAU,IAAI,UAAU,WAAW,YAAY,WAAW;QACjG,MAAM,CAAC,YAAY,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,QAAQ,QAAQ,WAAW,qBAAqB,WAAW;QACjH,OAAO;IACX;IACA,MAAM,SAAS,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,SAAS,EAAE;QAC7C,MAAM,MAAM,MAAM,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,OAAO,UAAU,IAAI,OAAO,QAAQ,WAAW;QAC1F,MAAM,CAAC,KAAK,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,QAAQ,KAAK,WAAW,qBAAqB,WAAW,aAAa;QACpH,OAAO;IACX;IACA,MAAM,QAAQ,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,SAAS,EAAE;QAC5C,MAAM,MAAM,MAAM,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,OAAO,UAAU,IAAI,OAAO,QAAQ,WAAW;QACzF,MAAM,CAAC,KAAK,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,QAAQ,KAAK,WAAW,qBAAqB,WAAW,aAAa;QACpH,OAAO;IACX;IACA,4CAA4C;IAC5C,SAAS;IACT,oBAAoB,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,WAAW,EAAE;QACtD,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU;IACrC;IACA,eAAe,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,WAAW,EAAE;QACjD,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU;IACrC;IACA,iBAAiB,QAAQ,EAAE;QACvB,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU;IACrC;IACA,gBAAgB,MAAM,EAAE,QAAQ,EAAE;QAC9B,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU;IACrC;IACA,YAAY,MAAM,EAAE,QAAQ,EAAE,OAAO,EAAE;QACnC,OAAO,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,UAAU;IAC5C;IACA;;KAEC,GACD,aAAa,QAAQ,EAAE,OAAO,EAAE;QAC5B,OAAO,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU;IAC1C;IACA;;KAEC,GACD,aAAa,QAAQ,EAAE,OAAO,EAAE;QAC5B,OAAO,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,UAAU;IAC9C;AACJ;AACA,QAAQ,oBAAoB,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5687, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/swaps/handlers/IHandler.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5694, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/events/StarknetChainEventsBrowser.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetChainEventsBrowser = void 0;\r\nconst base_1 = require(\"@atomiqlabs/base\");\r\nconst Utils_1 = require(\"../../utils/Utils\");\r\nconst starknet_1 = require(\"starknet\");\r\n/**\r\n * Starknet on-chain event handler for front-end systems without access to fs, uses WS or long-polling to subscribe, might lose\r\n *  out on some events if the network is unreliable, front-end systems should take this into consideration and not\r\n *  rely purely on events\r\n */\r\nclass StarknetChainEventsBrowser {\r\n    constructor(chainInterface, starknetSwapContract, starknetSpvVaultContract, pollIntervalSeconds = 5) {\r\n        this.listeners = [];\r\n        this.logger = (0, Utils_1.getLogger)(\"StarknetChainEventsBrowser: \");\r\n        this.initFunctionName = \"initialize\";\r\n        this.initEntryPointSelector = BigInt(starknet_1.hash.starknetKeccak(this.initFunctionName));\r\n        this.provider = chainInterface.provider;\r\n        this.starknetSwapContract = starknetSwapContract;\r\n        this.starknetSpvVaultContract = starknetSpvVaultContract;\r\n        this.pollIntervalSeconds = pollIntervalSeconds;\r\n    }\r\n    findInitSwapData(call, escrowHash, claimHandler) {\r\n        if (BigInt(call.contract_address) === BigInt(this.starknetSwapContract.contract.address) &&\r\n            BigInt(call.entry_point_selector) === this.initEntryPointSelector) {\r\n            //Found, check correct escrow hash\r\n            const { escrow, extraData } = (0, Utils_1.parseInitFunctionCalldata)(call.calldata, claimHandler);\r\n            if (\"0x\" + escrow.getEscrowHash() === (0, Utils_1.toHex)(escrowHash)) {\r\n                if (extraData.length !== 0) {\r\n                    escrow.setExtraData((0, Utils_1.bytes31SpanToBuffer)(extraData, 42).toString(\"hex\"));\r\n                }\r\n                return escrow;\r\n            }\r\n        }\r\n        for (let _call of call.calls) {\r\n            const found = this.findInitSwapData(_call, escrowHash, claimHandler);\r\n            if (found != null)\r\n                return found;\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Returns async getter for fetching on-demand initialize event swap data\r\n     *\r\n     * @param event\r\n     * @param claimHandler\r\n     * @private\r\n     * @returns {() => Promise<StarknetSwapData>} getter to be passed to InitializeEvent constructor\r\n     */\r\n    getSwapDataGetter(event, claimHandler) {\r\n        return async () => {\r\n            let trace;\r\n            try {\r\n                trace = await this.provider.getTransactionTrace(event.txHash);\r\n            }\r\n            catch (e) {\r\n                this.logger.warn(\"getSwapDataGetter(): getter: starknet_traceTransaction not supported by the RPC: \", e);\r\n                const blockTraces = await this.provider.getBlockTransactionsTraces(event.blockHash);\r\n                const foundTrace = blockTraces.find(val => (0, Utils_1.toHex)(val.transaction_hash) === (0, Utils_1.toHex)(event.txHash));\r\n                if (foundTrace == null)\r\n                    throw new Error(`Cannot find ${event.txHash} in the block traces, block: ${event.blockHash}`);\r\n                trace = foundTrace.trace_root;\r\n            }\r\n            if (trace == null)\r\n                return null;\r\n            if (trace.execute_invocation.revert_reason != null)\r\n                return null;\r\n            return this.findInitSwapData(trace.execute_invocation, event.params.escrow_hash, claimHandler);\r\n        };\r\n    }\r\n    parseInitializeEvent(event) {\r\n        const escrowHashBuffer = (0, Utils_1.bigNumberishToBuffer)(event.params.escrow_hash, 32);\r\n        const escrowHash = escrowHashBuffer.toString(\"hex\");\r\n        const claimHandlerHex = (0, Utils_1.toHex)(event.params.claim_handler);\r\n        const claimHandler = this.starknetSwapContract.claimHandlersByAddress[claimHandlerHex];\r\n        if (claimHandler == null) {\r\n            this.logger.warn(\"parseInitializeEvent(\" + escrowHash + \"): Unknown claim handler with claim: \" + claimHandlerHex);\r\n            return null;\r\n        }\r\n        const swapType = claimHandler.getType();\r\n        this.logger.debug(\"InitializeEvent claimHash: \" + (0, Utils_1.toHex)(event.params.claim_data) + \" escrowHash: \" + escrowHash);\r\n        return new base_1.InitializeEvent(escrowHash, swapType, (0, Utils_1.onceAsync)(this.getSwapDataGetter(event, claimHandler)));\r\n    }\r\n    parseRefundEvent(event) {\r\n        const escrowHashBuffer = (0, Utils_1.bigNumberishToBuffer)(event.params.escrow_hash, 32);\r\n        const escrowHash = escrowHashBuffer.toString(\"hex\");\r\n        this.logger.debug(\"RefundEvent claimHash: \" + (0, Utils_1.toHex)(event.params.claim_data) + \" escrowHash: \" + escrowHash);\r\n        return new base_1.RefundEvent(escrowHash);\r\n    }\r\n    parseClaimEvent(event) {\r\n        const escrowHashBuffer = (0, Utils_1.bigNumberishToBuffer)(event.params.escrow_hash, 32);\r\n        const escrowHash = escrowHashBuffer.toString(\"hex\");\r\n        const claimHandlerHex = (0, Utils_1.toHex)(event.params.claim_handler);\r\n        const claimHandler = this.starknetSwapContract.claimHandlersByAddress[claimHandlerHex];\r\n        if (claimHandler == null) {\r\n            this.logger.warn(\"parseClaimEvent(\" + escrowHash + \"): Unknown claim handler with claim: \" + claimHandlerHex);\r\n            return null;\r\n        }\r\n        const witnessResult = claimHandler.parseWitnessResult(event.params.witness_result);\r\n        this.logger.debug(\"ClaimEvent claimHash: \" + (0, Utils_1.toHex)(event.params.claim_data) +\r\n            \" witnessResult: \" + witnessResult + \" escrowHash: \" + escrowHash);\r\n        return new base_1.ClaimEvent(escrowHash, witnessResult);\r\n    }\r\n    parseSpvOpenEvent(event) {\r\n        const owner = (0, Utils_1.toHex)(event.params.owner);\r\n        const vaultId = (0, Utils_1.toBigInt)(event.params.vault_id);\r\n        const btcTxId = (0, Utils_1.bigNumberishToBuffer)(event.params.btc_tx_hash, 32).reverse().toString(\"hex\");\r\n        const vout = Number((0, Utils_1.toBigInt)(event.params.vout));\r\n        this.logger.debug(\"SpvOpenEvent owner: \" + owner + \" vaultId: \" + vaultId + \" utxo: \" + btcTxId + \":\" + vout);\r\n        return new base_1.SpvVaultOpenEvent(owner, vaultId, btcTxId, vout);\r\n    }\r\n    parseSpvDepositEvent(event) {\r\n        const owner = (0, Utils_1.toHex)(event.params.owner);\r\n        const vaultId = (0, Utils_1.toBigInt)(event.params.vault_id);\r\n        const amounts = [(0, Utils_1.toBigInt)(event.params.amounts[\"0\"]), (0, Utils_1.toBigInt)(event.params.amounts[\"1\"])];\r\n        const depositCount = Number((0, Utils_1.toBigInt)(event.params.deposit_count));\r\n        this.logger.debug(\"SpvDepositEvent owner: \" + owner + \" vaultId: \" + vaultId + \" depositCount: \" + depositCount + \" amounts: \", amounts);\r\n        return new base_1.SpvVaultDepositEvent(owner, vaultId, amounts, depositCount);\r\n    }\r\n    parseSpvFrontEvent(event) {\r\n        const owner = (0, Utils_1.toHex)(event.params.owner);\r\n        const vaultId = (0, Utils_1.toBigInt)(event.params.vault_id);\r\n        const btcTxId = (0, Utils_1.bigNumberishToBuffer)(event.params.btc_tx_hash, 32).reverse().toString(\"hex\");\r\n        const recipient = (0, Utils_1.toHex)(event.params.recipient);\r\n        const executionHash = (0, Utils_1.toHex)(event.params.execution_hash);\r\n        const amounts = [(0, Utils_1.toBigInt)(event.params.amounts[\"0\"]), (0, Utils_1.toBigInt)(event.params.amounts[\"1\"])];\r\n        const frontingAddress = (0, Utils_1.toHex)(event.params.caller);\r\n        this.logger.debug(\"SpvFrontEvent owner: \" + owner + \" vaultId: \" + vaultId + \" btcTxId: \" + btcTxId +\r\n            \" recipient: \" + recipient + \" frontedBy: \" + frontingAddress + \" amounts: \", amounts);\r\n        return new base_1.SpvVaultFrontEvent(owner, vaultId, btcTxId, recipient, executionHash, amounts, frontingAddress);\r\n    }\r\n    parseSpvClaimEvent(event) {\r\n        const owner = (0, Utils_1.toHex)(event.params.owner);\r\n        const vaultId = (0, Utils_1.toBigInt)(event.params.vault_id);\r\n        const btcTxId = (0, Utils_1.bigNumberishToBuffer)(event.params.btc_tx_hash, 32).reverse().toString(\"hex\");\r\n        const recipient = (0, Utils_1.toHex)(event.params.recipient);\r\n        const executionHash = (0, Utils_1.toHex)(event.params.execution_hash);\r\n        const amounts = [(0, Utils_1.toBigInt)(event.params.amounts[\"0\"]), (0, Utils_1.toBigInt)(event.params.amounts[\"1\"])];\r\n        const caller = (0, Utils_1.toHex)(event.params.caller);\r\n        const frontingAddress = (0, Utils_1.toHex)(event.params.fronting_address);\r\n        const withdrawCount = Number((0, Utils_1.toBigInt)(event.params.withdraw_count));\r\n        this.logger.debug(\"SpvClaimEvent owner: \" + owner + \" vaultId: \" + vaultId + \" btcTxId: \" + btcTxId + \" withdrawCount: \" + withdrawCount +\r\n            \" recipient: \" + recipient + \" frontedBy: \" + frontingAddress + \" claimedBy: \" + caller + \" amounts: \", amounts);\r\n        return new base_1.SpvVaultClaimEvent(owner, vaultId, btcTxId, recipient, executionHash, amounts, caller, frontingAddress, withdrawCount);\r\n    }\r\n    parseSpvCloseEvent(event) {\r\n        const owner = (0, Utils_1.toHex)(event.params.owner);\r\n        const vaultId = (0, Utils_1.toBigInt)(event.params.vault_id);\r\n        const btcTxId = (0, Utils_1.bigNumberishToBuffer)(event.params.btc_tx_hash, 32).reverse().toString(\"hex\");\r\n        const error = (0, Utils_1.bigNumberishToBuffer)(event.params.error).toString();\r\n        return new base_1.SpvVaultCloseEvent(owner, vaultId, btcTxId, error);\r\n    }\r\n    /**\r\n     * Processes event as received from the chain, parses it & calls event listeners\r\n     *\r\n     * @param events\r\n     * @param currentBlockNumber\r\n     * @param currentBlockTimestamp\r\n     * @param pendingEventTime\r\n     * @protected\r\n     */\r\n    async processEvents(events, currentBlockNumber, currentBlockTimestamp, pendingEventTime) {\r\n        const blockTimestampsCache = {};\r\n        const getBlockTimestamp = async (blockNumber) => {\r\n            if (blockNumber === currentBlockNumber)\r\n                return currentBlockTimestamp;\r\n            const blockNumberString = blockNumber.toString();\r\n            blockTimestampsCache[blockNumberString] ?? (blockTimestampsCache[blockNumberString] = (await this.provider.getBlockWithTxHashes(blockNumber)).timestamp);\r\n            return blockTimestampsCache[blockNumberString];\r\n        };\r\n        const parsedEvents = [];\r\n        for (let event of events) {\r\n            let parsedEvent;\r\n            switch (event.name) {\r\n                case \"escrow_manager::events::Claim\":\r\n                    parsedEvent = this.parseClaimEvent(event);\r\n                    break;\r\n                case \"escrow_manager::events::Refund\":\r\n                    parsedEvent = this.parseRefundEvent(event);\r\n                    break;\r\n                case \"escrow_manager::events::Initialize\":\r\n                    parsedEvent = this.parseInitializeEvent(event);\r\n                    break;\r\n                case \"spv_swap_vault::events::Opened\":\r\n                    parsedEvent = this.parseSpvOpenEvent(event);\r\n                    break;\r\n                case \"spv_swap_vault::events::Deposited\":\r\n                    parsedEvent = this.parseSpvDepositEvent(event);\r\n                    break;\r\n                case \"spv_swap_vault::events::Fronted\":\r\n                    parsedEvent = this.parseSpvFrontEvent(event);\r\n                    break;\r\n                case \"spv_swap_vault::events::Claimed\":\r\n                    parsedEvent = this.parseSpvClaimEvent(event);\r\n                    break;\r\n                case \"spv_swap_vault::events::Closed\":\r\n                    parsedEvent = this.parseSpvCloseEvent(event);\r\n                    break;\r\n            }\r\n            if (parsedEvent == null)\r\n                continue;\r\n            const timestamp = event.blockNumber == null ? pendingEventTime : await getBlockTimestamp(event.blockNumber);\r\n            parsedEvent.meta = {\r\n                blockTime: timestamp,\r\n                txId: event.txHash,\r\n                timestamp //Maybe deprecated\r\n            };\r\n            parsedEvents.push(parsedEvent);\r\n        }\r\n        for (let listener of this.listeners) {\r\n            await listener(parsedEvents);\r\n        }\r\n    }\r\n    async checkEventsEcrowManager(lastTxHash, lastBlockNumber, currentBlock) {\r\n        const currentBlockNumber = currentBlock.block_number;\r\n        lastBlockNumber ?? (lastBlockNumber = currentBlockNumber);\r\n        // this.logger.debug(\"checkEvents(EscrowManager): Requesting logs: \"+logStartHeight+\"...pending\");\r\n        let events = await this.starknetSwapContract.Events.getContractBlockEvents([\"escrow_manager::events::Initialize\", \"escrow_manager::events::Claim\", \"escrow_manager::events::Refund\"], [], lastBlockNumber, null);\r\n        if (lastTxHash != null) {\r\n            const latestProcessedEventIndex = (0, Utils_1.findLastIndex)(events, val => val.txHash === lastTxHash);\r\n            if (latestProcessedEventIndex !== -1) {\r\n                events.splice(0, latestProcessedEventIndex + 1);\r\n                // this.logger.debug(\"checkEvents(EscrowManager): Splicing processed events, resulting size: \"+events.length);\r\n            }\r\n        }\r\n        if (events.length > 0) {\r\n            await this.processEvents(events, currentBlock?.block_number, currentBlock?.timestamp, Math.floor(Date.now() / 1000));\r\n            lastTxHash = events[events.length - 1].txHash;\r\n        }\r\n        return lastTxHash;\r\n    }\r\n    async checkEventsSpvVaults(lastTxHash, lastBlockNumber, currentBlock) {\r\n        const currentBlockNumber = currentBlock.block_number;\r\n        lastBlockNumber ?? (lastBlockNumber = currentBlockNumber);\r\n        // this.logger.debug(\"checkEvents(SpvVaults): Requesting logs: \"+logStartHeight+\"...pending\");\r\n        let events = await this.starknetSpvVaultContract.Events.getContractBlockEvents([\"spv_swap_vault::events::Opened\", \"spv_swap_vault::events::Deposited\", \"spv_swap_vault::events::Closed\", \"spv_swap_vault::events::Fronted\", \"spv_swap_vault::events::Claimed\"], [], lastBlockNumber, null);\r\n        if (lastTxHash != null) {\r\n            const latestProcessedEventIndex = (0, Utils_1.findLastIndex)(events, val => val.txHash === lastTxHash);\r\n            if (latestProcessedEventIndex !== -1) {\r\n                events.splice(0, latestProcessedEventIndex + 1);\r\n                // this.logger.debug(\"checkEvents(SpvVaults): Splicing processed events, resulting size: \"+events.length);\r\n            }\r\n        }\r\n        if (events.length > 0) {\r\n            await this.processEvents(events, currentBlock?.block_number, currentBlock?.timestamp, Math.floor(Date.now() / 1000));\r\n            lastTxHash = events[events.length - 1].txHash;\r\n        }\r\n        return lastTxHash;\r\n    }\r\n    async checkEvents(lastBlockNumber, lastTxHashes) {\r\n        lastTxHashes ?? (lastTxHashes = []);\r\n        const currentBlock = await this.provider.getBlockWithTxHashes(\"latest\");\r\n        const currentBlockNumber = currentBlock.block_number;\r\n        lastTxHashes[0] = await this.checkEventsEcrowManager(lastTxHashes[0], lastBlockNumber, currentBlock);\r\n        lastTxHashes[1] = await this.checkEventsSpvVaults(lastTxHashes[1], lastBlockNumber, currentBlock);\r\n        return {\r\n            txHashes: lastTxHashes,\r\n            blockNumber: currentBlockNumber\r\n        };\r\n    }\r\n    /**\r\n     * Sets up event handlers listening for swap events over websocket\r\n     *\r\n     * @protected\r\n     */\r\n    async setupPoll(lastBlockNumber, lastTxHashes, saveLatestProcessedBlockNumber) {\r\n        this.stopped = false;\r\n        let func;\r\n        func = async () => {\r\n            await this.checkEvents(lastBlockNumber, lastTxHashes).then(({ blockNumber, txHashes }) => {\r\n                lastBlockNumber = blockNumber;\r\n                lastTxHashes = txHashes;\r\n                if (saveLatestProcessedBlockNumber != null)\r\n                    return saveLatestProcessedBlockNumber(blockNumber, lastTxHashes);\r\n            }).catch(e => {\r\n                this.logger.error(\"setupPoll(): Failed to fetch starknet log: \", e);\r\n            });\r\n            if (this.stopped)\r\n                return;\r\n            this.timeout = setTimeout(func, this.pollIntervalSeconds * 1000);\r\n        };\r\n        await func();\r\n    }\r\n    init() {\r\n        this.setupPoll();\r\n        return Promise.resolve();\r\n    }\r\n    async stop() {\r\n        this.stopped = true;\r\n        if (this.timeout != null)\r\n            clearTimeout(this.timeout);\r\n    }\r\n    registerListener(cbk) {\r\n        this.listeners.push(cbk);\r\n    }\r\n    unregisterListener(cbk) {\r\n        const index = this.listeners.indexOf(cbk);\r\n        if (index >= 0) {\r\n            this.listeners.splice(index, 1);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n}\r\nexports.StarknetChainEventsBrowser = StarknetChainEventsBrowser;\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,0BAA0B,GAAG,KAAK;AAC1C,MAAM;AACN,MAAM;AACN,MAAM;AACN;;;;CAIC,GACD,MAAM;IACF,YAAY,cAAc,EAAE,oBAAoB,EAAE,wBAAwB,EAAE,sBAAsB,CAAC,CAAE;QACjG,IAAI,CAAC,SAAS,GAAG,EAAE;QACnB,IAAI,CAAC,MAAM,GAAG,CAAC,GAAG,QAAQ,SAAS,EAAE;QACrC,IAAI,CAAC,gBAAgB,GAAG;QACxB,IAAI,CAAC,sBAAsB,GAAG,OAAO,WAAW,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,gBAAgB;QACzF,IAAI,CAAC,QAAQ,GAAG,eAAe,QAAQ;QACvC,IAAI,CAAC,oBAAoB,GAAG;QAC5B,IAAI,CAAC,wBAAwB,GAAG;QAChC,IAAI,CAAC,mBAAmB,GAAG;IAC/B;IACA,iBAAiB,IAAI,EAAE,UAAU,EAAE,YAAY,EAAE;QAC7C,IAAI,OAAO,KAAK,gBAAgB,MAAM,OAAO,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,OAAO,KACnF,OAAO,KAAK,oBAAoB,MAAM,IAAI,CAAC,sBAAsB,EAAE;YACnE,kCAAkC;YAClC,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,GAAG,CAAC,GAAG,QAAQ,yBAAyB,EAAE,KAAK,QAAQ,EAAE;YACpF,IAAI,OAAO,OAAO,aAAa,OAAO,CAAC,GAAG,QAAQ,KAAK,EAAE,aAAa;gBAClE,IAAI,UAAU,MAAM,KAAK,GAAG;oBACxB,OAAO,YAAY,CAAC,CAAC,GAAG,QAAQ,mBAAmB,EAAE,WAAW,IAAI,QAAQ,CAAC;gBACjF;gBACA,OAAO;YACX;QACJ;QACA,KAAK,IAAI,SAAS,KAAK,KAAK,CAAE;YAC1B,MAAM,QAAQ,IAAI,CAAC,gBAAgB,CAAC,OAAO,YAAY;YACvD,IAAI,SAAS,MACT,OAAO;QACf;QACA,OAAO;IACX;IACA;;;;;;;KAOC,GACD,kBAAkB,KAAK,EAAE,YAAY,EAAE;QACnC,OAAO;YACH,IAAI;YACJ,IAAI;gBACA,QAAQ,MAAM,IAAI,CAAC,QAAQ,CAAC,mBAAmB,CAAC,MAAM,MAAM;YAChE,EACA,OAAO,GAAG;gBACN,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,qFAAqF;gBACtG,MAAM,cAAc,MAAM,IAAI,CAAC,QAAQ,CAAC,0BAA0B,CAAC,MAAM,SAAS;gBAClF,MAAM,aAAa,YAAY,IAAI,CAAC,CAAA,MAAO,CAAC,GAAG,QAAQ,KAAK,EAAE,IAAI,gBAAgB,MAAM,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM;gBACvH,IAAI,cAAc,MACd,MAAM,IAAI,MAAM,CAAC,YAAY,EAAE,MAAM,MAAM,CAAC,6BAA6B,EAAE,MAAM,SAAS,EAAE;gBAChG,QAAQ,WAAW,UAAU;YACjC;YACA,IAAI,SAAS,MACT,OAAO;YACX,IAAI,MAAM,kBAAkB,CAAC,aAAa,IAAI,MAC1C,OAAO;YACX,OAAO,IAAI,CAAC,gBAAgB,CAAC,MAAM,kBAAkB,EAAE,MAAM,MAAM,CAAC,WAAW,EAAE;QACrF;IACJ;IACA,qBAAqB,KAAK,EAAE;QACxB,MAAM,mBAAmB,CAAC,GAAG,QAAQ,oBAAoB,EAAE,MAAM,MAAM,CAAC,WAAW,EAAE;QACrF,MAAM,aAAa,iBAAiB,QAAQ,CAAC;QAC7C,MAAM,kBAAkB,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,aAAa;QACrE,MAAM,eAAe,IAAI,CAAC,oBAAoB,CAAC,sBAAsB,CAAC,gBAAgB;QACtF,IAAI,gBAAgB,MAAM;YACtB,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,0BAA0B,aAAa,0CAA0C;YAClG,OAAO;QACX;QACA,MAAM,WAAW,aAAa,OAAO;QACrC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,gCAAgC,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,UAAU,IAAI,kBAAkB;QAClH,OAAO,IAAI,OAAO,eAAe,CAAC,YAAY,UAAU,CAAC,GAAG,QAAQ,SAAS,EAAE,IAAI,CAAC,iBAAiB,CAAC,OAAO;IACjH;IACA,iBAAiB,KAAK,EAAE;QACpB,MAAM,mBAAmB,CAAC,GAAG,QAAQ,oBAAoB,EAAE,MAAM,MAAM,CAAC,WAAW,EAAE;QACrF,MAAM,aAAa,iBAAiB,QAAQ,CAAC;QAC7C,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,4BAA4B,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,UAAU,IAAI,kBAAkB;QAC9G,OAAO,IAAI,OAAO,WAAW,CAAC;IAClC;IACA,gBAAgB,KAAK,EAAE;QACnB,MAAM,mBAAmB,CAAC,GAAG,QAAQ,oBAAoB,EAAE,MAAM,MAAM,CAAC,WAAW,EAAE;QACrF,MAAM,aAAa,iBAAiB,QAAQ,CAAC;QAC7C,MAAM,kBAAkB,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,aAAa;QACrE,MAAM,eAAe,IAAI,CAAC,oBAAoB,CAAC,sBAAsB,CAAC,gBAAgB;QACtF,IAAI,gBAAgB,MAAM;YACtB,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,qBAAqB,aAAa,0CAA0C;YAC7F,OAAO;QACX;QACA,MAAM,gBAAgB,aAAa,kBAAkB,CAAC,MAAM,MAAM,CAAC,cAAc;QACjF,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,2BAA2B,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,UAAU,IACnF,qBAAqB,gBAAgB,kBAAkB;QAC3D,OAAO,IAAI,OAAO,UAAU,CAAC,YAAY;IAC7C;IACA,kBAAkB,KAAK,EAAE;QACrB,MAAM,QAAQ,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,KAAK;QACnD,MAAM,UAAU,CAAC,GAAG,QAAQ,QAAQ,EAAE,MAAM,MAAM,CAAC,QAAQ;QAC3D,MAAM,UAAU,CAAC,GAAG,QAAQ,oBAAoB,EAAE,MAAM,MAAM,CAAC,WAAW,EAAE,IAAI,OAAO,GAAG,QAAQ,CAAC;QACnG,MAAM,OAAO,OAAO,CAAC,GAAG,QAAQ,QAAQ,EAAE,MAAM,MAAM,CAAC,IAAI;QAC3D,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,yBAAyB,QAAQ,eAAe,UAAU,YAAY,UAAU,MAAM;QACxG,OAAO,IAAI,OAAO,iBAAiB,CAAC,OAAO,SAAS,SAAS;IACjE;IACA,qBAAqB,KAAK,EAAE;QACxB,MAAM,QAAQ,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,KAAK;QACnD,MAAM,UAAU,CAAC,GAAG,QAAQ,QAAQ,EAAE,MAAM,MAAM,CAAC,QAAQ;QAC3D,MAAM,UAAU;YAAC,CAAC,GAAG,QAAQ,QAAQ,EAAE,MAAM,MAAM,CAAC,OAAO,CAAC,IAAI;YAAG,CAAC,GAAG,QAAQ,QAAQ,EAAE,MAAM,MAAM,CAAC,OAAO,CAAC,IAAI;SAAE;QACpH,MAAM,eAAe,OAAO,CAAC,GAAG,QAAQ,QAAQ,EAAE,MAAM,MAAM,CAAC,aAAa;QAC5E,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,4BAA4B,QAAQ,eAAe,UAAU,oBAAoB,eAAe,cAAc;QAChI,OAAO,IAAI,OAAO,oBAAoB,CAAC,OAAO,SAAS,SAAS;IACpE;IACA,mBAAmB,KAAK,EAAE;QACtB,MAAM,QAAQ,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,KAAK;QACnD,MAAM,UAAU,CAAC,GAAG,QAAQ,QAAQ,EAAE,MAAM,MAAM,CAAC,QAAQ;QAC3D,MAAM,UAAU,CAAC,GAAG,QAAQ,oBAAoB,EAAE,MAAM,MAAM,CAAC,WAAW,EAAE,IAAI,OAAO,GAAG,QAAQ,CAAC;QACnG,MAAM,YAAY,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,SAAS;QAC3D,MAAM,gBAAgB,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,cAAc;QACpE,MAAM,UAAU;YAAC,CAAC,GAAG,QAAQ,QAAQ,EAAE,MAAM,MAAM,CAAC,OAAO,CAAC,IAAI;YAAG,CAAC,GAAG,QAAQ,QAAQ,EAAE,MAAM,MAAM,CAAC,OAAO,CAAC,IAAI;SAAE;QACpH,MAAM,kBAAkB,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,MAAM;QAC9D,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,0BAA0B,QAAQ,eAAe,UAAU,eAAe,UACxF,iBAAiB,YAAY,iBAAiB,kBAAkB,cAAc;QAClF,OAAO,IAAI,OAAO,kBAAkB,CAAC,OAAO,SAAS,SAAS,WAAW,eAAe,SAAS;IACrG;IACA,mBAAmB,KAAK,EAAE;QACtB,MAAM,QAAQ,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,KAAK;QACnD,MAAM,UAAU,CAAC,GAAG,QAAQ,QAAQ,EAAE,MAAM,MAAM,CAAC,QAAQ;QAC3D,MAAM,UAAU,CAAC,GAAG,QAAQ,oBAAoB,EAAE,MAAM,MAAM,CAAC,WAAW,EAAE,IAAI,OAAO,GAAG,QAAQ,CAAC;QACnG,MAAM,YAAY,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,SAAS;QAC3D,MAAM,gBAAgB,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,cAAc;QACpE,MAAM,UAAU;YAAC,CAAC,GAAG,QAAQ,QAAQ,EAAE,MAAM,MAAM,CAAC,OAAO,CAAC,IAAI;YAAG,CAAC,GAAG,QAAQ,QAAQ,EAAE,MAAM,MAAM,CAAC,OAAO,CAAC,IAAI;SAAE;QACpH,MAAM,SAAS,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,MAAM;QACrD,MAAM,kBAAkB,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,gBAAgB;QACxE,MAAM,gBAAgB,OAAO,CAAC,GAAG,QAAQ,QAAQ,EAAE,MAAM,MAAM,CAAC,cAAc;QAC9E,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,0BAA0B,QAAQ,eAAe,UAAU,eAAe,UAAU,qBAAqB,gBACvH,iBAAiB,YAAY,iBAAiB,kBAAkB,iBAAiB,SAAS,cAAc;QAC5G,OAAO,IAAI,OAAO,kBAAkB,CAAC,OAAO,SAAS,SAAS,WAAW,eAAe,SAAS,QAAQ,iBAAiB;IAC9H;IACA,mBAAmB,KAAK,EAAE;QACtB,MAAM,QAAQ,CAAC,GAAG,QAAQ,KAAK,EAAE,MAAM,MAAM,CAAC,KAAK;QACnD,MAAM,UAAU,CAAC,GAAG,QAAQ,QAAQ,EAAE,MAAM,MAAM,CAAC,QAAQ;QAC3D,MAAM,UAAU,CAAC,GAAG,QAAQ,oBAAoB,EAAE,MAAM,MAAM,CAAC,WAAW,EAAE,IAAI,OAAO,GAAG,QAAQ,CAAC;QACnG,MAAM,QAAQ,CAAC,GAAG,QAAQ,oBAAoB,EAAE,MAAM,MAAM,CAAC,KAAK,EAAE,QAAQ;QAC5E,OAAO,IAAI,OAAO,kBAAkB,CAAC,OAAO,SAAS,SAAS;IAClE;IACA;;;;;;;;KAQC,GACD,MAAM,cAAc,MAAM,EAAE,kBAAkB,EAAE,qBAAqB,EAAE,gBAAgB,EAAE;QACrF,MAAM,uBAAuB,CAAC;QAC9B,MAAM,oBAAoB,OAAO;YAC7B,IAAI,gBAAgB,oBAChB,OAAO;YACX,MAAM,oBAAoB,YAAY,QAAQ;YAC9C,oBAAoB,CAAC,kBAAkB,IAAI,CAAC,oBAAoB,CAAC,kBAAkB,GAAG,CAAC,MAAM,IAAI,CAAC,QAAQ,CAAC,oBAAoB,CAAC,YAAY,EAAE,SAAS;YACvJ,OAAO,oBAAoB,CAAC,kBAAkB;QAClD;QACA,MAAM,eAAe,EAAE;QACvB,KAAK,IAAI,SAAS,OAAQ;YACtB,IAAI;YACJ,OAAQ,MAAM,IAAI;gBACd,KAAK;oBACD,cAAc,IAAI,CAAC,eAAe,CAAC;oBACnC;gBACJ,KAAK;oBACD,cAAc,IAAI,CAAC,gBAAgB,CAAC;oBACpC;gBACJ,KAAK;oBACD,cAAc,IAAI,CAAC,oBAAoB,CAAC;oBACxC;gBACJ,KAAK;oBACD,cAAc,IAAI,CAAC,iBAAiB,CAAC;oBACrC;gBACJ,KAAK;oBACD,cAAc,IAAI,CAAC,oBAAoB,CAAC;oBACxC;gBACJ,KAAK;oBACD,cAAc,IAAI,CAAC,kBAAkB,CAAC;oBACtC;gBACJ,KAAK;oBACD,cAAc,IAAI,CAAC,kBAAkB,CAAC;oBACtC;gBACJ,KAAK;oBACD,cAAc,IAAI,CAAC,kBAAkB,CAAC;oBACtC;YACR;YACA,IAAI,eAAe,MACf;YACJ,MAAM,YAAY,MAAM,WAAW,IAAI,OAAO,mBAAmB,MAAM,kBAAkB,MAAM,WAAW;YAC1G,YAAY,IAAI,GAAG;gBACf,WAAW;gBACX,MAAM,MAAM,MAAM;gBAClB;YACJ;YACA,aAAa,IAAI,CAAC;QACtB;QACA,KAAK,IAAI,YAAY,IAAI,CAAC,SAAS,CAAE;YACjC,MAAM,SAAS;QACnB;IACJ;IACA,MAAM,wBAAwB,UAAU,EAAE,eAAe,EAAE,YAAY,EAAE;QACrE,MAAM,qBAAqB,aAAa,YAAY;QACpD,mBAAmB,CAAC,kBAAkB,kBAAkB;QACxD,kGAAkG;QAClG,IAAI,SAAS,MAAM,IAAI,CAAC,oBAAoB,CAAC,MAAM,CAAC,sBAAsB,CAAC;YAAC;YAAsC;YAAiC;SAAiC,EAAE,EAAE,EAAE,iBAAiB;QAC3M,IAAI,cAAc,MAAM;YACpB,MAAM,4BAA4B,CAAC,GAAG,QAAQ,aAAa,EAAE,QAAQ,CAAA,MAAO,IAAI,MAAM,KAAK;YAC3F,IAAI,8BAA8B,CAAC,GAAG;gBAClC,OAAO,MAAM,CAAC,GAAG,4BAA4B;YAC7C,8GAA8G;YAClH;QACJ;QACA,IAAI,OAAO,MAAM,GAAG,GAAG;YACnB,MAAM,IAAI,CAAC,aAAa,CAAC,QAAQ,cAAc,cAAc,cAAc,WAAW,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK;YAC9G,aAAa,MAAM,CAAC,OAAO,MAAM,GAAG,EAAE,CAAC,MAAM;QACjD;QACA,OAAO;IACX;IACA,MAAM,qBAAqB,UAAU,EAAE,eAAe,EAAE,YAAY,EAAE;QAClE,MAAM,qBAAqB,aAAa,YAAY;QACpD,mBAAmB,CAAC,kBAAkB,kBAAkB;QACxD,8FAA8F;QAC9F,IAAI,SAAS,MAAM,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,sBAAsB,CAAC;YAAC;YAAkC;YAAqC;YAAkC;YAAmC;SAAkC,EAAE,EAAE,EAAE,iBAAiB;QACrR,IAAI,cAAc,MAAM;YACpB,MAAM,4BAA4B,CAAC,GAAG,QAAQ,aAAa,EAAE,QAAQ,CAAA,MAAO,IAAI,MAAM,KAAK;YAC3F,IAAI,8BAA8B,CAAC,GAAG;gBAClC,OAAO,MAAM,CAAC,GAAG,4BAA4B;YAC7C,0GAA0G;YAC9G;QACJ;QACA,IAAI,OAAO,MAAM,GAAG,GAAG;YACnB,MAAM,IAAI,CAAC,aAAa,CAAC,QAAQ,cAAc,cAAc,cAAc,WAAW,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK;YAC9G,aAAa,MAAM,CAAC,OAAO,MAAM,GAAG,EAAE,CAAC,MAAM;QACjD;QACA,OAAO;IACX;IACA,MAAM,YAAY,eAAe,EAAE,YAAY,EAAE;QAC7C,gBAAgB,CAAC,eAAe,EAAE;QAClC,MAAM,eAAe,MAAM,IAAI,CAAC,QAAQ,CAAC,oBAAoB,CAAC;QAC9D,MAAM,qBAAqB,aAAa,YAAY;QACpD,YAAY,CAAC,EAAE,GAAG,MAAM,IAAI,CAAC,uBAAuB,CAAC,YAAY,CAAC,EAAE,EAAE,iBAAiB;QACvF,YAAY,CAAC,EAAE,GAAG,MAAM,IAAI,CAAC,oBAAoB,CAAC,YAAY,CAAC,EAAE,EAAE,iBAAiB;QACpF,OAAO;YACH,UAAU;YACV,aAAa;QACjB;IACJ;IACA;;;;KAIC,GACD,MAAM,UAAU,eAAe,EAAE,YAAY,EAAE,8BAA8B,EAAE;QAC3E,IAAI,CAAC,OAAO,GAAG;QACf,IAAI;QACJ,OAAO;YACH,MAAM,IAAI,CAAC,WAAW,CAAC,iBAAiB,cAAc,IAAI,CAAC,CAAC,EAAE,WAAW,EAAE,QAAQ,EAAE;gBACjF,kBAAkB;gBAClB,eAAe;gBACf,IAAI,kCAAkC,MAClC,OAAO,+BAA+B,aAAa;YAC3D,GAAG,KAAK,CAAC,CAAA;gBACL,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,+CAA+C;YACrE;YACA,IAAI,IAAI,CAAC,OAAO,EACZ;YACJ,IAAI,CAAC,OAAO,GAAG,WAAW,MAAM,IAAI,CAAC,mBAAmB,GAAG;QAC/D;QACA,MAAM;IACV;IACA,OAAO;QACH,IAAI,CAAC,SAAS;QACd,OAAO,QAAQ,OAAO;IAC1B;IACA,MAAM,OAAO;QACT,IAAI,CAAC,OAAO,GAAG;QACf,IAAI,IAAI,CAAC,OAAO,IAAI,MAChB,aAAa,IAAI,CAAC,OAAO;IACjC;IACA,iBAAiB,GAAG,EAAE;QAClB,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC;IACxB;IACA,mBAAmB,GAAG,EAAE;QACpB,MAAM,QAAQ,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC;QACrC,IAAI,SAAS,GAAG;YACZ,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO;YAC7B,OAAO;QACX;QACA,OAAO;IACX;AACJ;AACA,QAAQ,0BAA0B,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 6005, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/StarknetChainType.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 6012, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/spv_swap/SpvVaultContractAbi.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.SpvVaultContractAbi = void 0;\r\nexports.SpvVaultContractAbi = [\r\n    {\r\n        \"type\": \"impl\",\r\n        \"name\": \"SpvVaultManagerImpl\",\r\n        \"interface_name\": \"spv_swap_vault::ISpvVaultManager\"\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"core::integer::u256\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"low\",\r\n                \"type\": \"core::integer::u128\"\r\n            },\r\n            {\r\n                \"name\": \"high\",\r\n                \"type\": \"core::integer::u128\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"spv_swap_vault::structs::BitcoinVaultTransactionData\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"recipient\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            },\r\n            {\r\n                \"name\": \"amount\",\r\n                \"type\": \"(core::integer::u64, core::integer::u64)\"\r\n            },\r\n            {\r\n                \"name\": \"caller_fee\",\r\n                \"type\": \"(core::integer::u64, core::integer::u64)\"\r\n            },\r\n            {\r\n                \"name\": \"fronting_fee\",\r\n                \"type\": \"(core::integer::u64, core::integer::u64)\"\r\n            },\r\n            {\r\n                \"name\": \"execution_handler_fee_amount_0\",\r\n                \"type\": \"core::integer::u64\"\r\n            },\r\n            {\r\n                \"name\": \"execution_hash\",\r\n                \"type\": \"core::felt252\"\r\n            },\r\n            {\r\n                \"name\": \"execution_expiry\",\r\n                \"type\": \"core::integer::u32\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"core::byte_array::ByteArray\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"data\",\r\n                \"type\": \"core::array::Array::<core::bytes_31::bytes31>\"\r\n            },\r\n            {\r\n                \"name\": \"pending_word\",\r\n                \"type\": \"core::felt252\"\r\n            },\r\n            {\r\n                \"name\": \"pending_word_len\",\r\n                \"type\": \"core::integer::u32\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"btc_relay::structs::blockheader::BlockHeader\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"reversed_version\",\r\n                \"type\": \"core::integer::u32\"\r\n            },\r\n            {\r\n                \"name\": \"previous_blockhash\",\r\n                \"type\": \"[core::integer::u32; 8]\"\r\n            },\r\n            {\r\n                \"name\": \"merkle_root\",\r\n                \"type\": \"[core::integer::u32; 8]\"\r\n            },\r\n            {\r\n                \"name\": \"reversed_timestamp\",\r\n                \"type\": \"core::integer::u32\"\r\n            },\r\n            {\r\n                \"name\": \"nbits\",\r\n                \"type\": \"core::integer::u32\"\r\n            },\r\n            {\r\n                \"name\": \"nonce\",\r\n                \"type\": \"core::integer::u32\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"btc_relay::structs::stored_blockheader::StoredBlockHeader\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"blockheader\",\r\n                \"type\": \"btc_relay::structs::blockheader::BlockHeader\"\r\n            },\r\n            {\r\n                \"name\": \"block_hash\",\r\n                \"type\": \"[core::integer::u32; 8]\"\r\n            },\r\n            {\r\n                \"name\": \"chain_work\",\r\n                \"type\": \"core::integer::u256\"\r\n            },\r\n            {\r\n                \"name\": \"block_height\",\r\n                \"type\": \"core::integer::u32\"\r\n            },\r\n            {\r\n                \"name\": \"last_diff_adjustment\",\r\n                \"type\": \"core::integer::u32\"\r\n            },\r\n            {\r\n                \"name\": \"prev_block_timestamps\",\r\n                \"type\": \"[core::integer::u32; 10]\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"core::array::Span::<[core::integer::u32; 8]>\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"snapshot\",\r\n                \"type\": \"@core::array::Array::<[core::integer::u32; 8]>\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"interface\",\r\n        \"name\": \"spv_swap_vault::ISpvVaultManager\",\r\n        \"items\": [\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"open\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"vault_id\",\r\n                        \"type\": \"core::felt252\"\r\n                    },\r\n                    {\r\n                        \"name\": \"relay_contract\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"utxo\",\r\n                        \"type\": \"(core::integer::u256, core::integer::u32)\"\r\n                    },\r\n                    {\r\n                        \"name\": \"confirmations\",\r\n                        \"type\": \"core::integer::u8\"\r\n                    },\r\n                    {\r\n                        \"name\": \"token_0\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"token_1\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"token_0_multiplier\",\r\n                        \"type\": \"core::felt252\"\r\n                    },\r\n                    {\r\n                        \"name\": \"token_1_multiplier\",\r\n                        \"type\": \"core::felt252\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"deposit\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"owner\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"vault_id\",\r\n                        \"type\": \"core::felt252\"\r\n                    },\r\n                    {\r\n                        \"name\": \"raw_token_0_amount\",\r\n                        \"type\": \"core::integer::u64\"\r\n                    },\r\n                    {\r\n                        \"name\": \"raw_token_1_amount\",\r\n                        \"type\": \"core::integer::u64\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"front\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"owner\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"vault_id\",\r\n                        \"type\": \"core::felt252\"\r\n                    },\r\n                    {\r\n                        \"name\": \"withdraw_sequence\",\r\n                        \"type\": \"core::integer::u32\"\r\n                    },\r\n                    {\r\n                        \"name\": \"btc_tx_hash\",\r\n                        \"type\": \"core::integer::u256\"\r\n                    },\r\n                    {\r\n                        \"name\": \"data\",\r\n                        \"type\": \"spv_swap_vault::structs::BitcoinVaultTransactionData\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"claim\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"owner\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"vault_id\",\r\n                        \"type\": \"core::felt252\"\r\n                    },\r\n                    {\r\n                        \"name\": \"transaction\",\r\n                        \"type\": \"core::byte_array::ByteArray\"\r\n                    },\r\n                    {\r\n                        \"name\": \"blockheader\",\r\n                        \"type\": \"btc_relay::structs::stored_blockheader::StoredBlockHeader\"\r\n                    },\r\n                    {\r\n                        \"name\": \"merkle_proof\",\r\n                        \"type\": \"core::array::Span::<[core::integer::u32; 8]>\"\r\n                    },\r\n                    {\r\n                        \"name\": \"position\",\r\n                        \"type\": \"core::integer::u32\"\r\n                    }\r\n                ],\r\n                \"outputs\": [],\r\n                \"state_mutability\": \"external\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"impl\",\r\n        \"name\": \"SpvVaultManagerReadOnlyImpl\",\r\n        \"interface_name\": \"spv_swap_vault::ISpvVaultManagerReadOnly\"\r\n    },\r\n    {\r\n        \"type\": \"struct\",\r\n        \"name\": \"spv_swap_vault::state::SpvVaultState\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"relay_contract\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            },\r\n            {\r\n                \"name\": \"token_0\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            },\r\n            {\r\n                \"name\": \"token_1\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            },\r\n            {\r\n                \"name\": \"token_0_multiplier\",\r\n                \"type\": \"core::felt252\"\r\n            },\r\n            {\r\n                \"name\": \"token_1_multiplier\",\r\n                \"type\": \"core::felt252\"\r\n            },\r\n            {\r\n                \"name\": \"utxo\",\r\n                \"type\": \"(core::integer::u256, core::integer::u32)\"\r\n            },\r\n            {\r\n                \"name\": \"confirmations\",\r\n                \"type\": \"core::integer::u8\"\r\n            },\r\n            {\r\n                \"name\": \"withdraw_count\",\r\n                \"type\": \"core::integer::u32\"\r\n            },\r\n            {\r\n                \"name\": \"deposit_count\",\r\n                \"type\": \"core::integer::u32\"\r\n            },\r\n            {\r\n                \"name\": \"token_0_amount\",\r\n                \"type\": \"core::integer::u64\"\r\n            },\r\n            {\r\n                \"name\": \"token_1_amount\",\r\n                \"type\": \"core::integer::u64\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"enum\",\r\n        \"name\": \"core::option::Option::<spv_swap_vault::structs::BitcoinVaultTransactionData>\",\r\n        \"variants\": [\r\n            {\r\n                \"name\": \"Some\",\r\n                \"type\": \"spv_swap_vault::structs::BitcoinVaultTransactionData\"\r\n            },\r\n            {\r\n                \"name\": \"None\",\r\n                \"type\": \"()\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"interface\",\r\n        \"name\": \"spv_swap_vault::ISpvVaultManagerReadOnly\",\r\n        \"items\": [\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"get_vault\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"owner\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"vault_id\",\r\n                        \"type\": \"core::felt252\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"spv_swap_vault::state::SpvVaultState\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"get_fronter_address\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"owner\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"vault_id\",\r\n                        \"type\": \"core::felt252\"\r\n                    },\r\n                    {\r\n                        \"name\": \"btc_tx_hash\",\r\n                        \"type\": \"core::integer::u256\"\r\n                    },\r\n                    {\r\n                        \"name\": \"data\",\r\n                        \"type\": \"spv_swap_vault::structs::BitcoinVaultTransactionData\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"get_fronter_address_by_id\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"owner\",\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    },\r\n                    {\r\n                        \"name\": \"vault_id\",\r\n                        \"type\": \"core::felt252\"\r\n                    },\r\n                    {\r\n                        \"name\": \"fronting_id\",\r\n                        \"type\": \"core::felt252\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            },\r\n            {\r\n                \"type\": \"function\",\r\n                \"name\": \"parse_bitcoin_tx\",\r\n                \"inputs\": [\r\n                    {\r\n                        \"name\": \"transaction\",\r\n                        \"type\": \"core::byte_array::ByteArray\"\r\n                    }\r\n                ],\r\n                \"outputs\": [\r\n                    {\r\n                        \"type\": \"core::option::Option::<spv_swap_vault::structs::BitcoinVaultTransactionData>\"\r\n                    }\r\n                ],\r\n                \"state_mutability\": \"view\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"constructor\",\r\n        \"name\": \"constructor\",\r\n        \"inputs\": [\r\n            {\r\n                \"name\": \"execution_contract\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"spv_swap_vault::events::Opened\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"btc_tx_hash\",\r\n                \"type\": \"core::integer::u256\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"owner\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"vault_id\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"vout\",\r\n                \"type\": \"core::integer::u32\",\r\n                \"kind\": \"key\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"spv_swap_vault::events::Deposited\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"owner\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"vault_id\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"amounts\",\r\n                \"type\": \"(core::integer::u64, core::integer::u64)\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"deposit_count\",\r\n                \"type\": \"core::integer::u32\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"spv_swap_vault::events::Claimed\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"btc_tx_hash\",\r\n                \"type\": \"core::integer::u256\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"owner\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"vault_id\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"recipient\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"execution_hash\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"caller\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"amounts\",\r\n                \"type\": \"(core::integer::u64, core::integer::u64)\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"withdraw_count\",\r\n                \"type\": \"core::integer::u32\",\r\n                \"kind\": \"data\"\r\n            },\r\n            {\r\n                \"name\": \"fronting_address\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"spv_swap_vault::events::Fronted\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"btc_tx_hash\",\r\n                \"type\": \"core::integer::u256\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"owner\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"vault_id\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"recipient\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"execution_hash\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"caller\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"amounts\",\r\n                \"type\": \"(core::integer::u64, core::integer::u64)\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"spv_swap_vault::events::Closed\",\r\n        \"kind\": \"struct\",\r\n        \"members\": [\r\n            {\r\n                \"name\": \"btc_tx_hash\",\r\n                \"type\": \"core::integer::u256\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"owner\",\r\n                \"type\": \"core::starknet::contract_address::ContractAddress\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"vault_id\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"key\"\r\n            },\r\n            {\r\n                \"name\": \"error\",\r\n                \"type\": \"core::felt252\",\r\n                \"kind\": \"data\"\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        \"type\": \"event\",\r\n        \"name\": \"spv_swap_vault::SpvVaultManager::Event\",\r\n        \"kind\": \"enum\",\r\n        \"variants\": [\r\n            {\r\n                \"name\": \"Opened\",\r\n                \"type\": \"spv_swap_vault::events::Opened\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"Deposited\",\r\n                \"type\": \"spv_swap_vault::events::Deposited\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"Claimed\",\r\n                \"type\": \"spv_swap_vault::events::Claimed\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"Fronted\",\r\n                \"type\": \"spv_swap_vault::events::Fronted\",\r\n                \"kind\": \"nested\"\r\n            },\r\n            {\r\n                \"name\": \"Closed\",\r\n                \"type\": \"spv_swap_vault::events::Closed\",\r\n                \"kind\": \"nested\"\r\n            }\r\n        ]\r\n    }\r\n];\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 6673, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/spv_swap/StarknetSpvWithdrawalData.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetSpvWithdrawalData = void 0;\r\nconst base_1 = require(\"@atomiqlabs/base\");\r\nconst buffer_1 = require(\"buffer\");\r\nconst starknet_1 = require(\"starknet\");\r\nconst Utils_1 = require(\"../../utils/Utils\");\r\nconst StarknetSpvVaultContract_1 = require(\"./StarknetSpvVaultContract\");\r\nclass StarknetSpvWithdrawalData extends base_1.SpvWithdrawalTransactionData {\r\n    fromOpReturnData(data) {\r\n        return StarknetSpvVaultContract_1.StarknetSpvVaultContract.fromOpReturnData(data);\r\n    }\r\n    isRecipient(address) {\r\n        return this.getRecipient().toLowerCase() === address.toLowerCase();\r\n    }\r\n    getTxHash() {\r\n        return BigInt(\"0x\" + buffer_1.Buffer.from(this.btcTx.txid, \"hex\").reverse().toString(\"hex\"));\r\n    }\r\n    getFrontingAmount() {\r\n        return [this.rawAmounts[0] + this.getExecutionFee()[0], this.rawAmounts[1]];\r\n    }\r\n    serialize() {\r\n        return {\r\n            type: \"STARKNET\",\r\n            ...super.serialize()\r\n        };\r\n    }\r\n    serializeToStruct() {\r\n        const callerFee = this.getCallerFee();\r\n        const frontingFee = this.getFrontingFee();\r\n        const executionFee = this.getExecutionFee();\r\n        return {\r\n            recipient: this.recipient,\r\n            amount: starknet_1.cairo.tuple(this.rawAmounts[0], this.rawAmounts[1]),\r\n            caller_fee: starknet_1.cairo.tuple(callerFee[0], callerFee[1]),\r\n            fronting_fee: starknet_1.cairo.tuple(frontingFee[0], frontingFee[1]),\r\n            execution_handler_fee_amount_0: executionFee[0],\r\n            execution_hash: (0, Utils_1.toBigInt)(this.executionHash) ?? 0n,\r\n            execution_expiry: BigInt(this.executionExpiry)\r\n        };\r\n    }\r\n    serializeToFelts() {\r\n        const callerFee = this.getCallerFee();\r\n        const frontingFee = this.getFrontingFee();\r\n        const executionFee = this.getExecutionFee();\r\n        return [\r\n            this.recipient,\r\n            this.rawAmounts[0],\r\n            this.rawAmounts[1],\r\n            callerFee[0],\r\n            callerFee[1],\r\n            frontingFee[0],\r\n            frontingFee[1],\r\n            executionFee[0],\r\n            (0, Utils_1.toBigInt)(this.executionHash) ?? 0n,\r\n            BigInt(this.executionExpiry)\r\n        ];\r\n    }\r\n}\r\nexports.StarknetSpvWithdrawalData = StarknetSpvWithdrawalData;\r\nbase_1.SpvWithdrawalTransactionData.deserializers[\"STARKNET\"] = StarknetSpvWithdrawalData;\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,yBAAyB,GAAG,KAAK;AACzC,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM,kCAAkC,OAAO,4BAA4B;IACvE,iBAAiB,IAAI,EAAE;QACnB,OAAO,2BAA2B,wBAAwB,CAAC,gBAAgB,CAAC;IAChF;IACA,YAAY,OAAO,EAAE;QACjB,OAAO,IAAI,CAAC,YAAY,GAAG,WAAW,OAAO,QAAQ,WAAW;IACpE;IACA,YAAY;QACR,OAAO,OAAO,OAAO,SAAS,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,OAAO,OAAO,GAAG,QAAQ,CAAC;IACzF;IACA,oBAAoB;QAChB,OAAO;YAAC,IAAI,CAAC,UAAU,CAAC,EAAE,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC,EAAE;YAAE,IAAI,CAAC,UAAU,CAAC,EAAE;SAAC;IAC/E;IACA,YAAY;QACR,OAAO;YACH,MAAM;YACN,GAAG,KAAK,CAAC,WAAW;QACxB;IACJ;IACA,oBAAoB;QAChB,MAAM,YAAY,IAAI,CAAC,YAAY;QACnC,MAAM,cAAc,IAAI,CAAC,cAAc;QACvC,MAAM,eAAe,IAAI,CAAC,eAAe;QACzC,OAAO;YACH,WAAW,IAAI,CAAC,SAAS;YACzB,QAAQ,WAAW,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,EAAE,IAAI,CAAC,UAAU,CAAC,EAAE;YACrE,YAAY,WAAW,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,EAAE,SAAS,CAAC,EAAE;YAC7D,cAAc,WAAW,KAAK,CAAC,KAAK,CAAC,WAAW,CAAC,EAAE,EAAE,WAAW,CAAC,EAAE;YACnE,gCAAgC,YAAY,CAAC,EAAE;YAC/C,gBAAgB,CAAC,GAAG,QAAQ,QAAQ,EAAE,IAAI,CAAC,aAAa,KAAK,EAAE;YAC/D,kBAAkB,OAAO,IAAI,CAAC,eAAe;QACjD;IACJ;IACA,mBAAmB;QACf,MAAM,YAAY,IAAI,CAAC,YAAY;QACnC,MAAM,cAAc,IAAI,CAAC,cAAc;QACvC,MAAM,eAAe,IAAI,CAAC,eAAe;QACzC,OAAO;YACH,IAAI,CAAC,SAAS;YACd,IAAI,CAAC,UAAU,CAAC,EAAE;YAClB,IAAI,CAAC,UAAU,CAAC,EAAE;YAClB,SAAS,CAAC,EAAE;YACZ,SAAS,CAAC,EAAE;YACZ,WAAW,CAAC,EAAE;YACd,WAAW,CAAC,EAAE;YACd,YAAY,CAAC,EAAE;YACf,CAAC,GAAG,QAAQ,QAAQ,EAAE,IAAI,CAAC,aAAa,KAAK,EAAE;YAC/C,OAAO,IAAI,CAAC,eAAe;SAC9B;IACL;AACJ;AACA,QAAQ,yBAAyB,GAAG;AACpC,OAAO,4BAA4B,CAAC,aAAa,CAAC,WAAW,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 6742, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/spv_swap/StarknetSpvVaultData.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetSpvVaultData = void 0;\r\nconst base_1 = require(\"@atomiqlabs/base\");\r\nconst Utils_1 = require(\"../../utils/Utils\");\r\nconst buffer_1 = require(\"buffer\");\r\nconst StarknetSpvWithdrawalData_1 = require(\"./StarknetSpvWithdrawalData\");\r\nclass StarknetSpvVaultData extends base_1.SpvVaultData {\r\n    constructor(ownerOrObj, vaultId, struct, initialUtxo) {\r\n        super();\r\n        if (typeof (ownerOrObj) === \"string\") {\r\n            this.owner = ownerOrObj;\r\n            this.vaultId = vaultId;\r\n            this.relayContract = (0, Utils_1.toHex)(struct.relay_contract);\r\n            this.token0 = {\r\n                token: (0, Utils_1.toHex)(struct.token_0),\r\n                multiplier: (0, Utils_1.toBigInt)(struct.token_0_multiplier),\r\n                rawAmount: (0, Utils_1.toBigInt)(struct.token_0_amount)\r\n            };\r\n            this.token1 = {\r\n                token: (0, Utils_1.toHex)(struct.token_1),\r\n                multiplier: (0, Utils_1.toBigInt)(struct.token_1_multiplier),\r\n                rawAmount: (0, Utils_1.toBigInt)(struct.token_1_amount)\r\n            };\r\n            const txHash = buffer_1.Buffer.from((0, Utils_1.toBigInt)(struct.utxo[\"0\"]).toString(16).padStart(64, \"0\"), \"hex\");\r\n            const vout = (0, Utils_1.toBigInt)(struct.utxo[\"1\"]);\r\n            this.utxo = txHash.reverse().toString(\"hex\") + \":\" + vout.toString(10);\r\n            this.confirmations = Number((0, Utils_1.toBigInt)(struct.confirmations));\r\n            this.withdrawCount = Number((0, Utils_1.toBigInt)(struct.withdraw_count));\r\n            this.depositCount = Number((0, Utils_1.toBigInt)(struct.deposit_count));\r\n            this.initialUtxo = initialUtxo;\r\n        }\r\n        else {\r\n            this.owner = ownerOrObj.owner;\r\n            this.vaultId = BigInt(ownerOrObj.vaultId);\r\n            this.relayContract = ownerOrObj.relayContract;\r\n            this.token0 = {\r\n                token: ownerOrObj.token0.token,\r\n                multiplier: BigInt(ownerOrObj.token0.multiplier),\r\n                rawAmount: BigInt(ownerOrObj.token0.rawAmount)\r\n            };\r\n            this.token1 = {\r\n                token: ownerOrObj.token1.token,\r\n                multiplier: BigInt(ownerOrObj.token1.multiplier),\r\n                rawAmount: BigInt(ownerOrObj.token1.rawAmount)\r\n            };\r\n            this.utxo = ownerOrObj.utxo;\r\n            this.confirmations = ownerOrObj.confirmations;\r\n            this.withdrawCount = ownerOrObj.withdrawCount;\r\n            this.depositCount = ownerOrObj.depositCount;\r\n            this.initialUtxo = ownerOrObj.initialUtxo;\r\n        }\r\n    }\r\n    getBalances() {\r\n        return [\r\n            { ...this.token0, scaledAmount: this.token0.rawAmount * this.token0.multiplier },\r\n            { ...this.token1, scaledAmount: this.token1.rawAmount * this.token1.multiplier }\r\n        ];\r\n    }\r\n    getConfirmations() {\r\n        return this.confirmations;\r\n    }\r\n    getOwner() {\r\n        return this.owner;\r\n    }\r\n    getTokenData() {\r\n        return [this.token0, this.token1];\r\n    }\r\n    getUtxo() {\r\n        return this.isOpened() ? this.utxo : this.initialUtxo;\r\n    }\r\n    getVaultId() {\r\n        return this.vaultId;\r\n    }\r\n    getWithdrawalCount() {\r\n        return this.withdrawCount;\r\n    }\r\n    isOpened() {\r\n        return this.utxo !== \"0000000000000000000000000000000000000000000000000000000000000000:0\";\r\n    }\r\n    serialize() {\r\n        return {\r\n            type: \"STARKNET\",\r\n            owner: this.owner,\r\n            vaultId: this.vaultId.toString(10),\r\n            relayContract: this.relayContract,\r\n            token0: {\r\n                token: this.token0.token,\r\n                multiplier: this.token0.multiplier.toString(10),\r\n                rawAmount: this.token0.rawAmount.toString(10)\r\n            },\r\n            token1: {\r\n                token: this.token1.token,\r\n                multiplier: this.token1.multiplier.toString(10),\r\n                rawAmount: this.token1.rawAmount.toString(10)\r\n            },\r\n            utxo: this.utxo,\r\n            confirmations: this.confirmations,\r\n            withdrawCount: this.withdrawCount,\r\n            depositCount: this.depositCount,\r\n            initialUtxo: this.initialUtxo\r\n        };\r\n    }\r\n    updateState(withdrawalTxOrEvent) {\r\n        if (withdrawalTxOrEvent instanceof base_1.SpvVaultClaimEvent) {\r\n            if (withdrawalTxOrEvent.withdrawCount <= this.withdrawCount)\r\n                return;\r\n            this.token0.rawAmount -= withdrawalTxOrEvent.amounts[0];\r\n            this.token1.rawAmount -= withdrawalTxOrEvent.amounts[1];\r\n            this.withdrawCount = withdrawalTxOrEvent.withdrawCount;\r\n            this.utxo = withdrawalTxOrEvent.btcTxId + \":0\";\r\n        }\r\n        if (withdrawalTxOrEvent instanceof base_1.SpvVaultCloseEvent) {\r\n            this.token0.rawAmount = 0n;\r\n            this.token1.rawAmount = 0n;\r\n            this.utxo = \"0000000000000000000000000000000000000000000000000000000000000000:0\";\r\n        }\r\n        if (withdrawalTxOrEvent instanceof base_1.SpvVaultOpenEvent) {\r\n            if (this.isOpened())\r\n                return;\r\n            this.utxo = withdrawalTxOrEvent.btcTxId + \":\" + withdrawalTxOrEvent.vout;\r\n        }\r\n        if (withdrawalTxOrEvent instanceof base_1.SpvVaultDepositEvent) {\r\n            if (withdrawalTxOrEvent.depositCount <= this.depositCount)\r\n                return;\r\n            this.token0.rawAmount += withdrawalTxOrEvent.amounts[0];\r\n            this.token1.rawAmount += withdrawalTxOrEvent.amounts[1];\r\n            this.depositCount = withdrawalTxOrEvent.depositCount;\r\n        }\r\n        if (withdrawalTxOrEvent instanceof StarknetSpvWithdrawalData_1.StarknetSpvWithdrawalData) {\r\n            if (withdrawalTxOrEvent.getSpentVaultUtxo() !== this.utxo)\r\n                return;\r\n            const amounts = withdrawalTxOrEvent.getTotalOutput();\r\n            this.token0.rawAmount -= amounts[0];\r\n            this.token1.rawAmount -= amounts[1];\r\n            this.withdrawCount++;\r\n            this.utxo = withdrawalTxOrEvent.btcTx.txid + \":0\";\r\n        }\r\n    }\r\n    getDepositCount() {\r\n        return this.depositCount;\r\n    }\r\n}\r\nexports.StarknetSpvVaultData = StarknetSpvVaultData;\r\nbase_1.SpvVaultData.deserializers[\"STARKNET\"] = StarknetSpvVaultData;\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 6896, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/spv_swap/StarknetSpvVaultContract.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetSpvVaultContract = void 0;\r\nconst base_1 = require(\"@atomiqlabs/base\");\r\nconst buffer_1 = require(\"buffer\");\r\nconst StarknetContractBase_1 = require(\"../contract/StarknetContractBase\");\r\nconst StarknetBtcRelay_1 = require(\"../btcrelay/StarknetBtcRelay\");\r\nconst starknet_1 = require(\"starknet\");\r\nconst StarknetAction_1 = require(\"../chain/StarknetAction\");\r\nconst SpvVaultContractAbi_1 = require(\"./SpvVaultContractAbi\");\r\nconst StarknetSpvVaultData_1 = require(\"./StarknetSpvVaultData\");\r\nconst StarknetSpvWithdrawalData_1 = require(\"./StarknetSpvWithdrawalData\");\r\nconst Utils_1 = require(\"../../utils/Utils\");\r\nconst StarknetAddresses_1 = require(\"../chain/modules/StarknetAddresses\");\r\nconst StarknetFees_1 = require(\"../chain/modules/StarknetFees\");\r\nconst spvVaultContractAddreses = {\r\n    [starknet_1.constants.StarknetChainId.SN_SEPOLIA]: \"0x02d581ea838cd5ca46ba08660eddd064d50a0392f618e95310432147928d572e\",\r\n    [starknet_1.constants.StarknetChainId.SN_MAIN]: \"0x01932042992647771f3d0aa6ee526e65359c891fe05a285faaf4d3ffa373e132\"\r\n};\r\nconst STARK_PRIME_MOD = 2n ** 251n + 17n * 2n ** 192n + 1n;\r\nfunction decodeUtxo(utxo) {\r\n    const [txId, vout] = utxo.split(\":\");\r\n    return {\r\n        txHash: BigInt(\"0x\" + buffer_1.Buffer.from(txId, \"hex\").reverse().toString(\"hex\")),\r\n        vout: BigInt(vout)\r\n    };\r\n}\r\nclass StarknetSpvVaultContract extends StarknetContractBase_1.StarknetContractBase {\r\n    constructor(chainInterface, btcRelay, bitcoinRpc, contractAddress = spvVaultContractAddreses[chainInterface.starknetChainId]) {\r\n        super(chainInterface, contractAddress, SpvVaultContractAbi_1.SpvVaultContractAbi);\r\n        this.chainId = \"STARKNET\";\r\n        this.claimTimeout = 180;\r\n        this.maxClaimsPerTx = 10;\r\n        this.logger = (0, Utils_1.getLogger)(\"StarknetSpvVaultContract: \");\r\n        this.btcRelay = btcRelay;\r\n        this.bitcoinRpc = bitcoinRpc;\r\n    }\r\n    //StarknetActions\r\n    Open(signer, vault) {\r\n        const { txHash, vout } = decodeUtxo(vault.getUtxo());\r\n        const tokens = vault.getTokenData();\r\n        if (tokens.length !== 2)\r\n            throw new Error(\"Must specify exactly 2 tokens for vault!\");\r\n        return new StarknetAction_1.StarknetAction(signer, this.Chain, this.contract.populateTransaction.open(vault.getVaultId(), this.btcRelay.contract.address, starknet_1.cairo.tuple(starknet_1.cairo.uint256(txHash), vout), vault.getConfirmations(), tokens[0].token, tokens[1].token, tokens[0].multiplier, tokens[1].multiplier), StarknetSpvVaultContract.GasCosts.OPEN);\r\n    }\r\n    Deposit(signer, vault, rawAmounts) {\r\n        return new StarknetAction_1.StarknetAction(signer, this.Chain, this.contract.populateTransaction.deposit(vault.getOwner(), vault.getVaultId(), rawAmounts[0], rawAmounts[1] ?? 0n), StarknetSpvVaultContract.GasCosts.DEPOSIT);\r\n    }\r\n    Front(signer, vault, data, withdrawalSequence) {\r\n        return new StarknetAction_1.StarknetAction(signer, this.Chain, this.contract.populateTransaction.front(vault.getOwner(), vault.getVaultId(), BigInt(withdrawalSequence), data.getTxHash(), data.serializeToStruct()), StarknetSpvVaultContract.GasCosts.FRONT);\r\n    }\r\n    Claim(signer, vault, data, blockheader, merkle, position) {\r\n        return new StarknetAction_1.StarknetAction(signer, this.Chain, {\r\n            contractAddress: this.contract.address,\r\n            entrypoint: \"claim\",\r\n            calldata: [\r\n                vault.getOwner(),\r\n                vault.getVaultId(),\r\n                ...(0, Utils_1.bufferToByteArray)(buffer_1.Buffer.from(data.btcTx.hex, \"hex\")),\r\n                ...blockheader.serialize(),\r\n                merkle.length,\r\n                ...merkle.map(Utils_1.bufferToU32Array).flat(),\r\n                position,\r\n            ].map(val => (0, Utils_1.toHex)(val, 0))\r\n        }, StarknetSpvVaultContract.GasCosts.CLAIM);\r\n    }\r\n    async checkWithdrawalTx(tx) {\r\n        const result = await this.Chain.provider.callContract({\r\n            contractAddress: this.contract.address,\r\n            entrypoint: \"parse_bitcoin_tx\",\r\n            calldata: (0, Utils_1.bufferToByteArray)(buffer_1.Buffer.from(tx.btcTx.hex, \"hex\"))\r\n        });\r\n        if (result == null)\r\n            throw new Error(\"Failed to parse transaction!\");\r\n    }\r\n    createVaultData(owner, vaultId, utxo, confirmations, tokenData) {\r\n        if (tokenData.length !== 2)\r\n            throw new Error(\"Must specify 2 tokens in tokenData!\");\r\n        return Promise.resolve(new StarknetSpvVaultData_1.StarknetSpvVaultData(owner, vaultId, {\r\n            relay_contract: this.btcRelay.contract.address,\r\n            token_0: tokenData[0].token,\r\n            token_1: tokenData[1].token,\r\n            token_0_multiplier: tokenData[0].multiplier,\r\n            token_1_multiplier: tokenData[1].multiplier,\r\n            utxo: starknet_1.cairo.tuple(starknet_1.cairo.uint256(0), 0),\r\n            confirmations: confirmations,\r\n            withdraw_count: 0,\r\n            deposit_count: 0,\r\n            token_0_amount: 0n,\r\n            token_1_amount: 0n\r\n        }, utxo));\r\n    }\r\n    //Getters\r\n    async getVaultData(owner, vaultId) {\r\n        const struct = await this.contract.get_vault(owner, vaultId);\r\n        if ((0, Utils_1.toHex)(struct.relay_contract) !== (0, Utils_1.toHex)(this.btcRelay.contract.address))\r\n            return null;\r\n        return new StarknetSpvVaultData_1.StarknetSpvVaultData(owner, vaultId, struct);\r\n    }\r\n    async getAllVaults(owner) {\r\n        const openedVaults = new Set();\r\n        await this.Events.findInContractEventsForward([\"spv_swap_vault::events::Opened\", \"spv_swap_vault::events::Closed\"], owner == null ? null : [null, owner], (event) => {\r\n            const owner = (0, Utils_1.toHex)(event.params.owner);\r\n            const vaultId = (0, Utils_1.toBigInt)(event.params.vault_id);\r\n            const vaultIdentifier = owner + \":\" + vaultId.toString(10);\r\n            if (event.name === \"spv_swap_vault::events::Opened\") {\r\n                openedVaults.add(vaultIdentifier);\r\n            }\r\n            else {\r\n                openedVaults.delete(vaultIdentifier);\r\n            }\r\n            return null;\r\n        });\r\n        const vaults = [];\r\n        for (let identifier of openedVaults.keys()) {\r\n            const [owner, vaultIdStr] = identifier.split(\":\");\r\n            const vaultData = await this.getVaultData(owner, BigInt(vaultIdStr));\r\n            if (vaultData != null)\r\n                vaults.push(vaultData);\r\n        }\r\n        return vaults;\r\n    }\r\n    async getWithdrawalState(btcTxId) {\r\n        const txHash = buffer_1.Buffer.from(btcTxId, \"hex\").reverse();\r\n        const txHashU256 = starknet_1.cairo.uint256(\"0x\" + txHash.toString(\"hex\"));\r\n        let result = {\r\n            type: base_1.SpvWithdrawalStateType.NOT_FOUND\r\n        };\r\n        await this.Events.findInContractEventsForward([\"spv_swap_vault::events::Fronted\", \"spv_swap_vault::events::Claimed\", \"spv_swap_vault::events::Closed\"], [\r\n            (0, Utils_1.toHex)(txHashU256.low),\r\n            (0, Utils_1.toHex)(txHashU256.high)\r\n        ], async (event) => {\r\n            switch (event.name) {\r\n                case \"spv_swap_vault::events::Fronted\":\r\n                    result = {\r\n                        type: base_1.SpvWithdrawalStateType.FRONTED,\r\n                        txId: event.txHash,\r\n                        owner: (0, Utils_1.toHex)(event.params.owner),\r\n                        vaultId: (0, Utils_1.toBigInt)(event.params.vault_id),\r\n                        recipient: (0, Utils_1.toHex)(event.params.recipient),\r\n                        fronter: (0, Utils_1.toHex)(event.params.fronting_address)\r\n                    };\r\n                    break;\r\n                case \"spv_swap_vault::events::Claimed\":\r\n                    result = {\r\n                        type: base_1.SpvWithdrawalStateType.CLAIMED,\r\n                        txId: event.txHash,\r\n                        owner: (0, Utils_1.toHex)(event.params.owner),\r\n                        vaultId: (0, Utils_1.toBigInt)(event.params.vault_id),\r\n                        recipient: (0, Utils_1.toHex)(event.params.recipient),\r\n                        claimer: (0, Utils_1.toHex)(event.params.caller),\r\n                        fronter: (0, Utils_1.toHex)(event.params.fronting_address)\r\n                    };\r\n                    break;\r\n                case \"spv_swap_vault::events::Closed\":\r\n                    result = {\r\n                        type: base_1.SpvWithdrawalStateType.CLOSED,\r\n                        txId: event.txHash,\r\n                        owner: (0, Utils_1.toHex)(event.params.owner),\r\n                        vaultId: (0, Utils_1.toBigInt)(event.params.vault_id),\r\n                        error: (0, Utils_1.bigNumberishToBuffer)(event.params.error).toString()\r\n                    };\r\n                    break;\r\n            }\r\n        });\r\n        return result;\r\n    }\r\n    getWithdrawalData(btcTx) {\r\n        return Promise.resolve(new StarknetSpvWithdrawalData_1.StarknetSpvWithdrawalData(btcTx));\r\n    }\r\n    //OP_RETURN data encoding/decoding\r\n    fromOpReturnData(data) {\r\n        return StarknetSpvVaultContract.fromOpReturnData(data);\r\n    }\r\n    static fromOpReturnData(data) {\r\n        let rawAmount0 = 0n;\r\n        let rawAmount1 = 0n;\r\n        let executionHash = null;\r\n        if (data.length === 40) {\r\n            rawAmount0 = data.readBigInt64LE(32).valueOf();\r\n        }\r\n        else if (data.length === 48) {\r\n            rawAmount0 = data.readBigInt64LE(32).valueOf();\r\n            rawAmount1 = data.readBigInt64LE(40).valueOf();\r\n        }\r\n        else if (data.length === 72) {\r\n            rawAmount0 = data.readBigInt64LE(32).valueOf();\r\n            executionHash = data.slice(40, 72).toString(\"hex\");\r\n        }\r\n        else if (data.length === 80) {\r\n            rawAmount0 = data.readBigInt64LE(32).valueOf();\r\n            rawAmount1 = data.readBigInt64LE(40).valueOf();\r\n            executionHash = data.slice(48, 80).toString(\"hex\");\r\n        }\r\n        else {\r\n            throw new Error(\"Invalid OP_RETURN data length!\");\r\n        }\r\n        if (executionHash != null) {\r\n            const executionHashValue = BigInt(\"0x\" + executionHash);\r\n            if (executionHashValue >= STARK_PRIME_MOD)\r\n                throw new Error(\"Execution hash not in range of starknet prime\");\r\n        }\r\n        const recipient = \"0x\" + data.slice(0, 32).toString(\"hex\");\r\n        if (!StarknetAddresses_1.StarknetAddresses.isValidAddress(recipient))\r\n            throw new Error(\"Invalid recipient specified\");\r\n        return { executionHash, rawAmounts: [rawAmount0, rawAmount1], recipient };\r\n    }\r\n    toOpReturnData(recipient, rawAmounts, executionHash) {\r\n        return StarknetSpvVaultContract.toOpReturnData(recipient, rawAmounts, executionHash);\r\n    }\r\n    static toOpReturnData(recipient, rawAmounts, executionHash) {\r\n        if (!StarknetAddresses_1.StarknetAddresses.isValidAddress(recipient))\r\n            throw new Error(\"Invalid recipient specified\");\r\n        if (rawAmounts.length < 1)\r\n            throw new Error(\"At least 1 amount needs to be specified\");\r\n        if (rawAmounts.length > 2)\r\n            throw new Error(\"At most 2 amounts need to be specified\");\r\n        rawAmounts.forEach(val => {\r\n            if (val < 0n)\r\n                throw new Error(\"Negative raw amount specified\");\r\n            if (val >= 2n ** 64n)\r\n                throw new Error(\"Raw amount overflow\");\r\n        });\r\n        if (executionHash != null) {\r\n            const executionHashValue = (0, Utils_1.toBigInt)(executionHash);\r\n            if (executionHashValue < 0n)\r\n                throw new Error(\"Execution hash negative\");\r\n            if (executionHashValue >= STARK_PRIME_MOD)\r\n                throw new Error(\"Execution hash not in range of starknet prime\");\r\n        }\r\n        const recipientBuffer = buffer_1.Buffer.from(recipient.substring(2).padStart(64, \"0\"), \"hex\");\r\n        const amount0Buffer = buffer_1.Buffer.from(rawAmounts[0].toString(16).padStart(16, \"0\"), \"hex\");\r\n        const amount1Buffer = rawAmounts[1] == null || rawAmounts[1] === 0n ? buffer_1.Buffer.alloc(0) : buffer_1.Buffer.from(rawAmounts[1].toString(16).padStart(16, \"0\"), \"hex\");\r\n        const executionHashBuffer = executionHash == null ? buffer_1.Buffer.alloc(0) : buffer_1.Buffer.from(executionHash.substring(2).padStart(64, \"0\"), \"hex\");\r\n        return buffer_1.Buffer.concat([\r\n            recipientBuffer,\r\n            amount0Buffer.reverse(),\r\n            amount1Buffer.reverse(),\r\n            executionHashBuffer\r\n        ]);\r\n    }\r\n    //Actions\r\n    async claim(signer, vault, txs, synchronizer, initAta, txOptions) {\r\n        const result = await this.txsClaim(signer.getAddress(), vault, txs, synchronizer, initAta, txOptions?.feeRate);\r\n        const [signature] = await this.Chain.sendAndConfirm(signer, result, txOptions?.waitForConfirmation, txOptions?.abortSignal);\r\n        return signature;\r\n    }\r\n    async deposit(signer, vault, rawAmounts, txOptions) {\r\n        const result = await this.txsDeposit(signer.getAddress(), vault, rawAmounts, txOptions?.feeRate);\r\n        const [signature] = await this.Chain.sendAndConfirm(signer, result, txOptions?.waitForConfirmation, txOptions?.abortSignal);\r\n        return signature;\r\n    }\r\n    async frontLiquidity(signer, vault, realWithdrawalTx, withdrawSequence, txOptions) {\r\n        const result = await this.txsFrontLiquidity(signer.getAddress(), vault, realWithdrawalTx, withdrawSequence, txOptions?.feeRate);\r\n        const [signature] = await this.Chain.sendAndConfirm(signer, result, txOptions?.waitForConfirmation, txOptions?.abortSignal);\r\n        return signature;\r\n    }\r\n    async open(signer, vault, txOptions) {\r\n        const result = await this.txsOpen(signer.getAddress(), vault, txOptions?.feeRate);\r\n        const [signature] = await this.Chain.sendAndConfirm(signer, result, txOptions?.waitForConfirmation, txOptions?.abortSignal);\r\n        return signature;\r\n    }\r\n    //Transactions\r\n    async txsClaim(signer, vault, txs, synchronizer, initAta, feeRate) {\r\n        if (!vault.isOpened())\r\n            throw new Error(\"Cannot claim from a closed vault!\");\r\n        feeRate ?? (feeRate = await this.Chain.Fees.getFeeRate());\r\n        const txsWithMerkleProofs = [];\r\n        for (let tx of txs) {\r\n            const merkleProof = await this.bitcoinRpc.getMerkleProof(tx.tx.btcTx.txid, tx.tx.btcTx.blockhash);\r\n            this.logger.debug(\"txsClaim(): merkle proof computed: \", merkleProof);\r\n            txsWithMerkleProofs.push({\r\n                ...merkleProof,\r\n                ...tx\r\n            });\r\n        }\r\n        const starknetTxs = [];\r\n        const storedHeaders = await StarknetBtcRelay_1.StarknetBtcRelay.getCommitedHeadersAndSynchronize(signer, this.btcRelay, txsWithMerkleProofs.filter(tx => tx.storedHeader == null).map(tx => {\r\n            return {\r\n                blockhash: tx.tx.btcTx.blockhash,\r\n                blockheight: tx.blockheight,\r\n                requiredConfirmations: vault.getConfirmations()\r\n            };\r\n        }), starknetTxs, synchronizer, feeRate);\r\n        if (storedHeaders == null)\r\n            throw new Error(\"Cannot fetch committed header!\");\r\n        const actions = txsWithMerkleProofs.map(tx => {\r\n            return this.Claim(signer, vault, tx.tx, tx.storedHeader ?? storedHeaders[tx.tx.btcTx.blockhash], tx.merkle, tx.pos);\r\n        });\r\n        let starknetAction = new StarknetAction_1.StarknetAction(signer, this.Chain);\r\n        for (let action of actions) {\r\n            starknetAction.add(action);\r\n            if (starknetAction.ixsLength() >= this.maxClaimsPerTx) {\r\n                await starknetAction.addToTxs(starknetTxs, feeRate);\r\n                starknetAction = new StarknetAction_1.StarknetAction(signer, this.Chain);\r\n            }\r\n        }\r\n        if (starknetAction.ixsLength() > 0) {\r\n            await starknetAction.addToTxs(starknetTxs, feeRate);\r\n        }\r\n        this.logger.debug(\"txsClaim(): \" + starknetTxs.length + \" claim TXs created claiming \" + txs.length + \" txs, owner: \" + vault.getOwner() +\r\n            \" vaultId: \" + vault.getVaultId().toString(10));\r\n        return starknetTxs;\r\n    }\r\n    async txsDeposit(signer, vault, rawAmounts, feeRate) {\r\n        if (!vault.isOpened())\r\n            throw new Error(\"Cannot deposit to a closed vault!\");\r\n        //Approve first\r\n        const vaultTokens = vault.getTokenData();\r\n        const action = new StarknetAction_1.StarknetAction(signer, this.Chain);\r\n        let realAmount0 = 0n;\r\n        let realAmount1 = 0n;\r\n        if (rawAmounts[0] != null && rawAmounts[0] !== 0n) {\r\n            realAmount0 = rawAmounts[0] * vaultTokens[0].multiplier;\r\n            action.add(this.Chain.Tokens.Approve(signer, this.contract.address, vaultTokens[0].token, realAmount0));\r\n        }\r\n        if (rawAmounts[1] != null && rawAmounts[1] !== 0n) {\r\n            realAmount1 = rawAmounts[1] * vaultTokens[1].multiplier;\r\n            action.add(this.Chain.Tokens.Approve(signer, this.contract.address, vaultTokens[1].token, realAmount1));\r\n        }\r\n        action.add(this.Deposit(signer, vault, rawAmounts));\r\n        feeRate ?? (feeRate = await this.Chain.Fees.getFeeRate());\r\n        this.logger.debug(\"txsDeposit(): deposit TX created,\" +\r\n            \" token0: \" + vaultTokens[0].token + \" rawAmount0: \" + rawAmounts[0].toString(10) + \" amount0: \" + realAmount0.toString(10) +\r\n            \" token1: \" + vaultTokens[1].token + \" rawAmount1: \" + (rawAmounts[1] ?? 0n).toString(10) + \" amount1: \" + realAmount1.toString(10));\r\n        return [await action.tx(feeRate)];\r\n    }\r\n    async txsFrontLiquidity(signer, vault, realWithdrawalTx, withdrawSequence, feeRate) {\r\n        if (!vault.isOpened())\r\n            throw new Error(\"Cannot front on a closed vault!\");\r\n        //Approve first\r\n        const vaultTokens = vault.getTokenData();\r\n        const action = new StarknetAction_1.StarknetAction(signer, this.Chain);\r\n        const rawAmounts = realWithdrawalTx.getFrontingAmount();\r\n        let realAmount0 = 0n;\r\n        let realAmount1 = 0n;\r\n        if (rawAmounts[0] != null && rawAmounts[0] !== 0n) {\r\n            realAmount0 = rawAmounts[0] * vaultTokens[0].multiplier;\r\n            action.add(this.Chain.Tokens.Approve(signer, this.contract.address, vaultTokens[0].token, realAmount0));\r\n        }\r\n        if (rawAmounts[1] != null && rawAmounts[1] !== 0n) {\r\n            realAmount1 = rawAmounts[1] * vaultTokens[1].multiplier;\r\n            action.add(this.Chain.Tokens.Approve(signer, this.contract.address, vaultTokens[1].token, realAmount1));\r\n        }\r\n        action.add(this.Front(signer, vault, realWithdrawalTx, withdrawSequence));\r\n        feeRate ?? (feeRate = await this.Chain.Fees.getFeeRate());\r\n        this.logger.debug(\"txsFrontLiquidity(): front TX created,\" +\r\n            \" token0: \" + vaultTokens[0].token + \" rawAmount0: \" + rawAmounts[0].toString(10) + \" amount0: \" + realAmount0.toString(10) +\r\n            \" token1: \" + vaultTokens[1].token + \" rawAmount1: \" + (rawAmounts[1] ?? 0n).toString(10) + \" amount1: \" + realAmount1.toString(10));\r\n        return [await action.tx(feeRate)];\r\n    }\r\n    async txsOpen(signer, vault, feeRate) {\r\n        if (vault.isOpened())\r\n            throw new Error(\"Cannot open an already opened vault!\");\r\n        const action = this.Open(signer, vault);\r\n        feeRate ?? (feeRate = await this.Chain.Fees.getFeeRate());\r\n        this.logger.debug(\"txsOpen(): open TX created, owner: \" + vault.getOwner() +\r\n            \" vaultId: \" + vault.getVaultId().toString(10));\r\n        return [await action.tx(feeRate)];\r\n    }\r\n    async getClaimFee(signer, withdrawalData, feeRate) {\r\n        feeRate ?? (feeRate = await this.Chain.Fees.getFeeRate());\r\n        return StarknetFees_1.StarknetFees.getGasFee(withdrawalData == null ? StarknetSpvVaultContract.GasCosts.CLAIM_OPTIMISTIC_ESTIMATE : StarknetSpvVaultContract.GasCosts.CLAIM, feeRate);\r\n    }\r\n    async getFrontFee(signer, withdrawalData, feeRate) {\r\n        feeRate ?? (feeRate = await this.Chain.Fees.getFeeRate());\r\n        return StarknetFees_1.StarknetFees.getGasFee(StarknetSpvVaultContract.GasCosts.FRONT, feeRate);\r\n    }\r\n}\r\nexports.StarknetSpvVaultContract = StarknetSpvVaultContract;\r\nStarknetSpvVaultContract.GasCosts = {\r\n    DEPOSIT: { l1DataGas: 400, l2Gas: 4000000, l1Gas: 0 },\r\n    OPEN: { l1DataGas: 1200, l2Gas: 3200000, l1Gas: 0 },\r\n    FRONT: { l1DataGas: 800, l2Gas: 12000000, l1Gas: 0 },\r\n    CLAIM: { l1DataGas: 1000, l2Gas: 400000000, l1Gas: 0 },\r\n    CLAIM_OPTIMISTIC_ESTIMATE: { l1DataGas: 1000, l2Gas: 80000000, l1Gas: 0 } //If claimer uses sierra 1.7.0 or later\r\n};\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 7291, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/provider/RpcProviderWithRetries.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.RpcProviderWithRetries = exports.RpcChannelWithRetries = void 0;\r\nconst starknet_1 = require(\"starknet\");\r\nconst Utils_1 = require(\"../../utils/Utils\");\r\nclass RpcChannelWithRetries extends starknet_1.RpcChannel {\r\n    constructor(options, retryPolicy) {\r\n        super(options);\r\n        this.retryPolicy = retryPolicy;\r\n    }\r\n    fetchEndpoint(method, params) {\r\n        return (0, Utils_1.tryWithRetries)(() => super.fetchEndpoint(method, params), this.retryPolicy, e => {\r\n            if (!e.message.startsWith(\"RPC: \"))\r\n                return false;\r\n            const arr = e.message.split(\"\\n\");\r\n            const errorCode = parseInt(arr[arr.length - 1]);\r\n            if (isNaN(errorCode))\r\n                return false;\r\n            if (errorCode < 0)\r\n                return false; //Not defined error, e.g. Rate limit (-32097)\r\n            return true;\r\n        });\r\n    }\r\n}\r\nexports.RpcChannelWithRetries = RpcChannelWithRetries;\r\nclass RpcProviderWithRetries extends starknet_1.RpcProvider {\r\n    constructor(options, retryPolicy) {\r\n        super(options);\r\n        this.channel = new RpcChannelWithRetries({ ...options, waitMode: false }, retryPolicy);\r\n    }\r\n}\r\nexports.RpcProviderWithRetries = RpcProviderWithRetries;\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,sBAAsB,GAAG,QAAQ,qBAAqB,GAAG,KAAK;AACtE,MAAM;AACN,MAAM;AACN,MAAM,8BAA8B,WAAW,UAAU;IACrD,YAAY,OAAO,EAAE,WAAW,CAAE;QAC9B,KAAK,CAAC;QACN,IAAI,CAAC,WAAW,GAAG;IACvB;IACA,cAAc,MAAM,EAAE,MAAM,EAAE;QAC1B,OAAO,CAAC,GAAG,QAAQ,cAAc,EAAE,IAAM,KAAK,CAAC,cAAc,QAAQ,SAAS,IAAI,CAAC,WAAW,EAAE,CAAA;YAC5F,IAAI,CAAC,EAAE,OAAO,CAAC,UAAU,CAAC,UACtB,OAAO;YACX,MAAM,MAAM,EAAE,OAAO,CAAC,KAAK,CAAC;YAC5B,MAAM,YAAY,SAAS,GAAG,CAAC,IAAI,MAAM,GAAG,EAAE;YAC9C,IAAI,MAAM,YACN,OAAO;YACX,IAAI,YAAY,GACZ,OAAO,OAAO,6CAA6C;YAC/D,OAAO;QACX;IACJ;AACJ;AACA,QAAQ,qBAAqB,GAAG;AAChC,MAAM,+BAA+B,WAAW,WAAW;IACvD,YAAY,OAAO,EAAE,WAAW,CAAE;QAC9B,KAAK,CAAC;QACN,IAAI,CAAC,OAAO,GAAG,IAAI,sBAAsB;YAAE,GAAG,OAAO;YAAE,UAAU;QAAM,GAAG;IAC9E;AACJ;AACA,QAAQ,sBAAsB,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 7328, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/starknet/StarknetInitializer.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.StarknetInitializer = exports.initializeStarknet = exports.StarknetAssets = void 0;\r\nconst starknet_1 = require(\"starknet\");\r\nconst StarknetFees_1 = require(\"./chain/modules/StarknetFees\");\r\nconst StarknetChainInterface_1 = require(\"./chain/StarknetChainInterface\");\r\nconst StarknetBtcRelay_1 = require(\"./btcrelay/StarknetBtcRelay\");\r\nconst StarknetSwapContract_1 = require(\"./swaps/StarknetSwapContract\");\r\nconst StarknetChainEventsBrowser_1 = require(\"./events/StarknetChainEventsBrowser\");\r\nconst base_1 = require(\"@atomiqlabs/base\");\r\nconst StarknetSwapData_1 = require(\"./swaps/StarknetSwapData\");\r\nconst StarknetSpvVaultContract_1 = require(\"./spv_swap/StarknetSpvVaultContract\");\r\nconst StarknetSpvVaultData_1 = require(\"./spv_swap/StarknetSpvVaultData\");\r\nconst StarknetSpvWithdrawalData_1 = require(\"./spv_swap/StarknetSpvWithdrawalData\");\r\nconst RpcProviderWithRetries_1 = require(\"./provider/RpcProviderWithRetries\");\r\nexports.StarknetAssets = {\r\n    ETH: {\r\n        address: \"0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7\",\r\n        decimals: 18,\r\n        displayDecimals: 9\r\n    },\r\n    STRK: {\r\n        address: \"0x04718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d\",\r\n        decimals: 18,\r\n        displayDecimals: 9\r\n    },\r\n    WBTC: {\r\n        address: \"0x03fe2b97c1fd336e750087d68b9b867997fd64a2661ff3ca5a7c771641e8e7ac\",\r\n        decimals: 8\r\n    },\r\n    TBTC: {\r\n        address: \"0x04daa17763b286d1e59b97c283C0b8C949994C361e426A28F743c67bDfE9a32f\",\r\n        decimals: 18,\r\n        displayDecimals: 8\r\n    },\r\n    _TESTNET_WBTC_VESU: {\r\n        address: \"0x04861ba938aed21f2cd7740acd3765ac4d2974783a3218367233de0153490cb6\",\r\n        decimals: 8\r\n    }\r\n};\r\nfunction initializeStarknet(options, bitcoinRpc, network) {\r\n    const provider = typeof (options.rpcUrl) === \"string\" ?\r\n        new RpcProviderWithRetries_1.RpcProviderWithRetries({ nodeUrl: options.rpcUrl }) :\r\n        options.rpcUrl;\r\n    const Fees = options.fees ?? new StarknetFees_1.StarknetFees(provider);\r\n    const chainId = options.chainId ??\r\n        (network === base_1.BitcoinNetwork.MAINNET ? starknet_1.constants.StarknetChainId.SN_MAIN : starknet_1.constants.StarknetChainId.SN_SEPOLIA);\r\n    const chainInterface = new StarknetChainInterface_1.StarknetChainInterface(chainId, provider, options.retryPolicy, Fees);\r\n    const btcRelay = new StarknetBtcRelay_1.StarknetBtcRelay(chainInterface, bitcoinRpc, network, options.btcRelayContract);\r\n    const swapContract = new StarknetSwapContract_1.StarknetSwapContract(chainInterface, btcRelay, options.swapContract, options.handlerContracts);\r\n    const spvVaultContract = new StarknetSpvVaultContract_1.StarknetSpvVaultContract(chainInterface, btcRelay, bitcoinRpc, options.spvVaultContract);\r\n    const chainEvents = new StarknetChainEventsBrowser_1.StarknetChainEventsBrowser(chainInterface, swapContract, spvVaultContract);\r\n    return {\r\n        chainId: \"STARKNET\",\r\n        btcRelay,\r\n        chainInterface,\r\n        swapContract,\r\n        chainEvents,\r\n        swapDataConstructor: StarknetSwapData_1.StarknetSwapData,\r\n        spvVaultContract,\r\n        spvVaultDataConstructor: StarknetSpvVaultData_1.StarknetSpvVaultData,\r\n        spvVaultWithdrawalDataConstructor: StarknetSpvWithdrawalData_1.StarknetSpvWithdrawalData\r\n    };\r\n}\r\nexports.initializeStarknet = initializeStarknet;\r\n;\r\nexports.StarknetInitializer = {\r\n    chainId: \"STARKNET\",\r\n    chainType: null,\r\n    initializer: initializeStarknet,\r\n    tokens: exports.StarknetAssets,\r\n    options: null\r\n};\r\n"],"names":[],"mappings":"AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,QAAQ,mBAAmB,GAAG,QAAQ,kBAAkB,GAAG,QAAQ,cAAc,GAAG,KAAK;AACzF,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,QAAQ,cAAc,GAAG;IACrB,KAAK;QACD,SAAS;QACT,UAAU;QACV,iBAAiB;IACrB;IACA,MAAM;QACF,SAAS;QACT,UAAU;QACV,iBAAiB;IACrB;IACA,MAAM;QACF,SAAS;QACT,UAAU;IACd;IACA,MAAM;QACF,SAAS;QACT,UAAU;QACV,iBAAiB;IACrB;IACA,oBAAoB;QAChB,SAAS;QACT,UAAU;IACd;AACJ;AACA,SAAS,mBAAmB,OAAO,EAAE,UAAU,EAAE,OAAO;IACpD,MAAM,WAAW,OAAQ,QAAQ,MAAM,KAAM,WACzC,IAAI,yBAAyB,sBAAsB,CAAC;QAAE,SAAS,QAAQ,MAAM;IAAC,KAC9E,QAAQ,MAAM;IAClB,MAAM,OAAO,QAAQ,IAAI,IAAI,IAAI,eAAe,YAAY,CAAC;IAC7D,MAAM,UAAU,QAAQ,OAAO,IAC3B,CAAC,YAAY,OAAO,cAAc,CAAC,OAAO,GAAG,WAAW,SAAS,CAAC,eAAe,CAAC,OAAO,GAAG,WAAW,SAAS,CAAC,eAAe,CAAC,UAAU;IAC/I,MAAM,iBAAiB,IAAI,yBAAyB,sBAAsB,CAAC,SAAS,UAAU,QAAQ,WAAW,EAAE;IACnH,MAAM,WAAW,IAAI,mBAAmB,gBAAgB,CAAC,gBAAgB,YAAY,SAAS,QAAQ,gBAAgB;IACtH,MAAM,eAAe,IAAI,uBAAuB,oBAAoB,CAAC,gBAAgB,UAAU,QAAQ,YAAY,EAAE,QAAQ,gBAAgB;IAC7I,MAAM,mBAAmB,IAAI,2BAA2B,wBAAwB,CAAC,gBAAgB,UAAU,YAAY,QAAQ,gBAAgB;IAC/I,MAAM,cAAc,IAAI,6BAA6B,0BAA0B,CAAC,gBAAgB,cAAc;IAC9G,OAAO;QACH,SAAS;QACT;QACA;QACA;QACA;QACA,qBAAqB,mBAAmB,gBAAgB;QACxD;QACA,yBAAyB,uBAAuB,oBAAoB;QACpE,mCAAmC,4BAA4B,yBAAyB;IAC5F;AACJ;AACA,QAAQ,kBAAkB,GAAG;;AAE7B,QAAQ,mBAAmB,GAAG;IAC1B,SAAS;IACT,WAAW;IACX,aAAa;IACb,QAAQ,QAAQ,cAAc;IAC9B,SAAS;AACb","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 7405, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/node_modules/%40atomiqlabs/chain-starknet/dist/index.js"],"sourcesContent":["\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n      desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n__exportStar(require(\"./starknet/chain/StarknetAction\"), exports);\r\n__exportStar(require(\"./starknet/chain/StarknetChainInterface\"), exports);\r\n__exportStar(require(\"./starknet/chain/StarknetModule\"), exports);\r\n__exportStar(require(\"./starknet/chain/modules/StarknetFees\"), exports);\r\n__exportStar(require(\"./starknet/chain/modules/StarknetEvents\"), exports);\r\n__exportStar(require(\"./starknet/chain/modules/StarknetTokens\"), exports);\r\n__exportStar(require(\"./starknet/chain/modules/StarknetAddresses\"), exports);\r\n__exportStar(require(\"./starknet/chain/modules/StarknetTransactions\"), exports);\r\n__exportStar(require(\"./starknet/chain/modules/StarknetSignatures\"), exports);\r\n__exportStar(require(\"./starknet/btcrelay/headers/StarknetBtcStoredHeader\"), exports);\r\n__exportStar(require(\"./starknet/btcrelay/headers/StarknetBtcHeader\"), exports);\r\n__exportStar(require(\"./starknet/btcrelay/StarknetBtcRelay\"), exports);\r\n__exportStar(require(\"./starknet/contract/modules/StarknetContractEvents\"), exports);\r\n__exportStar(require(\"./starknet/contract/StarknetContractBase\"), exports);\r\n__exportStar(require(\"./starknet/swaps/StarknetSwapContract\"), exports);\r\n__exportStar(require(\"./starknet/swaps/StarknetSwapData\"), exports);\r\n__exportStar(require(\"./starknet/swaps/StarknetSwapModule\"), exports);\r\n__exportStar(require(\"./starknet/swaps/modules/StarknetLpVault\"), exports);\r\n__exportStar(require(\"./starknet/swaps/modules/StarknetSwapClaim\"), exports);\r\n__exportStar(require(\"./starknet/swaps/modules/StarknetSwapInit\"), exports);\r\n__exportStar(require(\"./starknet/swaps/modules/StarknetSwapRefund\"), exports);\r\n__exportStar(require(\"./starknet/swaps/handlers/IHandler\"), exports);\r\n__exportStar(require(\"./starknet/swaps/handlers/refund/TimelockRefundHandler\"), exports);\r\n__exportStar(require(\"./starknet/swaps/handlers/claim/ClaimHandlers\"), exports);\r\n__exportStar(require(\"./starknet/swaps/handlers/claim/HashlockClaimHandler\"), exports);\r\n__exportStar(require(\"./starknet/swaps/handlers/claim/btc/IBitcoinClaimHandler\"), exports);\r\n__exportStar(require(\"./starknet/swaps/handlers/claim/btc/BitcoinTxIdClaimHandler\"), exports);\r\n__exportStar(require(\"./starknet/swaps/handlers/claim/btc/BitcoinOutputClaimHandler\"), exports);\r\n__exportStar(require(\"./starknet/swaps/handlers/claim/btc/BitcoinNoncedOutputClaimHandler\"), exports);\r\n__exportStar(require(\"./starknet/events/StarknetChainEventsBrowser\"), exports);\r\n__exportStar(require(\"./starknet/wallet/StarknetSigner\"), exports);\r\n__exportStar(require(\"./starknet/wallet/StarknetKeypairWallet\"), exports);\r\n__exportStar(require(\"./starknet/StarknetChainType\"), exports);\r\n__exportStar(require(\"./starknet/StarknetInitializer\"), exports);\r\n__exportStar(require(\"./starknet/spv_swap/StarknetSpvVaultContract\"), exports);\r\n__exportStar(require(\"./starknet/spv_swap/StarknetSpvVaultData\"), exports);\r\n__exportStar(require(\"./starknet/spv_swap/StarknetSpvWithdrawalData\"), exports);\r\n__exportStar(require(\"./starknet/provider/RpcProviderWithRetries\"), exports);\r\n"],"names":[],"mappings":"AACA,IAAI,kBAAkB,4DAAS,yDAAK,eAAe,IAAK,CAAC,OAAO,MAAM,GAAI,SAAS,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE;IAC1F,IAAI,OAAO,WAAW,KAAK;IAC3B,IAAI,OAAO,OAAO,wBAAwB,CAAC,GAAG;IAC9C,IAAI,CAAC,QAAQ,CAAC,SAAS,OAAO,CAAC,EAAE,UAAU,GAAG,KAAK,QAAQ,IAAI,KAAK,YAAY,GAAG;QACjF,OAAO;YAAE,YAAY;YAAM,KAAK;gBAAa,OAAO,CAAC,CAAC,EAAE;YAAE;QAAE;IAC9D;IACA,OAAO,cAAc,CAAC,GAAG,IAAI;AACjC,IAAM,SAAS,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE;IACtB,IAAI,OAAO,WAAW,KAAK;IAC3B,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,EAAE;AAChB,CAAE;AACF,IAAI,eAAe,4DAAS,yDAAK,YAAY,IAAK,SAAS,CAAC,EAAE,QAAO;IACjE,IAAK,IAAI,KAAK,EAAG,IAAI,MAAM,aAAa,CAAC,OAAO,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,UAAS,IAAI,gBAAgB,UAAS,GAAG;AAC3H;AACA,OAAO,cAAc,CAAC,SAAS,cAAc;IAAE,OAAO;AAAK;AAC3D,wJAAyD;AACzD,gKAAiE;AACjE,wJAAyD;AACzD,8JAA+D;AAC/D,gKAAiE;AACjE,gKAAiE;AACjE,mKAAoE;AACpE,sKAAuE;AACvE,oKAAqE;AACrE,4KAA6E;AAC7E,sKAAuE;AACvE,6JAA8D;AAC9D,2KAA4E;AAC5E,iKAAkE;AAClE,8JAA+D;AAC/D,0JAA2D;AAC3D,4JAA6D;AAC7D,iKAAkE;AAClE,mKAAoE;AACpE,kKAAmE;AACnE,oKAAqE;AACrE,2JAA4D;AAC5D,+KAAgF;AAChF,sKAAuE;AACvE,6KAA8E;AAC9E,iLAAkF;AAClF,oLAAqF;AACrF,sLAAuF;AACvF,4LAA6F;AAC7F,qKAAsE;AACtE,yJAA0D;AAC1D,gKAAiE;AACjE,qJAAsD;AACtD,uJAAwD;AACxD,qKAAsE;AACtE,iKAAkE;AAClE,sKAAuE;AACvE,mKAAoE","ignoreList":[0],"debugId":null}}]
}
module.exports=[443147,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},988983,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},368895,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},743293,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},236730,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},804278,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},472080,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BigIntBufferUtils=void 0;let d=a.r(500874);c.BigIntBufferUtils={toBuffer:(a,b="be",c)=>{let e=Array(c);for(let b=0;b<c;b++)e[b]=Number(255n&a),a>>=8n;let f=d.Buffer.from(e);return"be"===b&&f.reverse(),f},fromBuffer:(a,b="be")=>{if("le"===b){let b=d.Buffer.alloc(a.length);a.copy(b),b.reverse(),a=b}let c=0n;for(let b of a)c<<=8n,c|=BigInt(b);return c}}},865011,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StatePredictorUtils=void 0;let d=a.r(500874),e=a.r(472080);class f{static gtBuffer(a,b){for(let c=0;c<a.length;c++){if(a[c]>b[c])return!0;if(a[c]<b[c])break}return!1}static divInPlace(a,b){let c=0;for(let d=0;d<32;d++){let e=a[d]+c,f=Math.floor(e/b);c=e%b*256,a[d]=f}}static addInPlace(a,b){let c=0;for(let d=0;d<32;d++){let e=31-d,f=a[e]+b[e]+c,g=255&f;c=f>>8,a[e]=g}}static nbitsToTarget(a){let b=d.Buffer.alloc(32,0),c=[a>>16&127,a>>8&255,255&a],e=32-(a>>24&255);for(let a=0;a<3;a++)e+a<32&&(b[e+a]=c[a]);return b}static getDifficulty(a){let b=f.nbitsToTarget(a),c=0;for(let a=0;a<32;a++)if(b[a]>0){c=a;break}let e=32-c-3,g=0;for(let a=0;a<3;a++)g|=b[c+a]<<(2-a)*8;let h=d.Buffer.from("00000000FFFF0000000000000000000000000000000000000000000000000000","hex");f.divInPlace(h,g);let i=d.Buffer.alloc(32,0);for(let a=0;a<32-e;a++)i[a+e]=h[a];return i}static getChainwork(a){let b=f.nbitsToTarget(a),c=e.BigIntBufferUtils.fromBuffer(b);return e.BigIntBufferUtils.toBuffer((0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffn&~c)/(c+1n)+1n,"be",32)}}c.StatePredictorUtils=f,f.DIFF_ADJUSTMENT_PERIOD=2016},901536,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},346734,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ChainEvent=void 0,c.ChainEvent=class{}},797174,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SwapEvent=c.SwapEventType=void 0;let d=a.r(346734);!function(a){a[a.INITIALIZE=0]="INITIALIZE",a[a.REFUND=1]="REFUND",a[a.CLAIM=2]="CLAIM"}(c.SwapEventType||(c.SwapEventType={}));class e extends d.ChainEvent{constructor(a){super(),this.escrowHash=a}}c.SwapEvent=e},168633,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ClaimEvent=void 0;let d=a.r(797174);class e extends d.SwapEvent{constructor(a,b){super(a),this.result=b}}c.ClaimEvent=e},490979,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.InitializeEvent=void 0;let d=a.r(797174);class e extends d.SwapEvent{constructor(a,b,c){super(a),this.swapType=b,this.swapData=c}}c.InitializeEvent=e},787071,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.RefundEvent=void 0;let d=a.r(797174);class e extends d.SwapEvent{}c.RefundEvent=e},110055,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Lockable=void 0,c.Lockable=class{constructor(){this.lockedTill=0,this.lockNonce=0}lock(a){if(this.isLocked())return null;this.lockedTill=Date.now()+1e3*a,this.lockNonce++;let b=this.lockNonce;return()=>this.lockNonce===b&&(this.lockedTill=0,!0)}isLocked(){return this.lockedTill>Date.now()}}},865907,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},870917,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},713704,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},792295,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SwapData=void 0;class d{static deserialize(a){let b=d.deserializers[a.type];if(null!=b)return new b(a);throw Error(`No deserializer found for swap data type: ${a.type}`)}}c.SwapData=d,d.deserializers={}},525209,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ChainSwapType=void 0,function(a){a[a.HTLC=0]="HTLC",a[a.CHAIN=1]="CHAIN",a[a.CHAIN_NONCED=2]="CHAIN_NONCED",a[a.CHAIN_TXID=3]="CHAIN_TXID"}(c.ChainSwapType||(c.ChainSwapType={}))},22286,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SwapCommitStateType=void 0,function(a){a[a.EXPIRED=0]="EXPIRED",a[a.NOT_COMMITED=1]="NOT_COMMITED",a[a.COMMITED=2]="COMMITED",a[a.PAID=3]="PAID",a[a.REFUNDABLE=4]="REFUNDABLE"}(c.SwapCommitStateType||(c.SwapCommitStateType={}))},96575,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SignatureVerificationError=void 0;class d extends Error{constructor(a){super(a),Object.setPrototypeOf(this,d.prototype)}}c.SignatureVerificationError=d},661423,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.CannotInitializeATAError=void 0;class d extends Error{constructor(a){super(a),Object.setPrototypeOf(this,d.prototype)}}c.CannotInitializeATAError=d},304570,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SwapDataVerificationError=void 0;class d extends Error{constructor(a){super(a),Object.setPrototypeOf(this,d.prototype)}}c.SwapDataVerificationError=d},904225,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},940495,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},352601,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BitcoinNetwork=void 0,function(a){a[a.MAINNET=0]="MAINNET",a[a.TESTNET=1]="TESTNET",a[a.TESTNET4=2]="TESTNET4",a[a.REGTEST=3]="REGTEST"}(c.BitcoinNetwork||(c.BitcoinNetwork={}))},343160,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},302329,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},363452,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SpvVaultData=void 0;class d{static deserialize(a){if(null!=d.deserializers[a.type])return new d.deserializers[a.type](a)}calculateStateAfter(a){let b=[...this.getBalances()],c=this.getWithdrawalCount(),d=this.getUtxo();for(let e of a){if(e.getSpentVaultUtxo()!==d)throw Error("Invalid transaction, doesn't spend prior vault UTXO!");e.getTotalOutput().forEach((a,c)=>{if(null==b[c])throw Error("Tried to withdraw non-existing token!");if(b[c].rawAmount-=a,b[c].rawAmount<0n)throw Error("Prior transaction withdrew more than available in vault")}),d=e.getCreatedVaultUtxo(),c++}return b.forEach(a=>{a.scaledAmount=a.rawAmount*a.multiplier}),{withdrawalCount:c,balances:b}}}c.SpvVaultData=d,d.deserializers={}},17939,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SpvWithdrawalStateType=void 0,function(a){a[a.CLOSED=-1]="CLOSED",a[a.NOT_FOUND=0]="NOT_FOUND",a[a.CLAIMED=1]="CLAIMED",a[a.FRONTED=2]="FRONTED"}(c.SpvWithdrawalStateType||(c.SpvWithdrawalStateType={}))},198918,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SpvWithdrawalTransactionData=void 0;let d=a.r(500874);class e{static deserialize(a){if(null!=e.deserializers[a.type])return new e.deserializers[a.type](a)}constructor(a){let b;if(a.ins.length<2)throw Error("Need at least 2 inputs");if(a.outs.length<2)throw Error("Need at least 2 outputs");let c=BigInt(a.ins[0].sequence),e=BigInt(a.ins[1].sequence);if((2147483648n&c)!=2147483648n||(2147483648n&e)!=2147483648n)throw Error("nSequence0 high bit not set!");let f=a.locktime+1e9;if(f>=0x100000000)throw Error("Execution expiry overflow");let g=a.outs[1],h=d.Buffer.from(g.scriptPubKey.hex,"hex");if(0===h.length)throw Error("Output 1 empty script");if(106!==h.at(0))throw Error("Output 1 is not OP_RETURN");if(0===h.at(1))throw Error("Output 1 OP_RETURN followed by OP_0");if(76===h.at(1)){let a=h.at(2);if((b=h.subarray(3,3+a)).length!==a)throw Error("Output 1 OP_RETURN data length mismatch!")}else if(75>=h.at(1)){let a=h.at(1);if((b=h.subarray(2,2+a)).length!==a)throw Error("Output 1 OP_RETURN data length mismatch!")}else throw Error("Output 1 invalid push opcode");let i=this.fromOpReturnData(b);this.recipient=i.recipient,this.rawAmounts=i.rawAmounts,this.callerFeeRate=1048575n&c,this.frontingFeeRate=c>>10n&1047552n|e>>20n&1023n,this.executionFeeRate=1048575n&e,this.executionHash=i.executionHash,this.executionExpiry=f,this.btcTx=a}serialize(){return this.btcTx}getRecipient(){return this.recipient}getOutputWithoutFees(){return this.rawAmounts}getCallerFee(){return this.rawAmounts.map(a=>a*this.callerFeeRate/100000n)}getFrontingFee(){return this.rawAmounts.map(a=>a*this.frontingFeeRate/100000n)}getExecutionFee(){return[this.rawAmounts[0]*this.executionFeeRate/100000n]}getTotalOutput(){let a=[...this.getOutputWithoutFees()],b=this.getCallerFee();null!=b&&b.forEach((b,c)=>{if(null!=b&&0n!==b){if(null==a[c])throw Error("Caller fee token out of bounds");a[c]+=b}});let c=this.getFrontingFee();null!=c&&c.forEach((b,c)=>{if(null!=b&&0n!==b){if(null==a[c])throw Error("Fronting fee token out of bounds");a[c]+=b}});let d=this.getExecutionFee();return null!=d&&d.forEach((b,c)=>{if(null!=b&&0n!==b){if(null==a[c])throw Error("Execution fee token out of bounds");a[c]+=b}}),a.forEach((a,b)=>{if(a>=2n**64n)throw Error("Token "+b+" amount out of bounds")}),a}getExecutionData(){return null==this.executionHash?null:{executionHash:this.executionHash,executionExpiry:this.executionExpiry}}getTxId(){return this.btcTx.txid}getSpentVaultUtxo(){let a=this.btcTx.ins[0];return a.txid+":"+a.vout}getCreatedVaultUtxo(){return this.getTxId()+":0"}getNewVaultScript(){return d.Buffer.from(this.btcTx.outs[0].scriptPubKey.hex,"hex")}getNewVaultBtcAmount(){return this.btcTx.outs[0].value}}c.SpvWithdrawalTransactionData=e,e.deserializers={}},783817,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SpvVaultEvent=c.SpvVaultEventType=void 0;let d=a.r(346734);!function(a){a[a.OPEN=0]="OPEN",a[a.DEPOSIT=1]="DEPOSIT",a[a.CLAIM=2]="CLAIM",a[a.CLOSE=3]="CLOSE",a[a.FRONT=4]="FRONT"}(c.SpvVaultEventType||(c.SpvVaultEventType={}));class e extends d.ChainEvent{constructor(a,b){super(),this.owner=a,this.vaultId=b}}c.SpvVaultEvent=e},763728,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SpvVaultCloseEvent=void 0;let d=a.r(783817);class e extends d.SpvVaultEvent{constructor(a,b,c,e){super(a,b),this.eventType=d.SpvVaultEventType.CLOSE,this.btcTxId=c,this.error=e}}c.SpvVaultCloseEvent=e},333218,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SpvVaultClaimEvent=void 0;let d=a.r(783817);class e extends d.SpvVaultEvent{constructor(a,b,c,e,f,g,h,i,j){super(a,b),this.eventType=d.SpvVaultEventType.CLAIM,this.btcTxId=c,this.recipient=e,this.executionHash=f,this.amounts=g,this.caller=h,this.frontingAddress=i,this.withdrawCount=j}}c.SpvVaultClaimEvent=e},295527,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SpvVaultDepositEvent=void 0;let d=a.r(783817);class e extends d.SpvVaultEvent{constructor(a,b,c,e){super(a,b),this.eventType=d.SpvVaultEventType.DEPOSIT,this.amounts=c,this.depositCount=e}}c.SpvVaultDepositEvent=e},834047,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SpvVaultOpenEvent=void 0;let d=a.r(783817);class e extends d.SpvVaultEvent{constructor(a,b,c,e){super(a,b),this.eventType=d.SpvVaultEventType.OPEN,this.btcTxId=c,this.vout=e}}c.SpvVaultOpenEvent=e},708608,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SpvVaultFrontEvent=void 0;let d=a.r(783817);class e extends d.SpvVaultEvent{constructor(a,b,c,e,f,g,h){super(a,b),this.eventType=d.SpvVaultEventType.FRONT,this.btcTxId=c,this.recipient=e,this.executionHash=f,this.amounts=g,this.frontingAddress=h}}c.SpvVaultFrontEvent=e},163846,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),e(a.r(443147),c),e(a.r(988983),c),e(a.r(368895),c),e(a.r(743293),c),e(a.r(236730),c),e(a.r(804278),c),e(a.r(865011),c),e(a.r(901536),c),e(a.r(168633),c),e(a.r(490979),c),e(a.r(787071),c),e(a.r(797174),c),e(a.r(110055),c),e(a.r(865907),c),e(a.r(870917),c),e(a.r(713704),c),e(a.r(792295),c),e(a.r(525209),c),e(a.r(22286),c),e(a.r(96575),c),e(a.r(661423),c),e(a.r(304570),c),e(a.r(904225),c),e(a.r(940495),c),e(a.r(472080),c),e(a.r(352601),c),e(a.r(343160),c),e(a.r(302329),c),e(a.r(363452),c),e(a.r(17939),c),e(a.r(198918),c),e(a.r(346734),c),e(a.r(783817),c),e(a.r(763728),c),e(a.r(333218),c),e(a.r(295527),c),e(a.r(834047),c),e(a.r(708608),c)},21733,(a,b,c)=>{"use strict";function d(a){if(!Number.isSafeInteger(a)||a<0)throw Error("positive integer expected, got "+a)}function e(a,...b){if(!(a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}Object.defineProperty(c,"__esModule",{value:!0}),c.anumber=d,c.abytes=e,c.ahash=function(a){if("function"!=typeof a||"function"!=typeof a.create)throw Error("Hash should be wrapped by utils.wrapConstructor");d(a.outputLen),d(a.blockLen)},c.aexists=function(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")},c.aoutput=function(a,b){e(a);let c=b.outputLen;if(a.length<c)throw Error("digestInto() expects output buffer of length at least "+c)}},519494,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.crypto=void 0;let d=a.r(666680);c.crypto=d&&"object"==typeof d&&"webcrypto"in d?d.webcrypto:d&&"object"==typeof d&&"randomBytes"in d?d:void 0},116981,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Hash=c.nextTick=c.byteSwapIfBE=c.isLE=void 0,c.isBytes=function(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name},c.u8=function(a){return new Uint8Array(a.buffer,a.byteOffset,a.byteLength)},c.u32=function(a){return new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4))},c.createView=function(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)},c.rotr=function(a,b){return a<<32-b|a>>>b},c.rotl=function(a,b){return a<<b|a>>>32-b>>>0},c.byteSwap=f,c.byteSwap32=function(a){for(let b=0;b<a.length;b++)a[b]=f(a[b])},c.bytesToHex=function(a){if((0,e.abytes)(a),g)return a.toHex();let b="";for(let c=0;c<a.length;c++)b+=h[a[c]];return b},c.hexToBytes=function(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);if(g)return Uint8Array.fromHex(a);let b=a.length,c=b/2;if(b%2)throw Error("hex string expected, got unpadded hex of length "+b);let d=new Uint8Array(c);for(let b=0,e=0;b<c;b++,e+=2){let c=j(a.charCodeAt(e)),f=j(a.charCodeAt(e+1));if(void 0===c||void 0===f)throw Error('hex string expected, got non-hex character "'+(a[e]+a[e+1])+'" at index '+e);d[b]=16*c+f}return d},c.asyncLoop=k,c.utf8ToBytes=l,c.toBytes=m,c.concatBytes=function(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];(0,e.abytes)(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c},c.checkOpts=function(a,b){if(void 0!==b&&"[object Object]"!==({}).toString.call(b))throw Error("Options should be object or undefined");return Object.assign(a,b)},c.wrapConstructor=function(a){let b=b=>a().update(m(b)).digest(),c=a();return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=()=>a(),b},c.wrapConstructorWithOpts=function(a){let b=(b,c)=>a(c).update(m(b)).digest(),c=a({});return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=b=>a(b),b},c.wrapXOFConstructorWithOpts=function(a){let b=(b,c)=>a(c).update(m(b)).digest(),c=a({});return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=b=>a(b),b},c.randomBytes=function(a=32){if(d.crypto&&"function"==typeof d.crypto.getRandomValues)return d.crypto.getRandomValues(new Uint8Array(a));if(d.crypto&&"function"==typeof d.crypto.randomBytes)return Uint8Array.from(d.crypto.randomBytes(a));throw Error("crypto.getRandomValues must be defined")};let d=a.r(519494),e=a.r(21733);function f(a){return a<<24&0xff000000|a<<8&0xff0000|a>>>8&65280|a>>>24&255}c.isLE=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0],c.byteSwapIfBE=c.isLE?a=>a:a=>f(a);let g="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,h=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0")),i={_0:48,_9:57,A:65,F:70,a:97,f:102};function j(a){return a>=i._0&&a<=i._9?a-i._0:a>=i.A&&a<=i.F?a-(i.A-10):a>=i.a&&a<=i.f?a-(i.a-10):void 0}async function k(a,b,d){let e=Date.now();for(let f=0;f<a;f++){d(f);let a=Date.now()-e;a>=0&&a<b||(await (0,c.nextTick)(),e+=a)}}function l(a){if("string"!=typeof a)throw Error("utf8ToBytes expected string, got "+typeof a);return new Uint8Array(new TextEncoder().encode(a))}function m(a){return"string"==typeof a&&(a=l(a)),(0,e.abytes)(a),a}c.nextTick=async()=>{},c.Hash=class{clone(){return this._cloneInto()}}},563750,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.HashMD=void 0,c.setBigUint64=f,c.Chi=function(a,b,c){return a&b^~a&c},c.Maj=function(a,b,c){return a&b^a&c^b&c};let d=a.r(21733),e=a.r(116981);function f(a,b,c,d){if("function"==typeof a.setBigUint64)return a.setBigUint64(b,c,d);let e=BigInt(32),f=BigInt(0xffffffff),g=Number(c>>e&f),h=Number(c&f),i=4*!!d,j=4*!d;a.setUint32(b+i,g,d),a.setUint32(b+j,h,d)}class g extends e.Hash{constructor(a,b,c,d){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=a,this.outputLen=b,this.padOffset=c,this.isLE=d,this.buffer=new Uint8Array(a),this.view=(0,e.createView)(this.buffer)}update(a){(0,d.aexists)(this);let{view:b,buffer:c,blockLen:f}=this,g=(a=(0,e.toBytes)(a)).length;for(let d=0;d<g;){let h=Math.min(f-this.pos,g-d);if(h===f){let b=(0,e.createView)(a);for(;f<=g-d;d+=f)this.process(b,d);continue}c.set(a.subarray(d,d+h),this.pos),this.pos+=h,d+=h,this.pos===f&&(this.process(b,0),this.pos=0)}return this.length+=a.length,this.roundClean(),this}digestInto(a){(0,d.aexists)(this),(0,d.aoutput)(a,this),this.finished=!0;let{buffer:b,view:c,blockLen:g,isLE:h}=this,{pos:i}=this;b[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>g-i&&(this.process(c,0),i=0);for(let a=i;a<g;a++)b[a]=0;f(c,g-8,BigInt(8*this.length),h),this.process(c,0);let j=(0,e.createView)(a),k=this.outputLen;if(k%4)throw Error("_sha2: outputLen should be aligned to 32bit");let l=k/4,m=this.get();if(l>m.length)throw Error("_sha2: outputLen bigger than state");for(let a=0;a<l;a++)j.setUint32(4*a,m[a],h)}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}_cloneInto(a){a||(a=new this.constructor),a.set(...this.get());let{blockLen:b,buffer:c,length:d,finished:e,destroyed:f,pos:g}=this;return a.length=d,a.pos=g,a.finished=e,a.destroyed=f,d%b&&a.buffer.set(c),a}}c.HashMD=g},132267,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.sha224=c.sha256=c.SHA256=void 0;let d=a.r(563750),e=a.r(116981),f=new Uint32Array([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),g=new Uint32Array([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),h=new Uint32Array(64);class i extends d.HashMD{constructor(a=32){super(64,a,8,!1),this.A=0|g[0],this.B=0|g[1],this.C=0|g[2],this.D=0|g[3],this.E=0|g[4],this.F=0|g[5],this.G=0|g[6],this.H=0|g[7]}get(){let{A:a,B:b,C:c,D:d,E:e,F:f,G:g,H:h}=this;return[a,b,c,d,e,f,g,h]}set(a,b,c,d,e,f,g,h){this.A=0|a,this.B=0|b,this.C=0|c,this.D=0|d,this.E=0|e,this.F=0|f,this.G=0|g,this.H=0|h}process(a,b){for(let c=0;c<16;c++,b+=4)h[c]=a.getUint32(b,!1);for(let a=16;a<64;a++){let b=h[a-15],c=h[a-2],d=(0,e.rotr)(b,7)^(0,e.rotr)(b,18)^b>>>3,f=(0,e.rotr)(c,17)^(0,e.rotr)(c,19)^c>>>10;h[a]=f+h[a-7]+d+h[a-16]|0}let{A:c,B:g,C:i,D:j,E:k,F:l,G:m,H:n}=this;for(let a=0;a<64;a++){let b=n+((0,e.rotr)(k,6)^(0,e.rotr)(k,11)^(0,e.rotr)(k,25))+(0,d.Chi)(k,l,m)+f[a]+h[a]|0,o=((0,e.rotr)(c,2)^(0,e.rotr)(c,13)^(0,e.rotr)(c,22))+(0,d.Maj)(c,g,i)|0;n=m,m=l,l=k,k=j+b|0,j=i,i=g,g=c,c=b+o|0}c=c+this.A|0,g=g+this.B|0,i=i+this.C|0,j=j+this.D|0,k=k+this.E|0,l=l+this.F|0,m=m+this.G|0,n=n+this.H|0,this.set(c,g,i,j,k,l,m,n)}roundClean(){h.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}c.SHA256=i;class j extends i{constructor(){super(28),this.A=-0x3efa6128,this.B=0x367cd507,this.C=0x3070dd17,this.D=-0x8f1a6c7,this.E=-4191439,this.F=0x68581511,this.G=0x64f98fa7,this.H=-0x4105b05c}}c.sha256=(0,e.wrapConstructor)(()=>new i),c.sha224=(0,e.wrapConstructor)(()=>new j)},296461,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.add5L=c.add5H=c.add4H=c.add4L=c.add3H=c.add3L=c.rotlBL=c.rotlBH=c.rotlSL=c.rotlSH=c.rotr32L=c.rotr32H=c.rotrBL=c.rotrBH=c.rotrSL=c.rotrSH=c.shrSL=c.shrSH=c.toBig=void 0,c.fromBig=f,c.split=g,c.add=u;let d=BigInt(0x100000000-1),e=BigInt(32);function f(a,b=!1){return b?{h:Number(a&d),l:Number(a>>e&d)}:{h:0|Number(a>>e&d),l:0|Number(a&d)}}function g(a,b=!1){let c=new Uint32Array(a.length),d=new Uint32Array(a.length);for(let e=0;e<a.length;e++){let{h:g,l:h}=f(a[e],b);[c[e],d[e]]=[g,h]}return[c,d]}let h=(a,b)=>BigInt(a>>>0)<<e|BigInt(b>>>0);c.toBig=h;let i=(a,b,c)=>a>>>c;c.shrSH=i;let j=(a,b,c)=>a<<32-c|b>>>c;c.shrSL=j;let k=(a,b,c)=>a>>>c|b<<32-c;c.rotrSH=k;let l=(a,b,c)=>a<<32-c|b>>>c;c.rotrSL=l;let m=(a,b,c)=>a<<64-c|b>>>c-32;c.rotrBH=m;let n=(a,b,c)=>a>>>c-32|b<<64-c;c.rotrBL=n;let o=(a,b)=>b;c.rotr32H=o;let p=(a,b)=>a;c.rotr32L=p;let q=(a,b,c)=>a<<c|b>>>32-c;c.rotlSH=q;let r=(a,b,c)=>b<<c|a>>>32-c;c.rotlSL=r;let s=(a,b,c)=>b<<c-32|a>>>64-c;c.rotlBH=s;let t=(a,b,c)=>a<<c-32|b>>>64-c;function u(a,b,c,d){let e=(b>>>0)+(d>>>0);return{h:a+c+(e/0x100000000|0)|0,l:0|e}}c.rotlBL=t;let v=(a,b,c)=>(a>>>0)+(b>>>0)+(c>>>0);c.add3L=v;let w=(a,b,c,d)=>b+c+d+(a/0x100000000|0)|0;c.add3H=w;let x=(a,b,c,d)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0);c.add4L=x;let y=(a,b,c,d,e)=>b+c+d+e+(a/0x100000000|0)|0;c.add4H=y;let z=(a,b,c,d,e)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0)+(e>>>0);c.add5L=z;let A=(a,b,c,d,e,f)=>b+c+d+e+f+(a/0x100000000|0)|0;c.add5H=A,c.default={fromBig:f,split:g,toBig:h,shrSH:i,shrSL:j,rotrSH:k,rotrSL:l,rotrBH:m,rotrBL:n,rotr32H:o,rotr32L:p,rotlSH:q,rotlSL:r,rotlBH:s,rotlBL:t,add:u,add3L:v,add3H:w,add4L:x,add4H:y,add5H:A,add5L:z}},670744,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.sha384=c.sha512_256=c.sha512_224=c.sha512=c.SHA384=c.SHA512_256=c.SHA512_224=c.SHA512=void 0;let d=a.r(563750),e=a.r(296461),f=a.r(116981),[g,h]=e.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(a=>BigInt(a))),i=new Uint32Array(80),j=new Uint32Array(80);class k extends d.HashMD{constructor(a=64){super(128,a,16,!1),this.Ah=0x6a09e667,this.Al=-0xc4336f8,this.Bh=-0x4498517b,this.Bl=-0x7b3558c5,this.Ch=0x3c6ef372,this.Cl=-0x16b07d5,this.Dh=-0x5ab00ac6,this.Dl=0x5f1d36f1,this.Eh=0x510e527f,this.El=-0x52197d2f,this.Fh=-0x64fa9774,this.Fl=0x2b3e6c1f,this.Gh=0x1f83d9ab,this.Gl=-0x4be4295,this.Hh=0x5be0cd19,this.Hl=0x137e2179}get(){let{Ah:a,Al:b,Bh:c,Bl:d,Ch:e,Cl:f,Dh:g,Dl:h,Eh:i,El:j,Fh:k,Fl:l,Gh:m,Gl:n,Hh:o,Hl:p}=this;return[a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p]}set(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){this.Ah=0|a,this.Al=0|b,this.Bh=0|c,this.Bl=0|d,this.Ch=0|e,this.Cl=0|f,this.Dh=0|g,this.Dl=0|h,this.Eh=0|i,this.El=0|j,this.Fh=0|k,this.Fl=0|l,this.Gh=0|m,this.Gl=0|n,this.Hh=0|o,this.Hl=0|p}process(a,b){for(let c=0;c<16;c++,b+=4)i[c]=a.getUint32(b),j[c]=a.getUint32(b+=4);for(let a=16;a<80;a++){let b=0|i[a-15],c=0|j[a-15],d=e.default.rotrSH(b,c,1)^e.default.rotrSH(b,c,8)^e.default.shrSH(b,c,7),f=e.default.rotrSL(b,c,1)^e.default.rotrSL(b,c,8)^e.default.shrSL(b,c,7),g=0|i[a-2],h=0|j[a-2],k=e.default.rotrSH(g,h,19)^e.default.rotrBH(g,h,61)^e.default.shrSH(g,h,6),l=e.default.rotrSL(g,h,19)^e.default.rotrBL(g,h,61)^e.default.shrSL(g,h,6),m=e.default.add4L(f,l,j[a-7],j[a-16]),n=e.default.add4H(m,d,k,i[a-7],i[a-16]);i[a]=0|n,j[a]=0|m}let{Ah:c,Al:d,Bh:f,Bl:k,Ch:l,Cl:m,Dh:n,Dl:o,Eh:p,El:q,Fh:r,Fl:s,Gh:t,Gl:u,Hh:v,Hl:w}=this;for(let a=0;a<80;a++){let b=e.default.rotrSH(p,q,14)^e.default.rotrSH(p,q,18)^e.default.rotrBH(p,q,41),x=e.default.rotrSL(p,q,14)^e.default.rotrSL(p,q,18)^e.default.rotrBL(p,q,41),y=p&r^~p&t,z=q&s^~q&u,A=e.default.add5L(w,x,z,h[a],j[a]),B=e.default.add5H(A,v,b,y,g[a],i[a]),C=0|A,D=e.default.rotrSH(c,d,28)^e.default.rotrBH(c,d,34)^e.default.rotrBH(c,d,39),E=e.default.rotrSL(c,d,28)^e.default.rotrBL(c,d,34)^e.default.rotrBL(c,d,39),F=c&f^c&l^f&l,G=d&k^d&m^k&m;v=0|t,w=0|u,t=0|r,u=0|s,r=0|p,s=0|q,({h:p,l:q}=e.default.add(0|n,0|o,0|B,0|C)),n=0|l,o=0|m,l=0|f,m=0|k,f=0|c,k=0|d;let H=e.default.add3L(C,E,G);c=e.default.add3H(H,B,D,F),d=0|H}({h:c,l:d}=e.default.add(0|this.Ah,0|this.Al,0|c,0|d)),({h:f,l:k}=e.default.add(0|this.Bh,0|this.Bl,0|f,0|k)),({h:l,l:m}=e.default.add(0|this.Ch,0|this.Cl,0|l,0|m)),({h:n,l:o}=e.default.add(0|this.Dh,0|this.Dl,0|n,0|o)),({h:p,l:q}=e.default.add(0|this.Eh,0|this.El,0|p,0|q)),({h:r,l:s}=e.default.add(0|this.Fh,0|this.Fl,0|r,0|s)),({h:t,l:u}=e.default.add(0|this.Gh,0|this.Gl,0|t,0|u)),({h:v,l:w}=e.default.add(0|this.Hh,0|this.Hl,0|v,0|w)),this.set(c,d,f,k,l,m,n,o,p,q,r,s,t,u,v,w)}roundClean(){i.fill(0),j.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}c.SHA512=k;class l extends k{constructor(){super(28),this.Ah=-0x73c2c838,this.Al=0x19544da2,this.Bh=0x73e19966,this.Bl=-0x76232b2a,this.Ch=0x1dfab7ae,this.Cl=0x32ff9c82,this.Dh=0x679dd514,this.Dl=0x582f9fcf,this.Eh=0xf6d2b69,this.El=0x7bd44da8,this.Fh=0x77e36f73,this.Fl=0x4c48942,this.Gh=0x3f9d85a8,this.Gl=0x6a1d36c8,this.Hh=0x1112e6ad,this.Hl=-0x6e296d5f}}c.SHA512_224=l;class m extends k{constructor(){super(32),this.Ah=0x22312194,this.Al=-0x3d408d4,this.Bh=-0x60aaa05d,this.Bl=-0x37b39b3e,this.Ch=0x2393b86b,this.Cl=0x6f53b151,this.Dh=-0x69c788e7,this.Dl=0x5940eabd,this.Eh=-0x69d7c11e,this.El=-0x5771001d,this.Fh=-0x41a1e1db,this.Fl=0x53863992,this.Gh=0x2b0199fc,this.Gl=0x2c85b8aa,this.Hh=0xeb72ddc,this.Hl=-0x7e3ad35e}}c.SHA512_256=m;class n extends k{constructor(){super(48),this.Ah=-0x344462a3,this.Al=-0x3efa6128,this.Bh=0x629a292a,this.Bl=0x367cd507,this.Ch=-0x6ea6fea6,this.Cl=0x3070dd17,this.Dh=0x152fecd8,this.Dl=-0x8f1a6c7,this.Eh=0x67332667,this.El=-4191439,this.Fh=-0x714bb579,this.Fl=0x68581511,this.Gh=-0x24f3d1f3,this.Gl=0x64f98fa7,this.Hh=0x47b5481d,this.Hl=-0x4105b05c}}c.SHA384=n,c.sha512=(0,f.wrapConstructor)(()=>new k),c.sha512_224=(0,f.wrapConstructor)(()=>new l),c.sha512_256=(0,f.wrapConstructor)(()=>new m),c.sha384=(0,f.wrapConstructor)(()=>new n)},386983,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.sha512_256=c.sha512_224=c.sha512=c.sha384=c.sha256=c.sha224=void 0;var d=a.r(132267);Object.defineProperty(c,"sha224",{enumerable:!0,get:function(){return d.sha224}}),Object.defineProperty(c,"sha256",{enumerable:!0,get:function(){return d.sha256}});var e=a.r(670744);Object.defineProperty(c,"sha384",{enumerable:!0,get:function(){return e.sha384}}),Object.defineProperty(c,"sha512",{enumerable:!0,get:function(){return e.sha512}}),Object.defineProperty(c,"sha512_224",{enumerable:!0,get:function(){return e.sha512_224}}),Object.defineProperty(c,"sha512_256",{enumerable:!0,get:function(){return e.sha512_256}})},958596,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.hmac=c.HMAC=void 0;let d=a.r(21733),e=a.r(116981);class f extends e.Hash{constructor(a,b){super(),this.finished=!1,this.destroyed=!1,(0,d.ahash)(a);let c=(0,e.toBytes)(b);if(this.iHash=a.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let f=this.blockLen,g=new Uint8Array(f);g.set(c.length>f?a.create().update(c).digest():c);for(let a=0;a<g.length;a++)g[a]^=54;this.iHash.update(g),this.oHash=a.create();for(let a=0;a<g.length;a++)g[a]^=106;this.oHash.update(g),g.fill(0)}update(a){return(0,d.aexists)(this),this.iHash.update(a),this}digestInto(a){(0,d.aexists)(this),(0,d.abytes)(a,this.outputLen),this.finished=!0,this.iHash.digestInto(a),this.oHash.update(a),this.oHash.digestInto(a),this.destroy()}digest(){let a=new Uint8Array(this.oHash.outputLen);return this.digestInto(a),a}_cloneInto(a){a||(a=Object.create(Object.getPrototypeOf(this),{}));let{oHash:b,iHash:c,finished:d,destroyed:e,blockLen:f,outputLen:g}=this;return a.finished=d,a.destroyed=e,a.blockLen=f,a.outputLen=g,a.oHash=b._cloneInto(a.oHash),a.iHash=c._cloneInto(a.iHash),a}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}c.HMAC=f,c.hmac=(a,b,c)=>new f(a,b).update(c).digest(),c.hmac.create=(a,b)=>new f(a,b)},422009,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.notImplemented=c.bitMask=void 0,c.isBytes=f,c.abytes=g,c.abool=function(a,b){if("boolean"!=typeof b)throw Error(a+" boolean expected, got "+b)},c.numberToHexUnpadded=h,c.hexToNumber=i,c.bytesToHex=l,c.hexToBytes=o,c.bytesToNumberBE=function(a){return i(l(a))},c.bytesToNumberLE=function(a){return g(a),i(l(Uint8Array.from(a).reverse()))},c.numberToBytesBE=p,c.numberToBytesLE=function(a,b){return p(a,b).reverse()},c.numberToVarBytesBE=function(a){return o(h(a))},c.ensureBytes=function(a,b,c){let d;if("string"==typeof b)try{d=o(b)}catch(b){throw Error(a+" must be hex string or Uint8Array, cause: "+b)}else if(f(b))d=Uint8Array.from(b);else throw Error(a+" must be hex string or Uint8Array");let e=d.length;if("number"==typeof c&&e!==c)throw Error(a+" of length "+c+" expected, got "+e);return d},c.concatBytes=q,c.equalBytes=function(a,b){if(a.length!==b.length)return!1;let c=0;for(let d=0;d<a.length;d++)c|=a[d]^b[d];return 0===c},c.utf8ToBytes=function(a){if("string"!=typeof a)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(a))},c.inRange=s,c.aInRange=function(a,b,c,d){if(!s(b,c,d))throw Error("expected valid "+a+": "+c+" <= n < "+d+", got "+b)},c.bitLen=function(a){let b;for(b=0;a>d;a>>=e,b+=1);return b},c.bitGet=function(a,b){return a>>BigInt(b)&e},c.bitSet=function(a,b,c){return a|(c?e:d)<<BigInt(b)},c.createHmacDrbg=function(a,b,c){if("number"!=typeof a||a<2)throw Error("hashLen must be a number");if("number"!=typeof b||b<2)throw Error("qByteLen must be a number");if("function"!=typeof c)throw Error("hmacFn must be a function");let d=t(a),e=t(a),f=0,g=()=>{d.fill(1),e.fill(0),f=0},h=(...a)=>c(e,d,...a),i=(a=t(0))=>{e=h(u([0]),a),d=h(),0!==a.length&&(e=h(u([1]),a),d=h())},j=()=>{if(f++>=1e3)throw Error("drbg: tried 1000 values");let a=0,c=[];for(;a<b;){let b=(d=h()).slice();c.push(b),a+=d.length}return q(...c)};return(a,b)=>{let c;for(g(),i(a);!(c=b(j()));)i();return g(),c}},c.validateObject=function(a,b,c={}){let d=(b,c,d)=>{let e=v[c];if("function"!=typeof e)throw Error("invalid validator function");let f=a[b];if((!d||void 0!==f)&&!e(f,a))throw Error("param "+String(b)+" is invalid. Expected "+c+", got "+f)};for(let[a,c]of Object.entries(b))d(a,c,!1);for(let[a,b]of Object.entries(c))d(a,b,!0);return a},c.memoized=function(a){let b=new WeakMap;return(c,...d)=>{let e=b.get(c);if(void 0!==e)return e;let f=a(c,...d);return b.set(c,f),f}};let d=BigInt(0),e=BigInt(1);function f(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function g(a){if(!f(a))throw Error("Uint8Array expected")}function h(a){let b=a.toString(16);return 1&b.length?"0"+b:b}function i(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);return""===a?d:BigInt("0x"+a)}let j="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,k=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));function l(a){if(g(a),j)return a.toHex();let b="";for(let c=0;c<a.length;c++)b+=k[a[c]];return b}let m={_0:48,_9:57,A:65,F:70,a:97,f:102};function n(a){return a>=m._0&&a<=m._9?a-m._0:a>=m.A&&a<=m.F?a-(m.A-10):a>=m.a&&a<=m.f?a-(m.a-10):void 0}function o(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);if(j)return Uint8Array.fromHex(a);let b=a.length,c=b/2;if(b%2)throw Error("hex string expected, got unpadded hex of length "+b);let d=new Uint8Array(c);for(let b=0,e=0;b<c;b++,e+=2){let c=n(a.charCodeAt(e)),f=n(a.charCodeAt(e+1));if(void 0===c||void 0===f)throw Error('hex string expected, got non-hex character "'+(a[e]+a[e+1])+'" at index '+e);d[b]=16*c+f}return d}function p(a,b){return o(a.toString(16).padStart(2*b,"0"))}function q(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];g(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c}let r=a=>"bigint"==typeof a&&d<=a;function s(a,b,c){return r(a)&&r(b)&&r(c)&&b<=a&&a<c}c.bitMask=a=>(e<<BigInt(a))-e;let t=a=>new Uint8Array(a),u=a=>Uint8Array.from(a),v={bigint:a=>"bigint"==typeof a,function:a=>"function"==typeof a,boolean:a=>"boolean"==typeof a,string:a=>"string"==typeof a,stringOrUint8Array:a=>"string"==typeof a||f(a),isSafeInteger:a=>Number.isSafeInteger(a),array:a=>Array.isArray(a),field:(a,b)=>b.Fp.isValid(a),hash:a=>"function"==typeof a&&Number.isSafeInteger(a.outputLen)};c.notImplemented=()=>{throw Error("not implemented")}},745501,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.isNegativeLE=void 0,c.mod=l,c.pow=m,c.pow2=function(a,b,c){let d=a;for(;b-- >e;)d*=d,d%=c;return d},c.invert=n,c.tonelliShanks=o,c.FpSqrt=p,c.validateField=function(a){let b=q.reduce((a,b)=>(a[b]="function",a),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});return(0,d.validateObject)(a,b)},c.FpPow=r,c.FpInvertBatch=s,c.FpDiv=function(a,b,c){return a.mul(b,"bigint"==typeof c?n(c,a.ORDER):a.inv(c))},c.FpLegendre=t,c.FpIsSquare=function(a){let b=t(a.ORDER);return c=>{let d=b(a,c);return a.eql(d,a.ZERO)||a.eql(d,a.ONE)}},c.nLength=u,c.Field=function(a,b,c=!1,g={}){let h;if(a<=e)throw Error("invalid field: expected ORDER > 0, got "+a);let{nBitLength:i,nByteLength:j}=u(a,b);if(j>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let k=Object.freeze({ORDER:a,isLE:c,BITS:i,BYTES:j,MASK:(0,d.bitMask)(i),ZERO:e,ONE:f,create:b=>l(b,a),isValid:b=>{if("bigint"!=typeof b)throw Error("invalid field element: expected bigint, got "+typeof b);return e<=b&&b<a},is0:a=>a===e,isOdd:a=>(a&f)===f,neg:b=>l(-b,a),eql:(a,b)=>a===b,sqr:b=>l(b*b,a),add:(b,c)=>l(b+c,a),sub:(b,c)=>l(b-c,a),mul:(b,c)=>l(b*c,a),pow:(a,b)=>r(k,a,b),div:(b,c)=>l(b*n(c,a),a),sqrN:a=>a*a,addN:(a,b)=>a+b,subN:(a,b)=>a-b,mulN:(a,b)=>a*b,inv:b=>n(b,a),sqrt:g.sqrt||(b=>(h||(h=p(a)),h(k,b))),invertBatch:a=>s(k,a),cmov:(a,b,c)=>c?b:a,toBytes:a=>c?(0,d.numberToBytesLE)(a,j):(0,d.numberToBytesBE)(a,j),fromBytes:a=>{if(a.length!==j)throw Error("Field.fromBytes: expected "+j+" bytes, got "+a.length);return c?(0,d.bytesToNumberLE)(a):(0,d.bytesToNumberBE)(a)}});return Object.freeze(k)},c.FpSqrtOdd=function(a,b){if(!a.isOdd)throw Error("Field doesn't have isOdd");let c=a.sqrt(b);return a.isOdd(c)?c:a.neg(c)},c.FpSqrtEven=function(a,b){if(!a.isOdd)throw Error("Field doesn't have isOdd");let c=a.sqrt(b);return a.isOdd(c)?a.neg(c):c},c.hashToPrivateScalar=function(a,b,c=!1){let e=(a=(0,d.ensureBytes)("privateHash",a)).length,g=u(b).nByteLength+8;if(g<24||e<g||e>1024)throw Error("hashToPrivateScalar: expected "+g+"-1024 bytes of input, got "+e);return l(c?(0,d.bytesToNumberLE)(a):(0,d.bytesToNumberBE)(a),b-f)+f},c.getFieldBytesLength=v,c.getMinHashLength=w,c.mapHashToField=function(a,b,c=!1){let e=a.length,g=v(b),h=w(b);if(e<16||e<h||e>1024)throw Error("expected "+h+"-1024 bytes of input, got "+e);let i=l(c?(0,d.bytesToNumberLE)(a):(0,d.bytesToNumberBE)(a),b-f)+f;return c?(0,d.numberToBytesLE)(i,g):(0,d.numberToBytesBE)(i,g)};let d=a.r(422009),e=BigInt(0),f=BigInt(1),g=BigInt(2),h=BigInt(3),i=BigInt(4),j=BigInt(5),k=BigInt(8);function l(a,b){let c=a%b;return c>=e?c:b+c}function m(a,b,c){if(b<e)throw Error("invalid exponent, negatives unsupported");if(c<=e)throw Error("invalid modulus");if(c===f)return e;let d=f;for(;b>e;)b&f&&(d=d*a%c),a=a*a%c,b>>=f;return d}function n(a,b){if(a===e)throw Error("invert: expected non-zero number");if(b<=e)throw Error("invert: expected positive modulus, got "+b);let c=l(a,b),d=b,g=e,h=f,i=f,j=e;for(;c!==e;){let a=d/c,b=d%c,e=g-i*a,f=h-j*a;d=c,c=b,g=i,h=j,i=e,j=f}if(d!==f)throw Error("invert: does not exist");return l(g,b)}function o(a){let b,c,d,h=(a-f)/g;for(b=a-f,c=0;b%g===e;b/=g,c++);for(d=g;d<a&&m(d,h,a)!==a-f;d++)if(d>1e3)throw Error("Cannot find square root: likely non-prime P");if(1===c){let b=(a+f)/i;return function(a,c){let d=a.pow(c,b);if(!a.eql(a.sqr(d),c))throw Error("Cannot find square root");return d}}let j=(b+f)/g;return function(a,e){if(a.pow(e,h)===a.neg(a.ONE))throw Error("Cannot find square root");let g=c,i=a.pow(a.mul(a.ONE,d),b),k=a.pow(e,j),l=a.pow(e,b);for(;!a.eql(l,a.ONE);){if(a.eql(l,a.ZERO))return a.ZERO;let b=1;for(let c=a.sqr(l);b<g&&!a.eql(c,a.ONE);b++)c=a.sqr(c);let c=a.pow(i,f<<BigInt(g-b-1));i=a.sqr(c),k=a.mul(k,c),l=a.mul(l,i),g=b}return k}}function p(a){if(a%i===h){let b=(a+f)/i;return function(a,c){let d=a.pow(c,b);if(!a.eql(a.sqr(d),c))throw Error("Cannot find square root");return d}}if(a%k===j){let b=(a-j)/k;return function(a,c){let d=a.mul(c,g),e=a.pow(d,b),f=a.mul(c,e),h=a.mul(a.mul(f,g),e),i=a.mul(f,a.sub(h,a.ONE));if(!a.eql(a.sqr(i),c))throw Error("Cannot find square root");return i}}return o(a)}c.isNegativeLE=(a,b)=>(l(a,b)&f)===f;let q=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function r(a,b,c){if(c<e)throw Error("invalid exponent, negatives unsupported");if(c===e)return a.ONE;if(c===f)return b;let d=a.ONE,g=b;for(;c>e;)c&f&&(d=a.mul(d,g)),g=a.sqr(g),c>>=f;return d}function s(a,b){let c=Array(b.length),d=b.reduce((b,d,e)=>a.is0(d)?b:(c[e]=b,a.mul(b,d)),a.ONE),e=a.inv(d);return b.reduceRight((b,d,e)=>a.is0(d)?b:(c[e]=a.mul(b,c[e]),a.mul(b,d)),e),c}function t(a){let b=(a-f)/g;return(a,c)=>a.pow(c,b)}function u(a,b){let c=void 0!==b?b:a.toString(2).length,d=Math.ceil(c/8);return{nBitLength:c,nByteLength:d}}function v(a){if("bigint"!=typeof a)throw Error("field order must be bigint");return Math.ceil(a.toString(2).length/8)}function w(a){let b=v(a);return b+Math.ceil(b/2)}},384747,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.wNAF=function(a,b){return{constTimeNegate:h,hasPrecomputes:a=>1!==p(a),unsafeLadder(b,c,d=a.ZERO){let e=b;for(;c>f;)c&g&&(d=d.add(e)),e=e.double(),c>>=g;return d},precomputeWindow(a,c){let{windows:d,windowSize:e}=j(c,b),f=[],g=a,h=g;for(let a=0;a<d;a++){h=g,f.push(h);for(let a=1;a<e;a++)h=h.add(g),f.push(h);g=h.double()}return f},wNAF(c,d,e){let f=a.ZERO,g=a.BASE,i=j(c,b);for(let a=0;a<i.windows;a++){let{nextN:b,offset:c,isZero:j,isNeg:l,isNegF:m,offsetF:n}=k(e,a,i);e=b,j?g=g.add(h(m,d[n])):f=f.add(h(l,d[c]))}return{p:f,f:g}},wNAFUnsafe(c,d,e,g=a.ZERO){let h=j(c,b);for(let a=0;a<h.windows&&e!==f;a++){let{nextN:b,offset:c,isZero:f,isNeg:i}=k(e,a,h);if(e=b,!f){let a=d[c];g=g.add(i?a.negate():a)}}return g},getPrecomputes(a,b,c){let d=n.get(b);return d||(d=this.precomputeWindow(b,a),1!==a&&n.set(b,c(d))),d},wNAFCached(a,b,c){let d=p(a);return this.wNAF(d,this.getPrecomputes(d,a,c),b)},wNAFCachedUnsafe(a,b,c,d){let e=p(a);return 1===e?this.unsafeLadder(a,b,d):this.wNAFUnsafe(e,this.getPrecomputes(e,a,c),b,d)},setWindowSize(a,c){i(c,b),o.set(a,c),n.delete(a)}}},c.pippenger=function(a,b,c,d){if(l(c,a),m(d,b),c.length!==d.length)throw Error("arrays of points and scalars must have equal length");let f=a.ZERO,g=(0,e.bitLen)(BigInt(c.length)),h=g>12?g-3:g>4?g-2:g?2:1,i=(0,e.bitMask)(h),j=Array(Number(i)+1).fill(f),k=Math.floor((b.BITS-1)/h)*h,n=f;for(let a=k;a>=0;a-=h){j.fill(f);for(let b=0;b<d.length;b++){let e=Number(d[b]>>BigInt(a)&i);j[e]=j[e].add(c[b])}let b=f;for(let a=j.length-1,c=f;a>0;a--)c=c.add(j[a]),b=b.add(c);if(n=n.add(b),0!==a)for(let a=0;a<h;a++)n=n.double()}return n},c.precomputeMSMUnsafe=function(a,b,c,d){i(d,b.BITS),l(c,a);let f=a.ZERO,g=2**d-1,h=Math.ceil(b.BITS/d),j=(0,e.bitMask)(d),k=c.map(a=>{let b=[];for(let c=0,d=a;c<g;c++)b.push(d),d=d.add(a);return b});return a=>{if(m(a,b),a.length>c.length)throw Error("array of scalars must be smaller than array of points");let e=f;for(let b=0;b<h;b++){if(e!==f)for(let a=0;a<d;a++)e=e.double();let c=BigInt(h*d-(b+1)*d);for(let b=0;b<a.length;b++){let d=Number(a[b]>>c&j);d&&(e=e.add(k[b][d-1]))}}return e}},c.validateBasic=function(a){return(0,d.validateField)(a.Fp),(0,e.validateObject)(a,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,d.nLength)(a.n,a.nBitLength),...a,...{p:a.Fp.ORDER}})};let d=a.r(745501),e=a.r(422009),f=BigInt(0),g=BigInt(1);function h(a,b){let c=b.negate();return a?c:b}function i(a,b){if(!Number.isSafeInteger(a)||a<=0||a>b)throw Error("invalid window size, expected [1.."+b+"], got W="+a)}function j(a,b){i(a,b);let c=Math.ceil(b/a)+1,d=2**(a-1),f=2**a;return{windows:c,windowSize:d,mask:(0,e.bitMask)(a),maxNumber:f,shiftBy:BigInt(a)}}function k(a,b,c){let{windowSize:d,mask:e,maxNumber:f,shiftBy:h}=c,i=Number(a&e),j=a>>h;i>d&&(i-=f,j+=g);let k=b*d,l=k+Math.abs(i)-1,m=0===i;return{nextN:j,offset:l,isZero:m,isNeg:i<0,isNegF:b%2!=0,offsetF:k}}function l(a,b){if(!Array.isArray(a))throw Error("array expected");a.forEach((a,c)=>{if(!(a instanceof b))throw Error("invalid point at index "+c)})}function m(a,b){if(!Array.isArray(a))throw Error("array of scalars expected");a.forEach((a,c)=>{if(!b.isValid(a))throw Error("invalid scalar at index "+c)})}let n=new WeakMap,o=new WeakMap;function p(a){return o.get(a)||1}},175721,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DER=c.DERErr=void 0,c.weierstrassPoints=n,c.weierstrass=function(a){let b=function(a){let b=(0,d.validateBasic)(a);return(0,f.validateObject)(b,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...b})}(a),{Fp:h,n:k}=b,l=h.BYTES+1,m=2*h.BYTES+1;function o(a){return(0,e.mod)(a,k)}function p(a){return(0,e.invert)(a,k)}let{ProjectivePoint:q,normPrivateKeyToScalar:r,weierstrassEquation:s,isWithinCurveOrder:t}=n({...b,toBytes(a,b,c){let d=b.toAffine(),e=h.toBytes(d.x),g=f.concatBytes;return((0,f.abool)("isCompressed",c),c)?g(Uint8Array.from([b.hasEvenY()?2:3]),e):g(Uint8Array.from([4]),e,h.toBytes(d.y))},fromBytes(a){let b=a.length,c=a[0],d=a.subarray(1);if(b===l&&(2===c||3===c)){let a,b=(0,f.bytesToNumberBE)(d);if(!(0,f.inRange)(b,j,h.ORDER))throw Error("Point is not on curve");let e=s(b);try{a=h.sqrt(e)}catch(a){throw Error("Point is not on curve"+(a instanceof Error?": "+a.message:""))}return(1&c)==1!=((a&j)===j)&&(a=h.neg(a)),{x:b,y:a}}if(b===m&&4===c)return{x:h.fromBytes(d.subarray(0,h.BYTES)),y:h.fromBytes(d.subarray(h.BYTES,2*h.BYTES))};throw Error("invalid Point, expected length of "+l+", or uncompressed "+m+", got "+b)}}),u=a=>(0,f.bytesToHex)((0,f.numberToBytesBE)(a,b.nByteLength)),v=(a,b,c)=>(0,f.bytesToNumberBE)(a.slice(b,c));class w{constructor(a,b,c){(0,f.aInRange)("r",a,j,k),(0,f.aInRange)("s",b,j,k),this.r=a,this.s=b,null!=c&&(this.recovery=c),Object.freeze(this)}static fromCompact(a){let c=b.nByteLength;return new w(v(a=(0,f.ensureBytes)("compactSignature",a,2*c),0,c),v(a,c,2*c))}static fromDER(a){let{r:b,s:d}=c.DER.toSig((0,f.ensureBytes)("DER",a));return new w(b,d)}assertValidity(){}addRecoveryBit(a){return new w(this.r,this.s,a)}recoverPublicKey(a){let{r:c,s:d,recovery:e}=this,g=z((0,f.ensureBytes)("msgHash",a));if(null==e||![0,1,2,3].includes(e))throw Error("recovery id invalid");let i=2===e||3===e?c+b.n:c;if(i>=h.ORDER)throw Error("recovery id 2 or 3 invalid");let j=(1&e)==0?"02":"03",k=q.fromHex(j+u(i)),l=p(i),m=o(-g*l),n=o(d*l),r=q.BASE.multiplyAndAddUnsafe(k,m,n);if(!r)throw Error("point at infinify");return r.assertValidity(),r}hasHighS(){return this.s>k>>j}normalizeS(){return this.hasHighS()?new w(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return(0,f.hexToBytes)(this.toDERHex())}toDERHex(){return c.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return(0,f.hexToBytes)(this.toCompactHex())}toCompactHex(){return u(this.r)+u(this.s)}}function x(a){let b=(0,f.isBytes)(a),c="string"==typeof a,d=(b||c)&&a.length;return b?d===l||d===m:c?d===2*l||d===2*m:a instanceof q}let y=b.bits2int||function(a){if(a.length>8192)throw Error("input is too large");let c=(0,f.bytesToNumberBE)(a),d=8*a.length-b.nBitLength;return d>0?c>>BigInt(d):c},z=b.bits2int_modN||function(a){return o(y(a))},A=(0,f.bitMask)(b.nBitLength);function B(a){return(0,f.aInRange)("num < 2^"+b.nBitLength,a,i,A),(0,f.numberToBytesBE)(a,b.nByteLength)}let C={lowS:b.lowS,prehash:!1},D={lowS:b.lowS,prehash:!1};return q.BASE._setWindowSize(8),{CURVE:b,getPublicKey:function(a,b=!0){return q.fromPrivateKey(a).toRawBytes(b)},getSharedSecret:function(a,b,c=!0){if(x(a))throw Error("first arg must be private key");if(!x(b))throw Error("second arg must be public key");return q.fromHex(b).multiply(r(a)).toRawBytes(c)},sign:function(a,c,d=C){let{seed:e,k2sig:l}=function(a,c,d=C){if(["recovered","canonical"].some(a=>a in d))throw Error("sign() legacy options not supported");let{hash:e,randomBytes:l}=b,{lowS:m,prehash:n,extraEntropy:s}=d;null==m&&(m=!0),a=(0,f.ensureBytes)("msgHash",a),g(d),n&&(a=(0,f.ensureBytes)("prehashed msgHash",e(a)));let u=z(a),v=r(c),x=[B(v),B(u)];if(null!=s&&!1!==s){let a=!0===s?l(h.BYTES):s;x.push((0,f.ensureBytes)("extraEntropy",a))}return{seed:(0,f.concatBytes)(...x),k2sig:function(a){var b;let c=y(a);if(!t(c))return;let d=p(c),e=q.BASE.multiply(c).toAffine(),f=o(e.x);if(f===i)return;let g=o(d*o(u+f*v));if(g===i)return;let h=2*(e.x!==f)|Number(e.y&j),l=g;return m&&g>k>>j&&(l=(b=g)>k>>j?o(-b):b,h^=1),new w(f,l,h)}}}(a,c,d);return(0,f.createHmacDrbg)(b.hash.outputLen,b.nByteLength,b.hmac)(e,l)},verify:function(a,d,e,h=D){let i,j;d=(0,f.ensureBytes)("msgHash",d),e=(0,f.ensureBytes)("publicKey",e);let{lowS:k,prehash:l,format:m}=h;if(g(h),"strict"in h)throw Error("options.strict was renamed to lowS");if(void 0!==m&&"compact"!==m&&"der"!==m)throw Error("format must be compact or der");let n="string"==typeof a||(0,f.isBytes)(a),r=!n&&!m&&"object"==typeof a&&null!==a&&"bigint"==typeof a.r&&"bigint"==typeof a.s;if(!n&&!r)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(r&&(j=new w(a.r,a.s)),n){try{"compact"!==m&&(j=w.fromDER(a))}catch(a){if(!(a instanceof c.DER.Err))throw a}j||"der"===m||(j=w.fromCompact(a))}i=q.fromHex(e)}catch(a){return!1}if(!j||k&&j.hasHighS())return!1;l&&(d=b.hash(d));let{r:s,s:t}=j,u=z(d),v=p(t),x=o(u*v),y=o(s*v),A=q.BASE.multiplyAndAddUnsafe(i,x,y)?.toAffine();return!!A&&o(A.x)===s},ProjectivePoint:q,Signature:w,utils:{isValidPrivateKey(a){try{return r(a),!0}catch(a){return!1}},normPrivateKeyToScalar:r,randomPrivateKey:()=>{let a=(0,e.getMinHashLength)(b.n);return(0,e.mapHashToField)(b.randomBytes(a),b.n)},precompute:(a=8,b=q.BASE)=>(b._setWindowSize(a),b.multiply(BigInt(3)),b)}}},c.SWUFpSqrtRatio=o,c.mapToCurveSimpleSWU=function(a,b){if((0,e.validateField)(a),!a.isValid(b.A)||!a.isValid(b.B)||!a.isValid(b.Z))throw Error("mapToCurveSimpleSWU: invalid opts");let c=o(a,b.Z);if(!a.isOdd)throw Error("Fp.isOdd is not implemented!");return d=>{let e,f,g,h,i,j,k,l;e=a.sqr(d),e=a.mul(e,b.Z),f=a.sqr(e),f=a.add(f,e),g=a.add(f,a.ONE),g=a.mul(g,b.B),h=a.cmov(b.Z,a.neg(f),!a.eql(f,a.ZERO)),h=a.mul(h,b.A),f=a.sqr(g),j=a.sqr(h),i=a.mul(j,b.A),f=a.add(f,i),f=a.mul(f,g),j=a.mul(j,h),i=a.mul(j,b.B),f=a.add(f,i),k=a.mul(e,g);let{isValid:m,value:n}=c(f,j);l=a.mul(e,d),l=a.mul(l,n),k=a.cmov(k,g,m),l=a.cmov(l,n,m);let o=a.isOdd(d)===a.isOdd(l);return l=a.cmov(a.neg(l),l,o),{x:k=a.div(k,h),y:l}}};let d=a.r(384747),e=a.r(745501),f=a.r(422009);function g(a){void 0!==a.lowS&&(0,f.abool)("lowS",a.lowS),void 0!==a.prehash&&(0,f.abool)("prehash",a.prehash)}class h extends Error{constructor(a=""){super(a)}}c.DERErr=h,c.DER={Err:h,_tlv:{encode:(a,b)=>{let{Err:d}=c.DER;if(a<0||a>256)throw new d("tlv.encode: wrong tag");if(1&b.length)throw new d("tlv.encode: unpadded data");let e=b.length/2,g=(0,f.numberToHexUnpadded)(e);if(g.length/2&128)throw new d("tlv.encode: long form length too big");let h=e>127?(0,f.numberToHexUnpadded)(g.length/2|128):"";return(0,f.numberToHexUnpadded)(a)+h+g+b},decode(a,b){let{Err:d}=c.DER,e=0;if(a<0||a>256)throw new d("tlv.encode: wrong tag");if(b.length<2||b[e++]!==a)throw new d("tlv.decode: wrong tlv");let f=b[e++],g=0;if(128&f){let a=127&f;if(!a)throw new d("tlv.decode(long): indefinite length not supported");if(a>4)throw new d("tlv.decode(long): byte length is too big");let c=b.subarray(e,e+a);if(c.length!==a)throw new d("tlv.decode: length bytes not complete");if(0===c[0])throw new d("tlv.decode(long): zero leftmost byte");for(let a of c)g=g<<8|a;if(e+=a,g<128)throw new d("tlv.decode(long): not minimal encoding")}else g=f;let h=b.subarray(e,e+g);if(h.length!==g)throw new d("tlv.decode: wrong value length");return{v:h,l:b.subarray(e+g)}}},_int:{encode(a){let{Err:b}=c.DER;if(a<i)throw new b("integer: negative integers are not allowed");let d=(0,f.numberToHexUnpadded)(a);if(8&Number.parseInt(d[0],16)&&(d="00"+d),1&d.length)throw new b("unexpected DER parsing assertion: unpadded hex");return d},decode(a){let{Err:b}=c.DER;if(128&a[0])throw new b("invalid signature integer: negative");if(0===a[0]&&!(128&a[1]))throw new b("invalid signature integer: unnecessary leading zero");return(0,f.bytesToNumberBE)(a)}},toSig(a){let{Err:b,_int:d,_tlv:e}=c.DER,g=(0,f.ensureBytes)("signature",a),{v:h,l:i}=e.decode(48,g);if(i.length)throw new b("invalid signature: left bytes after parsing");let{v:j,l:k}=e.decode(2,h),{v:l,l:m}=e.decode(2,k);if(m.length)throw new b("invalid signature: left bytes after parsing");return{r:d.decode(j),s:d.decode(l)}},hexFromSig(a){let{_tlv:b,_int:d}=c.DER,e=b.encode(2,d.encode(a.r)),f=b.encode(2,d.encode(a.s));return b.encode(48,e+f)}};let i=BigInt(0),j=BigInt(1),k=BigInt(2),l=BigInt(3),m=BigInt(4);function n(a){let b=function(a){let b=(0,d.validateBasic)(a);(0,f.validateObject)(b,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:c,Fp:e,a:g}=b;if(c){if(!e.eql(g,e.ZERO))throw Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof c||"bigint"!=typeof c.beta||"function"!=typeof c.splitScalar)throw Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...b})}(a),{Fp:c}=b,g=(0,e.Field)(b.n,b.nBitLength),h=b.toBytes||((a,b,d)=>{let e=b.toAffine();return(0,f.concatBytes)(Uint8Array.from([4]),c.toBytes(e.x),c.toBytes(e.y))}),k=b.fromBytes||(a=>{let b=a.subarray(1);return{x:c.fromBytes(b.subarray(0,c.BYTES)),y:c.fromBytes(b.subarray(c.BYTES,2*c.BYTES))}});function m(a){let{a:d,b:e}=b,f=c.sqr(a),g=c.mul(f,a);return c.add(c.add(g,c.mul(a,d)),e)}if(!c.eql(c.sqr(b.Gy),m(b.Gx)))throw Error("bad generator point: equation left != right");function n(a){let c,{allowedPrivateKeyLengths:d,nByteLength:g,wrapPrivateKey:h,n:i}=b;if(d&&"bigint"!=typeof a){if((0,f.isBytes)(a)&&(a=(0,f.bytesToHex)(a)),"string"!=typeof a||!d.includes(a.length))throw Error("invalid private key");a=a.padStart(2*g,"0")}try{c="bigint"==typeof a?a:(0,f.bytesToNumberBE)((0,f.ensureBytes)("private key",a,g))}catch(b){throw Error("invalid private key, expected hex or "+g+" bytes, got "+typeof a)}return h&&(c=(0,e.mod)(c,i)),(0,f.aInRange)("private key",c,j,i),c}function o(a){if(!(a instanceof r))throw Error("ProjectivePoint expected")}let p=(0,f.memoized)((a,b)=>{let{px:d,py:e,pz:f}=a;if(c.eql(f,c.ONE))return{x:d,y:e};let g=a.is0();null==b&&(b=g?c.ONE:c.inv(f));let h=c.mul(d,b),i=c.mul(e,b),j=c.mul(f,b);if(g)return{x:c.ZERO,y:c.ZERO};if(!c.eql(j,c.ONE))throw Error("invZ was invalid");return{x:h,y:i}}),q=(0,f.memoized)(a=>{if(a.is0()){if(b.allowInfinityPoint&&!c.is0(a.py))return;throw Error("bad point: ZERO")}let{x:d,y:e}=a.toAffine();if(!c.isValid(d)||!c.isValid(e))throw Error("bad point: x or y not FE");let f=c.sqr(e),g=m(d);if(!c.eql(f,g))throw Error("bad point: equation left != right");if(!a.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class r{constructor(a,b,d){if(null==a||!c.isValid(a))throw Error("x required");if(null==b||!c.isValid(b))throw Error("y required");if(null==d||!c.isValid(d))throw Error("z required");this.px=a,this.py=b,this.pz=d,Object.freeze(this)}static fromAffine(a){let{x:b,y:d}=a||{};if(!a||!c.isValid(b)||!c.isValid(d))throw Error("invalid affine point");if(a instanceof r)throw Error("projective point not allowed");let e=a=>c.eql(a,c.ZERO);return e(b)&&e(d)?r.ZERO:new r(b,d,c.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(a){let b=c.invertBatch(a.map(a=>a.pz));return a.map((a,c)=>a.toAffine(b[c])).map(r.fromAffine)}static fromHex(a){let b=r.fromAffine(k((0,f.ensureBytes)("pointHex",a)));return b.assertValidity(),b}static fromPrivateKey(a){return r.BASE.multiply(n(a))}static msm(a,b){return(0,d.pippenger)(r,g,a,b)}_setWindowSize(a){t.setWindowSize(this,a)}assertValidity(){q(this)}hasEvenY(){let{y:a}=this.toAffine();if(c.isOdd)return!c.isOdd(a);throw Error("Field doesn't support isOdd")}equals(a){o(a);let{px:b,py:d,pz:e}=this,{px:f,py:g,pz:h}=a,i=c.eql(c.mul(b,h),c.mul(f,e)),j=c.eql(c.mul(d,h),c.mul(g,e));return i&&j}negate(){return new r(this.px,c.neg(this.py),this.pz)}double(){let{a,b:d}=b,e=c.mul(d,l),{px:f,py:g,pz:h}=this,i=c.ZERO,j=c.ZERO,k=c.ZERO,m=c.mul(f,f),n=c.mul(g,g),o=c.mul(h,h),p=c.mul(f,g);return p=c.add(p,p),k=c.mul(f,h),k=c.add(k,k),i=c.mul(a,k),j=c.mul(e,o),j=c.add(i,j),i=c.sub(n,j),j=c.add(n,j),j=c.mul(i,j),i=c.mul(p,i),k=c.mul(e,k),o=c.mul(a,o),p=c.sub(m,o),p=c.mul(a,p),p=c.add(p,k),k=c.add(m,m),m=c.add(k,m),m=c.add(m,o),m=c.mul(m,p),j=c.add(j,m),o=c.mul(g,h),o=c.add(o,o),m=c.mul(o,p),i=c.sub(i,m),k=c.mul(o,n),k=c.add(k,k),new r(i,j,k=c.add(k,k))}add(a){o(a);let{px:d,py:e,pz:f}=this,{px:g,py:h,pz:i}=a,j=c.ZERO,k=c.ZERO,m=c.ZERO,n=b.a,p=c.mul(b.b,l),q=c.mul(d,g),s=c.mul(e,h),t=c.mul(f,i),u=c.add(d,e),v=c.add(g,h);u=c.mul(u,v),v=c.add(q,s),u=c.sub(u,v),v=c.add(d,f);let w=c.add(g,i);return v=c.mul(v,w),w=c.add(q,t),v=c.sub(v,w),w=c.add(e,f),j=c.add(h,i),w=c.mul(w,j),j=c.add(s,t),w=c.sub(w,j),m=c.mul(n,v),j=c.mul(p,t),m=c.add(j,m),j=c.sub(s,m),m=c.add(s,m),k=c.mul(j,m),s=c.add(q,q),s=c.add(s,q),t=c.mul(n,t),v=c.mul(p,v),s=c.add(s,t),t=c.sub(q,t),t=c.mul(n,t),v=c.add(v,t),q=c.mul(s,v),k=c.add(k,q),q=c.mul(w,v),j=c.mul(u,j),j=c.sub(j,q),q=c.mul(u,s),m=c.mul(w,m),new r(j,k,m=c.add(m,q))}subtract(a){return this.add(a.negate())}is0(){return this.equals(r.ZERO)}wNAF(a){return t.wNAFCached(this,a,r.normalizeZ)}multiplyUnsafe(a){let{endo:d,n:e}=b;(0,f.aInRange)("scalar",a,i,e);let g=r.ZERO;if(a===i)return g;if(this.is0()||a===j)return this;if(!d||t.hasPrecomputes(this))return t.wNAFCachedUnsafe(this,a,r.normalizeZ);let{k1neg:h,k1:k,k2neg:l,k2:m}=d.splitScalar(a),n=g,o=g,p=this;for(;k>i||m>i;)k&j&&(n=n.add(p)),m&j&&(o=o.add(p)),p=p.double(),k>>=j,m>>=j;return h&&(n=n.negate()),l&&(o=o.negate()),o=new r(c.mul(o.px,d.beta),o.py,o.pz),n.add(o)}multiply(a){let d,e,{endo:g,n:h}=b;if((0,f.aInRange)("scalar",a,j,h),g){let{k1neg:b,k1:f,k2neg:h,k2:i}=g.splitScalar(a),{p:j,f:k}=this.wNAF(f),{p:l,f:m}=this.wNAF(i);j=t.constTimeNegate(b,j),l=t.constTimeNegate(h,l),l=new r(c.mul(l.px,g.beta),l.py,l.pz),d=j.add(l),e=k.add(m)}else{let{p:b,f:c}=this.wNAF(a);d=b,e=c}return r.normalizeZ([d,e])[0]}multiplyAndAddUnsafe(a,b,c){let d=r.BASE,e=(a,b)=>b!==i&&b!==j&&a.equals(d)?a.multiply(b):a.multiplyUnsafe(b),f=e(this,b).add(e(a,c));return f.is0()?void 0:f}toAffine(a){return p(this,a)}isTorsionFree(){let{h:a,isTorsionFree:c}=b;if(a===j)return!0;if(c)return c(r,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:a,clearCofactor:c}=b;return a===j?this:c?c(r,this):this.multiplyUnsafe(b.h)}toRawBytes(a=!0){return(0,f.abool)("isCompressed",a),this.assertValidity(),h(r,this,a)}toHex(a=!0){return(0,f.abool)("isCompressed",a),(0,f.bytesToHex)(this.toRawBytes(a))}}r.BASE=new r(b.Gx,b.Gy,c.ONE),r.ZERO=new r(c.ZERO,c.ONE,c.ZERO);let s=b.nBitLength,t=(0,d.wNAF)(r,b.endo?Math.ceil(s/2):s);return{CURVE:b,ProjectivePoint:r,normPrivateKeyToScalar:n,weierstrassEquation:m,isWithinCurveOrder:function(a){return(0,f.inRange)(a,j,b.n)}}}function o(a,b){let c=a.ORDER,d=i;for(let a=c-j;a%k===i;a/=k)d+=j;let e=d,f=k<<e-j-j,g=f*k,h=(c-j)/g,n=(h-j)/k,o=g-j,p=a.pow(b,h),q=a.pow(b,(h+j)/k),r=(b,c)=>{let d=p,g=a.pow(c,o),h=a.sqr(g);h=a.mul(h,c);let i=a.mul(b,h);i=a.pow(i,n),i=a.mul(i,g),g=a.mul(i,c),h=a.mul(i,b);let l=a.mul(h,g);i=a.pow(l,f);let m=a.eql(i,a.ONE);g=a.mul(h,q),i=a.mul(l,d),h=a.cmov(g,h,m),l=a.cmov(i,l,m);for(let b=e;b>j;b--){let c=b-k;c=k<<c-j;let e=a.pow(l,c),f=a.eql(e,a.ONE);g=a.mul(h,d),d=a.mul(d,d),e=a.mul(l,d),h=a.cmov(g,h,f),l=a.cmov(e,l,f)}return{isValid:m,value:h}};if(a.ORDER%m===l){let c=(a.ORDER-l)/m,d=a.sqrt(a.neg(b));r=(b,e)=>{let f=a.sqr(e),g=a.mul(b,e);f=a.mul(f,g);let h=a.pow(f,c);h=a.mul(h,g);let i=a.mul(h,d),j=a.mul(a.sqr(h),e),k=a.eql(j,b),l=a.cmov(i,h,k);return{isValid:k,value:l}}}return r}},523778,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.getHash=g,c.createCurve=function(a,b){let c=b=>(0,f.weierstrass)({...a,...g(b)});return{...c(b),create:c}};let d=a.r(958596),e=a.r(116981),f=a.r(175721);function g(a){return{hash:a,hmac:(b,...c)=>(0,d.hmac)(a,b,(0,e.concatBytes)(...c)),randomBytes:e.randomBytes}}},753781,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.expand_message_xmd=i,c.expand_message_xof=j,c.hash_to_field=k,c.isogenyMap=function(a,b){let c=b.map(a=>Array.from(a).reverse());return(b,d)=>{let[e,f,g,h]=c.map(c=>c.reduce((c,d)=>a.add(a.mul(c,b),d)));if(a.is0(f)||a.is0(h))throw Error("bad point: ZERO");return b=a.div(e,f),d=a.mul(d,a.div(g,h)),{x:b,y:d}}},c.createHasher=function(a,b,c){if("function"!=typeof b)throw Error("mapToCurve() must be defined");return{hashToCurve(d,e){let f=k(d,2,{...c,DST:c.DST,...e}),g=a.fromAffine(b(f[0])),h=a.fromAffine(b(f[1])),i=g.add(h).clearCofactor();return i.assertValidity(),i},encodeToCurve(d,e){let f=k(d,1,{...c,DST:c.encodeDST,...e}),g=a.fromAffine(b(f[0])).clearCofactor();return g.assertValidity(),g},mapToCurve(c){if(!Array.isArray(c))throw Error("mapToCurve: expected array of bigints");for(let a of c)if("bigint"!=typeof a)throw Error("mapToCurve: expected array of bigints");let d=a.fromAffine(b(c)).clearCofactor();return d.assertValidity(),d}}};let d=a.r(745501),e=a.r(422009),f=e.bytesToNumberBE;function g(a,b){if(h(a),h(b),a<0||a>=1<<8*b)throw Error("invalid I2OSP input: "+a);let c=Array.from({length:b}).fill(0);for(let d=b-1;d>=0;d--)c[d]=255&a,a>>>=8;return new Uint8Array(c)}function h(a){if(!Number.isSafeInteger(a))throw Error("number expected")}function i(a,b,c,d){(0,e.abytes)(a),(0,e.abytes)(b),h(c),b.length>255&&(b=d((0,e.concatBytes)((0,e.utf8ToBytes)("H2C-OVERSIZE-DST-"),b)));let{outputLen:f,blockLen:i}=d,j=Math.ceil(c/f);if(c>65535||j>255)throw Error("expand_message_xmd: invalid lenInBytes");let k=(0,e.concatBytes)(b,g(b.length,1)),l=g(0,i),m=g(c,2),n=Array(j),o=d((0,e.concatBytes)(l,a,m,g(0,1),k));n[0]=d((0,e.concatBytes)(o,g(1,1),k));for(let a=1;a<=j;a++){let b=[function(a,b){let c=new Uint8Array(a.length);for(let d=0;d<a.length;d++)c[d]=a[d]^b[d];return c}(o,n[a-1]),g(a+1,1),k];n[a]=d((0,e.concatBytes)(...b))}return(0,e.concatBytes)(...n).slice(0,c)}function j(a,b,c,d,f){if((0,e.abytes)(a),(0,e.abytes)(b),h(c),b.length>255){let a=Math.ceil(2*d/8);b=f.create({dkLen:a}).update((0,e.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(b).digest()}if(c>65535||b.length>255)throw Error("expand_message_xof: invalid lenInBytes");return f.create({dkLen:c}).update(a).update(g(c,2)).update(b).update(g(b.length,1)).digest()}function k(a,b,c){let g;(0,e.validateObject)(c,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:k,k:l,m,hash:n,expand:o,DST:p}=c;(0,e.abytes)(a),h(b);let q="string"==typeof p?(0,e.utf8ToBytes)(p):p,r=Math.ceil((k.toString(2).length+l)/8),s=b*m*r;if("xmd"===o)g=i(a,q,s,n);else if("xof"===o)g=j(a,q,s,l,n);else if("_internal_pass"===o)g=a;else throw Error('expand must be "xmd" or "xof"');let t=Array(b);for(let a=0;a<b;a++){let b=Array(m);for(let c=0;c<m;c++){let e=r*(c+a*m),h=g.subarray(e,e+r);b[c]=(0,d.mod)(f(h),k)}t[a]=b}return t}},168688,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.encodeToCurve=c.hashToCurve=c.schnorr=c.secp256k1=void 0;let d=a.r(386983),e=a.r(116981),f=a.r(523778),g=a.r(753781),h=a.r(745501),i=a.r(422009),j=a.r(175721),k=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),l=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),m=BigInt(1),n=BigInt(2),o=(a,b)=>(a+b/n)/b;function p(a){let b=BigInt(3),c=BigInt(6),d=BigInt(11),e=BigInt(22),f=BigInt(23),g=BigInt(44),i=BigInt(88),j=a*a*a%k,l=j*j*a%k,m=(0,h.pow2)(l,b,k)*l%k,o=(0,h.pow2)(m,b,k)*l%k,p=(0,h.pow2)(o,n,k)*j%k,r=(0,h.pow2)(p,d,k)*p%k,s=(0,h.pow2)(r,e,k)*r%k,t=(0,h.pow2)(s,g,k)*s%k,u=(0,h.pow2)(t,i,k)*t%k,v=(0,h.pow2)(u,g,k)*s%k,w=(0,h.pow2)(v,b,k)*l%k,x=(0,h.pow2)(w,f,k)*r%k,y=(0,h.pow2)(x,c,k)*j%k,z=(0,h.pow2)(y,n,k);if(!q.eql(q.sqr(z),a))throw Error("Cannot find square root");return z}let q=(0,h.Field)(k,void 0,void 0,{sqrt:p});c.secp256k1=(0,f.createCurve)({a:BigInt(0),b:BigInt(7),Fp:q,n:l,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:a=>{let b=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),c=-m*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),d=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),e=BigInt("0x100000000000000000000000000000000"),f=o(b*a,l),g=o(-c*a,l),i=(0,h.mod)(a-f*b-g*d,l),j=(0,h.mod)(-f*c-g*b,l),k=i>e,n=j>e;if(k&&(i=l-i),n&&(j=l-j),i>e||j>e)throw Error("splitScalar: Endomorphism failed, k="+a);return{k1neg:k,k1:i,k2neg:n,k2:j}}}},d.sha256);let r=BigInt(0),s={};function t(a,...b){let c=s[a];if(void 0===c){let b=(0,d.sha256)(Uint8Array.from(a,a=>a.charCodeAt(0)));c=(0,i.concatBytes)(b,b),s[a]=c}return(0,d.sha256)((0,i.concatBytes)(c,...b))}let u=a=>a.toRawBytes(!0).slice(1),v=a=>(0,i.numberToBytesBE)(a,32),w=a=>(0,h.mod)(a,k),x=a=>(0,h.mod)(a,l),y=c.secp256k1.ProjectivePoint;function z(a){let b=c.secp256k1.utils.normPrivateKeyToScalar(a),d=y.fromPrivateKey(b);return{scalar:d.hasEvenY()?b:x(-b),bytes:u(d)}}function A(a){(0,i.aInRange)("x",a,m,k);let b=w(a*a),c=p(w(b*a+BigInt(7)));c%n!==r&&(c=w(-c));let d=new y(a,c,m);return d.assertValidity(),d}let B=i.bytesToNumberBE;function C(...a){return x(B(t("BIP0340/challenge",...a)))}function D(a,b,c){let d=(0,i.ensureBytes)("signature",a,64),e=(0,i.ensureBytes)("message",b),f=(0,i.ensureBytes)("publicKey",c,32);try{let a,b=A(B(f)),c=B(d.subarray(0,32));if(!(0,i.inRange)(c,m,k))return!1;let g=B(d.subarray(32,64));if(!(0,i.inRange)(g,m,l))return!1;let h=C(v(c),u(b),e),j=(a=x(-h),y.BASE.multiplyAndAddUnsafe(b,g,a));if(!j||!j.hasEvenY()||j.toAffine().x!==c)return!1;return!0}catch(a){return!1}}c.schnorr={getPublicKey:function(a){return z(a).bytes},sign:function(a,b,c=(0,e.randomBytes)(32)){let d=(0,i.ensureBytes)("message",a),{bytes:f,scalar:g}=z(b),h=v(g^B(t("BIP0340/aux",(0,i.ensureBytes)("auxRand",c,32)))),j=x(B(t("BIP0340/nonce",h,f,d)));if(j===r)throw Error("sign failed: k is zero");let{bytes:k,scalar:l}=z(j),m=C(k,f,d),n=new Uint8Array(64);if(n.set(k,0),n.set(v(x(l+m*g)),32),!D(n,d,f))throw Error("sign: Invalid signature produced");return n},verify:D,utils:{randomPrivateKey:c.secp256k1.utils.randomPrivateKey,lift_x:A,pointToBytes:u,numberToBytesBE:i.numberToBytesBE,bytesToNumberBE:i.bytesToNumberBE,taggedHash:t,mod:h.mod}};let E=(0,g.isogenyMap)(q,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(a=>a.map(a=>BigInt(a)))),F=(0,j.mapToCurveSimpleSWU)(q,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:q.create(BigInt("-11"))}),G=(0,g.createHasher)(c.secp256k1.ProjectivePoint,a=>{let{x:b,y:c}=F(q.create(a[0]));return E(b,c)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:q.ORDER,m:1,k:128,expand:"xmd",hash:d.sha256});c.hashToCurve=G.hashToCurve,c.encodeToCurve=G.encodeToCurve},500809,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ripemd160=c.RIPEMD160=void 0;let d=a.r(563750),e=a.r(116981),f=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),g=new Uint8Array(Array(16).fill(0).map((a,b)=>b)),h=g.map(a=>(9*a+5)%16),i=[g],j=[h];for(let a=0;a<4;a++)for(let b of[i,j])b.push(b[a].map(a=>f[a]));let k=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(a=>new Uint8Array(a)),l=i.map((a,b)=>a.map(a=>k[b][a])),m=j.map((a,b)=>a.map(a=>k[b][a])),n=new Uint32Array([0,0x5a827999,0x6ed9eba1,0x8f1bbcdc,0xa953fd4e]),o=new Uint32Array([0x50a28be6,0x5c4dd124,0x6d703ef3,0x7a6d76e9,0]);function p(a,b,c,d){return 0===a?b^c^d:1===a?b&c|~b&d:2===a?(b|~c)^d:3===a?b&d|c&~d:b^(c|~d)}let q=new Uint32Array(16);class r extends d.HashMD{constructor(){super(64,20,8,!0),this.h0=0x67452301,this.h1=-0x10325477,this.h2=-0x67452302,this.h3=0x10325476,this.h4=-0x3c2d1e10}get(){let{h0:a,h1:b,h2:c,h3:d,h4:e}=this;return[a,b,c,d,e]}set(a,b,c,d,e){this.h0=0|a,this.h1=0|b,this.h2=0|c,this.h3=0|d,this.h4=0|e}process(a,b){for(let c=0;c<16;c++,b+=4)q[c]=a.getUint32(b,!0);let c=0|this.h0,d=c,f=0|this.h1,g=f,h=0|this.h2,k=h,r=0|this.h3,s=r,t=0|this.h4,u=t;for(let a=0;a<5;a++){let b=4-a,v=n[a],w=o[a],x=i[a],y=j[a],z=l[a],A=m[a];for(let b=0;b<16;b++){let d=(0,e.rotl)(c+p(a,f,h,r)+q[x[b]]+v,z[b])+t|0;c=t,t=r,r=0|(0,e.rotl)(h,10),h=f,f=d}for(let a=0;a<16;a++){let c=(0,e.rotl)(d+p(b,g,k,s)+q[y[a]]+w,A[a])+u|0;d=u,u=s,s=0|(0,e.rotl)(k,10),k=g,g=c}}this.set(this.h1+h+s|0,this.h2+r+u|0,this.h3+t+d|0,this.h4+c+g|0,this.h0+f+k|0)}roundClean(){q.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}c.RIPEMD160=r,c.ripemd160=(0,e.wrapConstructor)(()=>new r)},67528,(a,b,c)=>{"use strict";function d(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function e(a,...b){if(!d(a))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}function f(a,b){return!!Array.isArray(b)&&(0===b.length||(a?b.every(a=>"string"==typeof a):b.every(a=>Number.isSafeInteger(a))))}function g(a){if("function"!=typeof a)throw Error("function expected");return!0}function h(a,b){if("string"!=typeof b)throw Error(`${a}: string expected`);return!0}function i(a){if(!Number.isSafeInteger(a))throw Error(`invalid integer: ${a}`)}function j(a){if(!Array.isArray(a))throw Error("array expected")}function k(a,b){if(!f(!0,b))throw Error(`${a}: array of strings expected`)}function l(a,b){if(!f(!1,b))throw Error(`${a}: array of numbers expected`)}function m(...a){let b=a=>a,c=(a,b)=>c=>a(b(c));return{encode:a.map(a=>a.encode).reduceRight(c,b),decode:a.map(a=>a.decode).reduce(c,b)}}function n(a){let b="string"==typeof a?a.split(""):a,c=b.length;k("alphabet",b);let d=new Map(b.map((a,b)=>[a,b]));return{encode:d=>(j(d),d.map(d=>{if(!Number.isSafeInteger(d)||d<0||d>=c)throw Error(`alphabet.encode: digit index outside alphabet "${d}". Allowed: ${a}`);return b[d]})),decode:b=>(j(b),b.map(b=>{h("alphabet.decode",b);let c=d.get(b);if(void 0===c)throw Error(`Unknown letter: "${b}". Allowed: ${a}`);return c}))}}function o(a=""){return h("join",a),{encode:b=>(k("join.decode",b),b.join(a)),decode:b=>(h("join.decode",b),b.split(a))}}function p(a,b="="){return i(a),h("padding",b),{encode(c){for(k("padding.encode",c);c.length*a%8;)c.push(b);return c},decode(c){k("padding.decode",c);let d=c.length;if(d*a%8)throw Error("padding: invalid, string should have whole number of bytes");for(;d>0&&c[d-1]===b;d--)if((d-1)*a%8==0)throw Error("padding: invalid, string has too much padding");return c.slice(0,d)}}}function q(a){return g(a),{encode:a=>a,decode:b=>a(b)}}function r(a,b,c){if(b<2)throw Error(`convertRadix: invalid from=${b}, base cannot be less than 2`);if(c<2)throw Error(`convertRadix: invalid to=${c}, base cannot be less than 2`);if(j(a),!a.length)return[];let d=0,e=[],f=Array.from(a,a=>{if(i(a),a<0||a>=b)throw Error(`invalid integer: ${a}`);return a}),g=f.length;for(;;){let a=0,h=!0;for(let e=d;e<g;e++){let g=f[e],i=b*a,j=i+g;if(!Number.isSafeInteger(j)||i/b!==a||j-g!==i)throw Error("convertRadix: carry overflow");let k=j/c;a=j%c;let l=Math.floor(k);if(f[e]=l,!Number.isSafeInteger(l)||l*c+a!==j)throw Error("convertRadix: carry overflow");h&&(l?h=!1:d=e)}if(e.push(a),h)break}for(let b=0;b<a.length-1&&0===a[b];b++)e.push(0);return e.reverse()}Object.defineProperty(c,"__esModule",{value:!0}),c.bytes=c.stringToBytes=c.str=c.bytesToString=c.hex=c.utf8=c.bech32m=c.bech32=c.base58check=c.createBase58check=c.base58xmr=c.base58xrp=c.base58flickr=c.base58=c.base64urlnopad=c.base64url=c.base64nopad=c.base64=c.base32crockford=c.base32hexnopad=c.base32hex=c.base32nopad=c.base32=c.base16=c.utils=void 0;let s=(a,b)=>0===b?a:s(b,a%b),t=(a,b)=>a+(b-s(a,b)),u=(()=>{let a=[];for(let b=0;b<40;b++)a.push(2**b);return a})();function v(a,b,c,d){if(j(a),b<=0||b>32)throw Error(`convertRadix2: wrong from=${b}`);if(c<=0||c>32)throw Error(`convertRadix2: wrong to=${c}`);if(t(b,c)>32)throw Error(`convertRadix2: carry overflow from=${b} to=${c} carryBits=${t(b,c)}`);let e=0,f=0,g=u[b],h=u[c]-1,k=[];for(let d of a){if(i(d),d>=g)throw Error(`convertRadix2: invalid data word=${d} from=${b}`);if(e=e<<b|d,f+b>32)throw Error(`convertRadix2: carry overflow pos=${f} from=${b}`);for(f+=b;f>=c;f-=c)k.push((e>>f-c&h)>>>0);let a=u[f];if(void 0===a)throw Error("invalid carry");e&=a-1}if(e=e<<c-f&h,!d&&f>=b)throw Error("Excess padding");if(!d&&e>0)throw Error(`Non-zero padding: ${e}`);return d&&f>0&&k.push(e>>>0),k}function w(a){return i(a),{encode:b=>{if(!d(b))throw Error("radix.encode input should be Uint8Array");return r(Array.from(b),256,a)},decode:b=>(l("radix.decode",b),Uint8Array.from(r(b,a,256)))}}function x(a,b=!1){if(i(a),a<=0||a>32)throw Error("radix2: bits should be in (0..32]");if(t(8,a)>32||t(a,8)>32)throw Error("radix2: carry overflow");return{encode:c=>{if(!d(c))throw Error("radix2.encode input should be Uint8Array");return v(Array.from(c),8,a,!b)},decode:c=>(l("radix2.decode",c),Uint8Array.from(v(c,a,8,b)))}}function y(a){return g(a),function(...b){try{return a.apply(null,b)}catch(a){}}}function z(a,b){return i(a),g(b),{encode(c){if(!d(c))throw Error("checksum.encode: input should be Uint8Array");let e=b(c).slice(0,a),f=new Uint8Array(c.length+a);return f.set(c),f.set(e,c.length),f},decode(c){if(!d(c))throw Error("checksum.decode: input should be Uint8Array");let e=c.slice(0,-a),f=c.slice(-a),g=b(e).slice(0,a);for(let b=0;b<a;b++)if(g[b]!==f[b])throw Error("Invalid checksum");return e}}}c.utils={alphabet:n,chain:m,checksum:z,convertRadix:r,convertRadix2:v,radix:w,radix2:x,join:o,padding:p},c.base16=m(x(4),n("0123456789ABCDEF"),o("")),c.base32=m(x(5),n("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),p(5),o("")),c.base32nopad=m(x(5),n("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),o("")),c.base32hex=m(x(5),n("0123456789ABCDEFGHIJKLMNOPQRSTUV"),p(5),o("")),c.base32hexnopad=m(x(5),n("0123456789ABCDEFGHIJKLMNOPQRSTUV"),o("")),c.base32crockford=m(x(5),n("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),o(""),q(a=>a.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));let A="function"==typeof Uint8Array.from([]).toBase64&&"function"==typeof Uint8Array.fromBase64,B=(a,b)=>{if(h("base64",a),a.length>0&&!(b?/^[A-Za-z0-9=_-]+$/:/^[A-Za-z0-9=+/]+$/).test(a))throw Error("invalid base64");return Uint8Array.fromBase64(a,{alphabet:b?"base64url":"base64",lastChunkHandling:"strict"})};c.base64=A?{encode:a=>(e(a),a.toBase64()),decode:a=>B(a,!1)}:m(x(6),n("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),p(6),o("")),c.base64nopad=m(x(6),n("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),o("")),c.base64url=A?{encode:a=>(e(a),a.toBase64({alphabet:"base64url"})),decode:a=>B(a,!0)}:m(x(6),n("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),p(6),o("")),c.base64urlnopad=m(x(6),n("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),o(""));let C=a=>m(w(58),n(a),o(""));c.base58=C("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),c.base58flickr=C("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),c.base58xrp=C("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");let D=[0,2,3,5,6,7,9,10,11];c.base58xmr={encode(a){let b="";for(let d=0;d<a.length;d+=8){let e=a.subarray(d,d+8);b+=c.base58.encode(e).padStart(D[e.length],"1")}return b},decode(a){let b=[];for(let d=0;d<a.length;d+=11){let e=a.slice(d,d+11),f=D.indexOf(e.length),g=c.base58.decode(e);for(let a=0;a<g.length-f;a++)if(0!==g[a])throw Error("base58xmr: wrong padding");b=b.concat(Array.from(g.slice(g.length-f)))}return Uint8Array.from(b)}},c.createBase58check=a=>m(z(4,b=>a(a(b))),c.base58),c.base58check=c.createBase58check;let E=m(n("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),o("")),F=[0x3b6a57b2,0x26508e6d,0x1ea119fa,0x3d4233dd,0x2a1462b3];function G(a){let b=a>>25,c=(0x1ffffff&a)<<5;for(let a=0;a<F.length;a++)(b>>a&1)==1&&(c^=F[a]);return c}function H(a,b,c=1){let d=a.length,e=1;for(let b=0;b<d;b++){let c=a.charCodeAt(b);if(c<33||c>126)throw Error(`Invalid prefix (${a})`);e=G(e)^c>>5}e=G(e);for(let b=0;b<d;b++)e=G(e)^31&a.charCodeAt(b);for(let a of b)e=G(e)^a;for(let a=0;a<6;a++)e=G(e);return e^=c,E.encode(v([e%u[30]],30,5,!1))}function I(a){let b="bech32"===a?1:0x2bc830a3,c=x(5),e=c.decode,f=c.encode,g=y(e);function i(a,c,e=90){h("bech32.encode prefix",a),d(c)&&(c=Array.from(c)),l("bech32.encode",c);let f=a.length;if(0===f)throw TypeError(`Invalid prefix length ${f}`);let g=f+7+c.length;if(!1!==e&&g>e)throw TypeError(`Length ${g} exceeds limit ${e}`);let j=a.toLowerCase(),k=H(j,c,b);return`${j}1${E.encode(c)}${k}`}function j(a,c=90){h("bech32.decode input",a);let d=a.length;if(d<8||!1!==c&&d>c)throw TypeError(`invalid string length: ${d} (${a}). Expected (8..${c})`);let e=a.toLowerCase();if(a!==e&&a!==a.toUpperCase())throw Error("String must be lowercase or uppercase");let f=e.lastIndexOf("1");if(0===f||-1===f)throw Error('Letter "1" must be present between prefix and data only');let g=e.slice(0,f),i=e.slice(f+1);if(i.length<6)throw Error("Data must be at least 6 characters long");let k=E.decode(i).slice(0,-6),l=H(g,k,b);if(!i.endsWith(l))throw Error(`Invalid checksum in ${a}: expected "${l}"`);return{prefix:g,words:k}}let k=y(j);return{encode:i,decode:j,encodeFromBytes:function(a,b){return i(a,f(b))},decodeToBytes:function(a){let{prefix:b,words:c}=j(a,!1);return{prefix:b,words:c,bytes:e(c)}},decodeUnsafe:k,fromWords:e,fromWordsUnsafe:g,toWords:f}}c.bech32=I("bech32"),c.bech32m=I("bech32m"),c.utf8={encode:a=>new TextDecoder().decode(a),decode:a=>new TextEncoder().encode(a)},c.hex="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex?{encode:a=>(e(a),a.toHex()),decode:a=>(h("hex",a),Uint8Array.fromHex(a))}:m(x(4),n("0123456789abcdef"),o(""),q(a=>{if("string"!=typeof a||a.length%2!=0)throw TypeError(`hex.decode: expected string, got ${typeof a} with length ${a.length}`);return a.toLowerCase()}));let J={utf8:c.utf8,hex:c.hex,base16:c.base16,base32:c.base32,base64:c.base64,base64url:c.base64url,base58:c.base58,base58xmr:c.base58xmr},K="Invalid encoding type. Available types: utf8, hex, base16, base32, base64, base64url, base58, base58xmr";c.bytesToString=(a,b)=>{if("string"!=typeof a||!J.hasOwnProperty(a))throw TypeError(K);if(!d(b))throw TypeError("bytesToString() expects Uint8Array");return J[a].encode(b)},c.str=c.bytesToString,c.stringToBytes=(a,b)=>{if(!J.hasOwnProperty(a))throw TypeError(K);if("string"!=typeof b)throw TypeError("stringToBytes() expects string");return J[a].decode(b)},c.bytes=c.stringToBytes},405337,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c._TEST=c.ZeroPad=c.magicBytes=c.flag=c.cstring=c.string=c.hex=c.bytes=c.bool=c.F64LE=c.F64BE=c.F32LE=c.F32BE=c.I8=c.U8=c.I16BE=c.I16LE=c.U16BE=c.U16LE=c.I32BE=c.I32LE=c.U32BE=c.U32LE=c.int=c.I64BE=c.I64LE=c.U64BE=c.U64LE=c.I128BE=c.I128LE=c.U128BE=c.U128LE=c.I256BE=c.I256LE=c.U256BE=c.U256LE=c.bigint=c.bits=c.coders=c.wrap=c.utils=c.NULL=c.EMPTY=void 0,c.validate=r,c.isCoder=t,c.prefix=function(a,b){if(!t(b))throw Error(`prefix: invalid inner value ${b}`);return A(z(a),u(b))},c.apply=A,c.lazy=function(a){if("function"!=typeof a)throw Error(`lazy: expected function, got ${typeof a}`);return(0,c.wrap)({encodeStream:(b,c)=>a().encodeStream(b,c),decodeStream:b=>a().decodeStream(b)})},c.flagged=function(a,b,d){if(!t(b))throw Error(`flagged: invalid inner value ${b}`);if("string"!=typeof a&&!t(b))throw Error(`flagged: wrong path=${a}`);return(0,c.wrap)({encodeStream:(c,e)=>{"string"==typeof a?l.resolve(c.stack,a)?b.encodeStream(c,e):d&&b.encodeStream(c,d):(a.encodeStream(c,!!e),e?b.encodeStream(c,e):d&&b.encodeStream(c,d))},decodeStream:c=>{if("string"==typeof a?!!l.resolve(c.stack,a):a.decodeStream(c))return b.decodeStream(c);d&&b.decodeStream(c)}})},c.optional=function(a,b,d){if(!t(a)||!t(b))throw Error(`optional: invalid flag or inner value flag=${a} inner=${b}`);return(0,c.wrap)({size:void 0!==d&&a.size&&b.size?a.size+b.size:void 0,encodeStream:(c,e)=>{a.encodeStream(c,!!e),e?b.encodeStream(c,e):void 0!==d&&b.encodeStream(c,d)},decodeStream:c=>{if(a.decodeStream(c))return b.decodeStream(c);void 0!==d&&b.decodeStream(c)}})},c.magic=B,c.constant=function(a){return(0,c.wrap)({encodeStream:(b,c)=>{if(c!==a)throw Error(`constant: invalid value ${c} (exp: ${a})`)},decodeStream:b=>a})},c.struct=function(a){if(!h(a))throw Error(`struct: expected plain object, got ${a}`);for(let b in a)if(!t(a[b]))throw Error(`struct: field ${b} is not CoderType`);return(0,c.wrap)({size:C(Object.values(a)),encodeStream:(b,c)=>{b.pushObj(c,d=>{for(let e in a)d(e,()=>a[e].encodeStream(b,c[e]))})},decodeStream:b=>{let c={};return b.pushObj(c,d=>{for(let e in a)d(e,()=>c[e]=a[e].decodeStream(b))}),c},validate:a=>{if("object"!=typeof a||null===a)throw Error(`struct: invalid value ${a}`);return a}})},c.tuple=function(a){if(!Array.isArray(a))throw Error(`Packed.Tuple: got ${typeof a} instead of array`);for(let b=0;b<a.length;b++)if(!t(a[b]))throw Error(`tuple: field ${b} is not CoderType`);return(0,c.wrap)({size:C(a),encodeStream:(b,c)=>{if(!Array.isArray(c))throw b.err(`tuple: invalid value ${c}`);b.pushObj(c,d=>{for(let e=0;e<a.length;e++)d(`${e}`,()=>a[e].encodeStream(b,c[e]))})},decodeStream:b=>{let c=[];return b.pushObj(c,d=>{for(let e=0;e<a.length;e++)d(`${e}`,()=>c.push(a[e].decodeStream(b)))}),c},validate:b=>{if(!Array.isArray(b))throw Error(`tuple: invalid value ${b}`);if(b.length!==a.length)throw Error(`tuple: wrong length=${b.length}, expected ${a.length}`);return b}})},c.array=function(a,b){if(!t(b))throw Error(`array: invalid inner value ${b}`);let d=j("string"==typeof a?`../${a}`:a);return(0,c.wrap)({size:"number"==typeof a&&b.size?a*b.size:void 0,encodeStream:(c,g)=>{c.pushObj(g,h=>{f(a)||d.encodeStream(c,g.length);for(let d=0;d<g.length;d++)h(`${d}`,()=>{let h=g[d],i=c.pos;if(b.encodeStream(c,h),f(a)){if(a.length>c.pos-i)return;let b=c.finish(!1).subarray(i,c.pos);if(e(b.subarray(0,a.length),a))throw c.err(`array: inner element encoding same as separator. elm=${h} data=${b}`)}})}),f(a)&&c.bytes(a)},decodeStream:c=>{let g=[];return c.pushObj(g,h=>{if(null===a)for(let a=0;!c.isEnd()&&(h(`${a}`,()=>g.push(b.decodeStream(c))),!b.size||!(c.leftBytes<b.size));a++);else if(f(a))for(let d=0;;d++){if(e(c.bytes(a.length,!0),a)){c.bytes(a.length);break}h(`${d}`,()=>g.push(b.decodeStream(c)))}else{let a;h("arrayLen",()=>a=d.decodeStream(c));for(let d=0;d<a;d++)h(`${d}`,()=>g.push(b.decodeStream(c)))}}),g},validate:a=>{if(!Array.isArray(a))throw Error(`array: invalid value ${a}`);return a}})},c.map=D,c.tag=E,c.mappedTag=function(a,b){if(!t(a))throw Error(`mappedTag: invalid tag value ${E}`);if(!h(b))throw Error("mappedTag: variants should be plain object");let c={},d={};for(let a in b){let e=b[a];c[a]=e[0],d[a]=e[1]}return E(D(a,c),d)},c.bitset=function(a,b=!1){if("boolean"!=typeof b)throw Error(`bitset/pad: expected boolean, got ${typeof b}`);if(!Array.isArray(a))throw Error("bitset/names: expected array");for(let b of a)if("string"!=typeof b)throw Error("bitset/names: expected array of strings");return(0,c.wrap)({encodeStream:(c,d)=>{for(let b=0;b<a.length;b++)c.bits(+d[a[b]],1);b&&a.length%8&&c.bits(0,8-a.length%8)},decodeStream:c=>{let d={};for(let b=0;b<a.length;b++)d[a[b]]=!!c.bits(1);return b&&a.length%8&&c.bits(8-a.length%8),d},validate:a=>{if(!h(a))throw Error(`bitset: invalid value ${a}`);for(let b of Object.values(a))if("boolean"!=typeof b)throw Error("expected boolean");return a}})},c.padLeft=function(a,b,d){if(!i(a)||a<=0)throw Error(`padLeft: wrong blockSize=${a}`);if(!t(b))throw Error(`padLeft: invalid inner value ${b}`);if(void 0!==d&&"function"!=typeof d)throw Error(`padLeft: wrong padFn=${typeof d}`);let e=d||c.ZeroPad;if(!b.size)throw Error("padLeft cannot have dynamic size");return(0,c.wrap)({size:b.size+F(a,b.size),encodeStream:(c,d)=>{let f=F(a,b.size);for(let a=0;a<f;a++)c.byte(e(a));b.encodeStream(c,d)},decodeStream:c=>(c.bytes(F(a,b.size)),b.decodeStream(c))})},c.padRight=function(a,b,d){if(!t(b))throw Error(`padRight: invalid inner value ${b}`);if(!i(a)||a<=0)throw Error(`padLeft: wrong blockSize=${a}`);if(void 0!==d&&"function"!=typeof d)throw Error(`padRight: wrong padFn=${typeof d}`);let e=d||c.ZeroPad;return(0,c.wrap)({size:b.size?b.size+F(a,b.size):void 0,encodeStream:(c,d)=>{let f=c.pos;b.encodeStream(c,d);let g=F(a,c.pos-f);for(let a=0;a<g;a++)c.byte(e(a))},decodeStream:c=>{let d=c.pos,e=b.decodeStream(c);return c.bytes(F(a,c.pos-d)),e}})},c.pointer=function(a,b,d=!1){if(!t(a))throw Error(`pointer: invalid ptr value ${a}`);if(!t(b))throw Error(`pointer: invalid inner value ${b}`);if("boolean"!=typeof d)throw Error(`pointer/sized: expected boolean, got ${typeof d}`);if(!a.size)throw Error("unsized pointer");return(0,c.wrap)({size:d?a.size:void 0,encodeStream:(c,d)=>{let e=c.pos;a.encodeStream(c,0),c.ptrs.push({pos:e,ptr:a,buffer:b.encode(d)})},decodeStream:c=>{let d=a.decodeStream(c);return c._enablePointers(),b.decodeStream(c.offsetReader(d))}})};let d=a.r(67528);function e(a,b){if(a.length!==b.length)return!1;for(let c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function f(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}c.EMPTY=new Uint8Array,c.NULL=new Uint8Array([0]);let g=a=>new DataView(a.buffer,a.byteOffset,a.byteLength);function h(a){return"[object Object]"===Object.prototype.toString.call(a)}function i(a){return Number.isSafeInteger(a)}c.utils={equalBytes:e,isBytes:f,isCoder:t,checkBounds:p,concatBytes:function(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];if(!f(d))throw Error("Uint8Array expected");b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c},createView:g,isPlainObject:h};let j=a=>{if(null!==a&&"string"!=typeof a&&!t(a)&&!f(a)&&!i(a))throw Error(`lengthCoder: expected null | number | Uint8Array | CoderType, got ${a} (${typeof a})`);return{encodeStream(b,c){let d;if(null!==a){if(t(a))return a.encodeStream(b,c);if("number"==typeof a?d=a:"string"==typeof a&&(d=l.resolve(b.stack,a)),"bigint"==typeof d&&(d=Number(d)),void 0===d||d!==c)throw b.err(`Wrong length: ${d} len=${a} exp=${c} (${typeof c})`)}},decodeStream(b){let c;if(t(a)?c=Number(a.decodeStream(b)):"number"==typeof a?c=a:"string"==typeof a&&(c=l.resolve(b.stack,a)),"bigint"==typeof c&&(c=Number(c)),"number"!=typeof c)throw b.err(`Wrong length: ${c}`);return c}}},k={BITS:32,FULL_MASK:0xffffffff,len:a=>Math.ceil(a/32),create:a=>new Uint32Array(k.len(a)),clean:a=>a.fill(0),debug:a=>Array.from(a).map(a=>(a>>>0).toString(2).padStart(32,"0")),checkLen:(a,b)=>{if(k.len(b)!==a.length)throw Error(`wrong length=${a.length}. Expected: ${k.len(b)}`)},chunkLen:(a,b,c)=>{if(b<0)throw Error(`wrong pos=${b}`);if(b+c>a)throw Error(`wrong range=${b}/${c} of ${a}`)},set:(a,b,c,d=!0)=>(!!d||(a[b]&c)==0)&&(a[b]|=c,!0),pos:(a,b)=>({chunk:Math.floor((a+b)/32),mask:1<<32-(a+b)%32-1}),indices:(a,b,c=!1)=>{k.checkLen(a,b);let{FULL_MASK:d,BITS:e}=k,f=e-b%e,g=f?d>>>f<<f:d,h=[];for(let b=0;b<a.length;b++){let d=a[b];if(c&&(d=~d),b===a.length-1&&(d&=g),0!==d)for(let a=0;a<e;a++)d&1<<e-a-1&&h.push(b*e+a)}return h},range:a=>{let b,c=[];for(let d of a)void 0===b||d!==b.pos+b.length?c.push(b={pos:d,length:1}):b.length+=1;return c},rangeDebug:(a,b,c=!1)=>`[${k.range(k.indices(a,b,c)).map(a=>`(${a.pos}/${a.length})`).join(", ")}]`,setRange:(a,b,c,d,e=!0)=>{k.chunkLen(b,c,d);let{FULL_MASK:f,BITS:g}=k,h=c%g?Math.floor(c/g):void 0,i=c+d,j=i%g?Math.floor(i/g):void 0;if(void 0!==h&&h===j)return k.set(a,h,f>>>g-d<<g-d-c,e);if(void 0!==h&&!k.set(a,h,f>>>c%g,e))return!1;let l=void 0!==h?h+1:c/g,m=void 0!==j?j:i/g;for(let b=l;b<m;b++)if(!k.set(a,b,f,e))return!1;return void 0===j||h===j||!!k.set(a,j,f<<g-i%g,e)}},l={pushObj:(a,b,c)=>{let d={obj:b};a.push(d),c((a,b)=>{d.field=a,b(),d.field=void 0}),a.pop()},path:a=>{let b=[];for(let c of a)void 0!==c.field&&b.push(c.field);return b.join("/")},err:(a,b,c)=>{let d=Error(`${a}(${l.path(b)}): ${"string"==typeof c?c:c.message}`);return c instanceof Error&&c.stack&&(d.stack=c.stack),d},resolve:(a,b)=>{let c=b.split("/"),d=a.map(a=>a.obj),e=0;for(;e<c.length;e++)if(".."===c[e])d.pop();else break;let f=d.pop();for(;e<c.length;e++){if(!f||void 0===f[c[e]])return;f=f[c[e]]}return f}};class m{constructor(a,b={},c=[],d,e=0){this.pos=0,this.bitBuf=0,this.bitPos=0,this.data=a,this.opts=b,this.stack=c,this.parent=d,this.parentOffset=e,this.view=g(a)}_enablePointers(){if(this.parent)return this.parent._enablePointers();this.bs||(this.bs=k.create(this.data.length),k.setRange(this.bs,this.data.length,0,this.pos,this.opts.allowMultipleReads))}markBytesBS(a,b){return this.parent?this.parent.markBytesBS(this.parentOffset+a,b):!b||!this.bs||k.setRange(this.bs,this.data.length,a,b,!1)}markBytes(a){let b=this.pos;this.pos+=a;let c=this.markBytesBS(b,a);if(!this.opts.allowMultipleReads&&!c)throw this.err(`multiple read pos=${this.pos} len=${a}`);return c}pushObj(a,b){return l.pushObj(this.stack,a,b)}readView(a,b){if(!Number.isFinite(a))throw this.err(`readView: wrong length=${a}`);if(this.pos+a>this.data.length)throw this.err("readView: Unexpected end of buffer");let c=b(this.view,this.pos);return this.markBytes(a),c}absBytes(a){if(a>this.data.length)throw Error("Unexpected end of buffer");return this.data.subarray(a)}finish(){if(!this.opts.allowUnreadBytes){if(this.bitPos)throw this.err(`${this.bitPos} bits left after unpack: ${d.hex.encode(this.data.slice(this.pos))}`);if(this.bs&&!this.parent){let a=k.indices(this.bs,this.data.length,!0);if(!a.length)return;{let b=k.range(a).map(({pos:a,length:b})=>`(${a}/${b})[${d.hex.encode(this.data.subarray(a,a+b))}]`).join(", ");throw this.err(`unread byte ranges: ${b} (total=${this.data.length})`)}}if(!this.isEnd())throw this.err(`${this.leftBytes} bytes ${this.bitPos} bits left after unpack: ${d.hex.encode(this.data.slice(this.pos))}`)}}err(a){return l.err("Reader",this.stack,a)}offsetReader(a){if(a>this.data.length)throw this.err("offsetReader: Unexpected end of buffer");return new m(this.absBytes(a),this.opts,this.stack,this,a)}bytes(a,b=!1){if(this.bitPos)throw this.err("readBytes: bitPos not empty");if(!Number.isFinite(a))throw this.err(`readBytes: wrong length=${a}`);if(this.pos+a>this.data.length)throw this.err("readBytes: Unexpected end of buffer");let c=this.data.subarray(this.pos,this.pos+a);return b||this.markBytes(a),c}byte(a=!1){if(this.bitPos)throw this.err("readByte: bitPos not empty");if(this.pos+1>this.data.length)throw this.err("readBytes: Unexpected end of buffer");let b=this.data[this.pos];return a||this.markBytes(1),b}get leftBytes(){return this.data.length-this.pos}get totalBytes(){return this.data.length}isEnd(){return this.pos>=this.data.length&&!this.bitPos}bits(a){if(a>32)throw this.err("BitReader: cannot read more than 32 bits in single call");let b=0;for(;a;){this.bitPos||(this.bitBuf=this.byte(),this.bitPos=8);let c=Math.min(a,this.bitPos);this.bitPos-=c,b=b<<c|this.bitBuf>>this.bitPos&2**c-1,this.bitBuf&=2**this.bitPos-1,a-=c}return b>>>0}find(a,b=this.pos){if(!f(a))throw this.err(`find: needle is not bytes! ${a}`);if(this.bitPos)throw this.err("findByte: bitPos not empty");if(!a.length)throw this.err("find: needle is empty");for(let c=b;-1!==(c=this.data.indexOf(a[0],c))&&-1!==c&&!(this.data.length-c<a.length);c++)if(e(a,this.data.subarray(c,c+a.length)))return c}}class n{constructor(a=[]){this.pos=0,this.buffers=[],this.ptrs=[],this.bitBuf=0,this.bitPos=0,this.viewBuf=new Uint8Array(8),this.finished=!1,this.stack=a,this.view=g(this.viewBuf)}pushObj(a,b){return l.pushObj(this.stack,a,b)}writeView(a,b){if(this.finished)throw this.err("buffer: finished");if(!i(a)||a>8)throw Error(`wrong writeView length=${a}`);b(this.view),this.bytes(this.viewBuf.slice(0,a)),this.viewBuf.fill(0)}err(a){if(this.finished)throw this.err("buffer: finished");return l.err("Reader",this.stack,a)}bytes(a){if(this.finished)throw this.err("buffer: finished");if(this.bitPos)throw this.err("writeBytes: ends with non-empty bit buffer");this.buffers.push(a),this.pos+=a.length}byte(a){if(this.finished)throw this.err("buffer: finished");if(this.bitPos)throw this.err("writeByte: ends with non-empty bit buffer");this.buffers.push(new Uint8Array([a])),this.pos++}finish(a=!0){if(this.finished)throw this.err("buffer: finished");if(this.bitPos)throw this.err("buffer: ends with non-empty bit buffer");let b=this.buffers.concat(this.ptrs.map(a=>a.buffer)),c=new Uint8Array(b.map(a=>a.length).reduce((a,b)=>a+b,0));for(let a=0,d=0;a<b.length;a++){let e=b[a];c.set(e,d),d+=e.length}for(let a=this.pos,b=0;b<this.ptrs.length;b++){let d=this.ptrs[b];c.set(d.ptr.encode(a),d.pos),a+=d.buffer.length}if(a){for(let a of(this.buffers=[],this.ptrs))a.buffer.fill(0);this.ptrs=[],this.finished=!0,this.bitBuf=0}return c}bits(a,b){if(b>32)throw this.err("writeBits: cannot write more than 32 bits in single call");if(a>=2**b)throw this.err(`writeBits: value (${a}) >= 2**bits (${b})`);for(;b;){let c=Math.min(b,8-this.bitPos);this.bitBuf=this.bitBuf<<c|a>>b-c,this.bitPos+=c,b-=c,a&=2**b-1,8===this.bitPos&&(this.bitPos=0,this.buffers.push(new Uint8Array([this.bitBuf])),this.pos++)}}}let o=a=>Uint8Array.from(a).reverse();function p(a,b,c){if(c){let c=2n**(b-1n);if(a<-c||a>=c)throw Error(`value out of signed bounds. Expected ${-c} <= ${a} < ${c}`)}else if(0n>a||a>=2n**b)throw Error(`value out of unsigned bounds. Expected 0 <= ${a} < ${2n**b}`)}function q(a){return{encodeStream:a.encodeStream,decodeStream:a.decodeStream,size:a.size,encode:b=>{let c=new n;return a.encodeStream(c,b),c.finish()},decode:(b,c={})=>{let d=new m(b,c),e=a.decodeStream(d);return d.finish(),e}}}function r(a,b){if(!t(a))throw Error(`validate: invalid inner value ${a}`);if("function"!=typeof b)throw Error("validate: fn should be function");return q({size:a.size,encodeStream:(c,d)=>{let e;try{e=b(d)}catch(a){throw c.err(a)}a.encodeStream(c,e)},decodeStream:c=>{let d=a.decodeStream(c);try{return b(d)}catch(a){throw c.err(a)}}})}c.wrap=a=>{let b=q(a);return a.validate?r(b,a.validate):b};let s=a=>h(a)&&"function"==typeof a.decode&&"function"==typeof a.encode;function t(a){return h(a)&&s(a)&&"function"==typeof a.encodeStream&&"function"==typeof a.decodeStream&&(void 0===a.size||i(a.size))}let u=a=>{if(!s(a))throw Error("BaseCoder expected");return{encode:a.decode,decode:a.encode}};c.coders={dict:function(){return{encode:a=>{if(!Array.isArray(a))throw Error("array expected");let b={};for(let c of a){if(!Array.isArray(c)||2!==c.length)throw Error("array of two elements expected");let a=c[0],d=c[1];if(void 0!==b[a])throw Error(`key(${a}) appears twice in struct`);b[a]=d}return b},decode:a=>{if(!h(a))throw Error(`expected plain object, got ${a}`);return Object.entries(a)}}},numberBigint:{encode:a=>{if("bigint"!=typeof a)throw Error(`expected bigint, got ${typeof a}`);if(a>BigInt(Number.MAX_SAFE_INTEGER))throw Error(`element bigger than MAX_SAFE_INTEGER=${a}`);return Number(a)},decode:a=>{if(!i(a))throw Error("element is not a safe integer");return BigInt(a)}},tsEnum:function(a){if(!h(a))throw Error("plain object expected");return{encode:b=>{if(!i(b)||!(b in a))throw Error(`wrong value ${b}`);return a[b]},decode:b=>{if("string"!=typeof b)throw Error(`wrong value ${typeof b}`);return a[b]}}},decimal:function(a,b=!1){if(!i(a))throw Error(`decimal/precision: wrong value ${a}`);if("boolean"!=typeof b)throw Error(`decimal/round: expected boolean, got ${typeof b}`);let c=10n**BigInt(a);return{encode:b=>{if("bigint"!=typeof b)throw Error(`expected bigint, got ${typeof b}`);let c=(b<0n?-b:b).toString(10),d=c.length-a;d<0&&(c=c.padStart(c.length-d,"0"),d=0);let e=c.length-1;for(;e>=d&&"0"===c[e];e--);let f=c.slice(0,d),g=c.slice(d,e+1);return(f||(f="0"),b<0n&&(f="-"+f),g)?`${f}.${g}`:f},decode:d=>{if("string"!=typeof d)throw Error(`expected string, got ${typeof d}`);if("-0"===d)throw Error("negative zero is not allowed");let e=!1;if(d.startsWith("-")&&(e=!0,d=d.slice(1)),!/^(0|[1-9]\d*)(\.\d+)?$/.test(d))throw Error(`wrong string value=${d}`);let f=d.indexOf(".");f=-1===f?d.length:f;let g=d.slice(0,f),h=d.slice(f+1).replace(/0+$/,""),i=BigInt(g)*c;if(!b&&h.length>a)throw Error(`fractional part cannot be represented with this precision (num=${d}, prec=${a})`);let j=Math.min(h.length,a),k=i+BigInt(h.slice(0,j))*10n**BigInt(a-j);return e?-k:k}}},match:function(a){if(!Array.isArray(a))throw Error(`expected array, got ${typeof a}`);for(let b of a)if(!s(b))throw Error(`wrong base coder ${b}`);return{encode:b=>{for(let c of a){let a=c.encode(b);if(void 0!==a)return a}throw Error(`match/encode: cannot find match in ${b}`)},decode:b=>{for(let c of a){let a=c.decode(b);if(void 0!==a)return a}throw Error(`match/decode: cannot find match in ${b}`)}}},reverse:u},c.bits=a=>{if(!i(a))throw Error(`bits: wrong length ${a} (${typeof a})`);return(0,c.wrap)({encodeStream:(b,c)=>b.bits(c,a),decodeStream:b=>b.bits(a),validate:a=>{if(!i(a))throw Error(`bits: wrong value ${a}`);return a}})},c.bigint=(a,b=!1,d=!1,e=!0)=>{if(!i(a))throw Error(`bigint/size: wrong value ${a}`);if("boolean"!=typeof b)throw Error(`bigint/le: expected boolean, got ${typeof b}`);if("boolean"!=typeof d)throw Error(`bigint/signed: expected boolean, got ${typeof d}`);if("boolean"!=typeof e)throw Error(`bigint/sized: expected boolean, got ${typeof e}`);let f=BigInt(a),g=2n**(8n*f-1n);return(0,c.wrap)({size:e?a:void 0,encodeStream:(c,f)=>{d&&f<0&&(f|=g);let h=[];for(let b=0;b<a;b++)h.push(Number(255n&f)),f>>=8n;let i=new Uint8Array(h).reverse();if(!e){let a=0;for(a=0;a<i.length&&0===i[a];a++);i=i.subarray(a)}c.bytes(b?i.reverse():i)},decodeStream:c=>{let f=c.bytes(e?a:Math.min(a,c.leftBytes)),h=b?f:o(f),i=0n;for(let a=0;a<h.length;a++)i|=BigInt(h[a])<<8n*BigInt(a);return d&&i&g&&(i=(i^g)-g),i},validate:a=>{if("bigint"!=typeof a)throw Error(`bigint: invalid value: ${a}`);return p(a,8n*f,!!d),a}})},c.U256LE=(0,c.bigint)(32,!0),c.U256BE=(0,c.bigint)(32,!1),c.I256LE=(0,c.bigint)(32,!0,!0),c.I256BE=(0,c.bigint)(32,!1,!0),c.U128LE=(0,c.bigint)(16,!0),c.U128BE=(0,c.bigint)(16,!1),c.I128LE=(0,c.bigint)(16,!0,!0),c.I128BE=(0,c.bigint)(16,!1,!0),c.U64LE=(0,c.bigint)(8,!0),c.U64BE=(0,c.bigint)(8,!1),c.I64LE=(0,c.bigint)(8,!0,!0),c.I64BE=(0,c.bigint)(8,!1,!0),c.int=(a,b=!1,d=!1,e=!0)=>{if(!i(a))throw Error(`int/size: wrong value ${a}`);if("boolean"!=typeof b)throw Error(`int/le: expected boolean, got ${typeof b}`);if("boolean"!=typeof d)throw Error(`int/signed: expected boolean, got ${typeof d}`);if("boolean"!=typeof e)throw Error(`int/sized: expected boolean, got ${typeof e}`);if(a>6)throw Error("int supports size up to 6 bytes (48 bits): use bigints instead");return A((0,c.bigint)(a,b,d,e),c.coders.numberBigint)};let v=(a,b)=>(0,c.wrap)({size:a,encodeStream:(c,d)=>c.writeView(a,a=>b.write(a,d)),decodeStream:c=>c.readView(a,b.read),validate:a=>{if("number"!=typeof a)throw Error(`viewCoder: expected number, got ${typeof a}`);return b.validate&&b.validate(a),a}}),w=(a,b,c)=>{let d=8*a,e=2**(d-1),f=2**d;return v(a,{write:c.write,read:c.read,validate:b?a=>{if(!i(a))throw Error(`sintView: value is not safe integer: ${a}`);if(a<-e||a>=e)throw Error(`sintView: value out of bounds. Expected ${-e} <= ${a} < ${e}`)}:a=>{if(!i(a))throw Error(`uintView: value is not safe integer: ${a}`);if(0>a||a>=f)throw Error(`uintView: value out of bounds. Expected 0 <= ${a} < ${f}`)}})};c.U32LE=w(4,!1,{read:(a,b)=>a.getUint32(b,!0),write:(a,b)=>a.setUint32(0,b,!0)}),c.U32BE=w(4,!1,{read:(a,b)=>a.getUint32(b,!1),write:(a,b)=>a.setUint32(0,b,!1)}),c.I32LE=w(4,!0,{read:(a,b)=>a.getInt32(b,!0),write:(a,b)=>a.setInt32(0,b,!0)}),c.I32BE=w(4,!0,{read:(a,b)=>a.getInt32(b,!1),write:(a,b)=>a.setInt32(0,b,!1)}),c.U16LE=w(2,!1,{read:(a,b)=>a.getUint16(b,!0),write:(a,b)=>a.setUint16(0,b,!0)}),c.U16BE=w(2,!1,{read:(a,b)=>a.getUint16(b,!1),write:(a,b)=>a.setUint16(0,b,!1)}),c.I16LE=w(2,!0,{read:(a,b)=>a.getInt16(b,!0),write:(a,b)=>a.setInt16(0,b,!0)}),c.I16BE=w(2,!0,{read:(a,b)=>a.getInt16(b,!1),write:(a,b)=>a.setInt16(0,b,!1)}),c.U8=w(1,!1,{read:(a,b)=>a.getUint8(b),write:(a,b)=>a.setUint8(0,b)}),c.I8=w(1,!0,{read:(a,b)=>a.getInt8(b),write:(a,b)=>a.setInt8(0,b)});let x=a=>v(4,{read:(b,c)=>b.getFloat32(c,a),write:(b,c)=>b.setFloat32(0,c,a),validate:a=>{if(Math.fround(a)!==a&&!Number.isNaN(a))throw Error(`f32: wrong value=${a}`)}}),y=a=>v(8,{read:(b,c)=>b.getFloat64(c,a),write:(b,c)=>b.setFloat64(0,c,a)});c.F32BE=x(!1),c.F32LE=x(!0),c.F64BE=y(!1),c.F64LE=y(!0),c.bool=(0,c.wrap)({size:1,encodeStream:(a,b)=>a.byte(+!!b),decodeStream:a=>{let b=a.byte();if(0!==b&&1!==b)throw a.err(`bool: invalid value ${b}`);return 1===b},validate:a=>{if("boolean"!=typeof a)throw Error(`bool: invalid value ${a}`);return a}});let z=(a,b=!1)=>{if("boolean"!=typeof b)throw Error(`bytes/le: expected boolean, got ${typeof b}`);let d=j(a),e=f(a);return(0,c.wrap)({size:"number"==typeof a?a:void 0,encodeStream:(c,f)=>{e||d.encodeStream(c,f.length),c.bytes(b?o(f):f),e&&c.bytes(a)},decodeStream:c=>{let f;if(e){let b=c.find(a);if(!b)throw c.err("bytes: cannot find terminator");f=c.bytes(b-c.pos),c.bytes(a.length)}else f=c.bytes(null===a?c.leftBytes:d.decodeStream(c));return b?o(f):f},validate:a=>{if(!f(a))throw Error(`bytes: invalid value ${a}`);return a}})};function A(a,b){if(!t(a))throw Error(`apply: invalid inner value ${a}`);if(!s(b))throw Error(`apply: invalid base value ${a}`);return(0,c.wrap)({size:a.size,encodeStream:(c,d)=>{let e;try{e=b.decode(d)}catch(a){throw c.err(""+a)}return a.encodeStream(c,e)},decodeStream:c=>{let d=a.decodeStream(c);try{return b.encode(d)}catch(a){throw c.err(""+a)}}})}function B(a,b,d=!0){if(!t(a))throw Error(`magic: invalid inner value ${a}`);if("boolean"!=typeof d)throw Error(`magic: expected boolean, got ${typeof d}`);return(0,c.wrap)({size:a.size,encodeStream:(c,d)=>a.encodeStream(c,b),decodeStream:c=>{let g=a.decodeStream(c);if(d&&"object"!=typeof g&&g!==b||f(b)&&!e(b,g))throw c.err(`magic: invalid value: ${g} !== ${b}`)},validate:a=>{if(void 0!==a)throw Error(`magic: wrong value=${typeof a}`);return a}})}function C(a){let b=0;for(let c of a){if(void 0===c.size)return;if(!i(c.size))throw Error(`sizeof: wrong element size=${b}`);b+=c.size}return b}function D(a,b){if(!t(a))throw Error(`map: invalid inner value ${a}`);if(!h(b))throw Error("map: variants should be plain object");let d=new Map;for(let a in b)d.set(b[a],a);return(0,c.wrap)({size:a.size,encodeStream:(c,d)=>a.encodeStream(c,b[d]),decodeStream:b=>{let c=a.decodeStream(b),e=d.get(c);if(void 0===e)throw b.err(`Enum: unknown value: ${c} ${Array.from(d.keys())}`);return e},validate:a=>{if("string"!=typeof a)throw Error(`map: invalid value ${a}`);if(!(a in b))throw Error(`Map: unknown variant: ${a}`);return a}})}function E(a,b){if(!t(a))throw Error(`tag: invalid tag value ${a}`);if(!h(b))throw Error("tag: variants should be plain object");for(let a in b)if(!t(b[a]))throw Error(`tag: variant ${a} is not CoderType`);return(0,c.wrap)({size:a.size,encodeStream:(c,d)=>{let{TAG:e,data:f}=d,g=b[e];a.encodeStream(c,e),g.encodeStream(c,f)},decodeStream:c=>{let d=a.decodeStream(c),e=b[d];if(!e)throw c.err(`Tag: invalid tag ${d}`);return{TAG:d,data:e.decodeStream(c)}},validate:a=>{let{TAG:c}=a;if(!b[c])throw Error(`Tag: invalid tag ${c.toString()}`);return a}})}function F(a,b){return b%a==0?0:a-b%a}c.bytes=z,c.string=(a,b=!1)=>r(A(z(a,b),d.utf8),a=>{if("string"!=typeof a)throw Error(`expected string, got ${typeof a}`);return a}),c.cstring=(0,c.string)(c.NULL),c.hex=(a,b={isLE:!1,with0x:!1})=>{let c=A(z(a,b.isLE),d.hex),e=b.with0x;if("boolean"!=typeof e)throw Error(`hex/with0x: expected boolean, got ${typeof e}`);return e&&(c=A(c,{encode:a=>`0x${a}`,decode:a=>{if(!a.startsWith("0x"))throw Error("hex(with0x=true).encode input should start with 0x");return a.slice(2)}})),c},c.flag=(a,b=!1)=>{if(!f(a))throw Error(`flag/flagValue: expected Uint8Array, got ${typeof a}`);if("boolean"!=typeof b)throw Error(`flag/xor: expected boolean, got ${typeof b}`);return(0,c.wrap)({size:a.length,encodeStream:(c,d)=>{!!d!==b&&c.bytes(a)},decodeStream:c=>{let d=c.leftBytes>=a.length;return d&&(d=e(c.bytes(a.length,!0),a))&&c.bytes(a.length),d!==b},validate:a=>{if(void 0!==a&&"boolean"!=typeof a)throw Error(`flag: expected boolean value or undefined, got ${typeof a}`);return a}})},c.magicBytes=a=>{let b="string"==typeof a?d.utf8.decode(a):a;return B(z(b.length),b)},c.ZeroPad=a=>0,c._TEST={_bitset:k,_Reader:m,_Writer:n,Path:l}},411320,(a,b,c)=>{"use strict";var d;Object.defineProperty(c,"__esModule",{value:!0}),c.TEST_NETWORK=c.NETWORK=c.TAPROOT_UNSPENDABLE_KEY=c.PubT=c.tagSchnorr=c.signSchnorr=c.pubECDSA=c.pubSchnorr=c.randomPrivateKeyBytes=c.sha256x2=c.hash160=c.sha256=c.isBytes=c.equalBytes=c.concatBytes=void 0,c.signECDSA=function(a,b,c=!1){let d=e.secp256k1.sign(a,b);if(c&&!m(d)){let c=new Uint8Array(32),f=0;for(;!m(d);)if(c.set(h.U32LE.encode(f++)),d=e.secp256k1.sign(a,b,{extraEntropy:c}),f>0xffffffff)throw Error("lowR counter overflow: report the error")}return d.toDERRawBytes()},c.validatePubkey=function(a,b){let c=a.length;if(b===d.ecdsa){if(32===c)throw Error("Expected non-Schnorr key");return i.fromHex(a),a}if(b===d.schnorr){if(32!==c)throw Error("Expected 32-byte Schnorr key");return e.schnorr.utils.lift_x(e.schnorr.utils.bytesToNumberBE(a)),a}throw Error("Unknown key type")},c.tapTweak=n,c.taprootTweakPrivKey=function(a,b=new Uint8Array){let c=e.schnorr.utils,d=c.bytesToNumberBE(a),f=i.fromPrivateKey(d),g=f.hasEvenY()?d:c.mod(-d,j),h=n(c.pointToBytes(f),b);return c.numberToBytesBE(c.mod(g+h,j),32)},c.taprootTweakPubkey=function(a,b){let c=e.schnorr.utils,d=n(a,b),f=c.lift_x(c.bytesToNumberBE(a)).add(i.fromPrivateKey(d)),g=+!f.hasEvenY();return[c.pointToBytes(f),g]},c.compareBytes=function(a,b){if(!k(a)||!k(b))throw Error(`cmp: wrong type a=${typeof a} b=${typeof b}`);let c=Math.min(a.length,b.length);for(let d=0;d<c;d++)if(a[d]!=b[d])return Math.sign(a[d]-b[d]);return Math.sign(a.length-b.length)};let e=a.r(168688),f=a.r(500809),g=a.r(132267);Object.defineProperty(c,"sha256",{enumerable:!0,get:function(){return g.sha256}});let h=a.r(405337),i=e.secp256k1.ProjectivePoint,j=e.secp256k1.CURVE.n,k=h.utils.isBytes;c.isBytes=k;let l=h.utils.concatBytes;c.concatBytes=l,c.equalBytes=h.utils.equalBytes,c.hash160=a=>(0,f.ripemd160)((0,g.sha256)(a)),c.sha256x2=(...a)=>(0,g.sha256)((0,g.sha256)(l(...a))),c.randomPrivateKeyBytes=e.schnorr.utils.randomPrivateKey,c.pubSchnorr=e.schnorr.getPublicKey,c.pubECDSA=e.secp256k1.getPublicKey;let m=a=>a.r<j/2n;function n(a,b){let c=e.schnorr.utils,d=c.taggedHash("TapTweak",a,b),f=c.bytesToNumberBE(d);if(f>=j)throw Error("tweak higher than curve order");return f}c.signSchnorr=e.schnorr.sign,c.tagSchnorr=e.schnorr.utils.taggedHash,function(a){a[a.ecdsa=0]="ecdsa",a[a.schnorr=1]="schnorr"}(d||(c.PubT=d={})),c.TAPROOT_UNSPENDABLE_KEY=(0,g.sha256)(i.BASE.toRawBytes(!1)),c.NETWORK={bech32:"bc",pubKeyHash:0,scriptHash:5,wif:128},c.TEST_NETWORK={bech32:"tb",pubKeyHash:111,scriptHash:196,wif:239}},162850,(a,b,c)=>{"use strict";var d;Object.defineProperty(c,"__esModule",{value:!0}),c.RawOldTx=c.RawTx=c.RawOutput=c.RawInput=c.BTCArray=c.RawWitness=c.VarBytes=c.CompactSizeLen=c.CompactSize=c.Script=c.OP=c.MAX_SCRIPT_BYTE_LENGTH=void 0,c.ScriptNum=g,c.OpToNum=function(a,b=4,c=!0){if("number"==typeof a)return a;if((0,f.isBytes)(a))try{let d=g(b,c).decode(a);if(d>Number.MAX_SAFE_INTEGER)return;return Number(d)}catch(a){}};let e=a.r(405337),f=a.r(411320);function g(a=6,b=!1){return e.wrap({encodeStream:(a,b)=>{if(0n===b)return;let c=b<0,d=BigInt(b),e=[];for(let a=c?-d:d;a;a>>=8n)e.push(Number(255n&a));e[e.length-1]>=128?e.push(128*!!c):c&&(e[e.length-1]|=128),a.bytes(new Uint8Array(e))},decodeStream:c=>{let d=c.leftBytes;if(d>a)throw Error(`ScriptNum: number (${d}) bigger than limit=${a}`);if(0===d)return 0n;if(b){let a=c.bytes(d,!0);if((127&a[a.length-1])==0&&(d<=1||(128&a[a.length-2])==0))throw Error("Non-minimally encoded ScriptNum")}let e=0,f=0n;for(let a=0;a<d;++a)f|=BigInt(e=c.byte())<<8n*BigInt(a);return e>=128&&(f&=2n**BigInt(8*d)-1n>>1n,f=-f),f}})}c.MAX_SCRIPT_BYTE_LENGTH=520,function(a){a[a.OP_0=0]="OP_0",a[a.PUSHDATA1=76]="PUSHDATA1",a[a.PUSHDATA2=77]="PUSHDATA2",a[a.PUSHDATA4=78]="PUSHDATA4",a[a["1NEGATE"]=79]="1NEGATE",a[a.RESERVED=80]="RESERVED",a[a.OP_1=81]="OP_1",a[a.OP_2=82]="OP_2",a[a.OP_3=83]="OP_3",a[a.OP_4=84]="OP_4",a[a.OP_5=85]="OP_5",a[a.OP_6=86]="OP_6",a[a.OP_7=87]="OP_7",a[a.OP_8=88]="OP_8",a[a.OP_9=89]="OP_9",a[a.OP_10=90]="OP_10",a[a.OP_11=91]="OP_11",a[a.OP_12=92]="OP_12",a[a.OP_13=93]="OP_13",a[a.OP_14=94]="OP_14",a[a.OP_15=95]="OP_15",a[a.OP_16=96]="OP_16",a[a.NOP=97]="NOP",a[a.VER=98]="VER",a[a.IF=99]="IF",a[a.NOTIF=100]="NOTIF",a[a.VERIF=101]="VERIF",a[a.VERNOTIF=102]="VERNOTIF",a[a.ELSE=103]="ELSE",a[a.ENDIF=104]="ENDIF",a[a.VERIFY=105]="VERIFY",a[a.RETURN=106]="RETURN",a[a.TOALTSTACK=107]="TOALTSTACK",a[a.FROMALTSTACK=108]="FROMALTSTACK",a[a["2DROP"]=109]="2DROP",a[a["2DUP"]=110]="2DUP",a[a["3DUP"]=111]="3DUP",a[a["2OVER"]=112]="2OVER",a[a["2ROT"]=113]="2ROT",a[a["2SWAP"]=114]="2SWAP",a[a.IFDUP=115]="IFDUP",a[a.DEPTH=116]="DEPTH",a[a.DROP=117]="DROP",a[a.DUP=118]="DUP",a[a.NIP=119]="NIP",a[a.OVER=120]="OVER",a[a.PICK=121]="PICK",a[a.ROLL=122]="ROLL",a[a.ROT=123]="ROT",a[a.SWAP=124]="SWAP",a[a.TUCK=125]="TUCK",a[a.CAT=126]="CAT",a[a.SUBSTR=127]="SUBSTR",a[a.LEFT=128]="LEFT",a[a.RIGHT=129]="RIGHT",a[a.SIZE=130]="SIZE",a[a.INVERT=131]="INVERT",a[a.AND=132]="AND",a[a.OR=133]="OR",a[a.XOR=134]="XOR",a[a.EQUAL=135]="EQUAL",a[a.EQUALVERIFY=136]="EQUALVERIFY",a[a.RESERVED1=137]="RESERVED1",a[a.RESERVED2=138]="RESERVED2",a[a["1ADD"]=139]="1ADD",a[a["1SUB"]=140]="1SUB",a[a["2MUL"]=141]="2MUL",a[a["2DIV"]=142]="2DIV",a[a.NEGATE=143]="NEGATE",a[a.ABS=144]="ABS",a[a.NOT=145]="NOT",a[a["0NOTEQUAL"]=146]="0NOTEQUAL",a[a.ADD=147]="ADD",a[a.SUB=148]="SUB",a[a.MUL=149]="MUL",a[a.DIV=150]="DIV",a[a.MOD=151]="MOD",a[a.LSHIFT=152]="LSHIFT",a[a.RSHIFT=153]="RSHIFT",a[a.BOOLAND=154]="BOOLAND",a[a.BOOLOR=155]="BOOLOR",a[a.NUMEQUAL=156]="NUMEQUAL",a[a.NUMEQUALVERIFY=157]="NUMEQUALVERIFY",a[a.NUMNOTEQUAL=158]="NUMNOTEQUAL",a[a.LESSTHAN=159]="LESSTHAN",a[a.GREATERTHAN=160]="GREATERTHAN",a[a.LESSTHANOREQUAL=161]="LESSTHANOREQUAL",a[a.GREATERTHANOREQUAL=162]="GREATERTHANOREQUAL",a[a.MIN=163]="MIN",a[a.MAX=164]="MAX",a[a.WITHIN=165]="WITHIN",a[a.RIPEMD160=166]="RIPEMD160",a[a.SHA1=167]="SHA1",a[a.SHA256=168]="SHA256",a[a.HASH160=169]="HASH160",a[a.HASH256=170]="HASH256",a[a.CODESEPARATOR=171]="CODESEPARATOR",a[a.CHECKSIG=172]="CHECKSIG",a[a.CHECKSIGVERIFY=173]="CHECKSIGVERIFY",a[a.CHECKMULTISIG=174]="CHECKMULTISIG",a[a.CHECKMULTISIGVERIFY=175]="CHECKMULTISIGVERIFY",a[a.NOP1=176]="NOP1",a[a.CHECKLOCKTIMEVERIFY=177]="CHECKLOCKTIMEVERIFY",a[a.CHECKSEQUENCEVERIFY=178]="CHECKSEQUENCEVERIFY",a[a.NOP4=179]="NOP4",a[a.NOP5=180]="NOP5",a[a.NOP6=181]="NOP6",a[a.NOP7=182]="NOP7",a[a.NOP8=183]="NOP8",a[a.NOP9=184]="NOP9",a[a.NOP10=185]="NOP10",a[a.CHECKSIGADD=186]="CHECKSIGADD",a[a.INVALID=255]="INVALID"}(d||(c.OP=d={})),c.Script=e.wrap({encodeStream:(a,b)=>{for(let c of b){if("string"==typeof c){if(void 0===d[c])throw Error(`Unknown opcode=${c}`);a.byte(d[c]);continue}if("number"==typeof c){if(0===c){a.byte(0);continue}else if(1<=c&&c<=16){a.byte(d.OP_1-1+c);continue}}if("number"==typeof c&&(c=g().encode(BigInt(c))),!(0,f.isBytes)(c))throw Error(`Wrong Script OP=${c} (${typeof c})`);let b=c.length;b<d.PUSHDATA1?a.byte(b):b<=255?(a.byte(d.PUSHDATA1),a.byte(b)):b<=65535?(a.byte(d.PUSHDATA2),a.bytes(e.U16LE.encode(b))):(a.byte(d.PUSHDATA4),a.bytes(e.U32LE.encode(b))),a.bytes(c)}},decodeStream:a=>{let b=[];for(;!a.isEnd();){let c=a.byte();if(d.OP_0<c&&c<=d.PUSHDATA4){let f;if(c<d.PUSHDATA1)f=c;else if(c===d.PUSHDATA1)f=e.U8.decodeStream(a);else if(c===d.PUSHDATA2)f=e.U16LE.decodeStream(a);else if(c===d.PUSHDATA4)f=e.U32LE.decodeStream(a);else throw Error("Should be not possible");b.push(a.bytes(f))}else if(0===c)b.push(0);else if(d.OP_1<=c&&c<=d.OP_16)b.push(c-(d.OP_1-1));else{let a=d[c];if(void 0===a)throw Error(`Unknown opcode=${c.toString(16)}`);b.push(a)}}return b}});let h={253:[253,2,253n,65535n],254:[254,4,65536n,4294967295n],255:[255,8,4294967296n,0xffffffffffffffffn]};c.CompactSize=e.wrap({encodeStream:(a,b)=>{if("number"==typeof b&&(b=BigInt(b)),0n<=b&&b<=252n)return a.byte(Number(b));for(let[c,d,e,f]of Object.values(h))if(!(e>b)&&!(b>f)){a.byte(c);for(let c=0;c<d;c++)a.byte(Number(b>>8n*BigInt(c)&255n));return}throw a.err(`VarInt too big: ${b}`)},decodeStream:a=>{let b=a.byte();if(b<=252)return BigInt(b);let[c,d,e]=h[b],f=0n;for(let b=0;b<d;b++)f|=BigInt(a.byte())<<8n*BigInt(b);if(f<e)throw a.err(`Wrong CompactSize(${8*d})`);return f}}),c.CompactSizeLen=e.apply(c.CompactSize,e.coders.numberBigint),c.VarBytes=e.bytes(c.CompactSize),c.RawWitness=e.array(c.CompactSizeLen,c.VarBytes),c.BTCArray=a=>e.array(c.CompactSize,a),c.RawInput=e.struct({txid:e.bytes(32,!0),index:e.U32LE,finalScriptSig:c.VarBytes,sequence:e.U32LE}),c.RawOutput=e.struct({amount:e.U64LE,script:c.VarBytes});let i=e.struct({version:e.I32LE,segwitFlag:e.flag(new Uint8Array([0,1])),inputs:(0,c.BTCArray)(c.RawInput),outputs:(0,c.BTCArray)(c.RawOutput),witnesses:e.flagged("segwitFlag",e.array("inputs/length",c.RawWitness)),lockTime:e.U32LE});c.RawTx=e.validate(i,function(a){if(a.segwitFlag&&a.witnesses&&!a.witnesses.length)throw Error("Segwit flag with empty witnesses array");return a}),c.RawOldTx=e.struct({version:e.I32LE,inputs:(0,c.BTCArray)(c.RawInput),outputs:(0,c.BTCArray)(c.RawOutput),lockTime:e.U32LE})},524271,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c._Estimator=c._cmpBig=c.toVsize=void 0,c.getPrevOut=k,c.normalizeInput=l,c.getInputType=m,c.selectUTXO=function(a,b,c,d){return new p(a,b,{createTx:!0,bip69:!0,...d}).result(c)};let d=a.r(67528),e=a.r(405337),f=a.r(133028),g=a.r(621908),h=a.r(162850),i=a.r(807625),j=a.r(411320);function k(a){if(a.nonWitnessUtxo){if(void 0===a.index)throw Error("Unknown input index");return a.nonWitnessUtxo.outputs[a.index]}if(a.witnessUtxo)return a.witnessUtxo;throw Error("Cannot find previous output info")}function l(a,b,c,e=!1){let k,{nonWitnessUtxo:m,txid:n}=a;"string"==typeof m&&(m=d.hex.decode(m)),(0,j.isBytes)(m)&&(m=h.RawTx.decode(m)),"nonWitnessUtxo"in a||void 0!==m||(m=b?.nonWitnessUtxo),"string"==typeof n&&(n=d.hex.decode(n)),void 0===n&&(n=b?.txid);let o={...b,...a,nonWitnessUtxo:m,txid:n};return"nonWitnessUtxo"in a||void 0!==o.nonWitnessUtxo||delete o.nonWitnessUtxo,void 0===o.sequence&&(o.sequence=i.DEFAULT_SEQUENCE),null===o.tapMerkleRoot&&delete o.tapMerkleRoot,o=g.mergeKeyMap(g.PSBTInput,o,b,c),g.PSBTInputCoder.encode(o),o.nonWitnessUtxo&&void 0!==o.index?k=o.nonWitnessUtxo.outputs[o.index]:o.witnessUtxo&&(k=o.witnessUtxo),k&&!e&&(0,f.checkScript)(k&&k.script,o.redeemScript,o.witnessScript),o}function m(a,b=!1){let c="legacy",d=i.SignatureHash.ALL,e=k(a),g=f.OutScript.decode(e.script),h=g.type,j=g,l=[g];if("tr"===g.type)return d=i.SignatureHash.DEFAULT,{txType:"taproot",type:"tr",last:g,lastScript:e.script,defaultSighash:d,sighash:a.sighashType||d};{if(("wpkh"===g.type||"wsh"===g.type)&&(c="segwit"),"sh"===g.type){if(!a.redeemScript)throw Error("inputType: sh without redeemScript");let b=f.OutScript.decode(a.redeemScript);("wpkh"===b.type||"wsh"===b.type)&&(c="segwit"),l.push(b),j=b,h+=`-${b.type}`}if("wsh"===j.type){if(!a.witnessScript)throw Error("inputType: wsh without witnessScript");let b=f.OutScript.decode(a.witnessScript);"wsh"===b.type&&(c="segwit"),l.push(b),j=b,h+=`-${b.type}`}let e=l[l.length-1];if("sh"===e.type||"wsh"===e.type)throw Error("inputType: sh/wsh cannot be terminal type");let i=f.OutScript.encode(e),k={type:h,txType:c,last:e,lastScript:i,defaultSighash:d,sighash:a.sighashType||d};if("legacy"===c&&!b&&!a.nonWitnessUtxo)throw Error("Transaction/sign: legacy input without nonWitnessUtxo, can result in attack that forces paying higher fees. Pass allowLegacyWitnessUtxo=true, if you sure");return k}}c.toVsize=a=>Math.ceil(a/4);let n=a=>g.TaprootControlBlock.encode(a);function o(a,b={},c=j.NETWORK){let d;if("script"in a&&(0,j.isBytes)(a.script)&&(d=a.script),"address"in a){if("string"!=typeof a.address)throw Error(`Estimator: wrong output address=${a.address}`);d=f.OutScript.encode((0,f.Address)(c).decode(a.address))}if(!d)throw Error("Estimator: wrong output script");if("bigint"!=typeof a.amount)throw Error(`Estimator: wrong output amount=${a.amount}, should be of type bigint but got ${typeof a.amount}.`);if(d&&!b.allowUnknownOutputs&&"unknown"===f.OutScript.decode(d).type)throw Error("Estimator: unknown output script type, there is a chance that input is unspendable. Pass allowUnknownOutputs=true, if you sure");return b.disableScriptCheck||(0,f.checkScript)(d),d}c._cmpBig=(a,b)=>{let c=a-b;return c<0n?-1:+(c>0n)};class p{constructor(a,b,g){if(this.outputs=b,this.opts=g,this.requiredIndices=[],"bigint"!=typeof g.feePerByte)throw Error(`Estimator: wrong feePerByte=${g.feePerByte}, should be of type bigint but got ${typeof g.feePerByte}.`);let p=void 0===g.dust?BigInt(182):g.dust;if("bigint"!=typeof p)throw Error(`Estimator: wrong dust=${g.dust}, should be of type bigint but got ${typeof g.dust}.`);let q=void 0===g.dustRelayFeeRate?3n:g.dustRelayFeeRate;if("bigint"!=typeof q)throw Error(`Estimator: wrong dustRelayFeeRate=${g.dustRelayFeeRate}, should be of type bigint but got ${typeof g.dustRelayFeeRate}.`);if(this.dust=p*q,void 0!==g.requiredInputs&&!Array.isArray(g.requiredInputs))throw Error(`Estimator: wrong required inputs=${g.requiredInputs}`);let r=g.network||j.NETWORK,s=0n,t=32;for(let a of b){let b=o(a,g,g.network);t+=32+4*h.VarBytes.encode(b).length,s+=a.amount}if("string"!=typeof g.changeAddress)throw Error(`Estimator: wrong change address=${g.changeAddress}`);let u=t+32+4*h.VarBytes.encode(f.OutScript.encode((0,f.Address)(r).decode(g.changeAddress))).length;t+=4*h.CompactSizeLen.encode(b.length).length,u+=4*h.CompactSizeLen.encode(b.length+1).length,this.baseWeight=t,this.changeWeight=u,this.amount=s;let v=Array.from(a);if(g.requiredInputs)for(let a=0;a<g.requiredInputs.length;a++)this.requiredIndices.push(v.push(g.requiredInputs[a])-1);let w=new Set;this.normalizedInputs=v.map(a=>{let b=l(a,void 0,void 0,g.disableScriptCheck);(0,i.inputBeforeSign)(b);let o=`${d.hex.encode(b.txid)}:${b.index}`;if(!g.allowSameUtxo&&w.has(o))throw Error(`Estimator: same input passed multiple times: ${o}`);w.add(o);let p=m(b,g.allowLegacyWitnessUtxo),q=k(b),r=function(a,b,c){let d,g=e.EMPTY;if("taproot"===a.txType){let g=a.sighash!==i.SignatureHash.DEFAULT?65:64;if(b.tapInternalKey&&!(0,j.equalBytes)(b.tapInternalKey,j.TAPROOT_UNSPENDABLE_KEY))d=[new Uint8Array(g)];else if(b.tapLeafScript)d=function(a,b,c){if(!a||!a.length)throw Error("no leafs");let d=()=>new Uint8Array(b);for(let[b,g]of a.sort((a,b)=>n(a[0]).length-n(b[0]).length)){let a=g.slice(0,-1),i=g[g.length-1],k=f.OutScript.decode(a),l=[];if("tr_ms"===k.type){let a=k.m,b=k.pubkeys.length-a;for(let b=0;b<a;b++)l.push(d());for(let a=0;a<b;a++)l.push(e.EMPTY)}else if("tr_ns"===k.type)for(let a of k.pubkeys)l.push(d());else{if(!c)throw Error("Finalize: Unknown tapLeafScript");let e=(0,f.tapLeafHash)(a,i);for(let f of c){if(!f.finalizeTaproot)continue;let c=h.Script.decode(a),g=f.encode(c);if(void 0===g)continue;let i=c.filter(a=>{if(!(0,j.isBytes)(a))return!1;try{return(0,j.validatePubkey)(a,j.PubT.schnorr),!0}catch(a){return!1}}),k=f.finalizeTaproot(a,g,i.map(a=>[{pubKey:a,leafHash:e},d()]));if(k)return k.concat(n(b))}}return l.reverse().concat([a,n(b)])}throw Error("there was no witness")}(b.tapLeafScript,g,c.customScripts);else throw Error("estimateInput/taproot: unknown input")}else{let b=()=>new Uint8Array(72),f=()=>new Uint8Array(33),i=e.EMPTY,k=[],l=a.last.type;if("ms"===l){let c=a.last.m,d=[0];for(let a=0;a<c;a++)d.push(b());i=h.Script.encode(d)}else if("pk"===l)i=h.Script.encode([b()]);else if("pkh"===l)i=h.Script.encode([b(),f()]);else if("wpkh"===l)i=e.EMPTY,k=[b(),f()];else if("unknown"===l&&!c.allowUnknownInputs)throw Error("Unknown inputs are not allowed");a.type.includes("wsh-")&&(i.length&&a.lastScript.length&&(k=h.Script.decode(i).map(a=>{if(0===a)return e.EMPTY;if((0,j.isBytes)(a))return a;throw Error(`Wrong witness op=${a}`)})),k=k.concat(a.lastScript)),"segwit"===a.txType&&(d=k),a.type.startsWith("sh-wsh-")?g=h.Script.encode([h.Script.encode([0,new Uint8Array(j.sha256.outputLen)])]):a.type.startsWith("sh-")?g=h.Script.encode([...h.Script.decode(i),a.lastScript]):a.type.startsWith("wsh-")||"segwit"!==a.txType&&(g=i)}let k=160+4*h.VarBytes.encode(g).length,l=!1;return d&&(k+=h.RawWitness.encode(d).length,l=!0),{weight:k,hasWitnesses:l}}(p,b,this.opts),s=q.amount-g.feePerByte*BigInt((0,c.toVsize)(r.weight));return{inputType:p,normalized:b,amount:q.amount,value:s,estimate:r}})}checkInputIdx(a){if(!Number.isSafeInteger(a)||0>a||a>=this.normalizedInputs.length)throw Error(`Wrong input index=${a}`);return a}sortIndices(a){return a.slice().sort((a,b)=>{let c=this.normalizedInputs[this.checkInputIdx(a)],d=this.normalizedInputs[this.checkInputIdx(b)],e=(0,j.compareBytes)(c.normalized.txid,d.normalized.txid);return 0!==e?e:c.normalized.index-d.normalized.index})}sortOutputs(a){let b=a.map(a=>o(a,this.opts,this.opts.network));return a.map((a,b)=>b).sort((d,e)=>{let f=a[d].amount,g=a[e].amount,h=(0,c._cmpBig)(f,g);return 0!==h?h:(0,j.compareBytes)(b[d],b[e])})}getSatoshi(a){return this.opts.feePerByte*BigInt((0,c.toVsize)(a))}get biggest(){return this.normalizedInputs.map((a,b)=>b).sort((a,b)=>(0,c._cmpBig)(this.normalizedInputs[b].value,this.normalizedInputs[a].value))}get smallest(){return this.biggest.reverse()}get oldest(){return this.normalizedInputs.map((a,b)=>b)}get newest(){return this.oldest.reverse()}accumulate(a,b=!1,c=!0,d=!1){let e,f=this.opts.alwaysChange?this.changeWeight:this.baseWeight,g=!1,i=0,j=0n,k=this.amount,l=[];for(let a of this.requiredIndices){this.checkInputIdx(a);let{estimate:b,amount:c}=this.normalizedInputs[a],m=f+b.weight;!g&&b.hasWitnesses&&(m+=2);let n=m+4*h.CompactSizeLen.encode(i).length;if(e=this.getSatoshi(n),f=m,b.hasWitnesses&&(g=!0),i++,j+=c,l.push(a),!d&&k+e<=j)return{indices:l,fee:e,weight:n,total:j}}for(let m of a){this.checkInputIdx(m);let{estimate:a,amount:n,value:o}=this.normalizedInputs[m],p=f+a.weight;!g&&a.hasWitnesses&&(p+=2);let q=p+4*h.CompactSizeLen.encode(i).length;if((e=this.getSatoshi(q),!b||!(n+j>k+e+this.dust))&&(!c||!(o<=0n))&&(f=p,a.hasWitnesses&&(g=!0),i++,j+=n,l.push(m),!d&&k+e<=j))return{indices:l,fee:e,weight:q,total:j}}if(d)return{indices:l,fee:e,weight:f+4*h.CompactSizeLen.encode(i).length,total:j}}default(){let{biggest:a}=this,b=this.accumulate(a,!0,!1);return b||this.accumulate(a)}select(a){if("all"===a)return this.accumulate(this.normalizedInputs.map((a,b)=>b),!1,!0,!0);if("default"===a)return this.default();let b={Oldest:()=>this.oldest,Newest:()=>this.newest,Smallest:()=>this.smallest,Biggest:()=>this.biggest};if(a.startsWith("exact")){let[c,d]=a.slice(5).split("/");if(!b[c])throw Error(`Estimator.select: wrong strategy=${a}`);a=d;let e=this.accumulate(b[c](),!0,!0);if(e)return e}if(a.startsWith("accum")){let c=a.slice(5);if(!b[c])throw Error(`Estimator.select: wrong strategy=${a}`);return this.accumulate(b[c]())}throw Error(`Estimator.select: wrong strategy=${a}`)}result(a){let b,c=this.select(a);if(!c)return;let{indices:d,weight:e,total:f}=c,g=this.opts.alwaysChange,h=this.opts.alwaysChange?e:e+(this.changeWeight-this.baseWeight),j=this.getSatoshi(h),k=c.fee,l=f-this.amount-j;l>this.dust&&(g=!0);let m=d,n=Array.from(this.outputs);if(g){if(k=j,l<0n)throw Error(`Estimator.result: negative change=${l}`);n.push({address:this.opts.changeAddress,amount:l})}this.opts.bip69&&(m=this.sortIndices(m),n=this.sortOutputs(n).map(a=>n[a]));let p={inputs:m.map(a=>this.normalizedInputs[a].normalized),outputs:n,fee:k,weight:this.opts.alwaysChange?c.weight:h,change:!!g};if(this.opts.createTx){let{inputs:a,outputs:c}=p;for(let c of(b=new i.Transaction(this.opts),a))b.addInput(c);for(let a of c)b.addOutput({...a,script:o(a,this.opts,this.opts.network)})}return Object.assign(p,{tx:b})}}c._Estimator=p},807625,(a,b,c)=>{"use strict";var d,e;Object.defineProperty(c,"__esModule",{value:!0}),c.Transaction=c.SigHash=c.SignatureHash=c.def=c.Decimal=c.DEFAULT_SEQUENCE=c.DEFAULT_LOCKTIME=c.DEFAULT_VERSION=c.PRECISION=void 0,c.cloneDeep=p,c.inputBeforeSign=r,c.PSBTCombine=function(a){if(!a||!Array.isArray(a)||!a.length)throw Error("PSBTCombine: wrong PSBT list");let b=w.fromPSBT(a[0]);for(let c=1;c<a.length;c++)b.combine(w.fromPSBT(a[c]));return b.toPSBT()},c.bip32Path=function(a){let b=[];if(!/^[mM]'?/.test(a))throw Error('Path must start with "m" or "M"');if(/^[mM]'?$/.test(a))return b;for(let c of a.replace(/^[mM]'?\//,"").split("/")){let a=/^(\d+)('?)$/.exec(c);if(!a||3!==a.length)throw Error(`Invalid child index: ${c}`);let d=+a[1];if(!Number.isSafeInteger(d)||d>=0x80000000)throw Error("Invalid index");"'"===a[2]&&(d+=0x80000000),b.push(d)}return b};let f=a.r(67528),g=a.r(405337),h=a.r(133028),i=a.r(621908),j=a.r(162850),k=a.r(411320),l=a.r(411320),m=a.r(524271),n=new Uint8Array(32),o={amount:0xffffffffffffffffn,script:g.EMPTY};function p(a){if(Array.isArray(a))return a.map(a=>p(a));if((0,l.isBytes)(a))return Uint8Array.from(a);if(["number","bigint","boolean","string","undefined"].includes(typeof a))return a;if(null===a)return a;if("object"==typeof a)return Object.fromEntries(Object.entries(a).map(([a,b])=>[a,p(b)]));throw Error(`cloneDeep: unknown type=${a} (${typeof a})`)}function q(a){if(void 0===a.script||void 0===a.amount)throw Error("Transaction/output: script and amount required");return{script:a.script,amount:a.amount}}function r(a){if(void 0===a.txid||void 0===a.index)throw Error("Transaction/input: txid and index required");return{txid:a.txid,index:a.index,sequence:(0,c.def)(a.sequence,c.DEFAULT_SEQUENCE),finalScriptSig:(0,c.def)(a.finalScriptSig,g.EMPTY)}}function s(a){for(let b in a)i.PSBTInputFinalKeys.includes(b)||delete a[b]}c.PRECISION=8,c.DEFAULT_VERSION=2,c.DEFAULT_LOCKTIME=0,c.DEFAULT_SEQUENCE=0xffffffff,c.Decimal=g.coders.decimal(c.PRECISION),c.def=(a,b)=>void 0===a?b:a,function(a){a[a.DEFAULT=0]="DEFAULT",a[a.ALL=1]="ALL",a[a.NONE=2]="NONE",a[a.SINGLE=3]="SINGLE",a[a.ANYONECANPAY=128]="ANYONECANPAY"}(d||(c.SignatureHash=d={})),function(a){a[a.DEFAULT=0]="DEFAULT",a[a.ALL=1]="ALL",a[a.NONE=2]="NONE",a[a.SINGLE=3]="SINGLE",a[a.DEFAULT_ANYONECANPAY=128]="DEFAULT_ANYONECANPAY",a[a.ALL_ANYONECANPAY=129]="ALL_ANYONECANPAY",a[a.NONE_ANYONECANPAY=130]="NONE_ANYONECANPAY",a[a.SINGLE_ANYONECANPAY=131]="SINGLE_ANYONECANPAY"}(e||(c.SigHash=e={}));let t=g.struct({txid:g.bytes(32,!0),index:g.U32LE});function u(a){if("number"!=typeof a||"string"!=typeof e[a])throw Error(`Invalid SigHash=${a}`);return a}function v(a){let b=31&a;return{isAny:!!(a&d.ANYONECANPAY),isNone:b===d.NONE,isSingle:b===d.SINGLE}}class w{constructor(a={}){this.global={},this.inputs=[],this.outputs=[];let b=this.opts=function(a){if(void 0!==a&&"[object Object]"!==({}).toString.call(a))throw Error(`Wrong object type for transaction options: ${a}`);let b={...a,version:(0,c.def)(a.version,c.DEFAULT_VERSION),lockTime:(0,c.def)(a.lockTime,0),PSBTVersion:(0,c.def)(a.PSBTVersion,0)};if(void 0!==b.allowUnknowInput&&(a.allowUnknownInputs=b.allowUnknowInput),void 0!==b.allowUnknowOutput&&(a.allowUnknownOutputs=b.allowUnknowOutput),![-1,0,1,2,3].includes(b.version))throw Error(`Unknown version: ${b.version}`);if("number"!=typeof b.lockTime)throw Error("Transaction lock time should be number");if(g.U32LE.encode(b.lockTime),0!==b.PSBTVersion&&2!==b.PSBTVersion)throw Error(`Unknown PSBT version ${b.PSBTVersion}`);for(let a of["allowUnknownOutputs","allowUnknownInputs","disableScriptCheck","bip174jsCompat","allowLegacyWitnessUtxo","lowR"]){let c=b[a];if(void 0!==c&&"boolean"!=typeof c)throw Error(`Transation options wrong type: ${a}=${c} (${typeof c})`)}if(void 0!==b.customScripts){let a=b.customScripts;if(!Array.isArray(a))throw Error(`wrong custom scripts type (expected array): customScripts=${a} (${typeof a})`);for(let b of a)if("function"!=typeof b.encode||"function"!=typeof b.decode||void 0!==b.finalizeTaproot&&"function"!=typeof b.finalizeTaproot)throw Error(`wrong script=${b} (${typeof b})`)}return Object.freeze(b)}(a);b.lockTime!==c.DEFAULT_LOCKTIME&&(this.global.fallbackLocktime=b.lockTime),this.global.txVersion=b.version}static fromRaw(a,b={}){let c=j.RawTx.decode(a),d=new w({...b,version:c.version,lockTime:c.lockTime});for(let a of c.outputs)d.addOutput(a);if(d.outputs=c.outputs,d.inputs=c.inputs,c.witnesses)for(let a=0;a<c.witnesses.length;a++)d.inputs[a].finalScriptWitness=c.witnesses[a];return d}static fromPSBT(a,b={}){let d;try{d=i.RawPSBTV0.decode(a)}catch(b){try{d=i.RawPSBTV2.decode(a)}catch(a){throw b}}let e=d.global.version||0;if(0!==e&&2!==e)throw Error(`Wrong PSBT version=${e}`);let f=d.global.unsignedTx,h=0===e?f?.version:d.global.txVersion,j=0===e?f?.lockTime:d.global.fallbackLocktime,k=new w({...b,version:h,lockTime:j,PSBTVersion:e}),l=0===e?f?.inputs.length:d.global.inputCount;k.inputs=d.inputs.slice(0,l).map((a,b)=>({finalScriptSig:g.EMPTY,...d.global.unsignedTx?.inputs[b],...a}));let m=0===e?f?.outputs.length:d.global.outputCount;return k.outputs=d.outputs.slice(0,m).map((a,b)=>({...a,...d.global.unsignedTx?.outputs[b]})),k.global={...d.global,txVersion:h},j!==c.DEFAULT_LOCKTIME&&(k.global.fallbackLocktime=j),k}toPSBT(a=this.opts.PSBTVersion){if(0!==a&&2!==a)throw Error(`Wrong PSBT version=${a}`);let b=this.inputs.map(b=>i.cleanPSBTFields(a,i.PSBTInput,b));for(let a of b)a.partialSig&&!a.partialSig.length&&delete a.partialSig,a.finalScriptSig&&!a.finalScriptSig.length&&delete a.finalScriptSig,a.finalScriptWitness&&!a.finalScriptWitness.length&&delete a.finalScriptWitness;let d=this.outputs.map(b=>i.cleanPSBTFields(a,i.PSBTOutput,b)),e={...this.global};return 0===a?(e.unsignedTx=j.RawOldTx.decode(j.RawOldTx.encode({version:this.version,lockTime:this.lockTime,inputs:this.inputs.map(r).map(a=>({...a,finalScriptSig:g.EMPTY})),outputs:this.outputs.map(q)})),delete e.fallbackLocktime,delete e.txVersion):(e.version=a,e.txVersion=this.version,e.inputCount=this.inputs.length,e.outputCount=this.outputs.length,e.fallbackLocktime&&e.fallbackLocktime===c.DEFAULT_LOCKTIME&&delete e.fallbackLocktime),this.opts.bip174jsCompat&&(b.length||b.push({}),d.length||d.push({})),(0===a?i.RawPSBTV0:i.RawPSBTV2).encode({global:e,inputs:b,outputs:d})}get lockTime(){let a=c.DEFAULT_LOCKTIME,b=0,d=c.DEFAULT_LOCKTIME,e=0;for(let c of this.inputs)c.requiredHeightLocktime&&(a=Math.max(a,c.requiredHeightLocktime),b++),c.requiredTimeLocktime&&(d=Math.max(d,c.requiredTimeLocktime),e++);return b&&b>=e?a:d!==c.DEFAULT_LOCKTIME?d:this.global.fallbackLocktime||c.DEFAULT_LOCKTIME}get version(){if(void 0===this.global.txVersion)throw Error("No global.txVersion");return this.global.txVersion}inputStatus(a){this.checkInputIdx(a);let b=this.inputs[a];return b.finalScriptSig&&b.finalScriptSig.length||b.finalScriptWitness&&b.finalScriptWitness.length?"finalized":b.tapKeySig||b.tapScriptSig&&b.tapScriptSig.length||b.partialSig&&b.partialSig.length?"signed":"unsigned"}inputSighash(a){this.checkInputIdx(a);let b=this.inputs[a].sighashType,c=void 0===b?d.DEFAULT:b,e=c===d.DEFAULT?d.ALL:3&c;return{sigInputs:c&d.ANYONECANPAY,sigOutputs:e}}signStatus(){let a=!0,b=!0,c=[],e=[];for(let f=0;f<this.inputs.length;f++){if("unsigned"===this.inputStatus(f))continue;let{sigInputs:g,sigOutputs:h}=this.inputSighash(f);if(g===d.ANYONECANPAY?c.push(f):a=!1,h===d.ALL)b=!1;else if(h===d.SINGLE)e.push(f);else if(h===d.NONE);else throw Error(`Wrong signature hash output type: ${h}`)}return{addInput:a,addOutput:b,inputs:c,outputs:e}}get isFinal(){for(let a=0;a<this.inputs.length;a++)if("finalized"!==this.inputStatus(a))return!1;return!0}get hasWitnesses(){let a=!1;for(let b of this.inputs)b.finalScriptWitness&&b.finalScriptWitness.length&&(a=!0);return a}get weight(){if(!this.isFinal)throw Error("Transaction is not finalized");let a=32,b=this.outputs.map(q);for(let c of(a+=4*j.CompactSizeLen.encode(this.outputs.length).length,b))a+=32+4*j.VarBytes.encode(c.script).length;for(let b of(this.hasWitnesses&&(a+=2),a+=4*j.CompactSizeLen.encode(this.inputs.length).length,this.inputs))a+=160+4*j.VarBytes.encode(b.finalScriptSig||g.EMPTY).length,this.hasWitnesses&&b.finalScriptWitness&&(a+=j.RawWitness.encode(b.finalScriptWitness).length);return a}get vsize(){return(0,m.toVsize)(this.weight)}toBytes(a=!1,b=!1){return j.RawTx.encode({version:this.version,lockTime:this.lockTime,inputs:this.inputs.map(r).map(b=>({...b,finalScriptSig:a&&b.finalScriptSig||g.EMPTY})),outputs:this.outputs.map(q),witnesses:this.inputs.map(a=>a.finalScriptWitness||[]),segwitFlag:b&&this.hasWitnesses})}get unsignedTx(){return this.toBytes(!1,!1)}get hex(){return f.hex.encode(this.toBytes(!0,this.hasWitnesses))}get hash(){if(!this.isFinal)throw Error("Transaction is not finalized");return f.hex.encode(k.sha256x2(this.toBytes(!0)))}get id(){if(!this.isFinal)throw Error("Transaction is not finalized");return f.hex.encode(k.sha256x2(this.toBytes(!0)).reverse())}checkInputIdx(a){if(!Number.isSafeInteger(a)||0>a||a>=this.inputs.length)throw Error(`Wrong input index=${a}`)}getInput(a){return this.checkInputIdx(a),p(this.inputs[a])}get inputsLength(){return this.inputs.length}addInput(a,b=!1){if(!b&&!this.signStatus().addInput)throw Error("Tx has signed inputs, cannot add new one");return this.inputs.push((0,m.normalizeInput)(a,void 0,void 0,this.opts.disableScriptCheck)),this.inputs.length-1}updateInput(a,b,c=!1){let d;if(this.checkInputIdx(a),!c){let b=this.signStatus();(!b.addInput||b.inputs.includes(a))&&(d=i.PSBTInputUnsignedKeys)}this.inputs[a]=(0,m.normalizeInput)(b,this.inputs[a],d,this.opts.disableScriptCheck)}checkOutputIdx(a){if(!Number.isSafeInteger(a)||0>a||a>=this.outputs.length)throw Error(`Wrong output index=${a}`)}getOutput(a){return this.checkOutputIdx(a),p(this.outputs[a])}getOutputAddress(a,b=l.NETWORK){let c=this.getOutput(a);if(c.script)return(0,h.Address)(b).encode(h.OutScript.decode(c.script))}get outputsLength(){return this.outputs.length}normalizeOutput(a,b,c){let{amount:d,script:e}=a;if(void 0===d&&(d=b?.amount),"bigint"!=typeof d)throw Error(`Wrong amount type, should be of type bigint in sats, but got ${d} of type ${typeof d}`);"string"==typeof e&&(e=f.hex.decode(e)),void 0===e&&(e=b?.script);let g={...b,...a,amount:d,script:e};if(void 0===g.amount&&delete g.amount,g=i.mergeKeyMap(i.PSBTOutput,g,b,c),i.PSBTOutputCoder.encode(g),g.script&&!this.opts.allowUnknownOutputs&&"unknown"===h.OutScript.decode(g.script).type)throw Error("Transaction/output: unknown output script type, there is a chance that input is unspendable. Pass allowUnknownOutputs=true, if you sure");return this.opts.disableScriptCheck||(0,h.checkScript)(g.script,g.redeemScript,g.witnessScript),g}addOutput(a,b=!1){if(!b&&!this.signStatus().addOutput)throw Error("Tx has signed outputs, cannot add new one");return this.outputs.push(this.normalizeOutput(a)),this.outputs.length-1}updateOutput(a,b,c=!1){let d;if(this.checkOutputIdx(a),!c){let b=this.signStatus();(!b.addOutput||b.outputs.includes(a))&&(d=i.PSBTOutputUnsignedKeys)}this.outputs[a]=this.normalizeOutput(b,this.outputs[a],d)}addOutputAddress(a,b,c=l.NETWORK){return this.addOutput({script:h.OutScript.encode((0,h.Address)(c).decode(a)),amount:b})}get fee(){let a=0n;for(let b of this.inputs){let c=(0,m.getPrevOut)(b);if(!c)throw Error("Empty input amount");a+=c.amount}for(let b of this.outputs.map(q))a-=b.amount;return a}preimageLegacy(a,b,c){let{isAny:d,isNone:e,isSingle:f}=v(c);if(a<0||!Number.isSafeInteger(a))throw Error(`Invalid input idx=${a}`);if(f&&a>=this.outputs.length||a>=this.inputs.length)return g.U256BE.encode(1n);b=j.Script.encode(j.Script.decode(b).filter(a=>"CODESEPARATOR"!==a));let h=this.inputs.map(r).map((c,d)=>({...c,finalScriptSig:d===a?b:g.EMPTY}));d?h=[h[a]]:(e||f)&&(h=h.map((b,c)=>({...b,sequence:c===a?b.sequence:0})));let i=this.outputs.map(q);e?i=[]:f&&(i=i.slice(0,a).fill(o).concat([i[a]]));let l=j.RawTx.encode({lockTime:this.lockTime,version:this.version,segwitFlag:!1,inputs:h,outputs:i});return k.sha256x2(l,g.I32LE.encode(c))}preimageWitnessV0(a,b,c,d){let{isAny:e,isNone:f,isSingle:h}=v(c),i=n,l=n,m=n,o=this.inputs.map(r),p=this.outputs.map(q);e||(i=k.sha256x2(...o.map(t.encode))),e||h||f||(l=k.sha256x2(...o.map(a=>g.U32LE.encode(a.sequence)))),h||f?h&&a<p.length&&(m=k.sha256x2(j.RawOutput.encode(p[a]))):m=k.sha256x2(...p.map(j.RawOutput.encode));let s=o[a];return k.sha256x2(g.I32LE.encode(this.version),i,l,g.bytes(32,!0).encode(s.txid),g.U32LE.encode(s.index),j.VarBytes.encode(b),g.U64LE.encode(d),g.U32LE.encode(s.sequence),m,g.U32LE.encode(this.lockTime),g.U32LE.encode(c))}preimageWitnessV1(a,b,c,e,f=-1,i,m=192,o){if(!Array.isArray(e)||this.inputs.length!==e.length)throw Error(`Invalid amounts array=${e}`);if(!Array.isArray(b)||this.inputs.length!==b.length)throw Error(`Invalid prevOutScript array=${b}`);let p=[g.U8.encode(0),g.U8.encode(c),g.I32LE.encode(this.version),g.U32LE.encode(this.lockTime)],s=c===d.DEFAULT?d.ALL:3&c,u=c&d.ANYONECANPAY,v=this.inputs.map(r),w=this.outputs.map(q);u!==d.ANYONECANPAY&&p.push(...[v.map(t.encode),e.map(g.U64LE.encode),b.map(j.VarBytes.encode),v.map(a=>g.U32LE.encode(a.sequence))].map(a=>k.sha256((0,l.concatBytes)(...a)))),s===d.ALL&&p.push(k.sha256((0,l.concatBytes)(...w.map(j.RawOutput.encode))));let x=!!o|2*!!i;if(p.push(new Uint8Array([x])),u===d.ANYONECANPAY){let c=v[a];p.push(t.encode(c),g.U64LE.encode(e[a]),j.VarBytes.encode(b[a]),g.U32LE.encode(c.sequence))}else p.push(g.U32LE.encode(a));return 1&x&&p.push(k.sha256(j.VarBytes.encode(o||g.EMPTY))),s===d.SINGLE&&p.push(a<w.length?k.sha256(j.RawOutput.encode(w[a])):n),i&&p.push((0,h.tapLeafHash)(i,m),g.U8.encode(0),g.I32LE.encode(f)),k.tagSchnorr("TapSighash",...p)}signIdx(a,b,c,e){this.checkInputIdx(b);let f=this.inputs[b],i=(0,m.getInputType)(f,this.opts.allowLegacyWitnessUtxo);if(!(0,l.isBytes)(a)){if(!f.bip32Derivation||!f.bip32Derivation.length)throw Error("bip32Derivation: empty");let c=f.bip32Derivation.filter(b=>b[1].fingerprint==a.fingerprint).map(([b,{path:c}])=>{let d=a;for(let a of c)d=d.deriveChild(a);if(!(0,l.equalBytes)(d.publicKey,b))throw Error("bip32Derivation: wrong pubKey");if(!d.privateKey)throw Error("bip32Derivation: no privateKey");return d});if(!c.length)throw Error(`bip32Derivation: no items with fingerprint=${a.fingerprint}`);let d=!1;for(let a of c)this.signIdx(a.privateKey,b)&&(d=!0);return d}c?c.forEach(u):c=[i.defaultSighash];let n=i.sighash;if(!c.includes(n))throw Error(`Input with not allowed sigHash=${n}. Allowed: ${c.join(", ")}`);let{sigOutputs:o}=this.inputSighash(b);if(o===d.SINGLE&&b>=this.outputs.length)throw Error(`Input with sighash SINGLE, but there is no output with corresponding index=${b}`);let p=(0,m.getPrevOut)(f);if("taproot"===i.txType){let c=this.inputs.map(m.getPrevOut),i=c.map(a=>a.script),o=c.map(a=>a.amount),p=!1,q=k.pubSchnorr(a),r=f.tapMerkleRoot||g.EMPTY;if(f.tapInternalKey){let{pubKey:c,privKey:h}=function(a,b,c,d=g.EMPTY){return(0,l.equalBytes)(c,b)&&(a=k.taprootTweakPrivKey(a,d),b=k.pubSchnorr(a)),{privKey:a,pubKey:b}}(a,q,f.tapInternalKey,r),[j,m]=k.taprootTweakPubkey(f.tapInternalKey,r);if((0,l.equalBytes)(j,c)){let a=this.preimageWitnessV1(b,i,n,o),c=(0,l.concatBytes)(k.signSchnorr(a,h,e),n!==d.DEFAULT?new Uint8Array([n]):g.EMPTY);this.updateInput(b,{tapKeySig:c},!0),p=!0}}if(f.tapLeafScript)for(let[c,m]of(f.tapScriptSig=f.tapScriptSig||[],f.tapLeafScript)){let c=m.subarray(0,-1),f=j.Script.decode(c),r=m[m.length-1],s=(0,h.tapLeafHash)(c,r);if(-1===f.findIndex(a=>(0,l.isBytes)(a)&&(0,l.equalBytes)(a,q)))continue;let t=this.preimageWitnessV1(b,i,n,o,void 0,c,r),u=(0,l.concatBytes)(k.signSchnorr(t,a,e),n!==d.DEFAULT?new Uint8Array([n]):g.EMPTY);this.updateInput(b,{tapScriptSig:[[{pubKey:q,leafHash:s},u]]},!0),p=!0}if(!p)throw Error("No taproot scripts signed")}else{let c,d=k.pubECDSA(a),e=!1,f=k.hash160(d);for(let a of j.Script.decode(i.lastScript))(0,l.isBytes)(a)&&((0,l.equalBytes)(a,d)||(0,l.equalBytes)(a,f))&&(e=!0);if(!e)throw Error(`Input script doesn't have pubKey: ${i.lastScript}`);if("legacy"===i.txType)c=this.preimageLegacy(b,i.lastScript,n);else if("segwit"===i.txType){let a=i.lastScript;"wpkh"===i.last.type&&(a=h.OutScript.encode({type:"pkh",hash:i.last.hash})),c=this.preimageWitnessV0(b,a,n,p.amount)}else throw Error(`Transaction/sign: unknown tx type: ${i.txType}`);let g=k.signECDSA(c,a,this.opts.lowR);this.updateInput(b,{partialSig:[[d,(0,l.concatBytes)(g,new Uint8Array([n]))]]},!0)}return!0}sign(a,b,c){let d=0;for(let e=0;e<this.inputs.length;e++)try{this.signIdx(a,e,b,c)&&d++}catch(a){}if(!d)throw Error("No inputs signed");return d}finalizeIdx(a){let b,c;if(this.checkInputIdx(a),this.fee<0n)throw Error("Outputs spends more than inputs amount");let d=this.inputs[a],e=(0,m.getInputType)(d,this.opts.allowLegacyWitnessUtxo);if("taproot"===e.txType){if(d.tapKeySig)d.finalScriptWitness=[d.tapKeySig];else if(d.tapLeafScript&&d.tapScriptSig){for(let[a,b]of d.tapLeafScript.sort((a,b)=>i.TaprootControlBlock.encode(a[0]).length-i.TaprootControlBlock.encode(b[0]).length)){let c=b.slice(0,-1),e=b[b.length-1],f=h.OutScript.decode(c),k=(0,h.tapLeafHash)(c,e),m=d.tapScriptSig.filter(a=>(0,l.equalBytes)(a[0].leafHash,k)),n=[];if("tr_ms"===f.type){let a=f.m,b=f.pubkeys,c=0;for(let d of b){let b=m.findIndex(a=>(0,l.equalBytes)(a[0].pubKey,d));if(c===a||-1===b){n.push(g.EMPTY);continue}n.push(m[b][1]),c++}if(c!==a)continue}else if("tr_ns"===f.type){for(let a of f.pubkeys){let b=m.findIndex(b=>(0,l.equalBytes)(b[0].pubKey,a));-1!==b&&n.push(m[b][1])}if(n.length!==f.pubkeys.length)continue}else if("unknown"===f.type&&this.opts.allowUnknownInputs){let a=j.Script.decode(c);if(!(n=m.map(([{pubKey:b},c])=>{let d=a.findIndex(a=>(0,l.isBytes)(a)&&(0,l.equalBytes)(a,b));if(-1===d)throw Error("finalize/taproot: cannot find position of pubkey in script");return{signature:c,pos:d}}).sort((a,b)=>a.pos-b.pos).map(a=>a.signature)).length)continue}else{let b=this.opts.customScripts;if(b)for(let e of b){if(!e.finalizeTaproot)continue;let b=j.Script.decode(c),f=e.encode(b);if(void 0===f)continue;let h=e.finalizeTaproot(c,f,m);if(h){d.finalScriptWitness=h.concat(i.TaprootControlBlock.encode(a)),d.finalScriptSig=g.EMPTY,s(d);return}}throw Error("Finalize: Unknown tapLeafScript")}d.finalScriptWitness=n.reverse().concat([c,i.TaprootControlBlock.encode(a)]);break}if(!d.finalScriptWitness)throw Error("finalize/taproot: empty witness")}else throw Error("finalize/taproot: unknown input");d.finalScriptSig=g.EMPTY,s(d);return}if(!d.partialSig||!d.partialSig.length)throw Error("Not enough partial sign");let f=g.EMPTY,n=[];if("ms"===e.last.type){let a=e.last.m,b=e.last.pubkeys,c=[];for(let a of b){let b=d.partialSig.find(b=>(0,l.equalBytes)(a,b[0]));b&&c.push(b[1])}if((c=c.slice(0,a)).length!==a)throw Error(`Multisig: wrong signatures count, m=${a} n=${b.length} signatures=${c.length}`);f=j.Script.encode([0,...c])}else if("pk"===e.last.type)f=j.Script.encode([d.partialSig[0][1]]);else if("pkh"===e.last.type)f=j.Script.encode([d.partialSig[0][1],d.partialSig[0][0]]);else if("wpkh"===e.last.type)f=g.EMPTY,n=[d.partialSig[0][1],d.partialSig[0][0]];else if("unknown"===e.last.type&&!this.opts.allowUnknownInputs)throw Error("Unknown inputs not allowed");if(e.type.includes("wsh-")&&(f.length&&e.lastScript.length&&(n=j.Script.decode(f).map(a=>{if(0===a)return g.EMPTY;if((0,l.isBytes)(a))return a;throw Error(`Wrong witness op=${a}`)})),n=n.concat(e.lastScript)),"segwit"===e.txType&&(c=n),e.type.startsWith("sh-wsh-")?b=j.Script.encode([j.Script.encode([0,k.sha256(e.lastScript)])]):e.type.startsWith("sh-")?b=j.Script.encode([...j.Script.decode(f),e.lastScript]):e.type.startsWith("wsh-")||"segwit"!==e.txType&&(b=f),!b&&!c)throw Error("Unknown error finalizing input");b&&(d.finalScriptSig=b),c&&(d.finalScriptWitness=c),s(d)}finalize(){for(let a=0;a<this.inputs.length;a++)this.finalizeIdx(a)}extract(){if(!this.isFinal)throw Error("Transaction has unfinalized inputs");if(!this.outputs.length)throw Error("Transaction has no outputs");if(this.fee<0n)throw Error("Outputs spends more than inputs amount");return this.toBytes(!0,!0)}combine(a){for(let b of["PSBTVersion","version","lockTime"])if(this.opts[b]!==a.opts[b])throw Error(`Transaction/combine: different ${b} this=${this.opts[b]} other=${a.opts[b]}`);for(let b of["inputs","outputs"])if(this[b].length!==a[b].length)throw Error(`Transaction/combine: different ${b} length this=${this[b].length} other=${a[b].length}`);let b=this.global.unsignedTx?j.RawOldTx.encode(this.global.unsignedTx):g.EMPTY,c=a.global.unsignedTx?j.RawOldTx.encode(a.global.unsignedTx):g.EMPTY;if(!(0,l.equalBytes)(b,c))throw Error("Transaction/combine: different unsigned tx");this.global=i.mergeKeyMap(i.PSBTGlobal,this.global,a.global);for(let b=0;b<this.inputs.length;b++)this.updateInput(b,a.inputs[b],!0);for(let b=0;b<this.outputs.length;b++)this.updateOutput(b,a.outputs[b],!0);return this}clone(){return w.fromPSBT(this.toPSBT(this.opts.PSBTVersion),this.opts)}}c.Transaction=w},621908,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.RawPSBTV2=c.RawPSBTV0=c._DebugPSBT=c._RawPSBTV2=c._RawPSBTV0=c.PSBTOutputCoder=c.PSBTInputCoder=c.PSBTOutputUnsignedKeys=c.PSBTOutput=c.PSBTInputUnsignedKeys=c.PSBTInputFinalKeys=c.PSBTInput=c.PSBTGlobal=c.TaprootControlBlock=void 0,c.cleanPSBTFields=function(a,b,c){let d={};for(let e in c){if("unknown"!==e){if(!b[e])continue;let{allowInc:c,silentIgnore:d}=v(b[e]);if(!c.includes(a)){if(d)continue;throw Error(`Failed to serialize in PSBTv${a}: ${e} but versions allows inclusion=${c}`)}}d[e]=c[e]}return d},c.mergeKeyMap=function(a,b,c,e){let f={...c,...b};for(let g in a){let i=g,[j,k,l]=a[i],m=e&&!e.includes(g);if(void 0===b[g]&&g in b){if(m)throw Error(`Cannot remove signed field=${g}`);delete f[g]}else if(k){let a=c&&c[g]?c[g]:[],e=b[i];if(e){if(!Array.isArray(e))throw Error(`keyMap(${g}): KV pairs should be [k, v][]`);e=e.map(a=>{if(2!==a.length)throw Error(`keyMap(${g}): KV pairs should be [k, v][]`);return["string"==typeof a[0]?k.decode(d.hex.decode(a[0])):a[0],"string"==typeof a[1]?l.decode(d.hex.decode(a[1])):a[1]]});let b={},c=(a,c,e)=>{if(void 0===b[a]){b[a]=[c,e];return}let f=d.hex.encode(l.encode(b[a][1])),g=d.hex.encode(l.encode(e));if(f!==g)throw Error(`keyMap(${i}): same key=${a} oldVal=${f} newVal=${g}`)};for(let[b,e]of a)c(d.hex.encode(k.encode(b)),b,e);for(let[a,f]of e){let e=d.hex.encode(k.encode(a));if(void 0===f){if(m)throw Error(`Cannot remove signed field=${i}/${a}`);delete b[e]}else c(e,a,f)}f[i]=Object.values(b)}}else if("string"==typeof f[g])f[g]=l.decode(d.hex.decode(f[g]));else if(m&&g in b&&c&&void 0!==c[g]&&!(0,h.equalBytes)(l.encode(b[g]),l.encode(c[g])))throw Error(`Cannot change signed field=${g}`)}for(let b in f)a[b]||delete f[b];return f};let d=a.r(67528),e=a.r(405337),f=a.r(162850),g=a.r(807625),h=a.r(411320),i=e.validate(e.bytes(null),a=>(0,h.validatePubkey)(a,h.PubT.ecdsa)),j=e.validate(e.bytes(32),a=>(0,h.validatePubkey)(a,h.PubT.schnorr)),k=e.validate(e.bytes(null),a=>{if(64!==a.length&&65!==a.length)throw Error("Schnorr signature should be 64 or 65 bytes long");return a}),l=e.struct({fingerprint:e.U32BE,path:e.array(null,e.U32LE)}),m=e.struct({hashes:e.array(f.CompactSizeLen,e.bytes(32)),der:l}),n=e.bytes(78),o=e.struct({pubKey:j,leafHash:e.bytes(32)}),p=e.struct({version:e.U8,internalKey:e.bytes(32),merklePath:e.array(null,e.bytes(32))});c.TaprootControlBlock=e.validate(p,a=>{if(a.merklePath.length>128)throw Error("TaprootControlBlock: merklePath should be of length 0..128 (inclusive)");return a});let q=e.array(null,e.struct({depth:e.U8,version:e.U8,script:f.VarBytes})),r=e.bytes(null),s=e.bytes(20),t=e.bytes(32);c.PSBTGlobal={unsignedTx:[0,!1,f.RawOldTx,[0],[0],!1],xpub:[1,n,l,[],[0,2],!1],txVersion:[2,!1,e.U32LE,[2],[2],!1],fallbackLocktime:[3,!1,e.U32LE,[],[2],!1],inputCount:[4,!1,f.CompactSizeLen,[2],[2],!1],outputCount:[5,!1,f.CompactSizeLen,[2],[2],!1],txModifiable:[6,!1,e.U8,[],[2],!1],version:[251,!1,e.U32LE,[],[0,2],!1],proprietary:[252,r,r,[],[0,2],!1]},c.PSBTInput={nonWitnessUtxo:[0,!1,f.RawTx,[],[0,2],!1],witnessUtxo:[1,!1,f.RawOutput,[],[0,2],!1],partialSig:[2,i,r,[],[0,2],!1],sighashType:[3,!1,e.U32LE,[],[0,2],!1],redeemScript:[4,!1,r,[],[0,2],!1],witnessScript:[5,!1,r,[],[0,2],!1],bip32Derivation:[6,i,l,[],[0,2],!1],finalScriptSig:[7,!1,r,[],[0,2],!1],finalScriptWitness:[8,!1,f.RawWitness,[],[0,2],!1],porCommitment:[9,!1,r,[],[0,2],!1],ripemd160:[10,s,r,[],[0,2],!1],sha256:[11,t,r,[],[0,2],!1],hash160:[12,s,r,[],[0,2],!1],hash256:[13,t,r,[],[0,2],!1],txid:[14,!1,t,[2],[2],!0],index:[15,!1,e.U32LE,[2],[2],!0],sequence:[16,!1,e.U32LE,[],[2],!0],requiredTimeLocktime:[17,!1,e.U32LE,[],[2],!1],requiredHeightLocktime:[18,!1,e.U32LE,[],[2],!1],tapKeySig:[19,!1,k,[],[0,2],!1],tapScriptSig:[20,o,k,[],[0,2],!1],tapLeafScript:[21,c.TaprootControlBlock,r,[],[0,2],!1],tapBip32Derivation:[22,t,m,[],[0,2],!1],tapInternalKey:[23,!1,j,[],[0,2],!1],tapMerkleRoot:[24,!1,t,[],[0,2],!1],proprietary:[252,r,r,[],[0,2],!1]},c.PSBTInputFinalKeys=["txid","sequence","index","witnessUtxo","nonWitnessUtxo","finalScriptSig","finalScriptWitness","unknown"],c.PSBTInputUnsignedKeys=["partialSig","finalScriptSig","finalScriptWitness","tapKeySig","tapScriptSig"],c.PSBTOutput={redeemScript:[0,!1,r,[],[0,2],!1],witnessScript:[1,!1,r,[],[0,2],!1],bip32Derivation:[2,i,l,[],[0,2],!1],amount:[3,!1,e.I64LE,[2],[2],!0],script:[4,!1,r,[2],[2],!0],tapInternalKey:[5,!1,j,[],[0,2],!1],tapTree:[6,!1,q,[],[0,2],!1],tapBip32Derivation:[7,j,m,[],[0,2],!1],proprietary:[252,r,r,[],[0,2],!1]},c.PSBTOutputUnsignedKeys=[];let u=e.array(e.NULL,e.struct({key:e.prefix(f.CompactSizeLen,e.struct({type:f.CompactSizeLen,key:e.bytes(null)})),value:e.bytes(f.CompactSizeLen)}));function v(a){let[b,c,d,e,f,g]=a;return{type:b,kc:c,vc:d,reqInc:e,allowInc:f,silentIgnore:g}}function w(a){let b={};for(let c in a){let[d,e,f]=a[c];b[d]=[c,e,f]}return e.wrap({encodeStream:(b,c)=>{let d=[];for(let b in a){let f=c[b];if(void 0===f)continue;let[g,i,j]=a[b];if(i){let a=f.map(([a,b])=>[i.encode(a),j.encode(b)]);for(let[b,c]of(a.sort((a,b)=>(0,h.compareBytes)(a[0],b[0])),a))d.push({key:{key:b,type:g},value:c})}else d.push({key:{type:g,key:e.EMPTY},value:j.encode(f)})}if(c.unknown)for(let[a,b]of(c.unknown.sort((a,b)=>(0,h.compareBytes)(a[0].key,b[0].key)),c.unknown))d.push({key:a,value:b});u.encodeStream(b,d)},decodeStream:a=>{let c=u.decodeStream(a),e={},f={};for(let a of c){let c="unknown",g=a.key.key,h=a.value;if(b[a.key.type]){let[i,j,k]=b[a.key.type];if(c=i,!j&&g.length)throw Error(`PSBT: Non-empty key for ${c} (key=${d.hex.encode(g)} value=${d.hex.encode(h)}`);if(g=j?j.decode(g):void 0,h=k.decode(h),!j){if(e[c])throw Error(`PSBT: Same keys: ${c} (key=${g} value=${h})`);e[c]=h,f[c]=!0;continue}}else g={type:a.key.type,key:a.key.key};if(f[c])throw Error(`PSBT: Key type with empty key and no key=${c} val=${h}`);e[c]||(e[c]=[]),e[c].push([g,h])}return e}})}e.struct({type:f.CompactSizeLen,key:e.bytes(null)}),c.PSBTInputCoder=e.validate(w(c.PSBTInput),a=>{if(a.finalScriptWitness&&!a.finalScriptWitness.length)throw Error("validateInput: empty finalScriptWitness");if(a.partialSig&&!a.partialSig.length)throw Error("Empty partialSig");if(a.partialSig)for(let[b]of a.partialSig)(0,h.validatePubkey)(b,h.PubT.ecdsa);if(a.bip32Derivation)for(let[b]of a.bip32Derivation)(0,h.validatePubkey)(b,h.PubT.ecdsa);if(void 0!==a.requiredTimeLocktime&&a.requiredTimeLocktime<5e8)throw Error(`validateInput: wrong timeLocktime=${a.requiredTimeLocktime}`);if(void 0!==a.requiredHeightLocktime&&(a.requiredHeightLocktime<=0||a.requiredHeightLocktime>=5e8))throw Error(`validateInput: wrong heighLocktime=${a.requiredHeightLocktime}`);if(a.nonWitnessUtxo&&void 0!==a.index){let b=a.nonWitnessUtxo.outputs.length-1;if(a.index>b)throw Error(`validateInput: index(${a.index}) not in nonWitnessUtxo`);let c=a.nonWitnessUtxo.outputs[a.index];if(a.witnessUtxo&&(!(0,h.equalBytes)(a.witnessUtxo.script,c.script)||a.witnessUtxo.amount!==c.amount))throw Error("validateInput: witnessUtxo different from nonWitnessUtxo")}if(a.tapLeafScript)for(let[b,c]of a.tapLeafScript){if((254&b.version)!==c[c.length-1])throw Error("validateInput: tapLeafScript version mimatch");if(1&c[c.length-1])throw Error("validateInput: tapLeafScript version has parity bit!")}if(a.nonWitnessUtxo&&void 0!==a.index&&a.txid){if(a.nonWitnessUtxo.outputs.length-1<a.index)throw Error("nonWitnessUtxo: incorect output index");let b=g.Transaction.fromRaw(f.RawTx.encode(a.nonWitnessUtxo),{allowUnknownOutputs:!0,disableScriptCheck:!0,allowUnknownInputs:!0}),c=d.hex.encode(a.txid);if(b.isFinal&&b.id!==c)throw Error(`nonWitnessUtxo: wrong txid, exp=${c} got=${b.id}`)}return a}),c.PSBTOutputCoder=e.validate(w(c.PSBTOutput),a=>{if(a.bip32Derivation)for(let[b]of a.bip32Derivation)(0,h.validatePubkey)(b,h.PubT.ecdsa);return a});let x=e.validate(w(c.PSBTGlobal),a=>{if(0===(a.version||0)){if(!a.unsignedTx)throw Error("PSBTv0: missing unsignedTx");for(let b of a.unsignedTx.inputs)if(b.finalScriptSig&&b.finalScriptSig.length)throw Error("PSBTv0: input scriptSig found in unsignedTx")}return a});function y(a,b,c){for(let d in c){if("unknown"===d||!b[d])continue;let{allowInc:c}=v(b[d]);if(!c.includes(a))throw Error(`PSBTv${a}: field ${d} is not allowed`)}for(let d in b){let{reqInc:e}=v(b[d]);if(e.includes(a)&&void 0===c[d])throw Error(`PSBTv${a}: missing required field ${d}`)}}function z(a){let b=a&&a.global&&a.global.version||0;for(let d of(y(b,c.PSBTGlobal,a.global),a.inputs))y(b,c.PSBTInput,d);for(let d of a.outputs)y(b,c.PSBTOutput,d);let d=b?a.global.inputCount:a.global.unsignedTx.inputs.length;if(a.inputs.length<d)throw Error("Not enough inputs");let e=a.inputs.slice(d);if(e.length>1||e.length&&Object.keys(e[0]).length)throw Error(`Unexpected inputs left in tx=${e}`);let f=b?a.global.outputCount:a.global.unsignedTx.outputs.length;if(a.outputs.length<f)throw Error("Not outputs inputs");let g=a.outputs.slice(f);if(g.length>1||g.length&&Object.keys(g[0]).length)throw Error(`Unexpected outputs left in tx=${g}`);return a}c._RawPSBTV0=e.struct({magic:e.magic(e.string(new Uint8Array([255])),"psbt"),global:x,inputs:e.array("global/unsignedTx/inputs/length",c.PSBTInputCoder),outputs:e.array(null,c.PSBTOutputCoder)}),c._RawPSBTV2=e.struct({magic:e.magic(e.string(new Uint8Array([255])),"psbt"),global:x,inputs:e.array("global/inputCount",c.PSBTInputCoder),outputs:e.array("global/outputCount",c.PSBTOutputCoder)}),c._DebugPSBT=e.struct({magic:e.magic(e.string(new Uint8Array([255])),"psbt"),items:e.array(null,e.apply(e.array(e.NULL,e.tuple([e.hex(f.CompactSizeLen),e.bytes(f.CompactSize)])),e.coders.dict()))}),c.RawPSBTV0=e.validate(c._RawPSBTV0,z),c.RawPSBTV2=e.validate(c._RawPSBTV2,z)},133028,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c._sortPubkeys=c.p2tr_pk=c.p2tr_ns=c.tapLeafHash=c.TAP_LEAF_VERSION=c.p2ms=c.p2wpkh=c.p2wsh=c.p2sh=c.p2pkh=c.p2pk=c.OutScript=void 0,c.checkScript=n,c.taprootListToTree=p,c.p2tr=q,c.combinations=r,c.p2tr_ms=function(a,b,d=!1){return d||o(b),{type:"tr_ms",script:c.OutScript.encode({type:"tr_ms",pubkeys:b,m:a})}},c.getAddress=function(a,b,d=i.NETWORK){if("tr"===a)return q(h.pubSchnorr(b),void 0,d).address;let e=h.pubECDSA(b);if("pkh"===a)return(0,c.p2pkh)(e,d).address;if("wpkh"===a)return(0,c.p2wpkh)(e,d).address;throw Error(`getAddress: unknown type=${a}`)},c.multisig=s,c.sortedMultisig=function(a,b,c=!1,d=i.NETWORK){return s(a,b,!0,c,d)},c.WIF=function(a=i.NETWORK){return{encode:b=>w(h.concatBytes(b,new Uint8Array([1])).subarray(0,33),[a.wif]),decode(b){let c=t.decode(b);if(c[0]!==a.wif)throw Error("Wrong WIF prefix");if(33!==(c=c.subarray(1)).length)throw Error("Wrong WIF length");if(1!==c[32])throw Error("Wrong WIF postfix");return c.subarray(0,-1)}}},c.Address=x;let d=a.r(67528),e=a.r(405337),f=a.r(621908),g=a.r(162850),h=a.r(411320),i=a.r(411320);function j(a,b){try{return h.validatePubkey(a,b),!0}catch(a){return!1}}let k=[{encode(a){if(2===a.length&&1===a[0]&&h.isBytes(a[1])&&"4e73"===d.hex.encode(a[1]))return{type:"p2a",script:g.Script.encode(a)}},decode:a=>{if("p2a"===a.type)return[1,d.hex.decode("4e73")]}},{encode(a){if(2===a.length&&h.isBytes(a[0])&&j(a[0],h.PubT.ecdsa)&&"CHECKSIG"===a[1])return{type:"pk",pubkey:a[0]}},decode:a=>"pk"===a.type?[a.pubkey,"CHECKSIG"]:void 0},{encode(a){if(5===a.length&&"DUP"===a[0]&&"HASH160"===a[1]&&h.isBytes(a[2])&&"EQUALVERIFY"===a[3]&&"CHECKSIG"===a[4])return{type:"pkh",hash:a[2]}},decode:a=>"pkh"===a.type?["DUP","HASH160",a.hash,"EQUALVERIFY","CHECKSIG"]:void 0},{encode(a){if(3===a.length&&"HASH160"===a[0]&&h.isBytes(a[1])&&"EQUAL"===a[2])return{type:"sh",hash:a[1]}},decode:a=>"sh"===a.type?["HASH160",a.hash,"EQUAL"]:void 0},{encode(a){if(2===a.length&&0===a[0]&&h.isBytes(a[1])&&32===a[1].length)return{type:"wsh",hash:a[1]}},decode:a=>"wsh"===a.type?[0,a.hash]:void 0},{encode(a){if(2===a.length&&0===a[0]&&h.isBytes(a[1])&&20===a[1].length)return{type:"wpkh",hash:a[1]}},decode:a=>"wpkh"===a.type?[0,a.hash]:void 0},{encode(a){let b=a.length-1;if("CHECKMULTISIG"!==a[b])return;let c=a[0],d=a[b-1];if("number"!=typeof c||"number"!=typeof d)return;let e=a.slice(1,-2);if(d===e.length){for(let a of e)if(!h.isBytes(a))return;return{type:"ms",m:c,pubkeys:e}}},decode:a=>"ms"===a.type?[a.m,...a.pubkeys,a.pubkeys.length,"CHECKMULTISIG"]:void 0},{encode(a){if(2===a.length&&1===a[0]&&h.isBytes(a[1]))return{type:"tr",pubkey:a[1]}},decode:a=>"tr"===a.type?[1,a.pubkey]:void 0},{encode(a){let b=a.length-1;if("CHECKSIG"!==a[b])return;let c=[];for(let d=0;d<b;d++){let e=a[d];if(1&d){if("CHECKSIGVERIFY"!==e||d===b-1)return;continue}if(!h.isBytes(e))return;c.push(e)}return{type:"tr_ns",pubkeys:c}},decode:a=>{if("tr_ns"!==a.type)return;let b=[];for(let c=0;c<a.pubkeys.length-1;c++)b.push(a.pubkeys[c],"CHECKSIGVERIFY");return b.push(a.pubkeys[a.pubkeys.length-1],"CHECKSIG"),b}},{encode(a){let b=a.length-1;if("NUMEQUAL"!==a[b]||"CHECKSIG"!==a[1])return;let c=[],d=(0,g.OpToNum)(a[b-1]);if("number"==typeof d){for(let d=0;d<b-1;d++){let b=a[d];if(1&d){if(b!==(1===d?"CHECKSIG":"CHECKSIGADD"))throw Error("OutScript.encode/tr_ms: wrong element");continue}if(!h.isBytes(b))throw Error("OutScript.encode/tr_ms: wrong key element");c.push(b)}return{type:"tr_ms",pubkeys:c,m:d}}},decode:a=>{if("tr_ms"!==a.type)return;let b=[a.pubkeys[0],"CHECKSIG"];for(let c=1;c<a.pubkeys.length;c++)b.push(a.pubkeys[c],"CHECKSIGADD");return b.push(a.m,"NUMEQUAL"),b}},{encode:a=>({type:"unknown",script:g.Script.encode(a)}),decode:a=>"unknown"===a.type?g.Script.decode(a.script):void 0}],l=e.apply(g.Script,e.coders.match(k));function m(a,b){if(!h.equalBytes(a.hash,h.sha256(b)))throw Error("checkScript: wsh wrong witnessScript hash");let d=c.OutScript.decode(b);if("tr"===d.type||"tr_ns"===d.type||"tr_ms"===d.type)throw Error(`checkScript: P2${d.type} cannot be wrapped in P2SH`);if("wpkh"===d.type||"sh"===d.type)throw Error(`checkScript: P2${d.type} cannot be wrapped in P2WSH`)}function n(a,b,d){if(a){let e=c.OutScript.decode(a);if("tr_ns"===e.type||"tr_ms"===e.type||"ms"===e.type||"pk"==e.type)throw Error(`checkScript: non-wrapped ${e.type}`);if("sh"===e.type&&b){if(!h.equalBytes(e.hash,h.hash160(b)))throw Error("checkScript: sh wrong redeemScript hash");let a=c.OutScript.decode(b);if("tr"===a.type||"tr_ns"===a.type||"tr_ms"===a.type)throw Error(`checkScript: P2${a.type} cannot be wrapped in P2SH`);if("sh"===a.type)throw Error("checkScript: P2SH cannot be wrapped in P2SH")}"wsh"===e.type&&d&&m(e,d)}if(b){let a=c.OutScript.decode(b);"wsh"===a.type&&d&&m(a,d)}}function o(a){let b={};for(let c of a){let e=d.hex.encode(c);if(b[e])throw Error(`Multisig: non-uniq pubkey: ${a.map(d.hex.encode)}`);b[e]=!0}}function p(a){let b=Array.from(a);for(;b.length>=2;){b.sort((a,b)=>(b.weight||1)-(a.weight||1));let a=b.pop(),c=b.pop(),d=(c?.weight||1)+(a?.weight||1);b.push({weight:d,childs:[c?.childs||c,a?.childs||a]})}let c=b[0];return c?.childs||c}function q(a,b,k=i.NETWORK,l=!1,m){let n,o;if(!a&&!b)throw Error("p2tr: should have pubKey or scriptTree (or both)");let r="string"==typeof a?d.hex.decode(a):a||h.TAPROOT_UNSPENDABLE_KEY;if(!j(r,h.PubT.schnorr))throw Error("p2tr: non-schnorr pubkey");let s=b?function a(b,c=[]){if(!b)throw Error("taprootAddPath: empty tree");if("leaf"===b.type)return{...b,path:c};if("branch"!==b.type)throw Error(`taprootAddPath: wrong type=${b}`);return{...b,path:c,left:a(b.left,[b.right.hash,...c]),right:a(b.right,[b.left.hash,...c])}}(function a(b,f,i=!1,j){if(!b)throw Error("taprootHashTree: empty tree");if(Array.isArray(b)&&1===b.length&&(b=b[0]),!Array.isArray(b)){let{leafVersion:a,script:k}=b;if(b.tapLeafScript||b.tapMerkleRoot&&!h.equalBytes(b.tapMerkleRoot,e.EMPTY))throw Error("P2TR: tapRoot leafScript cannot have tree");let l="string"==typeof k?d.hex.decode(k):k;if(!h.isBytes(l))throw Error(`checkScript: wrong script type=${l}`);return!function(a,b,d=!1,f){let i=c.OutScript.decode(a);if("unknown"===i.type){if(f){let b=e.apply(g.Script,e.coders.match(f)).decode(a);if(void 0!==b){if("string"!=typeof b.type||!b.type.startsWith("tr_"))throw Error(`P2TR: invalid custom type=${b.type}`);return}}if(d)return}if(!["tr_ns","tr_ms"].includes(i.type))throw Error(`P2TR: invalid leaf script=${i.type}`);if(!d&&i.pubkeys)for(let a of i.pubkeys){if(h.equalBytes(a,h.TAPROOT_UNSPENDABLE_KEY))throw Error("Unspendable taproot key in leaf script");if(h.equalBytes(a,b))throw Error("Using P2TR with leaf script with same key as internal key is not supported")}}(l,f,i,j),{type:"leaf",version:a,script:l,hash:(0,c.tapLeafHash)(l,a)}}if(2!==b.length&&(b=p(b)),2!==b.length)throw Error("hashTree: non binary tree!");let k=a(b[0],f,i,j),l=a(b[1],f,i,j),[m,n]=[k.hash,l.hash];return -1===h.compareBytes(n,m)&&([m,n]=[n,m]),{type:"branch",left:k,right:l,hash:h.tagSchnorr("TapBranch",m,n)}}(b,r,l,m)):void 0,t=s?s.hash:void 0,[u,v]=h.taprootTweakPubkey(r,t||e.EMPTY);s&&(n=(function a(b){if(!b)throw Error("taprootAddPath: empty tree");if("leaf"===b.type)return[b];if("branch"!==b.type)throw Error(`taprootWalkTree: wrong type=${b}`);return[...a(b.left),...a(b.right)]})(s).map(a=>({...a,controlBlock:f.TaprootControlBlock.encode({version:(a.version||c.TAP_LEAF_VERSION)+v,internalKey:r,merklePath:a.path})}))),n&&(o=n.map(a=>[f.TaprootControlBlock.decode(a.controlBlock),h.concatBytes(a.script,new Uint8Array([a.version||c.TAP_LEAF_VERSION]))]));let w={type:"tr",script:c.OutScript.encode({type:"tr",pubkey:u}),address:x(k).encode({type:"tr",pubkey:u}),tweakedPubkey:u,tapInternalKey:r};return n&&(w.leaves=n),o&&(w.tapLeafScript=o),t&&(w.tapMerkleRoot=t),w}function r(a,b){let c=[];if(!Array.isArray(b))throw Error("combinations: lst arg should be array");let d=b.length;if(a>d)throw Error("combinations: m > lst.length, no combinations possible");let e=Array.from({length:a},(a,b)=>b),f=e.length-1;a:for(;;){c.push(e.map(a=>b[a])),e[f]+=1;let g=f;for(;g>=0&&e[g]>d-a+g;g--){if(e[g]=0,0===g)break a;e[g-1]+=1}for(g+=1;g<e.length;g++)e[g]=e[g-1]+1}return c}function s(a,b,d=!1,e=!1,f=i.NETWORK){let g=(0,c.p2ms)(a,d?(0,c._sortPubkeys)(b):b);return e?(0,c.p2wsh)(g,f):(0,c.p2sh)(g,f)}c.OutScript=e.validate(l,a=>{if("pk"===a.type&&!j(a.pubkey,h.PubT.ecdsa))throw Error("OutScript/pk: wrong key");if(("pkh"===a.type||"sh"===a.type||"wpkh"===a.type)&&(!h.isBytes(a.hash)||20!==a.hash.length))throw Error(`OutScript/${a.type}: wrong hash`);if("wsh"===a.type&&(!h.isBytes(a.hash)||32!==a.hash.length))throw Error("OutScript/wsh: wrong hash");if("tr"===a.type&&(!h.isBytes(a.pubkey)||!j(a.pubkey,h.PubT.schnorr)))throw Error("OutScript/tr: wrong taproot public key");if(("ms"===a.type||"tr_ns"===a.type||"tr_ms"===a.type)&&!Array.isArray(a.pubkeys))throw Error("OutScript/multisig: wrong pubkeys array");if("ms"===a.type){let b=a.pubkeys.length;for(let b of a.pubkeys)if(!j(b,h.PubT.ecdsa))throw Error("OutScript/multisig: wrong pubkey");if(a.m<=0||b>16||a.m>b)throw Error("OutScript/multisig: invalid params")}if("tr_ns"===a.type||"tr_ms"===a.type){for(let b of a.pubkeys)if(!j(b,h.PubT.schnorr))throw Error(`OutScript/${a.type}: wrong pubkey`)}if("tr_ms"===a.type){let b=a.pubkeys.length;if(a.m<=0||b>999||a.m>b)throw Error("OutScript/tr_ms: invalid params")}return a}),c.p2pk=(a,b=i.NETWORK)=>{if(!j(a,h.PubT.ecdsa))throw Error("P2PK: invalid publicKey");return{type:"pk",script:c.OutScript.encode({type:"pk",pubkey:a})}},c.p2pkh=(a,b=i.NETWORK)=>{if(!j(a,h.PubT.ecdsa))throw Error("P2PKH: invalid publicKey");let d=h.hash160(a);return{type:"pkh",script:c.OutScript.encode({type:"pkh",hash:d}),address:x(b).encode({type:"pkh",hash:d})}},c.p2sh=(a,b=i.NETWORK)=>{let d=a.script;if(!h.isBytes(d))throw Error(`Wrong script: ${typeof a.script}, expected Uint8Array`);let e=h.hash160(d);n(c.OutScript.encode({type:"sh",hash:e}),d,a.witnessScript);let f={type:"sh",redeemScript:d,script:c.OutScript.encode({type:"sh",hash:e}),address:x(b).encode({type:"sh",hash:e})};return a.witnessScript&&(f.witnessScript=a.witnessScript),f},c.p2wsh=(a,b=i.NETWORK)=>{let d=a.script;if(!h.isBytes(d))throw Error(`Wrong script: ${typeof d}, expected Uint8Array`);let e=h.sha256(d);return n(c.OutScript.encode({type:"wsh",hash:e}),void 0,d),{type:"wsh",witnessScript:d,script:c.OutScript.encode({type:"wsh",hash:e}),address:x(b).encode({type:"wsh",hash:e})}},c.p2wpkh=(a,b=i.NETWORK)=>{if(!j(a,h.PubT.ecdsa))throw Error("P2WPKH: invalid publicKey");if(65===a.length)throw Error("P2WPKH: uncompressed public key");let d=h.hash160(a);return{type:"wpkh",script:c.OutScript.encode({type:"wpkh",hash:d}),address:x(b).encode({type:"wpkh",hash:d})}},c.p2ms=(a,b,d=!1)=>(d||o(b),{type:"ms",script:c.OutScript.encode({type:"ms",pubkeys:b,m:a})}),c.TAP_LEAF_VERSION=192,c.tapLeafHash=(a,b=c.TAP_LEAF_VERSION)=>h.tagSchnorr("TapLeaf",new Uint8Array([b]),g.VarBytes.encode(a)),c.p2tr_ns=(a,b,d=!1)=>(d||o(b),r(a,b).map(a=>({type:"tr_ns",script:c.OutScript.encode({type:"tr_ns",pubkeys:a})}))),c.p2tr_pk=a=>(0,c.p2tr_ns)(1,[a],void 0)[0],c._sortPubkeys=a=>Array.from(a).sort(h.compareBytes);let t=(0,d.createBase58check)(h.sha256);function u(a,b){if(b.length<2||b.length>40)throw Error("Witness: invalid length");if(a>16)throw Error("Witness: invalid version");if(0===a&&20!==b.length&&32!==b.length)throw Error("Witness: invalid length for version")}function v(a,b,c=i.NETWORK){u(a,b);let e=0===a?d.bech32:d.bech32m;return e.encode(c.bech32,[a].concat(e.toWords(b)))}function w(a,b){return t.encode(h.concatBytes(Uint8Array.from(b),a))}function x(a=i.NETWORK){return{encode(b){let{type:c}=b;if("wpkh"===c||"wsh"===c)return v(0,b.hash,a);if("tr"===c)return v(1,b.pubkey,a);if("pkh"===c)return w(b.hash,[a.pubKeyHash]);if("sh"===c)return w(b.hash,[a.scriptHash]);throw Error(`Unknown address type=${c}`)},decode(b){if(b.length<14||b.length>74)throw Error("Invalid address length");if(a.bech32&&b.toLowerCase().startsWith(`${a.bech32}1`)){let c;try{if(c=d.bech32.decode(b),0!==c.words[0])throw Error(`bech32: wrong version=${c.words[0]}`)}catch(a){if(0===(c=d.bech32m.decode(b)).words[0])throw Error(`bech32m: wrong version=${c.words[0]}`)}if(c.prefix!==a.bech32)throw Error(`wrong bech32 prefix=${c.prefix}`);let[e,...f]=c.words,g=d.bech32.fromWords(f);if(u(e,g),0===e&&32===g.length)return{type:"wsh",hash:g};if(0===e&&20===g.length)return{type:"wpkh",hash:g};if(1===e&&32===g.length)return{type:"tr",pubkey:g};else throw Error("Unknown witness program")}let c=t.decode(b);if(21!==c.length)throw Error("Invalid base58 address");if(c[0]===a.pubKeyHash)return{type:"pkh",hash:c.slice(1)};if(c[0]===a.scriptHash)return{type:"sh",hash:c.slice(1)};throw Error(`Invalid address prefix=${c[0]}`)}}}},680302,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c._Estimator=c._cmpBig=c.SigHash=c.PSBTCombine=c.DEFAULT_SEQUENCE=c.Decimal=c.bip32Path=c.TaprootControlBlock=c._DebugPSBT=c.WIF=c.taprootListToTree=c.sortedMultisig=c.OutScript=c.getAddress=c.combinations=c.Address=c._sortPubkeys=c.utils=c.selectUTXO=c.getInputType=c.TEST_NETWORK=c.TAPROOT_UNSPENDABLE_KEY=c.NETWORK=c.Transaction=c.ScriptNum=c.Script=c.RawWitness=c.RawTx=c.OP=c.MAX_SCRIPT_BYTE_LENGTH=c.CompactSize=c.p2wsh=c.p2wpkh=c.p2tr_pk=c.p2tr_ns=c.p2tr_ms=c.p2tr=c.p2sh=c.p2pkh=c.p2pk=c.p2ms=c.multisig=void 0;let d=a.r(411320);var e=a.r(133028);Object.defineProperty(c,"multisig",{enumerable:!0,get:function(){return e.multisig}}),Object.defineProperty(c,"p2ms",{enumerable:!0,get:function(){return e.p2ms}}),Object.defineProperty(c,"p2pk",{enumerable:!0,get:function(){return e.p2pk}}),Object.defineProperty(c,"p2pkh",{enumerable:!0,get:function(){return e.p2pkh}}),Object.defineProperty(c,"p2sh",{enumerable:!0,get:function(){return e.p2sh}}),Object.defineProperty(c,"p2tr",{enumerable:!0,get:function(){return e.p2tr}}),Object.defineProperty(c,"p2tr_ms",{enumerable:!0,get:function(){return e.p2tr_ms}}),Object.defineProperty(c,"p2tr_ns",{enumerable:!0,get:function(){return e.p2tr_ns}}),Object.defineProperty(c,"p2tr_pk",{enumerable:!0,get:function(){return e.p2tr_pk}}),Object.defineProperty(c,"p2wpkh",{enumerable:!0,get:function(){return e.p2wpkh}}),Object.defineProperty(c,"p2wsh",{enumerable:!0,get:function(){return e.p2wsh}});var f=a.r(162850);Object.defineProperty(c,"CompactSize",{enumerable:!0,get:function(){return f.CompactSize}}),Object.defineProperty(c,"MAX_SCRIPT_BYTE_LENGTH",{enumerable:!0,get:function(){return f.MAX_SCRIPT_BYTE_LENGTH}}),Object.defineProperty(c,"OP",{enumerable:!0,get:function(){return f.OP}}),Object.defineProperty(c,"RawTx",{enumerable:!0,get:function(){return f.RawTx}}),Object.defineProperty(c,"RawWitness",{enumerable:!0,get:function(){return f.RawWitness}}),Object.defineProperty(c,"Script",{enumerable:!0,get:function(){return f.Script}}),Object.defineProperty(c,"ScriptNum",{enumerable:!0,get:function(){return f.ScriptNum}});var g=a.r(807625);Object.defineProperty(c,"Transaction",{enumerable:!0,get:function(){return g.Transaction}});var h=a.r(411320);Object.defineProperty(c,"NETWORK",{enumerable:!0,get:function(){return h.NETWORK}}),Object.defineProperty(c,"TAPROOT_UNSPENDABLE_KEY",{enumerable:!0,get:function(){return h.TAPROOT_UNSPENDABLE_KEY}}),Object.defineProperty(c,"TEST_NETWORK",{enumerable:!0,get:function(){return h.TEST_NETWORK}});var i=a.r(524271);Object.defineProperty(c,"getInputType",{enumerable:!0,get:function(){return i.getInputType}}),Object.defineProperty(c,"selectUTXO",{enumerable:!0,get:function(){return i.selectUTXO}}),c.utils={isBytes:d.isBytes,concatBytes:d.concatBytes,compareBytes:d.compareBytes,pubSchnorr:d.pubSchnorr,randomPrivateKeyBytes:d.randomPrivateKeyBytes,taprootTweakPubkey:d.taprootTweakPubkey};var j=a.r(133028);Object.defineProperty(c,"_sortPubkeys",{enumerable:!0,get:function(){return j._sortPubkeys}}),Object.defineProperty(c,"Address",{enumerable:!0,get:function(){return j.Address}}),Object.defineProperty(c,"combinations",{enumerable:!0,get:function(){return j.combinations}}),Object.defineProperty(c,"getAddress",{enumerable:!0,get:function(){return j.getAddress}}),Object.defineProperty(c,"OutScript",{enumerable:!0,get:function(){return j.OutScript}}),Object.defineProperty(c,"sortedMultisig",{enumerable:!0,get:function(){return j.sortedMultisig}}),Object.defineProperty(c,"taprootListToTree",{enumerable:!0,get:function(){return j.taprootListToTree}}),Object.defineProperty(c,"WIF",{enumerable:!0,get:function(){return j.WIF}});var k=a.r(621908);Object.defineProperty(c,"_DebugPSBT",{enumerable:!0,get:function(){return k._DebugPSBT}}),Object.defineProperty(c,"TaprootControlBlock",{enumerable:!0,get:function(){return k.TaprootControlBlock}});var l=a.r(807625);Object.defineProperty(c,"bip32Path",{enumerable:!0,get:function(){return l.bip32Path}}),Object.defineProperty(c,"Decimal",{enumerable:!0,get:function(){return l.Decimal}}),Object.defineProperty(c,"DEFAULT_SEQUENCE",{enumerable:!0,get:function(){return l.DEFAULT_SEQUENCE}}),Object.defineProperty(c,"PSBTCombine",{enumerable:!0,get:function(){return l.PSBTCombine}}),Object.defineProperty(c,"SigHash",{enumerable:!0,get:function(){return l.SigHash}});var m=a.r(524271);Object.defineProperty(c,"_cmpBig",{enumerable:!0,get:function(){return m._cmpBig}}),Object.defineProperty(c,"_Estimator",{enumerable:!0,get:function(){return m._Estimator}})},980791,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},583835,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},829502,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},954635,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},544064,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},370682,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ETransactionVersion3=c.ETransactionVersion2=c.ETransactionVersion=c.EDAMode=c.EDataAvailabilityMode=c.EBlockTag=c.ETransactionExecutionStatus=c.ETransactionFinalityStatus=c.ETransactionStatus=c.ESimulationFlag=c.ETransactionType=c.CALL_TYPE=c.L1_DA_MODE=c.PRICE_UNIT_FRI=c.PRICE_UNIT_WEI=c.STATE_MUTABILITY_EXTERNAL=c.STATE_MUTABILITY_VIEW=c.ABI_TYPE_ENUM=c.ABI_TYPE_L1_HANDLER=c.ABI_TYPE_CONSTRUCTOR=c.ABI_TYPE_FUNCTION=c.EVENT_ABI_TYPE=c.STRUCT_ABI_TYPE=c.TXN_TYPE_L1_HANDLER=c.TXN_TYPE_INVOKE=c.TXN_TYPE_DEPLOY_ACCOUNT=c.TXN_TYPE_DEPLOY=c.TXN_TYPE_DECLARE=c.STATUS_RECEIVED=c.STATUS_REJECTED=c.STATUS_PENDING=c.STATUS_REVERTED=c.STATUS_SUCCEEDED=c.STATUS_ACCEPTED_ON_L1=c.STATUS_ACCEPTED_ON_L2=void 0,c.STATUS_ACCEPTED_ON_L2="ACCEPTED_ON_L2",c.STATUS_ACCEPTED_ON_L1="ACCEPTED_ON_L1",c.STATUS_SUCCEEDED="SUCCEEDED",c.STATUS_REVERTED="REVERTED",c.STATUS_PENDING="PENDING",c.STATUS_REJECTED="REJECTED",c.STATUS_RECEIVED="RECEIVED",c.TXN_TYPE_DECLARE="DECLARE",c.TXN_TYPE_DEPLOY="DEPLOY",c.TXN_TYPE_DEPLOY_ACCOUNT="DEPLOY_ACCOUNT",c.TXN_TYPE_INVOKE="INVOKE",c.TXN_TYPE_L1_HANDLER="L1_HANDLER",c.STRUCT_ABI_TYPE="struct",c.EVENT_ABI_TYPE="event",c.ABI_TYPE_FUNCTION="function",c.ABI_TYPE_CONSTRUCTOR="constructor",c.ABI_TYPE_L1_HANDLER="l1_handler",c.ABI_TYPE_ENUM="enum",c.STATE_MUTABILITY_VIEW="view",c.STATE_MUTABILITY_EXTERNAL="external",c.PRICE_UNIT_WEI="WEI",c.PRICE_UNIT_FRI="FRI",c.L1_DA_MODE={BLOB:"BLOB",CALLDATA:"CALLDATA"},c.CALL_TYPE={DELEGATE:"DELEGATE",LIBRARY_CALL:"LIBRARY_CALL",CALL:"CALL"},c.ETransactionType={DECLARE:c.TXN_TYPE_DECLARE,DEPLOY:c.TXN_TYPE_DEPLOY,DEPLOY_ACCOUNT:c.TXN_TYPE_DEPLOY_ACCOUNT,INVOKE:c.TXN_TYPE_INVOKE,L1_HANDLER:c.TXN_TYPE_L1_HANDLER},c.ESimulationFlag={SKIP_VALIDATE:"SKIP_VALIDATE",SKIP_FEE_CHARGE:"SKIP_FEE_CHARGE"},c.ETransactionStatus={RECEIVED:c.STATUS_RECEIVED,REJECTED:c.STATUS_REJECTED,ACCEPTED_ON_L2:c.STATUS_ACCEPTED_ON_L2,ACCEPTED_ON_L1:c.STATUS_ACCEPTED_ON_L1},c.ETransactionFinalityStatus={ACCEPTED_ON_L2:c.STATUS_ACCEPTED_ON_L2,ACCEPTED_ON_L1:c.STATUS_ACCEPTED_ON_L1},c.ETransactionExecutionStatus={SUCCEEDED:c.STATUS_SUCCEEDED,REVERTED:c.STATUS_REVERTED},c.EBlockTag={LATEST:"latest",PENDING:"pending"},c.EDataAvailabilityMode={L1:"L1",L2:"L2"},c.EDAMode={L1:0,L2:1},c.ETransactionVersion={V0:"0x0",V1:"0x1",V2:"0x2",V3:"0x3",F0:"0x100000000000000000000000000000000",F1:"0x100000000000000000000000000000001",F2:"0x100000000000000000000000000000002",F3:"0x100000000000000000000000000000003"},c.ETransactionVersion2={V0:c.ETransactionVersion.V0,V1:c.ETransactionVersion.V1,V2:c.ETransactionVersion.V2,F0:c.ETransactionVersion.F0,F1:c.ETransactionVersion.F1,F2:c.ETransactionVersion.F2},c.ETransactionVersion3={V3:c.ETransactionVersion.V3,F3:c.ETransactionVersion.F3}},611894,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},450098,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},199293,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.CONTRACT=void 0,e(a.r(980791),c),c.CONTRACT=a.r(583835),e(a.r(829502),c),e(a.r(954635),c),e(a.r(544064),c),e(a.r(370682),c),e(a.r(611894),c),e(a.r(450098),c)},752981,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Permission=void 0,c.Permission={ACCOUNTS:"accounts"}},645003,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.TypedDataRevision=void 0,c.TypedDataRevision={ACTIVE:"1",LEGACY:"0"}},708061,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},899446,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},853940,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},449727,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},113115,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},961576,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),e(a.r(752981),c),e(a.r(645003),c),e(a.r(708061),c),e(a.r(899446),c),e(a.r(853940),c),e(a.r(449727),c),e(a.r(113115),c)},321256,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},53537,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},584226,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},894015,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},157728,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),e(a.r(321256),c),e(a.r(53537),c),e(a.r(584226),c),e(a.r(894015),c)},895831,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.PAYMASTER_API=c.WALLET_API=c.API=void 0,e(a.r(199293),c),c.API=a.r(199293),e(a.r(961576),c),c.WALLET_API=a.r(961576),c.PAYMASTER_API=a.r(157728)},995936,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},358218,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},946695,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},112116,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ETransactionVersion3=c.ETransactionVersion2=c.ETransactionVersion=c.EDAMode=c.EDataAvailabilityMode=c.EBlockTag=c.ETransactionExecutionStatus=c.ETransactionFinalityStatus=c.ETransactionStatus=c.ESimulationFlag=c.ETransactionType=void 0,c.ETransactionType={DECLARE:"DECLARE",DEPLOY:"DEPLOY",DEPLOY_ACCOUNT:"DEPLOY_ACCOUNT",INVOKE:"INVOKE",L1_HANDLER:"L1_HANDLER"},c.ESimulationFlag={SKIP_VALIDATE:"SKIP_VALIDATE",SKIP_FEE_CHARGE:"SKIP_FEE_CHARGE"},c.ETransactionStatus={RECEIVED:"RECEIVED",REJECTED:"REJECTED",ACCEPTED_ON_L2:"ACCEPTED_ON_L2",ACCEPTED_ON_L1:"ACCEPTED_ON_L1"},c.ETransactionFinalityStatus={ACCEPTED_ON_L2:"ACCEPTED_ON_L2",ACCEPTED_ON_L1:"ACCEPTED_ON_L1"},c.ETransactionExecutionStatus={SUCCEEDED:"SUCCEEDED",REVERTED:"REVERTED"},c.EBlockTag={LATEST:"latest",PENDING:"pending"},c.EDataAvailabilityMode={L1:"L1",L2:"L2"},c.EDAMode={L1:0,L2:1},c.ETransactionVersion={V0:"0x0",V1:"0x1",V2:"0x2",V3:"0x3",F0:"0x100000000000000000000000000000000",F1:"0x100000000000000000000000000000001",F2:"0x100000000000000000000000000000002",F3:"0x100000000000000000000000000000003"},c.ETransactionVersion2={V0:"0x0",V1:"0x1",V2:"0x2",F0:"0x100000000000000000000000000000000",F1:"0x100000000000000000000000000000001",F2:"0x100000000000000000000000000000002"},c.ETransactionVersion3={V3:"0x3",F3:"0x100000000000000000000000000000003"}},534712,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.SPEC=c.Errors=void 0,e(a.r(995936),c),c.Errors=a.r(358218),c.SPEC=a.r(946695),e(a.r(112116),c)},675951,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Permission=void 0,c.Permission={ACCOUNTS:"accounts"}},19546,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.TypedDataRevision=void 0,c.TypedDataRevision={ACTIVE:"1",LEGACY:"0"}},890949,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},548183,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},620275,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},289451,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},662235,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},491004,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),e(a.r(675951),c),e(a.r(19546),c),e(a.r(890949),c),e(a.r(548183),c),e(a.r(620275),c),e(a.r(289451),c),e(a.r(662235),c)},356569,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.WALLET_API=c.API=void 0,e(a.r(534712),c),c.API=a.r(534712),e(a.r(491004),c),c.WALLET_API=a.r(491004)},330320,(a,b,c)=>{"use strict";function d(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function e(a,b){return!!Array.isArray(b)&&(0===b.length||(a?b.every(a=>"string"==typeof a):b.every(a=>Number.isSafeInteger(a))))}function f(a){if("function"!=typeof a)throw Error("function expected");return!0}function g(a,b){if("string"!=typeof b)throw Error(`${a}: string expected`);return!0}function h(a){if(!Number.isSafeInteger(a))throw Error(`invalid integer: ${a}`)}function i(a){if(!Array.isArray(a))throw Error("array expected")}function j(a,b){if(!e(!0,b))throw Error(`${a}: array of strings expected`)}function k(a,b){if(!e(!1,b))throw Error(`${a}: array of numbers expected`)}function l(...a){let b=a=>a,c=(a,b)=>c=>a(b(c));return{encode:a.map(a=>a.encode).reduceRight(c,b),decode:a.map(a=>a.decode).reduce(c,b)}}function m(a){let b="string"==typeof a?a.split(""):a,c=b.length;j("alphabet",b);let d=new Map(b.map((a,b)=>[a,b]));return{encode:d=>(i(d),d.map(d=>{if(!Number.isSafeInteger(d)||d<0||d>=c)throw Error(`alphabet.encode: digit index outside alphabet "${d}". Allowed: ${a}`);return b[d]})),decode:b=>(i(b),b.map(b=>{g("alphabet.decode",b);let c=d.get(b);if(void 0===c)throw Error(`Unknown letter: "${b}". Allowed: ${a}`);return c}))}}function n(a=""){return g("join",a),{encode:b=>(j("join.decode",b),b.join(a)),decode:b=>(g("join.decode",b),b.split(a))}}function o(a,b="="){return h(a),g("padding",b),{encode(c){for(j("padding.encode",c);c.length*a%8;)c.push(b);return c},decode(c){j("padding.decode",c);let d=c.length;if(d*a%8)throw Error("padding: invalid, string should have whole number of bytes");for(;d>0&&c[d-1]===b;d--)if((d-1)*a%8==0)throw Error("padding: invalid, string has too much padding");return c.slice(0,d)}}}function p(a){return f(a),{encode:a=>a,decode:b=>a(b)}}function q(a,b,c){if(b<2)throw Error(`convertRadix: invalid from=${b}, base cannot be less than 2`);if(c<2)throw Error(`convertRadix: invalid to=${c}, base cannot be less than 2`);if(i(a),!a.length)return[];let d=0,e=[],f=Array.from(a,a=>{if(h(a),a<0||a>=b)throw Error(`invalid integer: ${a}`);return a}),g=f.length;for(;;){let a=0,h=!0;for(let e=d;e<g;e++){let g=f[e],i=b*a,j=i+g;if(!Number.isSafeInteger(j)||i/b!==a||j-g!==i)throw Error("convertRadix: carry overflow");let k=j/c;a=j%c;let l=Math.floor(k);if(f[e]=l,!Number.isSafeInteger(l)||l*c+a!==j)throw Error("convertRadix: carry overflow");h&&(l?h=!1:d=e)}if(e.push(a),h)break}for(let b=0;b<a.length-1&&0===a[b];b++)e.push(0);return e.reverse()}Object.defineProperty(c,"__esModule",{value:!0}),c.bytes=c.stringToBytes=c.str=c.bytesToString=c.hex=c.utf8=c.bech32m=c.bech32=c.base58check=c.createBase58check=c.base58xmr=c.base58xrp=c.base58flickr=c.base58=c.base64urlnopad=c.base64url=c.base64nopad=c.base64=c.base32crockford=c.base32hexnopad=c.base32hex=c.base32nopad=c.base32=c.base16=c.utils=c.assertNumber=void 0,c.assertNumber=h;let r=(a,b)=>0===b?a:r(b,a%b),s=(a,b)=>a+(b-r(a,b)),t=(()=>{let a=[];for(let b=0;b<40;b++)a.push(2**b);return a})();function u(a,b,c,d){if(i(a),b<=0||b>32)throw Error(`convertRadix2: wrong from=${b}`);if(c<=0||c>32)throw Error(`convertRadix2: wrong to=${c}`);if(s(b,c)>32)throw Error(`convertRadix2: carry overflow from=${b} to=${c} carryBits=${s(b,c)}`);let e=0,f=0,g=t[b],j=t[c]-1,k=[];for(let d of a){if(h(d),d>=g)throw Error(`convertRadix2: invalid data word=${d} from=${b}`);if(e=e<<b|d,f+b>32)throw Error(`convertRadix2: carry overflow pos=${f} from=${b}`);for(f+=b;f>=c;f-=c)k.push((e>>f-c&j)>>>0);let a=t[f];if(void 0===a)throw Error("invalid carry");e&=a-1}if(e=e<<c-f&j,!d&&f>=b)throw Error("Excess padding");if(!d&&e>0)throw Error(`Non-zero padding: ${e}`);return d&&f>0&&k.push(e>>>0),k}function v(a){return h(a),{encode:b=>{if(!d(b))throw Error("radix.encode input should be Uint8Array");return q(Array.from(b),256,a)},decode:b=>(k("radix.decode",b),Uint8Array.from(q(b,a,256)))}}function w(a,b=!1){if(h(a),a<=0||a>32)throw Error("radix2: bits should be in (0..32]");if(s(8,a)>32||s(a,8)>32)throw Error("radix2: carry overflow");return{encode:c=>{if(!d(c))throw Error("radix2.encode input should be Uint8Array");return u(Array.from(c),8,a,!b)},decode:c=>(k("radix2.decode",c),Uint8Array.from(u(c,a,8,b)))}}function x(a){return f(a),function(...b){try{return a.apply(null,b)}catch(a){}}}function y(a,b){return h(a),f(b),{encode(c){if(!d(c))throw Error("checksum.encode: input should be Uint8Array");let e=b(c).slice(0,a),f=new Uint8Array(c.length+a);return f.set(c),f.set(e,c.length),f},decode(c){if(!d(c))throw Error("checksum.decode: input should be Uint8Array");let e=c.slice(0,-a),f=c.slice(-a),g=b(e).slice(0,a);for(let b=0;b<a;b++)if(g[b]!==f[b])throw Error("Invalid checksum");return e}}}c.utils={alphabet:m,chain:l,checksum:y,convertRadix:q,convertRadix2:u,radix:v,radix2:w,join:n,padding:o},c.base16=l(w(4),m("0123456789ABCDEF"),n("")),c.base32=l(w(5),m("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),o(5),n("")),c.base32nopad=l(w(5),m("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),n("")),c.base32hex=l(w(5),m("0123456789ABCDEFGHIJKLMNOPQRSTUV"),o(5),n("")),c.base32hexnopad=l(w(5),m("0123456789ABCDEFGHIJKLMNOPQRSTUV"),n("")),c.base32crockford=l(w(5),m("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),n(""),p(a=>a.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),c.base64=l(w(6),m("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),o(6),n("")),c.base64nopad=l(w(6),m("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),n("")),c.base64url=l(w(6),m("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),o(6),n("")),c.base64urlnopad=l(w(6),m("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),n(""));let z=a=>l(v(58),m(a),n(""));c.base58=z("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),c.base58flickr=z("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),c.base58xrp=z("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");let A=[0,2,3,5,6,7,9,10,11];c.base58xmr={encode(a){let b="";for(let d=0;d<a.length;d+=8){let e=a.subarray(d,d+8);b+=c.base58.encode(e).padStart(A[e.length],"1")}return b},decode(a){let b=[];for(let d=0;d<a.length;d+=11){let e=a.slice(d,d+11),f=A.indexOf(e.length),g=c.base58.decode(e);for(let a=0;a<g.length-f;a++)if(0!==g[a])throw Error("base58xmr: wrong padding");b=b.concat(Array.from(g.slice(g.length-f)))}return Uint8Array.from(b)}},c.createBase58check=a=>l(y(4,b=>a(a(b))),c.base58),c.base58check=c.createBase58check;let B=l(m("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),n("")),C=[0x3b6a57b2,0x26508e6d,0x1ea119fa,0x3d4233dd,0x2a1462b3];function D(a){let b=a>>25,c=(0x1ffffff&a)<<5;for(let a=0;a<C.length;a++)(b>>a&1)==1&&(c^=C[a]);return c}function E(a,b,c=1){let d=a.length,e=1;for(let b=0;b<d;b++){let c=a.charCodeAt(b);if(c<33||c>126)throw Error(`Invalid prefix (${a})`);e=D(e)^c>>5}e=D(e);for(let b=0;b<d;b++)e=D(e)^31&a.charCodeAt(b);for(let a of b)e=D(e)^a;for(let a=0;a<6;a++)e=D(e);return e^=c,B.encode(u([e%t[30]],30,5,!1))}function F(a){let b="bech32"===a?1:0x2bc830a3,c=w(5),e=c.decode,f=c.encode,h=x(e);function i(a,c,e=90){g("bech32.encode prefix",a),d(c)&&(c=Array.from(c)),k("bech32.encode",c);let f=a.length;if(0===f)throw TypeError(`Invalid prefix length ${f}`);let h=f+7+c.length;if(!1!==e&&h>e)throw TypeError(`Length ${h} exceeds limit ${e}`);let j=a.toLowerCase(),l=E(j,c,b);return`${j}1${B.encode(c)}${l}`}function j(a,c=90){g("bech32.decode input",a);let d=a.length;if(d<8||!1!==c&&d>c)throw TypeError(`invalid string length: ${d} (${a}). Expected (8..${c})`);let e=a.toLowerCase();if(a!==e&&a!==a.toUpperCase())throw Error("String must be lowercase or uppercase");let f=e.lastIndexOf("1");if(0===f||-1===f)throw Error('Letter "1" must be present between prefix and data only');let h=e.slice(0,f),i=e.slice(f+1);if(i.length<6)throw Error("Data must be at least 6 characters long");let k=B.decode(i).slice(0,-6),l=E(h,k,b);if(!i.endsWith(l))throw Error(`Invalid checksum in ${a}: expected "${l}"`);return{prefix:h,words:k}}let l=x(j);return{encode:i,decode:j,encodeFromBytes:function(a,b){return i(a,f(b))},decodeToBytes:function(a){let{prefix:b,words:c}=j(a,!1);return{prefix:b,words:c,bytes:e(c)}},decodeUnsafe:l,fromWords:e,fromWordsUnsafe:h,toWords:f}}c.bech32=F("bech32"),c.bech32m=F("bech32m"),c.utf8={encode:a=>new TextDecoder().decode(a),decode:a=>new TextEncoder().encode(a)},c.hex=l(w(4),m("0123456789abcdef"),n(""),p(a=>{if("string"!=typeof a||a.length%2!=0)throw TypeError(`hex.decode: expected string, got ${typeof a} with length ${a.length}`);return a.toLowerCase()}));let G={utf8:c.utf8,hex:c.hex,base16:c.base16,base32:c.base32,base64:c.base64,base64url:c.base64url,base58:c.base58,base58xmr:c.base58xmr},H="Invalid encoding type. Available types: utf8, hex, base16, base32, base64, base64url, base58, base58xmr";c.bytesToString=(a,b)=>{if("string"!=typeof a||!G.hasOwnProperty(a))throw TypeError(H);if(!d(b))throw TypeError("bytesToString() expects Uint8Array");return G[a].encode(b)},c.str=c.bytesToString,c.stringToBytes=(a,b)=>{if(!G.hasOwnProperty(a))throw TypeError(H);if("string"!=typeof b)throw TypeError("stringToBytes() expects string");return G[a].decode(b)},c.bytes=c.stringToBytes},353361,(a,b,c)=>{a.e,function(a){"use strict";var b;function c(a){return d.test(a)}let d=/^-?[0-9]+$/;function e(a){return f.test(a)}let f=/^-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?$/;function g(a,b){if(c(a))return Number.isSafeInteger(Number.parseInt(a,10));let d=String(Number.parseFloat(a));if(a===d)return!0;let e=l(a),f=l(d);return!!(e===f||!0===b?.approx&&!c(a)&&f.length>=14&&e.startsWith(f.substring(0,14)))||!1}let h=((b={}).underflow="underflow",b.overflow="overflow",b.truncate_integer="truncate_integer",b.truncate_float="truncate_float",b);function i(a){if(g(a,{approx:!1}))return;if(c(a))return h.truncate_integer;let b=Number.parseFloat(a);return Number.isFinite(b)?0===b?h.underflow:h.truncate_float:h.overflow}function j(a){let b=a.match(/^(-?)(\d+\.?\d*)([eE]([+-]?\d+))?$/);if(!b)throw SyntaxError(`Invalid number: ${a}`);let c=b[1],d=b[2],e=void 0!==b[4]?Number.parseInt(b[4],10):0,f=d.indexOf(".");e+=-1!==f?f-1:d.length-1;let g=d.replace(".","").replace(/^0*/,a=>(e-=a.length,"")).replace(/0*$/,"");return g.length>0?{sign:c,digits:g,exponent:e}:{sign:c,digits:"0",exponent:e+1}}function k(a,b){if(a===b)return 0;let c=j(a),d=j(b),e="-"===c.sign?-1:1;return c.sign!==d.sign?"0"===c.digits&&"0"===d.digits?0:e:c.exponent!==d.exponent?c.exponent>d.exponent?e:c.exponent<d.exponent?-e:0:c.digits>d.digits?e:c.digits<d.digits?-e:0}function l(a){let{start:b,end:c}=m(a),d=a.substring(b,c),e=d.indexOf(".");return -1===e?d:d.substring(0,e)+d.substring(e+1)}function m(a){let b=0;for("-"===a[0]&&b++;"0"===a[b]||"."===a[b];)b++;let c=a.lastIndexOf("e");for(-1===c&&(c=a.lastIndexOf("E")),-1===c&&(c=a.length);("0"===a[c-1]||"."===a[c-1])&&c>b;)c--;return{start:b,end:c}}class n{isLosslessNumber=!0;constructor(a){if(!e(a))throw Error(`Invalid number (value: "${a}")`);this.value=a}valueOf(){let a=i(this.value);if(void 0===a||a===h.truncate_float)return Number.parseFloat(this.value);if(c(this.value))return BigInt(this.value);throw Error(`Cannot safely convert to number: the value '${this.value}' would ${a} and become ${Number.parseFloat(this.value)}`)}toString(){return this.value}}function o(a){return a&&"object"==typeof a&&a.isLosslessNumber||!1}function p(a){return new n(a)}function q(a){return a>=u&&a<=v||a>=w&&a<=y||a>=x&&a<=z}function r(a){return a>=u&&a<=v}function s(a){return"object"==typeof a&&null!==a}let t={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},u=48,v=57,w=65,x=97,y=70,z=102,A=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z$/;a.LosslessNumber=n,a.UnsafeNumberReason=h,a.compareLosslessNumber=function(a,b){return k(a.value,b.value)},a.compareNumber=k,a.config=function(a){throw Error("config is deprecated, support for circularRefs is removed from the library. If you encounter circular references in your data structures, please rethink your datastructures: better prevent circular references in the first place.")},a.getUnsafeNumberReason=i,a.isInteger=c,a.isLosslessNumber=o,a.isNumber=e,a.isSafeNumber=g,a.parse=function(a,b,c){let d="function"==typeof c?{parseNumber:c}:c,e=d?.parseNumber??p,f=d?.onDuplicateKey??function(a){let{key:b,position:c}=a;throw SyntaxError(`Duplicate key '${b}' encountered at position ${c}`)},g=0,h=function b(){j();let c=k()??function(){var b;let c=g;if(45===a.charCodeAt(g)&&(g++,m(c)),a.charCodeAt(g)===u)g++;else if((b=a.charCodeAt(g))>=49&&b<=v)for(g++;r(a.charCodeAt(g));)g++;if(46===a.charCodeAt(g))for(g++,m(c);r(a.charCodeAt(g));)g++;if(101===a.charCodeAt(g)||69===a.charCodeAt(g))for(g++,45!==a.charCodeAt(g)&&43!==a.charCodeAt(g)||g++,m(c);r(a.charCodeAt(g));)g++;if(g>c)return e(a.slice(c,g))}()??function(){if(123===a.charCodeAt(g)){g++,j();let c={},d=!0;for(;g<a.length&&125!==a.charCodeAt(g);){d?d=!1:(l(),j());let e=g,h=k();if(void 0===h)return void function(){throw SyntaxError(`Quoted object key expected ${w()}`)}();j(),function(){if(58!==a.charCodeAt(g))throw SyntaxError(`Colon ':' expected after property name ${w()}`);g++}();let i=b();if(void 0===i)return void function(){throw SyntaxError(`Object value expected after ':' ${n()}`)}();if(Object.prototype.hasOwnProperty.call(c,h)&&!function a(b,c){return b===c||(Array.isArray(b)&&Array.isArray(c)?b.length===c.length&&b.every((b,d)=>a(b,c[d])):!!(s(b)&&s(c))&&[...new Set([...Object.keys(b),...Object.keys(c)])].every(d=>a(b[d],c[d])))}(i,c[h])){let a=f({key:h,position:e+1,oldValue:c[h],newValue:i});void 0!==a&&(c[h]=a)}else c[h]=i}return 125!==a.charCodeAt(g)&&function(){throw SyntaxError(`Quoted object key or end of object '}' expected ${w()}`)}(),g++,c}}()??function(){if(91===a.charCodeAt(g)){g++,j();let c=[],d=!0;for(;g<a.length&&93!==a.charCodeAt(g);){d?d=!1:l();let a=b();(function(a){if(void 0===a)throw SyntaxError(`Array item expected ${w()}`)})(a),c.push(a)}return 93!==a.charCodeAt(g)&&function(){throw SyntaxError(`Array item or end of array ']' expected ${w()}`)}(),g++,c}}()??i("true",!0)??i("false",!1)??i("null",null);return j(),c}();return function(a){if(void 0===a)throw SyntaxError(`JSON value expected ${w()}`)}(h),function(){if(g<a.length)throw SyntaxError(`Expected end of input ${w()}`)}(),b?function a(b,c,d,e){return Array.isArray(d)?e.call(b,c,function(b,c){for(let d=0;d<b.length;d++)b[d]=a(b,String(d),b[d],c);return b}(d,e)):d&&"object"==typeof d&&!o(d)?e.call(b,c,function(b,c){for(let d of Object.keys(b)){let e=a(b,d,b[d],c);void 0!==e?b[d]=e:delete b[d]}return b}(d,e)):e.call(b,c,d)}({"":h},"",h,b):h;function i(b,c){if(a.slice(g,g+b.length)===b)return g+=b.length,c}function j(){for(var b;32===(b=a.charCodeAt(g))||10===b||9===b||13===b;)g++}function k(){var b;if(34===a.charCodeAt(g)){g++;let c="";for(;g<a.length&&34!==a.charCodeAt(g);){if(92===a.charCodeAt(g)){let b=a[g+1],d=t[b];void 0!==d?(c+=d,g++):"u"===b?q(a.charCodeAt(g+2))&&q(a.charCodeAt(g+3))&&q(a.charCodeAt(g+4))&&q(a.charCodeAt(g+5))?(c+=String.fromCharCode(Number.parseInt(a.slice(g+2,g+6),16)),g+=5):function(b){let c=a.slice(b,b+6);throw SyntaxError(`Invalid unicode character '${c}' ${n()}`)}(g):function(b){let c=a.slice(b,b+2);throw SyntaxError(`Invalid escape character '${c}' ${n()}`)}(g)}else(b=a.charCodeAt(g))>=32&&b<=1114111?c+=a[g]:function(a){throw SyntaxError(`Invalid character '${a}' ${n()}`)}(a[g]);g++}return function(){if(34!==a.charCodeAt(g))throw SyntaxError(`End of string '"' expected ${w()}`)}(),g++,c}}function l(){if(44!==a.charCodeAt(g))throw SyntaxError(`Comma ',' expected after value ${w()}`);g++}function m(b){if(!r(a.charCodeAt(g))){let c=a.slice(b,g);throw SyntaxError(`Invalid number '${c}', expecting a digit ${w()}`)}}function n(){return`at position ${g}`}function w(){return`${g<a.length?`but got '${a[g]}'`:"but reached end of input"} ${n()}`}},a.parseLosslessNumber=p,a.parseNumberAndBigInt=function(a){return c(a)?BigInt(a):Number.parseFloat(a)},a.reviveDate=function(a,b){return"string"==typeof b&&A.test(b)?new Date(b):b},a.splitNumber=j,a.stringify=function a(b,c,d,f){let g="number"==typeof d?" ".repeat(d):"string"==typeof d&&""!==d?d:void 0;return function b(h,i){if(Array.isArray(f)){let a=f.find(a=>a.test(h));if(a){let b=a.stringify(h);if("string"!=typeof b||!e(b))throw Error(`Invalid JSON number: output of a number stringifier must be a string containing a JSON number (output: ${b})`);return b}}return"boolean"==typeof h||"number"==typeof h||"string"==typeof h||null===h||h instanceof Date||h instanceof Boolean||h instanceof Number||h instanceof String?JSON.stringify(h):h?.isLosslessNumber||"bigint"==typeof h?h.toString():Array.isArray(h)?function(a,d){if(0===a.length)return"[]";let e=g?d+g:void 0,f=g?"[\n":"[";for(let d=0;d<a.length;d++){let h="function"==typeof c?c.call(a,String(d),a[d]):a[d];g&&(f+=e),f+=void 0!==h&&"function"!=typeof h?b(h,e):"null",d<a.length-1&&(f+=g?",\n":",")}return f+(g?`
${d}]`:"]")}(h,i):h&&"object"==typeof h?function(e,f){if("function"==typeof e.toJSON)return a(e.toJSON(),c,d,void 0);let h=Array.isArray(c)?c.map(String):Object.keys(e);if(0===h.length)return"{}";let i=g?f+g:void 0,j=!0,k=g?"{\n":"{";for(let a of h){var l,m;let d="function"==typeof c?c.call(e,a,e[a]):e[a];if(l=0,void 0!==(m=d)&&"function"!=typeof m&&"symbol"!=typeof m){j?j=!1:k+=g?",\n":",";let c=JSON.stringify(a);k+=g?`${i+c}: `:`${c}:`,k+=b(d,i)}}return k+(g?`
${f}}`:"}")}(h,i):void 0}("function"==typeof c?c.call({"":b},"",b):b,"")},a.toLosslessNumber=function(a){if(function(a){let{start:b,end:c}=m(a),d=a.indexOf(".");return -1===d||d<b||d>c?c-b:c-b-1}(String(a))>15)throw Error(`Invalid number: contains more than 15 digits and is most likely truncated and unsafe by itself (value: ${a})`);if(Number.isNaN(a))throw Error("Invalid number: NaN");if(!Number.isFinite(a))throw Error(`Invalid number: ${a}`);return new n(String(a))},a.toSafeNumberOrThrow=function(a,b){let c=Number.parseFloat(a),d=i(a);if(!0===b?.approx?d&&d!==h.truncate_float:d){let b=d?.replace(/_\w+$/,"");throw Error(`Cannot safely convert to number: the value '${a}' would ${b} and become ${c}`)}return c}}(c)},246367,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.notImplemented=c.bitMask=void 0,c.isBytes=g,c.abytes=h,c.abool=function(a,b){if("boolean"!=typeof b)throw Error(a+" boolean expected, got "+b)},c.bytesToHex=j,c.numberToHexUnpadded=k,c.hexToNumber=l,c.hexToBytes=o,c.bytesToNumberBE=function(a){return l(j(a))},c.bytesToNumberLE=function(a){return h(a),l(j(Uint8Array.from(a).reverse()))},c.numberToBytesBE=p,c.numberToBytesLE=function(a,b){return p(a,b).reverse()},c.numberToVarBytesBE=function(a){return o(k(a))},c.ensureBytes=function(a,b,c){let d;if("string"==typeof b)try{d=o(b)}catch(b){throw Error(a+" must be hex string or Uint8Array, cause: "+b)}else if(g(b))d=Uint8Array.from(b);else throw Error(a+" must be hex string or Uint8Array");let e=d.length;if("number"==typeof c&&e!==c)throw Error(a+" of length "+c+" expected, got "+e);return d},c.concatBytes=q,c.equalBytes=function(a,b){if(a.length!==b.length)return!1;let c=0;for(let d=0;d<a.length;d++)c|=a[d]^b[d];return 0===c},c.utf8ToBytes=function(a){if("string"!=typeof a)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(a))},c.inRange=s,c.aInRange=function(a,b,c,d){if(!s(b,c,d))throw Error("expected valid "+a+": "+c+" <= n < "+d+", got "+b)},c.bitLen=function(a){let b;for(b=0;a>d;a>>=e,b+=1);return b},c.bitGet=function(a,b){return a>>BigInt(b)&e},c.bitSet=function(a,b,c){return a|(c?e:d)<<BigInt(b)},c.createHmacDrbg=function(a,b,c){if("number"!=typeof a||a<2)throw Error("hashLen must be a number");if("number"!=typeof b||b<2)throw Error("qByteLen must be a number");if("function"!=typeof c)throw Error("hmacFn must be a function");let d=t(a),e=t(a),f=0,g=()=>{d.fill(1),e.fill(0),f=0},h=(...a)=>c(e,d,...a),i=(a=t())=>{e=h(u([0]),a),d=h(),0!==a.length&&(e=h(u([1]),a),d=h())},j=()=>{if(f++>=1e3)throw Error("drbg: tried 1000 values");let a=0,c=[];for(;a<b;){let b=(d=h()).slice();c.push(b),a+=d.length}return q(...c)};return(a,b)=>{let c;for(g(),i(a);!(c=b(j()));)i();return g(),c}},c.validateObject=function(a,b,c={}){let d=(b,c,d)=>{let e=v[c];if("function"!=typeof e)throw Error("invalid validator function");let f=a[b];if((!d||void 0!==f)&&!e(f,a))throw Error("param "+String(b)+" is invalid. Expected "+c+", got "+f)};for(let[a,c]of Object.entries(b))d(a,c,!1);for(let[a,b]of Object.entries(c))d(a,b,!0);return a},c.memoized=function(a){let b=new WeakMap;return(c,...d)=>{let e=b.get(c);if(void 0!==e)return e;let f=a(c,...d);return b.set(c,f),f}};let d=BigInt(0),e=BigInt(1),f=BigInt(2);function g(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function h(a){if(!g(a))throw Error("Uint8Array expected")}let i=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));function j(a){h(a);let b="";for(let c=0;c<a.length;c++)b+=i[a[c]];return b}function k(a){let b=a.toString(16);return 1&b.length?"0"+b:b}function l(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);return""===a?d:BigInt("0x"+a)}let m={_0:48,_9:57,A:65,F:70,a:97,f:102};function n(a){return a>=m._0&&a<=m._9?a-m._0:a>=m.A&&a<=m.F?a-(m.A-10):a>=m.a&&a<=m.f?a-(m.a-10):void 0}function o(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);let b=a.length,c=b/2;if(b%2)throw Error("hex string expected, got unpadded hex of length "+b);let d=new Uint8Array(c);for(let b=0,e=0;b<c;b++,e+=2){let c=n(a.charCodeAt(e)),f=n(a.charCodeAt(e+1));if(void 0===c||void 0===f)throw Error('hex string expected, got non-hex character "'+(a[e]+a[e+1])+'" at index '+e);d[b]=16*c+f}return d}function p(a,b){return o(a.toString(16).padStart(2*b,"0"))}function q(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];h(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c}let r=a=>"bigint"==typeof a&&d<=a;function s(a,b,c){return r(a)&&r(b)&&r(c)&&b<=a&&a<c}c.bitMask=a=>(f<<BigInt(a-1))-e;let t=a=>new Uint8Array(a),u=a=>Uint8Array.from(a),v={bigint:a=>"bigint"==typeof a,function:a=>"function"==typeof a,boolean:a=>"boolean"==typeof a,string:a=>"string"==typeof a,stringOrUint8Array:a=>"string"==typeof a||g(a),isSafeInteger:a=>Number.isSafeInteger(a),array:a=>Array.isArray(a),field:(a,b)=>b.Fp.isValid(a),hash:a=>"function"==typeof a&&Number.isSafeInteger(a.outputLen)};c.notImplemented=()=>{throw Error("not implemented")}},153295,(a,b,c)=>{"use strict";function d(a){if(!Number.isSafeInteger(a)||a<0)throw Error("positive integer expected, got "+a)}function e(a,...b){if(!(a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}function f(a){if("function"!=typeof a||"function"!=typeof a.create)throw Error("Hash should be wrapped by utils.wrapConstructor");d(a.outputLen),d(a.blockLen)}function g(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")}function h(a,b){e(a);let c=b.outputLen;if(a.length<c)throw Error("digestInto() expects output buffer of length at least "+c)}Object.defineProperty(c,"__esModule",{value:!0}),c.anumber=d,c.number=d,c.abytes=e,c.bytes=e,c.ahash=f,c.aexists=g,c.aoutput=h,c.default={number:d,bytes:e,hash:f,exists:g,output:h}},135106,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.crypto=void 0;let d=a.r(666680);c.crypto=d&&"object"==typeof d&&"webcrypto"in d?d.webcrypto:d&&"object"==typeof d&&"randomBytes"in d?d:void 0},428454,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Hash=c.nextTick=c.byteSwapIfBE=c.byteSwap=c.isLE=c.rotl=c.rotr=c.createView=c.u32=c.u8=void 0,c.isBytes=function(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name},c.byteSwap32=function(a){for(let b=0;b<a.length;b++)a[b]=(0,c.byteSwap)(a[b])},c.bytesToHex=function(a){(0,e.abytes)(a);let b="";for(let c=0;c<a.length;c++)b+=f[a[c]];return b},c.hexToBytes=function(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);let b=a.length,c=b/2;if(b%2)throw Error("padded hex string expected, got unpadded hex of length "+b);let d=new Uint8Array(c);for(let b=0,e=0;b<c;b++,e+=2){let c=h(a.charCodeAt(e)),f=h(a.charCodeAt(e+1));if(void 0===c||void 0===f)throw Error('hex string expected, got non-hex character "'+(a[e]+a[e+1])+'" at index '+e);d[b]=16*c+f}return d},c.asyncLoop=i,c.utf8ToBytes=j,c.toBytes=k,c.concatBytes=function(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];(0,e.abytes)(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c},c.checkOpts=function(a,b){if(void 0!==b&&"[object Object]"!==({}).toString.call(b))throw Error("Options should be object or undefined");return Object.assign(a,b)},c.wrapConstructor=function(a){let b=b=>a().update(k(b)).digest(),c=a();return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=()=>a(),b},c.wrapConstructorWithOpts=function(a){let b=(b,c)=>a(c).update(k(b)).digest(),c=a({});return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=b=>a(b),b},c.wrapXOFConstructorWithOpts=function(a){let b=(b,c)=>a(c).update(k(b)).digest(),c=a({});return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=b=>a(b),b},c.randomBytes=function(a=32){if(d.crypto&&"function"==typeof d.crypto.getRandomValues)return d.crypto.getRandomValues(new Uint8Array(a));if(d.crypto&&"function"==typeof d.crypto.randomBytes)return d.crypto.randomBytes(a);throw Error("crypto.getRandomValues must be defined")};let d=a.r(135106),e=a.r(153295);c.u8=a=>new Uint8Array(a.buffer,a.byteOffset,a.byteLength),c.u32=a=>new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4)),c.createView=a=>new DataView(a.buffer,a.byteOffset,a.byteLength),c.rotr=(a,b)=>a<<32-b|a>>>b,c.rotl=(a,b)=>a<<b|a>>>32-b>>>0,c.isLE=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0],c.byteSwap=a=>a<<24&0xff000000|a<<8&0xff0000|a>>>8&65280|a>>>24&255,c.byteSwapIfBE=c.isLE?a=>a:a=>(0,c.byteSwap)(a);let f=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0")),g={_0:48,_9:57,A:65,F:70,a:97,f:102};function h(a){return a>=g._0&&a<=g._9?a-g._0:a>=g.A&&a<=g.F?a-(g.A-10):a>=g.a&&a<=g.f?a-(g.a-10):void 0}async function i(a,b,d){let e=Date.now();for(let f=0;f<a;f++){d(f);let a=Date.now()-e;a>=0&&a<b||(await (0,c.nextTick)(),e+=a)}}function j(a){if("string"!=typeof a)throw Error("utf8ToBytes expected string, got "+typeof a);return new Uint8Array(new TextEncoder().encode(a))}function k(a){return"string"==typeof a&&(a=j(a)),(0,e.abytes)(a),a}c.nextTick=async()=>{},c.Hash=class{clone(){return this._cloneInto()}}},650961,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.HashMD=c.Maj=c.Chi=void 0;let d=a.r(153295),e=a.r(428454);c.Chi=(a,b,c)=>a&b^~a&c,c.Maj=(a,b,c)=>a&b^a&c^b&c;class f extends e.Hash{constructor(a,b,c,d){super(),this.blockLen=a,this.outputLen=b,this.padOffset=c,this.isLE=d,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(a),this.view=(0,e.createView)(this.buffer)}update(a){(0,d.aexists)(this);let{view:b,buffer:c,blockLen:f}=this,g=(a=(0,e.toBytes)(a)).length;for(let d=0;d<g;){let h=Math.min(f-this.pos,g-d);if(h===f){let b=(0,e.createView)(a);for(;f<=g-d;d+=f)this.process(b,d);continue}c.set(a.subarray(d,d+h),this.pos),this.pos+=h,d+=h,this.pos===f&&(this.process(b,0),this.pos=0)}return this.length+=a.length,this.roundClean(),this}digestInto(a){(0,d.aexists)(this),(0,d.aoutput)(a,this),this.finished=!0;let{buffer:b,view:c,blockLen:f,isLE:g}=this,{pos:h}=this;b[h++]=128,this.buffer.subarray(h).fill(0),this.padOffset>f-h&&(this.process(c,0),h=0);for(let a=h;a<f;a++)b[a]=0;!function(a,b,c,d){if("function"==typeof a.setBigUint64)return a.setBigUint64(b,c,d);let e=BigInt(32),f=BigInt(0xffffffff),g=Number(c>>e&f),h=Number(c&f),i=4*!!d,j=4*!d;a.setUint32(b+i,g,d),a.setUint32(b+j,h,d)}(c,f-8,BigInt(8*this.length),g),this.process(c,0);let i=(0,e.createView)(a),j=this.outputLen;if(j%4)throw Error("_sha2: outputLen should be aligned to 32bit");let k=j/4,l=this.get();if(k>l.length)throw Error("_sha2: outputLen bigger than state");for(let a=0;a<k;a++)i.setUint32(4*a,l[a],g)}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}_cloneInto(a){a||(a=new this.constructor),a.set(...this.get());let{blockLen:b,buffer:c,length:d,finished:e,destroyed:f,pos:g}=this;return a.length=d,a.pos=g,a.finished=e,a.destroyed=f,d%b&&a.buffer.set(c),a}}c.HashMD=f},765288,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.sha224=c.sha256=c.SHA256=void 0;let d=a.r(650961),e=a.r(428454),f=new Uint32Array([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),g=new Uint32Array([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),h=new Uint32Array(64);class i extends d.HashMD{constructor(){super(64,32,8,!1),this.A=0|g[0],this.B=0|g[1],this.C=0|g[2],this.D=0|g[3],this.E=0|g[4],this.F=0|g[5],this.G=0|g[6],this.H=0|g[7]}get(){let{A:a,B:b,C:c,D:d,E:e,F:f,G:g,H:h}=this;return[a,b,c,d,e,f,g,h]}set(a,b,c,d,e,f,g,h){this.A=0|a,this.B=0|b,this.C=0|c,this.D=0|d,this.E=0|e,this.F=0|f,this.G=0|g,this.H=0|h}process(a,b){for(let c=0;c<16;c++,b+=4)h[c]=a.getUint32(b,!1);for(let a=16;a<64;a++){let b=h[a-15],c=h[a-2],d=(0,e.rotr)(b,7)^(0,e.rotr)(b,18)^b>>>3,f=(0,e.rotr)(c,17)^(0,e.rotr)(c,19)^c>>>10;h[a]=f+h[a-7]+d+h[a-16]|0}let{A:c,B:g,C:i,D:j,E:k,F:l,G:m,H:n}=this;for(let a=0;a<64;a++){let b=n+((0,e.rotr)(k,6)^(0,e.rotr)(k,11)^(0,e.rotr)(k,25))+(0,d.Chi)(k,l,m)+f[a]+h[a]|0,o=((0,e.rotr)(c,2)^(0,e.rotr)(c,13)^(0,e.rotr)(c,22))+(0,d.Maj)(c,g,i)|0;n=m,m=l,l=k,k=j+b|0,j=i,i=g,g=c,c=b+o|0}c=c+this.A|0,g=g+this.B|0,i=i+this.C|0,j=j+this.D|0,k=k+this.E|0,l=l+this.F|0,m=m+this.G|0,n=n+this.H|0,this.set(c,g,i,j,k,l,m,n)}roundClean(){h.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}c.SHA256=i;class j extends i{constructor(){super(),this.A=-0x3efa6128,this.B=0x367cd507,this.C=0x3070dd17,this.D=-0x8f1a6c7,this.E=-4191439,this.F=0x68581511,this.G=0x64f98fa7,this.H=-0x4105b05c,this.outputLen=28}}c.sha256=(0,e.wrapConstructor)(()=>new i),c.sha224=(0,e.wrapConstructor)(()=>new j)},6803,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.add5L=c.add5H=c.add4H=c.add4L=c.add3H=c.add3L=c.rotlBL=c.rotlBH=c.rotlSL=c.rotlSH=c.rotr32L=c.rotr32H=c.rotrBL=c.rotrBH=c.rotrSL=c.rotrSH=c.shrSL=c.shrSH=c.toBig=void 0,c.fromBig=f,c.split=g,c.add=u;let d=BigInt(0x100000000-1),e=BigInt(32);function f(a,b=!1){return b?{h:Number(a&d),l:Number(a>>e&d)}:{h:0|Number(a>>e&d),l:0|Number(a&d)}}function g(a,b=!1){let c=new Uint32Array(a.length),d=new Uint32Array(a.length);for(let e=0;e<a.length;e++){let{h:g,l:h}=f(a[e],b);[c[e],d[e]]=[g,h]}return[c,d]}let h=(a,b)=>BigInt(a>>>0)<<e|BigInt(b>>>0);c.toBig=h;let i=(a,b,c)=>a>>>c;c.shrSH=i;let j=(a,b,c)=>a<<32-c|b>>>c;c.shrSL=j;let k=(a,b,c)=>a>>>c|b<<32-c;c.rotrSH=k;let l=(a,b,c)=>a<<32-c|b>>>c;c.rotrSL=l;let m=(a,b,c)=>a<<64-c|b>>>c-32;c.rotrBH=m;let n=(a,b,c)=>a>>>c-32|b<<64-c;c.rotrBL=n;let o=(a,b)=>b;c.rotr32H=o;let p=(a,b)=>a;c.rotr32L=p;let q=(a,b,c)=>a<<c|b>>>32-c;c.rotlSH=q;let r=(a,b,c)=>b<<c|a>>>32-c;c.rotlSL=r;let s=(a,b,c)=>b<<c-32|a>>>64-c;c.rotlBH=s;let t=(a,b,c)=>a<<c-32|b>>>64-c;function u(a,b,c,d){let e=(b>>>0)+(d>>>0);return{h:a+c+(e/0x100000000|0)|0,l:0|e}}c.rotlBL=t;let v=(a,b,c)=>(a>>>0)+(b>>>0)+(c>>>0);c.add3L=v;let w=(a,b,c,d)=>b+c+d+(a/0x100000000|0)|0;c.add3H=w;let x=(a,b,c,d)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0);c.add4L=x;let y=(a,b,c,d,e)=>b+c+d+e+(a/0x100000000|0)|0;c.add4H=y;let z=(a,b,c,d,e)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0)+(e>>>0);c.add5L=z;let A=(a,b,c,d,e,f)=>b+c+d+e+f+(a/0x100000000|0)|0;c.add5H=A,c.default={fromBig:f,split:g,toBig:h,shrSH:i,shrSL:j,rotrSH:k,rotrSL:l,rotrBH:m,rotrBL:n,rotr32H:o,rotr32L:p,rotlSH:q,rotlSL:r,rotlBH:s,rotlBL:t,add:u,add3L:v,add3H:w,add4L:x,add4H:y,add5H:A,add5L:z}},190999,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.shake256=c.shake128=c.keccak_512=c.keccak_384=c.keccak_256=c.keccak_224=c.sha3_512=c.sha3_384=c.sha3_256=c.sha3_224=c.Keccak=void 0,c.keccakP=t;let d=a.r(153295),e=a.r(6803),f=a.r(428454),g=[],h=[],i=[],j=BigInt(0),k=BigInt(1),l=BigInt(2),m=BigInt(7),n=BigInt(256),o=BigInt(113);for(let a=0,b=k,c=1,d=0;a<24;a++){[c,d]=[d,(2*c+3*d)%5],g.push(2*(5*d+c)),h.push((a+1)*(a+2)/2%64);let e=j;for(let a=0;a<7;a++)(b=(b<<k^(b>>m)*o)%n)&l&&(e^=k<<(k<<BigInt(a))-k);i.push(e)}let[p,q]=(0,e.split)(i,!0),r=(a,b,c)=>c>32?(0,e.rotlBH)(a,b,c):(0,e.rotlSH)(a,b,c),s=(a,b,c)=>c>32?(0,e.rotlBL)(a,b,c):(0,e.rotlSL)(a,b,c);function t(a,b=24){let c=new Uint32Array(10);for(let d=24-b;d<24;d++){for(let b=0;b<10;b++)c[b]=a[b]^a[b+10]^a[b+20]^a[b+30]^a[b+40];for(let b=0;b<10;b+=2){let d=(b+8)%10,e=(b+2)%10,f=c[e],g=c[e+1],h=r(f,g,1)^c[d],i=s(f,g,1)^c[d+1];for(let c=0;c<50;c+=10)a[b+c]^=h,a[b+c+1]^=i}let b=a[2],e=a[3];for(let c=0;c<24;c++){let d=h[c],f=r(b,e,d),i=s(b,e,d),j=g[c];b=a[j],e=a[j+1],a[j]=f,a[j+1]=i}for(let b=0;b<50;b+=10){for(let d=0;d<10;d++)c[d]=a[b+d];for(let d=0;d<10;d++)a[b+d]^=~c[(d+2)%10]&c[(d+4)%10]}a[0]^=p[d],a[1]^=q[d]}c.fill(0)}class u extends f.Hash{constructor(a,b,c,e=!1,g=24){if(super(),this.blockLen=a,this.suffix=b,this.outputLen=c,this.enableXOF=e,this.rounds=g,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,d.anumber)(c),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,f.u32)(this.state)}keccak(){f.isLE||(0,f.byteSwap32)(this.state32),t(this.state32,this.rounds),f.isLE||(0,f.byteSwap32)(this.state32),this.posOut=0,this.pos=0}update(a){(0,d.aexists)(this);let{blockLen:b,state:c}=this,e=(a=(0,f.toBytes)(a)).length;for(let d=0;d<e;){let f=Math.min(b-this.pos,e-d);for(let b=0;b<f;b++)c[this.pos++]^=a[d++];this.pos===b&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:a,suffix:b,pos:c,blockLen:d}=this;a[c]^=b,(128&b)!=0&&c===d-1&&this.keccak(),a[d-1]^=128,this.keccak()}writeInto(a){(0,d.aexists)(this,!1),(0,d.abytes)(a),this.finish();let b=this.state,{blockLen:c}=this;for(let d=0,e=a.length;d<e;){this.posOut>=c&&this.keccak();let f=Math.min(c-this.posOut,e-d);a.set(b.subarray(this.posOut,this.posOut+f),d),this.posOut+=f,d+=f}return a}xofInto(a){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(a)}xof(a){return(0,d.anumber)(a),this.xofInto(new Uint8Array(a))}digestInto(a){if((0,d.aoutput)(a,this),this.finished)throw Error("digest() was already called");return this.writeInto(a),this.destroy(),a}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(a){let{blockLen:b,suffix:c,outputLen:d,rounds:e,enableXOF:f}=this;return a||(a=new u(b,c,d,f,e)),a.state32.set(this.state32),a.pos=this.pos,a.posOut=this.posOut,a.finished=this.finished,a.rounds=e,a.suffix=c,a.outputLen=d,a.enableXOF=f,a.destroyed=this.destroyed,a}}c.Keccak=u;let v=(a,b,c)=>(0,f.wrapConstructor)(()=>new u(b,a,c));c.sha3_224=v(6,144,28),c.sha3_256=v(6,136,32),c.sha3_384=v(6,104,48),c.sha3_512=v(6,72,64),c.keccak_224=v(1,144,28),c.keccak_256=v(1,136,32),c.keccak_384=v(1,104,48),c.keccak_512=v(1,72,64);let w=(a,b,c)=>(0,f.wrapXOFConstructorWithOpts)((d={})=>new u(b,a,void 0===d.dkLen?c:d.dkLen,!0));c.shake128=w(31,168,16),c.shake256=w(31,136,32)},123319,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.isNegativeLE=void 0,c.mod=l,c.pow=m,c.pow2=function(a,b,c){let d=a;for(;b-- >e;)d*=d,d%=c;return d},c.invert=n,c.tonelliShanks=o,c.FpSqrt=p,c.validateField=function(a){let b=q.reduce((a,b)=>(a[b]="function",a),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});return(0,d.validateObject)(a,b)},c.FpPow=r,c.FpInvertBatch=s,c.FpDiv=function(a,b,c){return a.mul(b,"bigint"==typeof c?n(c,a.ORDER):a.inv(c))},c.FpLegendre=t,c.FpIsSquare=function(a){let b=t(a.ORDER);return c=>{let d=b(a,c);return a.eql(d,a.ZERO)||a.eql(d,a.ONE)}},c.nLength=u,c.Field=function(a,b,c=!1,g={}){let h;if(a<=e)throw Error("invalid field: expected ORDER > 0, got "+a);let{nBitLength:i,nByteLength:j}=u(a,b);if(j>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let k=Object.freeze({ORDER:a,BITS:i,BYTES:j,MASK:(0,d.bitMask)(i),ZERO:e,ONE:f,create:b=>l(b,a),isValid:b=>{if("bigint"!=typeof b)throw Error("invalid field element: expected bigint, got "+typeof b);return e<=b&&b<a},is0:a=>a===e,isOdd:a=>(a&f)===f,neg:b=>l(-b,a),eql:(a,b)=>a===b,sqr:b=>l(b*b,a),add:(b,c)=>l(b+c,a),sub:(b,c)=>l(b-c,a),mul:(b,c)=>l(b*c,a),pow:(a,b)=>r(k,a,b),div:(b,c)=>l(b*n(c,a),a),sqrN:a=>a*a,addN:(a,b)=>a+b,subN:(a,b)=>a-b,mulN:(a,b)=>a*b,inv:b=>n(b,a),sqrt:g.sqrt||(b=>(h||(h=p(a)),h(k,b))),invertBatch:a=>s(k,a),cmov:(a,b,c)=>c?b:a,toBytes:a=>c?(0,d.numberToBytesLE)(a,j):(0,d.numberToBytesBE)(a,j),fromBytes:a=>{if(a.length!==j)throw Error("Field.fromBytes: expected "+j+" bytes, got "+a.length);return c?(0,d.bytesToNumberLE)(a):(0,d.bytesToNumberBE)(a)}});return Object.freeze(k)},c.FpSqrtOdd=function(a,b){if(!a.isOdd)throw Error("Field doesn't have isOdd");let c=a.sqrt(b);return a.isOdd(c)?c:a.neg(c)},c.FpSqrtEven=function(a,b){if(!a.isOdd)throw Error("Field doesn't have isOdd");let c=a.sqrt(b);return a.isOdd(c)?a.neg(c):c},c.hashToPrivateScalar=function(a,b,c=!1){let e=(a=(0,d.ensureBytes)("privateHash",a)).length,g=u(b).nByteLength+8;if(g<24||e<g||e>1024)throw Error("hashToPrivateScalar: expected "+g+"-1024 bytes of input, got "+e);return l(c?(0,d.bytesToNumberLE)(a):(0,d.bytesToNumberBE)(a),b-f)+f},c.getFieldBytesLength=v,c.getMinHashLength=w,c.mapHashToField=function(a,b,c=!1){let e=a.length,g=v(b),h=w(b);if(e<16||e<h||e>1024)throw Error("expected "+h+"-1024 bytes of input, got "+e);let i=l(c?(0,d.bytesToNumberBE)(a):(0,d.bytesToNumberLE)(a),b-f)+f;return c?(0,d.numberToBytesLE)(i,g):(0,d.numberToBytesBE)(i,g)};let d=a.r(246367),e=BigInt(0),f=BigInt(1),g=BigInt(2),h=BigInt(3),i=BigInt(4),j=BigInt(5),k=BigInt(8);function l(a,b){let c=a%b;return c>=e?c:b+c}function m(a,b,c){if(b<e)throw Error("invalid exponent, negatives unsupported");if(c<=e)throw Error("invalid modulus");if(c===f)return e;let d=f;for(;b>e;)b&f&&(d=d*a%c),a=a*a%c,b>>=f;return d}function n(a,b){if(a===e)throw Error("invert: expected non-zero number");if(b<=e)throw Error("invert: expected positive modulus, got "+b);let c=l(a,b),d=b,g=e,h=f,i=f,j=e;for(;c!==e;){let a=d/c,b=d%c,e=g-i*a,f=h-j*a;d=c,c=b,g=i,h=j,i=e,j=f}if(d!==f)throw Error("invert: does not exist");return l(g,b)}function o(a){let b,c,d,h=(a-f)/g;for(b=a-f,c=0;b%g===e;b/=g,c++);for(d=g;d<a&&m(d,h,a)!==a-f;d++)if(d>1e3)throw Error("Cannot find square root: likely non-prime P");if(1===c){let b=(a+f)/i;return function(a,c){let d=a.pow(c,b);if(!a.eql(a.sqr(d),c))throw Error("Cannot find square root");return d}}let j=(b+f)/g;return function(a,e){if(a.pow(e,h)===a.neg(a.ONE))throw Error("Cannot find square root");let g=c,i=a.pow(a.mul(a.ONE,d),b),k=a.pow(e,j),l=a.pow(e,b);for(;!a.eql(l,a.ONE);){if(a.eql(l,a.ZERO))return a.ZERO;let b=1;for(let c=a.sqr(l);b<g&&!a.eql(c,a.ONE);b++)c=a.sqr(c);let c=a.pow(i,f<<BigInt(g-b-1));i=a.sqr(c),k=a.mul(k,c),l=a.mul(l,i),g=b}return k}}function p(a){if(a%i===h){let b=(a+f)/i;return function(a,c){let d=a.pow(c,b);if(!a.eql(a.sqr(d),c))throw Error("Cannot find square root");return d}}if(a%k===j){let b=(a-j)/k;return function(a,c){let d=a.mul(c,g),e=a.pow(d,b),f=a.mul(c,e),h=a.mul(a.mul(f,g),e),i=a.mul(f,a.sub(h,a.ONE));if(!a.eql(a.sqr(i),c))throw Error("Cannot find square root");return i}}return o(a)}c.isNegativeLE=(a,b)=>(l(a,b)&f)===f;let q=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function r(a,b,c){if(c<e)throw Error("invalid exponent, negatives unsupported");if(c===e)return a.ONE;if(c===f)return b;let d=a.ONE,g=b;for(;c>e;)c&f&&(d=a.mul(d,g)),g=a.sqr(g),c>>=f;return d}function s(a,b){let c=Array(b.length),d=b.reduce((b,d,e)=>a.is0(d)?b:(c[e]=b,a.mul(b,d)),a.ONE),e=a.inv(d);return b.reduceRight((b,d,e)=>a.is0(d)?b:(c[e]=a.mul(b,c[e]),a.mul(b,d)),e),c}function t(a){let b=(a-f)/g;return(a,c)=>a.pow(c,b)}function u(a,b){let c=void 0!==b?b:a.toString(2).length,d=Math.ceil(c/8);return{nBitLength:c,nByteLength:d}}function v(a){if("bigint"!=typeof a)throw Error("field order must be bigint");return Math.ceil(a.toString(2).length/8)}function w(a){let b=v(a);return b+Math.ceil(b/2)}},259418,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.validateOpts=e,c.splitConstants=function(a,b){if("number"!=typeof b)throw Error("poseidonSplitConstants: invalid t");if(!Array.isArray(a)||a.length%b)throw Error("poseidonSplitConstants: invalid rc");let c=[],d=[];for(let e=0;e<a.length;e++)d.push(a[e]),d.length===b&&(c.push(d),d=[]);return c},c.poseidon=function(a){let b=e(a),{Fp:c,mds:d,roundConstants:f,rounds:g,roundsPartial:h,sboxFn:i,t:j}=b,k=b.roundsFull/2,l=b.reversePartialPowIdx?j-1:0,m=(a,b,e)=>(a=a.map((a,b)=>c.add(a,f[e][b])),b?a=a.map(a=>i(a)):a[l]=i(a[l]),a=d.map(b=>b.reduce((b,d,e)=>c.add(b,c.mulN(d,a[e])),c.ZERO))),n=function(a){if(!Array.isArray(a)||a.length!==j)throw Error("invalid values, expected array of bigints with length "+j);a=a.map(a=>{if("bigint"!=typeof a)throw Error("invalid bigint="+a);return c.create(a)});let b=0;for(let c=0;c<k;c++)a=m(a,!0,b++);for(let c=0;c<h;c++)a=m(a,!1,b++);for(let c=0;c<k;c++)a=m(a,!0,b++);if(b!==g)throw Error("invalid number of rounds");return a};return n.roundConstants=f,n};let d=a.r(123319);function e(a){let{Fp:b,mds:c,reversePartialPowIdx:e,roundConstants:f}=a,{roundsFull:g,roundsPartial:h,sboxPower:i,t:j}=a;for(let c of((0,d.validateField)(b),["t","roundsFull","roundsPartial"]))if("number"!=typeof a[c]||!Number.isSafeInteger(a[c]))throw Error("invalid number "+c);if(!Array.isArray(c)||c.length!==j)throw Error("Poseidon: invalid MDS matrix");let k=c.map(a=>{if(!Array.isArray(a)||a.length!==j)throw Error("invalid MDS matrix row: "+a);return a.map(a=>{if("bigint"!=typeof a)throw Error("invalid MDS matrix bigint: "+a);return b.create(a)})});if(void 0!==e&&"boolean"!=typeof e)throw Error("invalid param reversePartialPowIdx="+e);if(1&g)throw Error("roundsFull is not even"+g);let l=g+h;if(!Array.isArray(f)||f.length!==l)throw Error("Poseidon: invalid round constants");let m=f.map(a=>{if(!Array.isArray(a)||a.length!==j)throw Error("invalid round constants");return a.map(a=>{if("bigint"!=typeof a||!b.isValid(a))throw Error("invalid round constant");return b.create(a)})});if(!i||![3,5,7].includes(i))throw Error("invalid sboxPower");let n=BigInt(i),o=a=>(0,d.FpPow)(b,a,n);return 3===i?o=a=>b.mul(b.sqrN(a),a):5===i&&(o=a=>b.mul(b.sqrN(b.sqrN(a)),a)),Object.freeze({...a,rounds:l,sboxFn:o,roundConstants:m,mds:k})}},391989,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.wNAF=function(a,b){return{constTimeNegate:h,hasPrecomputes:a=>1!==o(a),unsafeLadder(b,c,d=a.ZERO){let e=b;for(;c>f;)c&g&&(d=d.add(e)),e=e.double(),c>>=g;return d},precomputeWindow(a,c){let{windows:d,windowSize:e}=j(c,b),f=[],g=a,h=g;for(let a=0;a<d;a++){h=g,f.push(h);for(let a=1;a<e;a++)h=h.add(g),f.push(h);g=h.double()}return f},wNAF(c,d,e){let{windows:f,windowSize:i}=j(c,b),k=a.ZERO,l=a.BASE,m=BigInt(2**c-1),n=2**c,o=BigInt(c);for(let a=0;a<f;a++){let b=a*i,c=Number(e&m);e>>=o,c>i&&(c-=n,e+=g);let f=b+Math.abs(c)-1,j=a%2!=0,p=c<0;0===c?l=l.add(h(j,d[b])):k=k.add(h(p,d[f]))}return{p:k,f:l}},wNAFUnsafe(c,d,e,h=a.ZERO){let{windows:i,windowSize:k}=j(c,b),l=BigInt(2**c-1),m=2**c,n=BigInt(c);for(let a=0;a<i;a++){let b=a*k;if(e===f)break;let c=Number(e&l);if(e>>=n,c>k&&(c-=m,e+=g),0===c)continue;let i=d[b+Math.abs(c)-1];c<0&&(i=i.negate()),h=h.add(i)}return h},getPrecomputes(a,b,c){let d=m.get(b);return d||(d=this.precomputeWindow(b,a),1!==a&&m.set(b,c(d))),d},wNAFCached(a,b,c){let d=o(a);return this.wNAF(d,this.getPrecomputes(d,a,c),b)},wNAFCachedUnsafe(a,b,c,d){let e=o(a);return 1===e?this.unsafeLadder(a,b,d):this.wNAFUnsafe(e,this.getPrecomputes(e,a,c),b,d)},setWindowSize(a,c){i(c,b),n.set(a,c),m.delete(a)}}},c.pippenger=function(a,b,c,d){if(k(c,a),l(d,b),c.length!==d.length)throw Error("arrays of points and scalars must have equal length");let f=a.ZERO,g=(0,e.bitLen)(BigInt(c.length)),h=g>12?g-3:g>4?g-2:g?2:1,i=(1<<h)-1,j=Array(i+1).fill(f),m=Math.floor((b.BITS-1)/h)*h,n=f;for(let a=m;a>=0;a-=h){j.fill(f);for(let b=0;b<d.length;b++){let e=Number(d[b]>>BigInt(a)&BigInt(i));j[e]=j[e].add(c[b])}let b=f;for(let a=j.length-1,c=f;a>0;a--)c=c.add(j[a]),b=b.add(c);if(n=n.add(b),0!==a)for(let a=0;a<h;a++)n=n.double()}return n},c.precomputeMSMUnsafe=function(a,b,c,d){i(d,b.BITS),k(c,a);let e=a.ZERO,f=2**d-1,g=Math.ceil(b.BITS/d),h=BigInt((1<<d)-1),j=c.map(a=>{let b=[];for(let c=0,d=a;c<f;c++)b.push(d),d=d.add(a);return b});return a=>{if(l(a,b),a.length>c.length)throw Error("array of scalars must be smaller than array of points");let f=e;for(let b=0;b<g;b++){if(f!==e)for(let a=0;a<d;a++)f=f.double();let c=BigInt(g*d-(b+1)*d);for(let b=0;b<a.length;b++){let d=Number(a[b]>>c&h);d&&(f=f.add(j[b][d-1]))}}return f}},c.validateBasic=function(a){return(0,d.validateField)(a.Fp),(0,e.validateObject)(a,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,d.nLength)(a.n,a.nBitLength),...a,...{p:a.Fp.ORDER}})};let d=a.r(123319),e=a.r(246367),f=BigInt(0),g=BigInt(1);function h(a,b){let c=b.negate();return a?c:b}function i(a,b){if(!Number.isSafeInteger(a)||a<=0||a>b)throw Error("invalid window size, expected [1.."+b+"], got W="+a)}function j(a,b){return i(a,b),{windows:Math.ceil(b/a)+1,windowSize:2**(a-1)}}function k(a,b){if(!Array.isArray(a))throw Error("array expected");a.forEach((a,c)=>{if(!(a instanceof b))throw Error("invalid point at index "+c)})}function l(a,b){if(!Array.isArray(a))throw Error("array of scalars expected");a.forEach((a,c)=>{if(!b.isValid(a))throw Error("invalid scalar at index "+c)})}let m=new WeakMap,n=new WeakMap;function o(a){return n.get(a)||1}},642585,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DER=void 0,c.weierstrassPoints=p,c.weierstrass=function(a){let b=function(a){let b=(0,d.validateBasic)(a);return f.validateObject(b,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...b})}(a),{Fp:i,n:j}=b,m=i.BYTES+1,n=2*i.BYTES+1;function o(a){return e.mod(a,j)}function q(a){return e.invert(a,j)}let{ProjectivePoint:r,normPrivateKeyToScalar:s,weierstrassEquation:t,isWithinCurveOrder:u}=p({...b,toBytes(a,b,c){let d=b.toAffine(),e=i.toBytes(d.x),h=f.concatBytes;return((0,g.abool)("isCompressed",c),c)?h(Uint8Array.from([b.hasEvenY()?2:3]),e):h(Uint8Array.from([4]),e,i.toBytes(d.y))},fromBytes(a){let b=a.length,c=a[0],d=a.subarray(1);if(b===m&&(2===c||3===c)){let a,b=f.bytesToNumberBE(d);if(!f.inRange(b,l,i.ORDER))throw Error("Point is not on curve");let e=t(b);try{a=i.sqrt(e)}catch(a){throw Error("Point is not on curve"+(a instanceof Error?": "+a.message:""))}return(1&c)==1!=((a&l)===l)&&(a=i.neg(a)),{x:b,y:a}}if(b===n&&4===c)return{x:i.fromBytes(d.subarray(0,i.BYTES)),y:i.fromBytes(d.subarray(i.BYTES,2*i.BYTES))};throw Error("invalid Point, expected length of "+m+", or uncompressed "+n+", got "+b)}}),v=a=>f.bytesToHex(f.numberToBytesBE(a,b.nByteLength)),w=(a,b,c)=>f.bytesToNumberBE(a.slice(b,c));class x{constructor(a,b,c){this.r=a,this.s=b,this.recovery=c,this.assertValidity()}static fromCompact(a){let c=b.nByteLength;return new x(w(a=(0,g.ensureBytes)("compactSignature",a,2*c),0,c),w(a,c,2*c))}static fromDER(a){let{r:b,s:d}=c.DER.toSig((0,g.ensureBytes)("DER",a));return new x(b,d)}assertValidity(){f.aInRange("r",this.r,l,j),f.aInRange("s",this.s,l,j)}addRecoveryBit(a){return new x(this.r,this.s,a)}recoverPublicKey(a){let{r:c,s:d,recovery:e}=this,f=A((0,g.ensureBytes)("msgHash",a));if(null==e||![0,1,2,3].includes(e))throw Error("recovery id invalid");let h=2===e||3===e?c+b.n:c;if(h>=i.ORDER)throw Error("recovery id 2 or 3 invalid");let j=(1&e)==0?"02":"03",k=r.fromHex(j+v(h)),l=q(h),m=o(-f*l),n=o(d*l),p=r.BASE.multiplyAndAddUnsafe(k,m,n);if(!p)throw Error("point at infinify");return p.assertValidity(),p}hasHighS(){return this.s>j>>l}normalizeS(){return this.hasHighS()?new x(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return f.hexToBytes(this.toDERHex())}toDERHex(){return c.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return f.hexToBytes(this.toCompactHex())}toCompactHex(){return v(this.r)+v(this.s)}}function y(a){let b=f.isBytes(a),c="string"==typeof a,d=(b||c)&&a.length;return b?d===m||d===n:c?d===2*m||d===2*n:a instanceof r}let z=b.bits2int||function(a){if(a.length>8192)throw Error("input is too large");let c=f.bytesToNumberBE(a),d=8*a.length-b.nBitLength;return d>0?c>>BigInt(d):c},A=b.bits2int_modN||function(a){return o(z(a))},B=f.bitMask(b.nBitLength);function C(a){return f.aInRange("num < 2^"+b.nBitLength,a,k,B),f.numberToBytesBE(a,b.nByteLength)}let D={lowS:b.lowS,prehash:!1},E={lowS:b.lowS,prehash:!1};return r.BASE._setWindowSize(8),{CURVE:b,getPublicKey:function(a,b=!0){return r.fromPrivateKey(a).toRawBytes(b)},getSharedSecret:function(a,b,c=!0){if(y(a))throw Error("first arg must be private key");if(!y(b))throw Error("second arg must be public key");return r.fromHex(b).multiply(s(a)).toRawBytes(c)},sign:function(a,c,d=D){let{seed:e,k2sig:m}=function(a,c,d=D){if(["recovered","canonical"].some(a=>a in d))throw Error("sign() legacy options not supported");let{hash:e,randomBytes:m}=b,{lowS:n,prehash:p,extraEntropy:t}=d;null==n&&(n=!0),a=(0,g.ensureBytes)("msgHash",a),h(d),p&&(a=(0,g.ensureBytes)("prehashed msgHash",e(a)));let v=A(a),w=s(c),y=[C(w),C(v)];if(null!=t&&!1!==t){let a=!0===t?m(i.BYTES):t;y.push((0,g.ensureBytes)("extraEntropy",a))}return{seed:f.concatBytes(...y),k2sig:function(a){var b;let c=z(a);if(!u(c))return;let d=q(c),e=r.BASE.multiply(c).toAffine(),f=o(e.x);if(f===k)return;let g=o(d*o(v+f*w));if(g===k)return;let h=2*(e.x!==f)|Number(e.y&l),i=g;return n&&g>j>>l&&(i=(b=g)>j>>l?o(-b):b,h^=1),new x(f,i,h)}}}(a,c,d);return f.createHmacDrbg(b.hash.outputLen,b.nByteLength,b.hmac)(e,m)},verify:function(a,d,e,i=E){let j,k;d=(0,g.ensureBytes)("msgHash",d),e=(0,g.ensureBytes)("publicKey",e);let{lowS:l,prehash:m,format:n}=i;if(h(i),"strict"in i)throw Error("options.strict was renamed to lowS");if(void 0!==n&&"compact"!==n&&"der"!==n)throw Error("format must be compact or der");let p="string"==typeof a||f.isBytes(a),s=!p&&!n&&"object"==typeof a&&null!==a&&"bigint"==typeof a.r&&"bigint"==typeof a.s;if(!p&&!s)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(s&&(k=new x(a.r,a.s)),p){try{"compact"!==n&&(k=x.fromDER(a))}catch(a){if(!(a instanceof c.DER.Err))throw a}k||"der"===n||(k=x.fromCompact(a))}j=r.fromHex(e)}catch(a){return!1}if(!k||l&&k.hasHighS())return!1;m&&(d=b.hash(d));let{r:t,s:u}=k,v=A(d),w=q(u),y=o(v*w),z=o(t*w),B=r.BASE.multiplyAndAddUnsafe(j,y,z)?.toAffine();return!!B&&o(B.x)===t},ProjectivePoint:r,Signature:x,utils:{isValidPrivateKey(a){try{return s(a),!0}catch(a){return!1}},normPrivateKeyToScalar:s,randomPrivateKey:()=>{let a=e.getMinHashLength(b.n);return e.mapHashToField(b.randomBytes(a),b.n)},precompute:(a=8,b=r.BASE)=>(b._setWindowSize(a),b.multiply(BigInt(3)),b)}}},c.SWUFpSqrtRatio=q,c.mapToCurveSimpleSWU=function(a,b){if(e.validateField(a),!a.isValid(b.A)||!a.isValid(b.B)||!a.isValid(b.Z))throw Error("mapToCurveSimpleSWU: invalid opts");let c=q(a,b.Z);if(!a.isOdd)throw Error("Fp.isOdd is not implemented!");return d=>{let e,f,g,h,i,j,k,l;e=a.sqr(d),e=a.mul(e,b.Z),f=a.sqr(e),f=a.add(f,e),g=a.add(f,a.ONE),g=a.mul(g,b.B),h=a.cmov(b.Z,a.neg(f),!a.eql(f,a.ZERO)),h=a.mul(h,b.A),f=a.sqr(g),j=a.sqr(h),i=a.mul(j,b.A),f=a.add(f,i),f=a.mul(f,g),j=a.mul(j,h),i=a.mul(j,b.B),f=a.add(f,i),k=a.mul(e,g);let{isValid:m,value:n}=c(f,j);l=a.mul(e,d),l=a.mul(l,n),k=a.cmov(k,g,m),l=a.cmov(l,n,m);let o=a.isOdd(d)===a.isOdd(l);return l=a.cmov(a.neg(l),l,o),{x:k=a.div(k,h),y:l}}};let d=a.r(391989),e=a.r(123319),f=a.r(246367),g=a.r(246367);function h(a){void 0!==a.lowS&&(0,g.abool)("lowS",a.lowS),void 0!==a.prehash&&(0,g.abool)("prehash",a.prehash)}let{bytesToNumberBE:i,hexToBytes:j}=f;c.DER={Err:class extends Error{constructor(a=""){super(a)}},_tlv:{encode:(a,b)=>{let{Err:d}=c.DER;if(a<0||a>256)throw new d("tlv.encode: wrong tag");if(1&b.length)throw new d("tlv.encode: unpadded data");let e=b.length/2,g=f.numberToHexUnpadded(e);if(g.length/2&128)throw new d("tlv.encode: long form length too big");let h=e>127?f.numberToHexUnpadded(g.length/2|128):"";return f.numberToHexUnpadded(a)+h+g+b},decode(a,b){let{Err:d}=c.DER,e=0;if(a<0||a>256)throw new d("tlv.encode: wrong tag");if(b.length<2||b[e++]!==a)throw new d("tlv.decode: wrong tlv");let f=b[e++],g=0;if(128&f){let a=127&f;if(!a)throw new d("tlv.decode(long): indefinite length not supported");if(a>4)throw new d("tlv.decode(long): byte length is too big");let c=b.subarray(e,e+a);if(c.length!==a)throw new d("tlv.decode: length bytes not complete");if(0===c[0])throw new d("tlv.decode(long): zero leftmost byte");for(let a of c)g=g<<8|a;if(e+=a,g<128)throw new d("tlv.decode(long): not minimal encoding")}else g=f;let h=b.subarray(e,e+g);if(h.length!==g)throw new d("tlv.decode: wrong value length");return{v:h,l:b.subarray(e+g)}}},_int:{encode(a){let{Err:b}=c.DER;if(a<k)throw new b("integer: negative integers are not allowed");let d=f.numberToHexUnpadded(a);if(8&Number.parseInt(d[0],16)&&(d="00"+d),1&d.length)throw new b("unexpected DER parsing assertion: unpadded hex");return d},decode(a){let{Err:b}=c.DER;if(128&a[0])throw new b("invalid signature integer: negative");if(0===a[0]&&!(128&a[1]))throw new b("invalid signature integer: unnecessary leading zero");return i(a)}},toSig(a){let{Err:b,_int:d,_tlv:e}=c.DER,g="string"==typeof a?j(a):a;f.abytes(g);let{v:h,l:i}=e.decode(48,g);if(i.length)throw new b("invalid signature: left bytes after parsing");let{v:k,l:l}=e.decode(2,h),{v:m,l:n}=e.decode(2,l);if(n.length)throw new b("invalid signature: left bytes after parsing");return{r:d.decode(k),s:d.decode(m)}},hexFromSig(a){let{_tlv:b,_int:d}=c.DER,e=b.encode(2,d.encode(a.r)),f=b.encode(2,d.encode(a.s));return b.encode(48,e+f)}};let k=BigInt(0),l=BigInt(1),m=BigInt(2),n=BigInt(3),o=BigInt(4);function p(a){let b=function(a){let b=(0,d.validateBasic)(a);f.validateObject(b,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:c,Fp:e,a:g}=b;if(c){if(!e.eql(g,e.ZERO))throw Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof c||"bigint"!=typeof c.beta||"function"!=typeof c.splitScalar)throw Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...b})}(a),{Fp:c}=b,h=e.Field(b.n,b.nBitLength),i=b.toBytes||((a,b,d)=>{let e=b.toAffine();return f.concatBytes(Uint8Array.from([4]),c.toBytes(e.x),c.toBytes(e.y))}),j=b.fromBytes||(a=>{let b=a.subarray(1);return{x:c.fromBytes(b.subarray(0,c.BYTES)),y:c.fromBytes(b.subarray(c.BYTES,2*c.BYTES))}});function m(a){let{a:d,b:e}=b,f=c.sqr(a),g=c.mul(f,a);return c.add(c.add(g,c.mul(a,d)),e)}if(!c.eql(c.sqr(b.Gy),m(b.Gx)))throw Error("bad generator point: equation left != right");function o(a){let c,{allowedPrivateKeyLengths:d,nByteLength:h,wrapPrivateKey:i,n:j}=b;if(d&&"bigint"!=typeof a){if(f.isBytes(a)&&(a=f.bytesToHex(a)),"string"!=typeof a||!d.includes(a.length))throw Error("invalid private key");a=a.padStart(2*h,"0")}try{c="bigint"==typeof a?a:f.bytesToNumberBE((0,g.ensureBytes)("private key",a,h))}catch(b){throw Error("invalid private key, expected hex or "+h+" bytes, got "+typeof a)}return i&&(c=e.mod(c,j)),f.aInRange("private key",c,l,j),c}function p(a){if(!(a instanceof s))throw Error("ProjectivePoint expected")}let q=(0,g.memoized)((a,b)=>{let{px:d,py:e,pz:f}=a;if(c.eql(f,c.ONE))return{x:d,y:e};let g=a.is0();null==b&&(b=g?c.ONE:c.inv(f));let h=c.mul(d,b),i=c.mul(e,b),j=c.mul(f,b);if(g)return{x:c.ZERO,y:c.ZERO};if(!c.eql(j,c.ONE))throw Error("invZ was invalid");return{x:h,y:i}}),r=(0,g.memoized)(a=>{if(a.is0()){if(b.allowInfinityPoint&&!c.is0(a.py))return;throw Error("bad point: ZERO")}let{x:d,y:e}=a.toAffine();if(!c.isValid(d)||!c.isValid(e))throw Error("bad point: x or y not FE");let f=c.sqr(e),g=m(d);if(!c.eql(f,g))throw Error("bad point: equation left != right");if(!a.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class s{constructor(a,b,d){if(this.px=a,this.py=b,this.pz=d,null==a||!c.isValid(a))throw Error("x required");if(null==b||!c.isValid(b))throw Error("y required");if(null==d||!c.isValid(d))throw Error("z required");Object.freeze(this)}static fromAffine(a){let{x:b,y:d}=a||{};if(!a||!c.isValid(b)||!c.isValid(d))throw Error("invalid affine point");if(a instanceof s)throw Error("projective point not allowed");let e=a=>c.eql(a,c.ZERO);return e(b)&&e(d)?s.ZERO:new s(b,d,c.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(a){let b=c.invertBatch(a.map(a=>a.pz));return a.map((a,c)=>a.toAffine(b[c])).map(s.fromAffine)}static fromHex(a){let b=s.fromAffine(j((0,g.ensureBytes)("pointHex",a)));return b.assertValidity(),b}static fromPrivateKey(a){return s.BASE.multiply(o(a))}static msm(a,b){return(0,d.pippenger)(s,h,a,b)}_setWindowSize(a){u.setWindowSize(this,a)}assertValidity(){r(this)}hasEvenY(){let{y:a}=this.toAffine();if(c.isOdd)return!c.isOdd(a);throw Error("Field doesn't support isOdd")}equals(a){p(a);let{px:b,py:d,pz:e}=this,{px:f,py:g,pz:h}=a,i=c.eql(c.mul(b,h),c.mul(f,e)),j=c.eql(c.mul(d,h),c.mul(g,e));return i&&j}negate(){return new s(this.px,c.neg(this.py),this.pz)}double(){let{a,b:d}=b,e=c.mul(d,n),{px:f,py:g,pz:h}=this,i=c.ZERO,j=c.ZERO,k=c.ZERO,l=c.mul(f,f),m=c.mul(g,g),o=c.mul(h,h),p=c.mul(f,g);return p=c.add(p,p),k=c.mul(f,h),k=c.add(k,k),i=c.mul(a,k),j=c.mul(e,o),j=c.add(i,j),i=c.sub(m,j),j=c.add(m,j),j=c.mul(i,j),i=c.mul(p,i),k=c.mul(e,k),o=c.mul(a,o),p=c.sub(l,o),p=c.mul(a,p),p=c.add(p,k),k=c.add(l,l),l=c.add(k,l),l=c.add(l,o),l=c.mul(l,p),j=c.add(j,l),o=c.mul(g,h),o=c.add(o,o),l=c.mul(o,p),i=c.sub(i,l),k=c.mul(o,m),k=c.add(k,k),new s(i,j,k=c.add(k,k))}add(a){p(a);let{px:d,py:e,pz:f}=this,{px:g,py:h,pz:i}=a,j=c.ZERO,k=c.ZERO,l=c.ZERO,m=b.a,o=c.mul(b.b,n),q=c.mul(d,g),r=c.mul(e,h),t=c.mul(f,i),u=c.add(d,e),v=c.add(g,h);u=c.mul(u,v),v=c.add(q,r),u=c.sub(u,v),v=c.add(d,f);let w=c.add(g,i);return v=c.mul(v,w),w=c.add(q,t),v=c.sub(v,w),w=c.add(e,f),j=c.add(h,i),w=c.mul(w,j),j=c.add(r,t),w=c.sub(w,j),l=c.mul(m,v),j=c.mul(o,t),l=c.add(j,l),j=c.sub(r,l),l=c.add(r,l),k=c.mul(j,l),r=c.add(q,q),r=c.add(r,q),t=c.mul(m,t),v=c.mul(o,v),r=c.add(r,t),t=c.sub(q,t),t=c.mul(m,t),v=c.add(v,t),q=c.mul(r,v),k=c.add(k,q),q=c.mul(w,v),j=c.mul(u,j),j=c.sub(j,q),q=c.mul(u,r),l=c.mul(w,l),new s(j,k,l=c.add(l,q))}subtract(a){return this.add(a.negate())}is0(){return this.equals(s.ZERO)}wNAF(a){return u.wNAFCached(this,a,s.normalizeZ)}multiplyUnsafe(a){let{endo:d,n:e}=b;f.aInRange("scalar",a,k,e);let g=s.ZERO;if(a===k)return g;if(this.is0()||a===l)return this;if(!d||u.hasPrecomputes(this))return u.wNAFCachedUnsafe(this,a,s.normalizeZ);let{k1neg:h,k1:i,k2neg:j,k2:m}=d.splitScalar(a),n=g,o=g,p=this;for(;i>k||m>k;)i&l&&(n=n.add(p)),m&l&&(o=o.add(p)),p=p.double(),i>>=l,m>>=l;return h&&(n=n.negate()),j&&(o=o.negate()),o=new s(c.mul(o.px,d.beta),o.py,o.pz),n.add(o)}multiply(a){let d,e,{endo:g,n:h}=b;if(f.aInRange("scalar",a,l,h),g){let{k1neg:b,k1:f,k2neg:h,k2:i}=g.splitScalar(a),{p:j,f:k}=this.wNAF(f),{p:l,f:m}=this.wNAF(i);j=u.constTimeNegate(b,j),l=u.constTimeNegate(h,l),l=new s(c.mul(l.px,g.beta),l.py,l.pz),d=j.add(l),e=k.add(m)}else{let{p:b,f:c}=this.wNAF(a);d=b,e=c}return s.normalizeZ([d,e])[0]}multiplyAndAddUnsafe(a,b,c){let d=s.BASE,e=(a,b)=>b!==k&&b!==l&&a.equals(d)?a.multiply(b):a.multiplyUnsafe(b),f=e(this,b).add(e(a,c));return f.is0()?void 0:f}toAffine(a){return q(this,a)}isTorsionFree(){let{h:a,isTorsionFree:c}=b;if(a===l)return!0;if(c)return c(s,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:a,clearCofactor:c}=b;return a===l?this:c?c(s,this):this.multiplyUnsafe(b.h)}toRawBytes(a=!0){return(0,g.abool)("isCompressed",a),this.assertValidity(),i(s,this,a)}toHex(a=!0){return(0,g.abool)("isCompressed",a),f.bytesToHex(this.toRawBytes(a))}}s.BASE=new s(b.Gx,b.Gy,c.ONE),s.ZERO=new s(c.ZERO,c.ONE,c.ZERO);let t=b.nBitLength,u=(0,d.wNAF)(s,b.endo?Math.ceil(t/2):t);return{CURVE:b,ProjectivePoint:s,normPrivateKeyToScalar:o,weierstrassEquation:m,isWithinCurveOrder:function(a){return f.inRange(a,l,b.n)}}}function q(a,b){let c=a.ORDER,d=k;for(let a=c-l;a%m===k;a/=m)d+=l;let e=d,f=m<<e-l-l,g=f*m,h=(c-l)/g,i=(h-l)/m,j=g-l,p=a.pow(b,h),q=a.pow(b,(h+l)/m),r=(b,c)=>{let d=p,g=a.pow(c,j),h=a.sqr(g);h=a.mul(h,c);let k=a.mul(b,h);k=a.pow(k,i),k=a.mul(k,g),g=a.mul(k,c),h=a.mul(k,b);let n=a.mul(h,g);k=a.pow(n,f);let o=a.eql(k,a.ONE);g=a.mul(h,q),k=a.mul(n,d),h=a.cmov(g,h,o),n=a.cmov(k,n,o);for(let b=e;b>l;b--){let c=b-m;c=m<<c-l;let e=a.pow(n,c),f=a.eql(e,a.ONE);g=a.mul(h,d),d=a.mul(d,d),e=a.mul(n,d),h=a.cmov(g,h,f),n=a.cmov(e,n,f)}return{isValid:o,value:h}};if(a.ORDER%o===n){let c=(a.ORDER-n)/o,d=a.sqrt(a.neg(b));r=(b,e)=>{let f=a.sqr(e),g=a.mul(b,e);f=a.mul(f,g);let h=a.pow(f,c);h=a.mul(h,g);let i=a.mul(h,d),j=a.mul(a.sqr(h),e),k=a.eql(j,b),l=a.cmov(i,h,k);return{isValid:k,value:l}}}return r}},955870,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.hmac=c.HMAC=void 0;let d=a.r(153295),e=a.r(428454);class f extends e.Hash{constructor(a,b){super(),this.finished=!1,this.destroyed=!1,(0,d.ahash)(a);let c=(0,e.toBytes)(b);if(this.iHash=a.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let f=this.blockLen,g=new Uint8Array(f);g.set(c.length>f?a.create().update(c).digest():c);for(let a=0;a<g.length;a++)g[a]^=54;this.iHash.update(g),this.oHash=a.create();for(let a=0;a<g.length;a++)g[a]^=106;this.oHash.update(g),g.fill(0)}update(a){return(0,d.aexists)(this),this.iHash.update(a),this}digestInto(a){(0,d.aexists)(this),(0,d.abytes)(a,this.outputLen),this.finished=!0,this.iHash.digestInto(a),this.oHash.update(a),this.oHash.digestInto(a),this.destroy()}digest(){let a=new Uint8Array(this.oHash.outputLen);return this.digestInto(a),a}_cloneInto(a){a||(a=Object.create(Object.getPrototypeOf(this),{}));let{oHash:b,iHash:c,finished:d,destroyed:e,blockLen:f,outputLen:g}=this;return a.finished=d,a.destroyed=e,a.blockLen=f,a.outputLen=g,a.oHash=b._cloneInto(a.oHash),a.iHash=c._cloneInto(a.iHash),a}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}c.HMAC=f,c.hmac=(a,b,c)=>new f(a,b).update(c).digest(),c.hmac.create=(a,b)=>new f(a,b)},887782,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.getHash=g,c.createCurve=function(a,b){let c=b=>(0,f.weierstrass)({...a,...g(b)});return Object.freeze({...c(b),create:c})};let d=a.r(955870),e=a.r(428454),f=a.r(642585);function g(a){return{hash:a,hmac:(b,...c)=>(0,d.hmac)(a,b,(0,e.concatBytes)(...c)),randomBytes:e.randomBytes}}},677716,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.poseidonSmall=c.Fp251=c.keccak=c.computeHashOnElements=c.utils=c.Signature=c.ProjectivePoint=c.CURVE=c._starkCurve=c.MAX_VALUE=void 0,c.normalizePrivateKey=q,c.getPublicKey=r,c.getSharedSecret=function(a,b){return o.getSharedSecret(q(a),b)},c.sign=function(a,b,c){let d=o.sign(t(a),q(b),c);return s(d),d},c.verify=function(a,b,c){if(!(a instanceof w)){let b=p(a);try{a=w.fromDER(b)}catch(c){if(!(c instanceof i.DER.Err))throw c;a=w.fromCompact(b)}}return s(a),o.verify(a,t(b),p(c))},c.grindKey=A,c.getStarkKey=function(a){return y(r(a,!0))},c.ethSigToPrivate=function(a){if(130!==(a=z(a)).length)throw Error("Wrong ethereum signature");return A(a.substring(0,64))},c.getAccountPath=function(a,b,c,d){let e=C(K(a)),f=C(K(b)),g=j.hexToNumber(z(c));return`m/2645'/${e}'/${f}'/${C(g)}'/${C(g>>31n)}'/${d}`},c.pedersen=I,c._poseidonMDS=M,c.poseidonBasic=O,c.poseidonCreate=function(a,b=0){let c=a.rate+a.capacity;if(!Number.isSafeInteger(b))throw Error(`Wrong mdsAttempt=${b}`);return O(a,M(a.Fp,"HadesMDS",c,b))},c.poseidonHash=P,c.poseidonHashFunc=function(a,b,d=c.poseidonSmall){return j.numberToVarBytesBE(P(j.bytesToNumberBE(a),j.bytesToNumberBE(b),d))},c.poseidonHashSingle=function(a,b=c.poseidonSmall){return b([a,0n,1n])[0]},c.poseidonHashMany=function(a,b=c.poseidonSmall){let{m:d,rate:e}=b;if(!Array.isArray(a))throw Error("bigint array expected in values");let f=Array.from(a);for(f.push(1n);f.length%e!=0;)f.push(0n);let g=Array(d).fill(0n);for(let a=0;a<f.length;a+=e){for(let b=0;b<e;b++){let c=f[a+b];if(void 0===c)throw Error("invalid index");if(void 0===g[b])throw Error("state[j] is undefined");g[b]=g[b]+c}g=b(g)}return g[0]};let d=a.r(190999),e=a.r(765288),f=a.r(428454),g=a.r(123319),h=a.r(259418),i=a.r(642585),j=a.r(246367),k=a.r(887782),l=BigInt("3618502788666131213697322783095070105526743751716087489154079457884512865583");function m(a){for(;0===a[0];)a=a.subarray(1);let b=8*a.length-252,c=j.bytesToNumberBE(a);return b>0?c>>BigInt(b):c}function n(a){return"string"==typeof a&&1&(a=z(a)).length&&(a="0"+a),j.hexToBytes(a)}c.MAX_VALUE=BigInt("0x800000000000000000000000000000000000000000000000000000000000000");let o=(0,i.weierstrass)({a:BigInt(1),b:BigInt("3141592653589793238462643383279502884197169399375105820974944592307816406665"),Fp:(0,g.Field)(BigInt("0x800000000000011000000000000000000000000000000000000000000000001")),n:l,nBitLength:252,Gx:BigInt("874739451078007766457464989774322083649278607533249481151382481072868806602"),Gy:BigInt("152666792071518830868575557812948353041420400780739481342941381225525861407"),h:BigInt(1),lowS:!1,...(0,k.getHash)(e.sha256),bits2int:m,bits2int_modN:a=>{let b=j.bytesToNumberBE(a).toString(16);return 63===b.length&&(a=n(b+"0")),(0,g.mod)(m(a),l)}});function p(a){return j.ensureBytes("","string"==typeof a?n(a):a)}function q(a){return j.bytesToHex(p(a)).padStart(64,"0")}function r(a,b=!1){return o.getPublicKey(q(a),b)}function s(a){let{r:b,s:d}=a;if(b<0n||b>=c.MAX_VALUE)throw Error(`Signature.r should be [1, ${c.MAX_VALUE})`);let e=(0,g.invert)(d,l);if(e<0n||e>=c.MAX_VALUE)throw Error(`inv(Signature.s) should be [1, ${c.MAX_VALUE})`)}function t(a){let b=p(a);if(j.bytesToNumberBE(b)>=c.MAX_VALUE)throw Error(`msgHash should be [0, ${c.MAX_VALUE})`);return b}c._starkCurve=o;let{CURVE:u,ProjectivePoint:v,Signature:w,utils:x}=o;function y(a){let b=j.bytesToHex(a.subarray(1)).replace(/^0+/gm,"");return`0x${b}`}function z(a){return a.replace(/^0x/i,"")}function A(a){let b=p(a),c=2n**256n,d=c-(0,g.mod)(c,l);for(let a=0;;a++){let c=K(j.concatBytes(b,j.numberToVarBytesBE(BigInt(a))));if(c<d)return(0,g.mod)(c,l).toString(16);if(1e5===a)throw Error("grindKey is broken: tried 100k vals")}}c.CURVE=u,c.ProjectivePoint=v,c.Signature=w,c.utils=x;let B=2n**31n-1n,C=a=>Number(a&B),D=[new v(0x49ee3eba8c1600700ee1b87eb599f16716b0b1022947733551fde4050ca6804n,0x3ca0cfe4b3bc6ddf346d49d06ea0ed34e621062c0e056c1d0405d266e10268an,1n),new v(0x234287dcbaffe7f969c748655fca9e58fa8120b6d56eb0c1080d17957ebe47bn,0x3b056f100f96fb21e889527d41f4e39940135dd7a6c94cc6ed0268ee89e5615n,1n),new v(0x4fa56f376c83db33f9dab2656558f3399099ec1de5e3018b7a6932dba8aa378n,0x3fa0984c931c9e38113e0c0e47e4401562761f92a7a23b45168f4e80ff5b54dn,1n),new v(0x4ba4cc166be8dec764910f75b45f74b40c690c74709e90f3aa372f0bd2d6997n,0x40301cf5c1751f4b971e46c4ede85fcac5c59a5ce5ae7c48151f27b24b219cn,1n),new v(0x54302dcb0e6cc1c6e44cca8f61a63bb2ca65048d53fb325d36ff12c49a58202n,0x1b77b3e37d13504b348046268d8ae25ce98ad783c25561a879dcc77e99c2426n,1n)];function E(a,b){let c=[],d=a;for(let a=0;a<248;a++)c.push(d),d=d.double();d=b;for(let a=0;a<4;a++)c.push(d),d=d.double();return c}let F=E(D[1],D[2]),G=E(D[3],D[4]);function H(a,b,c){let d=function(a){let b;if("bigint"==typeof a)b=a;else if("number"==typeof a){if(!Number.isSafeInteger(a))throw Error(`Invalid pedersenArg: ${a}`);b=BigInt(a)}else b=j.bytesToNumberBE(p(a));if(!(0n<=b&&b<o.CURVE.Fp.ORDER))throw Error(`PedersenArg should be 0 <= value < CURVE.P: ${b}`);return b}(b);for(let b=0;b<252;b++){let e=c[b];if(!e)throw Error("invalid constant index");if(e.equals(a))throw Error("Same point");(1n&d)!==0n&&(a=a.add(e)),d>>=1n}return a}function I(a,b){let c=D[0];return c=H(c,a,F),y((c=H(c,b,G)).toRawBytes(!0))}c.computeHashOnElements=(a,b=I)=>[0,...a,a.length].reduce((a,c)=>b(a,c));let J=j.bitMask(250);c.keccak=a=>j.bytesToNumberBE((0,d.keccak_256)(a))&J;let K=a=>j.bytesToNumberBE((0,e.sha256)(a));function L(a,b,c){let d=a.fromBytes((0,e.sha256)((0,f.utf8ToBytes)(`${b}${c}`)));return a.create(d)}function M(a,b,c,d=0){let e=[],f=[];for(let g=0;g<c;g++)e.push(L(a,`${b}x`,d*c+g)),f.push(L(a,`${b}y`,d*c+g));if(new Set([...e,...f]).size!==2*c)throw Error("X and Y values are not distinct");return e.map(b=>f.map(c=>a.inv(a.sub(b,c))))}c.Fp251=(0,g.Field)(BigInt("3618502788666131213697322783095070105623107215331596699973092056135872020481"));let N=[[3,1,1],[1,-1,1],[1,1,-2]].map(a=>a.map(BigInt));function O(a,b){if((0,g.validateField)(a.Fp),!Number.isSafeInteger(a.rate)||!Number.isSafeInteger(a.capacity))throw Error(`Wrong poseidon opts: ${a}`);let c=a.rate+a.capacity,d=a.roundsFull+a.roundsPartial,e=[];for(let b=0;b<d;b++){let d=[];for(let e=0;e<c;e++)d.push(L(a.Fp,"Hades",c*b+e));e.push(d)}let f=(0,h.poseidon)({...a,t:c,sboxPower:3,reversePartialPowIdx:!0,mds:b,roundConstants:e});return f.m=c,f.rate=a.rate,f.capacity=a.capacity,f}function P(a,b,d=c.poseidonSmall){return d([a,b,2n])[0]}c.poseidonSmall=O({Fp:c.Fp251,rate:2,capacity:1,roundsFull:8,roundsPartial:83},N)},173414,(a,b,c)=>{"use strict";b.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},459892,(a,b,c)=>{"use strict";let d,e,f;function g(a){let b=a.length;for(;--b>=0;)a[b]=0}let h=573,i=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),j=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),k=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),l=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),m=Array(576);g(m);let n=Array(60);g(n);let o=Array(512);g(o);let p=Array(256);g(p);let q=Array(29);g(q);let r=Array(30);function s(a,b,c,d,e){this.static_tree=a,this.extra_bits=b,this.extra_base=c,this.elems=d,this.max_length=e,this.has_stree=a&&a.length}function t(a,b){this.dyn_tree=a,this.max_code=0,this.stat_desc=b}g(r);let u=a=>a<256?o[a]:o[256+(a>>>7)],v=(a,b)=>{a.pending_buf[a.pending++]=255&b,a.pending_buf[a.pending++]=b>>>8&255},w=(a,b,c)=>{a.bi_valid>16-c?(a.bi_buf|=b<<a.bi_valid&65535,v(a,a.bi_buf),a.bi_buf=b>>16-a.bi_valid,a.bi_valid+=c-16):(a.bi_buf|=b<<a.bi_valid&65535,a.bi_valid+=c)},x=(a,b,c)=>{w(a,c[2*b],c[2*b+1])},y=(a,b)=>{let c=0;do c|=1&a,a>>>=1,c<<=1;while(--b>0)return c>>>1},z=(a,b,c)=>{let d,e,f=Array(16),g=0;for(d=1;d<=15;d++)g=g+c[d-1]<<1,f[d]=g;for(e=0;e<=b;e++){let b=a[2*e+1];0!==b&&(a[2*e]=y(f[b]++,b))}},A=a=>{let b;for(b=0;b<286;b++)a.dyn_ltree[2*b]=0;for(b=0;b<30;b++)a.dyn_dtree[2*b]=0;for(b=0;b<19;b++)a.bl_tree[2*b]=0;a.dyn_ltree[512]=1,a.opt_len=a.static_len=0,a.sym_next=a.matches=0},B=a=>{a.bi_valid>8?v(a,a.bi_buf):a.bi_valid>0&&(a.pending_buf[a.pending++]=a.bi_buf),a.bi_buf=0,a.bi_valid=0},C=(a,b,c,d)=>{let e=2*b,f=2*c;return a[e]<a[f]||a[e]===a[f]&&d[b]<=d[c]},D=(a,b,c)=>{let d=a.heap[c],e=c<<1;for(;e<=a.heap_len&&(e<a.heap_len&&C(b,a.heap[e+1],a.heap[e],a.depth)&&e++,!C(b,d,a.heap[e],a.depth));)a.heap[c]=a.heap[e],c=e,e<<=1;a.heap[c]=d},E=(a,b,c)=>{let d,e,f,g,h=0;if(0!==a.sym_next)do d=(255&a.pending_buf[a.sym_buf+h++])+((255&a.pending_buf[a.sym_buf+h++])<<8),e=a.pending_buf[a.sym_buf+h++],0===d?x(a,e,b):(x(a,(f=p[e])+256+1,b),0!==(g=i[f])&&w(a,e-=q[f],g),x(a,f=u(--d),c),0!==(g=j[f])&&w(a,d-=r[f],g));while(h<a.sym_next)x(a,256,b)},F=(a,b)=>{let c,d,e,f=b.dyn_tree,g=b.stat_desc.static_tree,i=b.stat_desc.has_stree,j=b.stat_desc.elems,k=-1;for(c=0,a.heap_len=0,a.heap_max=h;c<j;c++)0!==f[2*c]?(a.heap[++a.heap_len]=k=c,a.depth[c]=0):f[2*c+1]=0;for(;a.heap_len<2;)f[2*(e=a.heap[++a.heap_len]=k<2?++k:0)]=1,a.depth[e]=0,a.opt_len--,i&&(a.static_len-=g[2*e+1]);for(b.max_code=k,c=a.heap_len>>1;c>=1;c--)D(a,f,c);e=j;do c=a.heap[1],a.heap[1]=a.heap[a.heap_len--],D(a,f,1),d=a.heap[1],a.heap[--a.heap_max]=c,a.heap[--a.heap_max]=d,f[2*e]=f[2*c]+f[2*d],a.depth[e]=(a.depth[c]>=a.depth[d]?a.depth[c]:a.depth[d])+1,f[2*c+1]=f[2*d+1]=e,a.heap[1]=e++,D(a,f,1);while(a.heap_len>=2)a.heap[--a.heap_max]=a.heap[1],((a,b)=>{let c,d,e,f,g,i,j=b.dyn_tree,k=b.max_code,l=b.stat_desc.static_tree,m=b.stat_desc.has_stree,n=b.stat_desc.extra_bits,o=b.stat_desc.extra_base,p=b.stat_desc.max_length,q=0;for(f=0;f<=15;f++)a.bl_count[f]=0;for(j[2*a.heap[a.heap_max]+1]=0,c=a.heap_max+1;c<h;c++)(f=j[2*j[2*(d=a.heap[c])+1]+1]+1)>p&&(f=p,q++),j[2*d+1]=f,!(d>k)&&(a.bl_count[f]++,g=0,d>=o&&(g=n[d-o]),i=j[2*d],a.opt_len+=i*(f+g),m&&(a.static_len+=i*(l[2*d+1]+g)));if(0!==q){do{for(f=p-1;0===a.bl_count[f];)f--;a.bl_count[f]--,a.bl_count[f+1]+=2,a.bl_count[p]--,q-=2}while(q>0)for(f=p;0!==f;f--)for(d=a.bl_count[f];0!==d;)!((e=a.heap[--c])>k)&&(j[2*e+1]!==f&&(a.opt_len+=(f-j[2*e+1])*j[2*e],j[2*e+1]=f),d--)}})(a,b),z(f,k,a.bl_count)},G=(a,b,c)=>{let d,e,f=-1,g=b[1],h=0,i=7,j=4;for(0===g&&(i=138,j=3),b[(c+1)*2+1]=65535,d=0;d<=c;d++)e=g,g=b[(d+1)*2+1],++h<i&&e===g||(h<j?a.bl_tree[2*e]+=h:0!==e?(e!==f&&a.bl_tree[2*e]++,a.bl_tree[32]++):h<=10?a.bl_tree[34]++:a.bl_tree[36]++,h=0,f=e,0===g?(i=138,j=3):e===g?(i=6,j=3):(i=7,j=4))},H=(a,b,c)=>{let d,e,f=-1,g=b[1],h=0,i=7,j=4;for(0===g&&(i=138,j=3),d=0;d<=c;d++)if(e=g,g=b[(d+1)*2+1],!(++h<i)||e!==g){if(h<j)do x(a,e,a.bl_tree);while(0!=--h)else 0!==e?(e!==f&&(x(a,e,a.bl_tree),h--),x(a,16,a.bl_tree),w(a,h-3,2)):h<=10?(x(a,17,a.bl_tree),w(a,h-3,3)):(x(a,18,a.bl_tree),w(a,h-11,7));h=0,f=e,0===g?(i=138,j=3):e===g?(i=6,j=3):(i=7,j=4)}},I=!1,J=(a,b,c,d)=>{w(a,0+ +!!d,3),B(a),v(a,c),v(a,~c),c&&a.pending_buf.set(a.window.subarray(b,b+c),a.pending),a.pending+=c};b.exports._tr_init=a=>{I||((()=>{let a,b,c,g,h,l=Array(16);for(g=0,c=0;g<28;g++)for(a=0,q[g]=c;a<1<<i[g];a++)p[c++]=g;for(p[c-1]=g,h=0,g=0;g<16;g++)for(a=0,r[g]=h;a<1<<j[g];a++)o[h++]=g;for(h>>=7;g<30;g++)for(a=0,r[g]=h<<7;a<1<<j[g]-7;a++)o[256+h++]=g;for(b=0;b<=15;b++)l[b]=0;for(a=0;a<=143;)m[2*a+1]=8,a++,l[8]++;for(;a<=255;)m[2*a+1]=9,a++,l[9]++;for(;a<=279;)m[2*a+1]=7,a++,l[7]++;for(;a<=287;)m[2*a+1]=8,a++,l[8]++;for(z(m,287,l),a=0;a<30;a++)n[2*a+1]=5,n[2*a]=y(a,5);d=new s(m,i,257,286,15),e=new s(n,j,0,30,15),f=new s([],k,0,19,7)})(),I=!0),a.l_desc=new t(a.dyn_ltree,d),a.d_desc=new t(a.dyn_dtree,e),a.bl_desc=new t(a.bl_tree,f),a.bi_buf=0,a.bi_valid=0,A(a)},b.exports._tr_stored_block=J,b.exports._tr_flush_block=(a,b,c,d)=>{let e,f,g=0;a.level>0?(2===a.strm.data_type&&(a.strm.data_type=(a=>{let b,c=0xf3ffc07f;for(b=0;b<=31;b++,c>>>=1)if(1&c&&0!==a.dyn_ltree[2*b])return 0;if(0!==a.dyn_ltree[18]||0!==a.dyn_ltree[20]||0!==a.dyn_ltree[26])return 1;for(b=32;b<256;b++)if(0!==a.dyn_ltree[2*b])return 1;return 0})(a)),F(a,a.l_desc),F(a,a.d_desc),g=(a=>{let b;for(G(a,a.dyn_ltree,a.l_desc.max_code),G(a,a.dyn_dtree,a.d_desc.max_code),F(a,a.bl_desc),b=18;b>=3&&0===a.bl_tree[2*l[b]+1];b--);return a.opt_len+=3*(b+1)+5+5+4,b})(a),e=a.opt_len+3+7>>>3,(f=a.static_len+3+7>>>3)<=e&&(e=f)):e=f=c+5,c+4<=e&&-1!==b?J(a,b,c,d):4===a.strategy||f===e?(w(a,2+ +!!d,3),E(a,m,n)):(w(a,4+ +!!d,3),((a,b,c,d)=>{let e;for(w(a,b-257,5),w(a,c-1,5),w(a,d-4,4),e=0;e<d;e++)w(a,a.bl_tree[2*l[e]+1],3);H(a,a.dyn_ltree,b-1),H(a,a.dyn_dtree,c-1)})(a,a.l_desc.max_code+1,a.d_desc.max_code+1,g+1),E(a,a.dyn_ltree,a.dyn_dtree)),A(a),d&&B(a)},b.exports._tr_tally=(a,b,c)=>(a.pending_buf[a.sym_buf+a.sym_next++]=b,a.pending_buf[a.sym_buf+a.sym_next++]=b>>8,a.pending_buf[a.sym_buf+a.sym_next++]=c,0===b?a.dyn_ltree[2*c]++:(a.matches++,b--,a.dyn_ltree[(p[c]+256+1)*2]++,a.dyn_dtree[2*u(b)]++),a.sym_next===a.sym_end),b.exports._tr_align=a=>{w(a,2,3),x(a,256,m),(a=>{16===a.bi_valid?(v(a,a.bi_buf),a.bi_buf=0,a.bi_valid=0):a.bi_valid>=8&&(a.pending_buf[a.pending++]=255&a.bi_buf,a.bi_buf>>=8,a.bi_valid-=8)})(a)}},145628,(a,b,c)=>{"use strict";b.exports=(a,b,c,d)=>{let e=65535&a,f=a>>>16&65535,g=0;for(;0!==c;){g=c>2e3?2e3:c,c-=g;do f=f+(e=e+b[d++]|0)|0;while(--g)e%=65521,f%=65521}return e|f<<16}},680720,(a,b,c)=>{"use strict";let d=new Uint32Array((()=>{let a,b=[];for(var c=0;c<256;c++){a=c;for(var d=0;d<8;d++)a=1&a?0xedb88320^a>>>1:a>>>1;b[c]=a}return b})());b.exports=(a,b,c,e)=>{let f=e+c;a^=-1;for(let c=e;c<f;c++)a=a>>>8^d[(a^b[c])&255];return -1^a}},793404,(a,b,c)=>{"use strict";b.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},226301,(a,b,c)=>{"use strict";let{_tr_init:d,_tr_stored_block:e,_tr_flush_block:f,_tr_tally:g,_tr_align:h}=a.r(459892),i=a.r(145628),j=a.r(680720),k=a.r(793404),{Z_NO_FLUSH:l,Z_PARTIAL_FLUSH:m,Z_FULL_FLUSH:n,Z_FINISH:o,Z_BLOCK:p,Z_OK:q,Z_STREAM_END:r,Z_STREAM_ERROR:s,Z_DATA_ERROR:t,Z_BUF_ERROR:u,Z_DEFAULT_COMPRESSION:v,Z_FILTERED:w,Z_HUFFMAN_ONLY:x,Z_RLE:y,Z_FIXED:z,Z_DEFAULT_STRATEGY:A,Z_UNKNOWN:B,Z_DEFLATED:C}=a.r(173414),D=573,E=(a,b)=>(a.msg=k[b],b),F=a=>2*a-9*(a>4),G=a=>{let b=a.length;for(;--b>=0;)a[b]=0},H=a=>{let b,c,d,e=a.w_size;d=b=a.hash_size;do c=a.head[--d],a.head[d]=c>=e?c-e:0;while(--b)d=b=e;do c=a.prev[--d],a.prev[d]=c>=e?c-e:0;while(--b)},I=(a,b,c)=>(b<<a.hash_shift^c)&a.hash_mask,J=a=>{let b=a.state,c=b.pending;c>a.avail_out&&(c=a.avail_out),0!==c&&(a.output.set(b.pending_buf.subarray(b.pending_out,b.pending_out+c),a.next_out),a.next_out+=c,b.pending_out+=c,a.total_out+=c,a.avail_out-=c,b.pending-=c,0===b.pending&&(b.pending_out=0))},K=(a,b)=>{f(a,a.block_start>=0?a.block_start:-1,a.strstart-a.block_start,b),a.block_start=a.strstart,J(a.strm)},L=(a,b)=>{a.pending_buf[a.pending++]=b},M=(a,b)=>{a.pending_buf[a.pending++]=b>>>8&255,a.pending_buf[a.pending++]=255&b},N=(a,b,c,d)=>{let e=a.avail_in;return(e>d&&(e=d),0===e)?0:(a.avail_in-=e,b.set(a.input.subarray(a.next_in,a.next_in+e),c),1===a.state.wrap?a.adler=i(a.adler,b,e,c):2===a.state.wrap&&(a.adler=j(a.adler,b,e,c)),a.next_in+=e,a.total_in+=e,e)},O=(a,b)=>{let c,d,e=a.max_chain_length,f=a.strstart,g=a.prev_length,h=a.nice_match,i=a.strstart>a.w_size-262?a.strstart-(a.w_size-262):0,j=a.window,k=a.w_mask,l=a.prev,m=a.strstart+258,n=j[f+g-1],o=j[f+g];a.prev_length>=a.good_match&&(e>>=2),h>a.lookahead&&(h=a.lookahead);do{if(j[(c=b)+g]!==o||j[c+g-1]!==n||j[c]!==j[f]||j[++c]!==j[f+1])continue;f+=2,c++;do;while(j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&f<m)if(d=258-(m-f),f=m-258,d>g){if(a.match_start=b,g=d,d>=h)break;n=j[f+g-1],o=j[f+g]}}while((b=l[b&k])>i&&0!=--e)return g<=a.lookahead?g:a.lookahead},P=a=>{let b,c,d,e=a.w_size;do{if(c=a.window_size-a.lookahead-a.strstart,a.strstart>=e+(e-262)&&(a.window.set(a.window.subarray(e,e+e-c),0),a.match_start-=e,a.strstart-=e,a.block_start-=e,a.insert>a.strstart&&(a.insert=a.strstart),H(a),c+=e),0===a.strm.avail_in)break;if(b=N(a.strm,a.window,a.strstart+a.lookahead,c),a.lookahead+=b,a.lookahead+a.insert>=3)for(d=a.strstart-a.insert,a.ins_h=a.window[d],a.ins_h=I(a,a.ins_h,a.window[d+1]);a.insert&&(a.ins_h=I(a,a.ins_h,a.window[d+3-1]),a.prev[d&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=d,d++,a.insert--,!(a.lookahead+a.insert<3)););}while(a.lookahead<262&&0!==a.strm.avail_in)},Q=(a,b)=>{let c=a.pending_buf_size-5>a.w_size?a.w_size:a.pending_buf_size-5,d,f,g,h=0,i=a.strm.avail_in;do{if(d=65535,g=a.bi_valid+42>>3,a.strm.avail_out<g||(g=a.strm.avail_out-g,d>(f=a.strstart-a.block_start)+a.strm.avail_in&&(d=f+a.strm.avail_in),d>g&&(d=g),d<c&&(0===d&&b!==o||b===l||d!==f+a.strm.avail_in)))break;h=+(b===o&&d===f+a.strm.avail_in),e(a,0,0,h),a.pending_buf[a.pending-4]=d,a.pending_buf[a.pending-3]=d>>8,a.pending_buf[a.pending-2]=~d,a.pending_buf[a.pending-1]=~d>>8,J(a.strm),f&&(f>d&&(f=d),a.strm.output.set(a.window.subarray(a.block_start,a.block_start+f),a.strm.next_out),a.strm.next_out+=f,a.strm.avail_out-=f,a.strm.total_out+=f,a.block_start+=f,d-=f),d&&(N(a.strm,a.strm.output,a.strm.next_out,d),a.strm.next_out+=d,a.strm.avail_out-=d,a.strm.total_out+=d)}while(0===h)return((i-=a.strm.avail_in)&&(i>=a.w_size?(a.matches=2,a.window.set(a.strm.input.subarray(a.strm.next_in-a.w_size,a.strm.next_in),0),a.strstart=a.w_size,a.insert=a.strstart):(a.window_size-a.strstart<=i&&(a.strstart-=a.w_size,a.window.set(a.window.subarray(a.w_size,a.w_size+a.strstart),0),a.matches<2&&a.matches++,a.insert>a.strstart&&(a.insert=a.strstart)),a.window.set(a.strm.input.subarray(a.strm.next_in-i,a.strm.next_in),a.strstart),a.strstart+=i,a.insert+=i>a.w_size-a.insert?a.w_size-a.insert:i),a.block_start=a.strstart),a.high_water<a.strstart&&(a.high_water=a.strstart),h)?4:b!==l&&b!==o&&0===a.strm.avail_in&&a.strstart===a.block_start?2:(g=a.window_size-a.strstart,a.strm.avail_in>g&&a.block_start>=a.w_size&&(a.block_start-=a.w_size,a.strstart-=a.w_size,a.window.set(a.window.subarray(a.w_size,a.w_size+a.strstart),0),a.matches<2&&a.matches++,g+=a.w_size,a.insert>a.strstart&&(a.insert=a.strstart)),g>a.strm.avail_in&&(g=a.strm.avail_in),g&&(N(a.strm,a.window,a.strstart,g),a.strstart+=g,a.insert+=g>a.w_size-a.insert?a.w_size-a.insert:g),a.high_water<a.strstart&&(a.high_water=a.strstart),g=a.bi_valid+42>>3,c=(g=a.pending_buf_size-g>65535?65535:a.pending_buf_size-g)>a.w_size?a.w_size:g,((f=a.strstart-a.block_start)>=c||(f||b===o)&&b!==l&&0===a.strm.avail_in&&f<=g)&&(d=f>g?g:f,h=+(b===o&&0===a.strm.avail_in&&d===f),e(a,a.block_start,d,h),a.block_start+=d,J(a.strm)),h?3:1)},R=(a,b)=>{let c,d;for(;;){if(a.lookahead<262){if(P(a),a.lookahead<262&&b===l)return 1;if(0===a.lookahead)break}if(c=0,a.lookahead>=3&&(a.ins_h=I(a,a.ins_h,a.window[a.strstart+3-1]),c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),0!==c&&a.strstart-c<=a.w_size-262&&(a.match_length=O(a,c)),a.match_length>=3)if(d=g(a,a.strstart-a.match_start,a.match_length-3),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&a.lookahead>=3){a.match_length--;do a.strstart++,a.ins_h=I(a,a.ins_h,a.window[a.strstart+3-1]),c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart;while(0!=--a.match_length)a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=I(a,a.ins_h,a.window[a.strstart+1]);else d=g(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(d&&(K(a,!1),0===a.strm.avail_out))return 1}return(a.insert=a.strstart<2?a.strstart:2,b===o)?(K(a,!0),0===a.strm.avail_out)?3:4:a.sym_next&&(K(a,!1),0===a.strm.avail_out)?1:2},S=(a,b)=>{let c,d,e;for(;;){if(a.lookahead<262){if(P(a),a.lookahead<262&&b===l)return 1;if(0===a.lookahead)break}if(c=0,a.lookahead>=3&&(a.ins_h=I(a,a.ins_h,a.window[a.strstart+3-1]),c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=2,0!==c&&a.prev_length<a.max_lazy_match&&a.strstart-c<=a.w_size-262&&(a.match_length=O(a,c),a.match_length<=5&&(a.strategy===w||3===a.match_length&&a.strstart-a.match_start>4096)&&(a.match_length=2)),a.prev_length>=3&&a.match_length<=a.prev_length){e=a.strstart+a.lookahead-3,d=g(a,a.strstart-1-a.prev_match,a.prev_length-3),a.lookahead-=a.prev_length-1,a.prev_length-=2;do++a.strstart<=e&&(a.ins_h=I(a,a.ins_h,a.window[a.strstart+3-1]),c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);while(0!=--a.prev_length)if(a.match_available=0,a.match_length=2,a.strstart++,d&&(K(a,!1),0===a.strm.avail_out))return 1}else if(a.match_available){if((d=g(a,0,a.window[a.strstart-1]))&&K(a,!1),a.strstart++,a.lookahead--,0===a.strm.avail_out)return 1}else a.match_available=1,a.strstart++,a.lookahead--}return(a.match_available&&(d=g(a,0,a.window[a.strstart-1]),a.match_available=0),a.insert=a.strstart<2?a.strstart:2,b===o)?(K(a,!0),0===a.strm.avail_out)?3:4:a.sym_next&&(K(a,!1),0===a.strm.avail_out)?1:2};function T(a,b,c,d,e){this.good_length=a,this.max_lazy=b,this.nice_length=c,this.max_chain=d,this.func=e}let U=[new T(0,0,0,0,Q),new T(4,4,8,4,R),new T(4,5,16,8,R),new T(4,6,32,32,R),new T(4,4,16,16,S),new T(8,16,32,32,S),new T(8,16,128,128,S),new T(8,32,128,256,S),new T(32,128,258,1024,S),new T(32,258,258,4096,S)];function V(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=C,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*D),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),G(this.dyn_ltree),G(this.dyn_dtree),G(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),G(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),G(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}let W=a=>{if(!a)return 1;let b=a.state;return b&&b.strm===a&&(42===b.status||57===b.status||69===b.status||73===b.status||91===b.status||103===b.status||113===b.status||666===b.status)?0:1},X=a=>{if(W(a))return E(a,s);a.total_in=a.total_out=0,a.data_type=B;let b=a.state;return b.pending=0,b.pending_out=0,b.wrap<0&&(b.wrap=-b.wrap),b.status=2===b.wrap?57:b.wrap?42:113,a.adler=+(2!==b.wrap),b.last_flush=-2,d(b),q},Y=a=>{let b=X(a);return b===q&&(a=>{a.window_size=2*a.w_size,G(a.head),a.max_lazy_match=U[a.level].max_lazy,a.good_match=U[a.level].good_length,a.nice_match=U[a.level].nice_length,a.max_chain_length=U[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=2,a.match_available=0,a.ins_h=0})(a.state),b},Z=(a,b,c,d,e,f)=>{if(!a)return s;let g=1;if(b===v&&(b=6),d<0?(g=0,d=-d):d>15&&(g=2,d-=16),e<1||e>9||c!==C||d<8||d>15||b<0||b>9||f<0||f>z||8===d&&1!==g)return E(a,s);8===d&&(d=9);let h=new V;return a.state=h,h.strm=a,h.status=42,h.wrap=g,h.gzhead=null,h.w_bits=d,h.w_size=1<<h.w_bits,h.w_mask=h.w_size-1,h.hash_bits=e+7,h.hash_size=1<<h.hash_bits,h.hash_mask=h.hash_size-1,h.hash_shift=~~((h.hash_bits+3-1)/3),h.window=new Uint8Array(2*h.w_size),h.head=new Uint16Array(h.hash_size),h.prev=new Uint16Array(h.w_size),h.lit_bufsize=1<<e+6,h.pending_buf_size=4*h.lit_bufsize,h.pending_buf=new Uint8Array(h.pending_buf_size),h.sym_buf=h.lit_bufsize,h.sym_end=(h.lit_bufsize-1)*3,h.level=b,h.strategy=f,h.method=c,Y(a)};b.exports.deflateInit=(a,b)=>Z(a,b,C,15,8,A),b.exports.deflateInit2=Z,b.exports.deflateReset=Y,b.exports.deflateResetKeep=X,b.exports.deflateSetHeader=(a,b)=>W(a)||2!==a.state.wrap?s:(a.state.gzhead=b,q),b.exports.deflate=(a,b)=>{if(W(a)||b>p||b<0)return a?E(a,s):s;let c=a.state;if(!a.output||0!==a.avail_in&&!a.input||666===c.status&&b!==o)return E(a,0===a.avail_out?u:s);let d=c.last_flush;if(c.last_flush=b,0!==c.pending){if(J(a),0===a.avail_out)return c.last_flush=-1,q}else if(0===a.avail_in&&F(b)<=F(d)&&b!==o)return E(a,u);if(666===c.status&&0!==a.avail_in)return E(a,u);if(42===c.status&&0===c.wrap&&(c.status=113),42===c.status){let b=C+(c.w_bits-8<<4)<<8;if(b|=(c.strategy>=x||c.level<2?0:c.level<6?1:6===c.level?2:3)<<6,0!==c.strstart&&(b|=32),M(c,b+=31-b%31),0!==c.strstart&&(M(c,a.adler>>>16),M(c,65535&a.adler)),a.adler=1,c.status=113,J(a),0!==c.pending)return c.last_flush=-1,q}if(57===c.status){if(a.adler=0,L(c,31),L(c,139),L(c,8),c.gzhead)L(c,+!!c.gzhead.text+2*!!c.gzhead.hcrc+4*!!c.gzhead.extra+8*!!c.gzhead.name+16*!!c.gzhead.comment),L(c,255&c.gzhead.time),L(c,c.gzhead.time>>8&255),L(c,c.gzhead.time>>16&255),L(c,c.gzhead.time>>24&255),L(c,9===c.level?2:4*(c.strategy>=x||c.level<2)),L(c,255&c.gzhead.os),c.gzhead.extra&&c.gzhead.extra.length&&(L(c,255&c.gzhead.extra.length),L(c,c.gzhead.extra.length>>8&255)),c.gzhead.hcrc&&(a.adler=j(a.adler,c.pending_buf,c.pending,0)),c.gzindex=0,c.status=69;else if(L(c,0),L(c,0),L(c,0),L(c,0),L(c,0),L(c,9===c.level?2:4*(c.strategy>=x||c.level<2)),L(c,3),c.status=113,J(a),0!==c.pending)return c.last_flush=-1,q}if(69===c.status){if(c.gzhead.extra){let b=c.pending,d=(65535&c.gzhead.extra.length)-c.gzindex;for(;c.pending+d>c.pending_buf_size;){let e=c.pending_buf_size-c.pending;if(c.pending_buf.set(c.gzhead.extra.subarray(c.gzindex,c.gzindex+e),c.pending),c.pending=c.pending_buf_size,c.gzhead.hcrc&&c.pending>b&&(a.adler=j(a.adler,c.pending_buf,c.pending-b,b)),c.gzindex+=e,J(a),0!==c.pending)return c.last_flush=-1,q;b=0,d-=e}let e=new Uint8Array(c.gzhead.extra);c.pending_buf.set(e.subarray(c.gzindex,c.gzindex+d),c.pending),c.pending+=d,c.gzhead.hcrc&&c.pending>b&&(a.adler=j(a.adler,c.pending_buf,c.pending-b,b)),c.gzindex=0}c.status=73}if(73===c.status){if(c.gzhead.name){let b,d=c.pending;do{if(c.pending===c.pending_buf_size){if(c.gzhead.hcrc&&c.pending>d&&(a.adler=j(a.adler,c.pending_buf,c.pending-d,d)),J(a),0!==c.pending)return c.last_flush=-1,q;d=0}b=c.gzindex<c.gzhead.name.length?255&c.gzhead.name.charCodeAt(c.gzindex++):0,L(c,b)}while(0!==b)c.gzhead.hcrc&&c.pending>d&&(a.adler=j(a.adler,c.pending_buf,c.pending-d,d)),c.gzindex=0}c.status=91}if(91===c.status){if(c.gzhead.comment){let b,d=c.pending;do{if(c.pending===c.pending_buf_size){if(c.gzhead.hcrc&&c.pending>d&&(a.adler=j(a.adler,c.pending_buf,c.pending-d,d)),J(a),0!==c.pending)return c.last_flush=-1,q;d=0}b=c.gzindex<c.gzhead.comment.length?255&c.gzhead.comment.charCodeAt(c.gzindex++):0,L(c,b)}while(0!==b)c.gzhead.hcrc&&c.pending>d&&(a.adler=j(a.adler,c.pending_buf,c.pending-d,d))}c.status=103}if(103===c.status){if(c.gzhead.hcrc){if(c.pending+2>c.pending_buf_size&&(J(a),0!==c.pending))return c.last_flush=-1,q;L(c,255&a.adler),L(c,a.adler>>8&255),a.adler=0}if(c.status=113,J(a),0!==c.pending)return c.last_flush=-1,q}if(0!==a.avail_in||0!==c.lookahead||b!==l&&666!==c.status){let d=0===c.level?Q(c,b):c.strategy===x?((a,b)=>{let c;for(;;){if(0===a.lookahead&&(P(a),0===a.lookahead)){if(b===l)return 1;break}if(a.match_length=0,c=g(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++,c&&(K(a,!1),0===a.strm.avail_out))return 1}return(a.insert=0,b===o)?(K(a,!0),0===a.strm.avail_out)?3:4:a.sym_next&&(K(a,!1),0===a.strm.avail_out)?1:2})(c,b):c.strategy===y?((a,b)=>{let c,d,e,f,h=a.window;for(;;){if(a.lookahead<=258){if(P(a),a.lookahead<=258&&b===l)return 1;if(0===a.lookahead)break}if(a.match_length=0,a.lookahead>=3&&a.strstart>0&&(d=h[e=a.strstart-1])===h[++e]&&d===h[++e]&&d===h[++e]){f=a.strstart+258;do;while(d===h[++e]&&d===h[++e]&&d===h[++e]&&d===h[++e]&&d===h[++e]&&d===h[++e]&&d===h[++e]&&d===h[++e]&&e<f)a.match_length=258-(f-e),a.match_length>a.lookahead&&(a.match_length=a.lookahead)}if(a.match_length>=3?(c=g(a,1,a.match_length-3),a.lookahead-=a.match_length,a.strstart+=a.match_length,a.match_length=0):(c=g(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++),c&&(K(a,!1),0===a.strm.avail_out))return 1}return(a.insert=0,b===o)?(K(a,!0),0===a.strm.avail_out)?3:4:a.sym_next&&(K(a,!1),0===a.strm.avail_out)?1:2})(c,b):U[c.level].func(c,b);if((3===d||4===d)&&(c.status=666),1===d||3===d)return 0===a.avail_out&&(c.last_flush=-1),q;if(2===d&&(b===m?h(c):b!==p&&(e(c,0,0,!1),b===n&&(G(c.head),0===c.lookahead&&(c.strstart=0,c.block_start=0,c.insert=0))),J(a),0===a.avail_out))return c.last_flush=-1,q}return b!==o?q:c.wrap<=0?r:(2===c.wrap?(L(c,255&a.adler),L(c,a.adler>>8&255),L(c,a.adler>>16&255),L(c,a.adler>>24&255),L(c,255&a.total_in),L(c,a.total_in>>8&255),L(c,a.total_in>>16&255),L(c,a.total_in>>24&255)):(M(c,a.adler>>>16),M(c,65535&a.adler)),J(a),c.wrap>0&&(c.wrap=-c.wrap),0!==c.pending?q:r)},b.exports.deflateEnd=a=>{if(W(a))return s;let b=a.state.status;return a.state=null,113===b?E(a,t):q},b.exports.deflateSetDictionary=(a,b)=>{let c=b.length;if(W(a))return s;let d=a.state,e=d.wrap;if(2===e||1===e&&42!==d.status||d.lookahead)return s;if(1===e&&(a.adler=i(a.adler,b,c,0)),d.wrap=0,c>=d.w_size){0===e&&(G(d.head),d.strstart=0,d.block_start=0,d.insert=0);let a=new Uint8Array(d.w_size);a.set(b.subarray(c-d.w_size,c),0),b=a,c=d.w_size}let f=a.avail_in,g=a.next_in,h=a.input;for(a.avail_in=c,a.next_in=0,a.input=b,P(d);d.lookahead>=3;){let a=d.strstart,b=d.lookahead-2;do d.ins_h=I(d,d.ins_h,d.window[a+3-1]),d.prev[a&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=a,a++;while(--b)d.strstart=a,d.lookahead=2,P(d)}return d.strstart+=d.lookahead,d.block_start=d.strstart,d.insert=d.lookahead,d.lookahead=0,d.match_length=d.prev_length=2,d.match_available=0,a.next_in=g,a.input=h,a.avail_in=f,d.wrap=e,q},b.exports.deflateInfo="pako deflate (from Nodeca project)"},680837,(a,b,c)=>{"use strict";let d=(a,b)=>Object.prototype.hasOwnProperty.call(a,b);b.exports.assign=function(a){let b=Array.prototype.slice.call(arguments,1);for(;b.length;){let c=b.shift();if(c){if("object"!=typeof c)throw TypeError(c+"must be non-object");for(let b in c)d(c,b)&&(a[b]=c[b])}}return a},b.exports.flattenChunks=a=>{let b=0;for(let c=0,d=a.length;c<d;c++)b+=a[c].length;let c=new Uint8Array(b);for(let b=0,d=0,e=a.length;b<e;b++){let e=a[b];c.set(e,d),d+=e.length}return c}},785455,(a,b,c)=>{"use strict";let d=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(a){d=!1}let e=new Uint8Array(256);for(let a=0;a<256;a++)e[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;e[254]=e[254]=1,b.exports.string2buf=a=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return new TextEncoder().encode(a);let b,c,d,e,f,g=a.length,h=0;for(e=0;e<g;e++)(64512&(c=a.charCodeAt(e)))==55296&&e+1<g&&(64512&(d=a.charCodeAt(e+1)))==56320&&(c=65536+(c-55296<<10)+(d-56320),e++),h+=c<128?1:c<2048?2:c<65536?3:4;for(f=0,b=new Uint8Array(h),e=0;f<h;e++)(64512&(c=a.charCodeAt(e)))==55296&&e+1<g&&(64512&(d=a.charCodeAt(e+1)))==56320&&(c=65536+(c-55296<<10)+(d-56320),e++),c<128?b[f++]=c:(c<2048?b[f++]=192|c>>>6:(c<65536?b[f++]=224|c>>>12:(b[f++]=240|c>>>18,b[f++]=128|c>>>12&63),b[f++]=128|c>>>6&63),b[f++]=128|63&c);return b},b.exports.buf2string=(a,b)=>{let c,f,g=b||a.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return new TextDecoder().decode(a.subarray(0,b));let h=Array(2*g);for(f=0,c=0;c<g;){let b=a[c++];if(b<128){h[f++]=b;continue}let d=e[b];if(d>4){h[f++]=65533,c+=d-1;continue}for(b&=2===d?31:3===d?15:7;d>1&&c<g;)b=b<<6|63&a[c++],d--;if(d>1){h[f++]=65533;continue}b<65536?h[f++]=b:(b-=65536,h[f++]=55296|b>>10&1023,h[f++]=56320|1023&b)}return((a,b)=>{if(b<65534&&a.subarray&&d)return String.fromCharCode.apply(null,a.length===b?a:a.subarray(0,b));let c="";for(let d=0;d<b;d++)c+=String.fromCharCode(a[d]);return c})(h,f)},b.exports.utf8border=(a,b)=>{(b=b||a.length)>a.length&&(b=a.length);let c=b-1;for(;c>=0&&(192&a[c])==128;)c--;return c<0||0===c?b:c+e[a[c]]>b?c:b}},381481,(a,b,c)=>{"use strict";b.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},388069,(a,b,c)=>{"use strict";let d=a.r(226301),e=a.r(680837),f=a.r(785455),g=a.r(793404),h=a.r(381481),i=Object.prototype.toString,{Z_NO_FLUSH:j,Z_SYNC_FLUSH:k,Z_FULL_FLUSH:l,Z_FINISH:m,Z_OK:n,Z_STREAM_END:o,Z_DEFAULT_COMPRESSION:p,Z_DEFAULT_STRATEGY:q,Z_DEFLATED:r}=a.r(173414);function s(a){this.options=e.assign({level:p,method:r,chunkSize:16384,windowBits:15,memLevel:8,strategy:q},a||{});let b=this.options;b.raw&&b.windowBits>0?b.windowBits=-b.windowBits:b.gzip&&b.windowBits>0&&b.windowBits<16&&(b.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;let c=d.deflateInit2(this.strm,b.level,b.method,b.windowBits,b.memLevel,b.strategy);if(c!==n)throw Error(g[c]);if(b.header&&d.deflateSetHeader(this.strm,b.header),b.dictionary){let a;if(a="string"==typeof b.dictionary?f.string2buf(b.dictionary):"[object ArrayBuffer]"===i.call(b.dictionary)?new Uint8Array(b.dictionary):b.dictionary,(c=d.deflateSetDictionary(this.strm,a))!==n)throw Error(g[c]);this._dict_set=!0}}function t(a,b){let c=new s(b);if(c.push(a,!0),c.err)throw c.msg||g[c.err];return c.result}s.prototype.push=function(a,b){let c,e,g=this.strm,h=this.options.chunkSize;if(this.ended)return!1;for(e=b===~~b?b:!0===b?m:j,"string"==typeof a?g.input=f.string2buf(a):"[object ArrayBuffer]"===i.call(a)?g.input=new Uint8Array(a):g.input=a,g.next_in=0,g.avail_in=g.input.length;;){if(0===g.avail_out&&(g.output=new Uint8Array(h),g.next_out=0,g.avail_out=h),(e===k||e===l)&&g.avail_out<=6){this.onData(g.output.subarray(0,g.next_out)),g.avail_out=0;continue}if((c=d.deflate(g,e))===o)return g.next_out>0&&this.onData(g.output.subarray(0,g.next_out)),c=d.deflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===n;if(0===g.avail_out){this.onData(g.output);continue}if(e>0&&g.next_out>0){this.onData(g.output.subarray(0,g.next_out)),g.avail_out=0;continue}if(0===g.avail_in)break}return!0},s.prototype.onData=function(a){this.chunks.push(a)},s.prototype.onEnd=function(a){a===n&&(this.result=e.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg},b.exports.Deflate=s,b.exports.deflate=t,b.exports.deflateRaw=function(a,b){return(b=b||{}).raw=!0,t(a,b)},b.exports.gzip=function(a,b){return(b=b||{}).gzip=!0,t(a,b)},b.exports.constants=a.r(173414)},783628,(a,b,c)=>{"use strict";b.exports=function(a,b){let c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=a.state;c=a.next_in,y=a.input,d=c+(a.avail_in-5),e=a.next_out,z=a.output,f=e-(b-a.avail_out),g=e+(a.avail_out-257),h=A.dmax,i=A.wsize,j=A.whave,k=A.wnext,l=A.window,m=A.hold,n=A.bits,o=A.lencode,p=A.distcode,q=(1<<A.lenbits)-1,r=(1<<A.distbits)-1;b:do for(n<15&&(m+=y[c++]<<n,n+=8,m+=y[c++]<<n,n+=8),s=o[m&q];;){if(m>>>=t=s>>>24,n-=t,0==(t=s>>>16&255))z[e++]=65535&s;else if(16&t)for(u=65535&s,(t&=15)&&(n<t&&(m+=y[c++]<<n,n+=8),u+=m&(1<<t)-1,m>>>=t,n-=t),n<15&&(m+=y[c++]<<n,n+=8,m+=y[c++]<<n,n+=8),s=p[m&r];;){if(m>>>=t=s>>>24,n-=t,16&(t=s>>>16&255)){if(v=65535&s,n<(t&=15)&&(m+=y[c++]<<n,(n+=8)<t&&(m+=y[c++]<<n,n+=8)),(v+=m&(1<<t)-1)>h){a.msg="invalid distance too far back",A.mode=16209;break b}if(m>>>=t,n-=t,v>(t=e-f)){if((t=v-t)>j&&A.sane){a.msg="invalid distance too far back",A.mode=16209;break b}if(w=0,x=l,0===k){if(w+=i-t,t<u){u-=t;do z[e++]=l[w++];while(--t)w=e-v,x=z}}else if(k<t){if(w+=i+k-t,(t-=k)<u){u-=t;do z[e++]=l[w++];while(--t)if(w=0,k<u){u-=t=k;do z[e++]=l[w++];while(--t)w=e-v,x=z}}}else if(w+=k-t,t<u){u-=t;do z[e++]=l[w++];while(--t)w=e-v,x=z}for(;u>2;)z[e++]=x[w++],z[e++]=x[w++],z[e++]=x[w++],u-=3;u&&(z[e++]=x[w++],u>1&&(z[e++]=x[w++]))}else{w=e-v;do z[e++]=z[w++],z[e++]=z[w++],z[e++]=z[w++],u-=3;while(u>2)u&&(z[e++]=z[w++],u>1&&(z[e++]=z[w++]))}}else if((64&t)==0){s=p[(65535&s)+(m&(1<<t)-1)];continue}else{a.msg="invalid distance code",A.mode=16209;break b}break}else if((64&t)==0){s=o[(65535&s)+(m&(1<<t)-1)];continue}else if(32&t){A.mode=16191;break b}else{a.msg="invalid literal/length code",A.mode=16209;break b}break}while(c<d&&e<g)c-=u=n>>3,n-=u<<3,m&=(1<<n)-1,a.next_in=c,a.next_out=e,a.avail_in=c<d?5+(d-c):5-(c-d),a.avail_out=e<g?257+(g-e):257-(e-g),A.hold=m,A.bits=n}},478496,(a,b,c)=>{"use strict";let d=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),e=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),f=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),g=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);b.exports=(a,b,c,h,i,j,k,l)=>{let m,n,o,p,q,r,s,t,u,v=l.bits,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=null,H=new Uint16Array(16),I=new Uint16Array(16),J=null;for(w=0;w<=15;w++)H[w]=0;for(x=0;x<h;x++)H[b[c+x]]++;for(z=15,A=v;z>=1&&0===H[z];z--);if(A>z&&(A=z),0===z)return i[j++]=0x1400000,i[j++]=0x1400000,l.bits=1,0;for(y=1;y<z&&0===H[y];y++);for(A<y&&(A=y),D=1,w=1;w<=15;w++)if(D<<=1,(D-=H[w])<0)return -1;if(D>0&&(0===a||1!==z))return -1;for(w=1,I[1]=0;w<15;w++)I[w+1]=I[w]+H[w];for(x=0;x<h;x++)0!==b[c+x]&&(k[I[b[c+x]]++]=x);if(0===a?(G=J=k,r=20):1===a?(G=d,J=e,r=257):(G=f,J=g,r=0),F=0,x=0,w=y,q=j,B=A,C=0,o=-1,p=(E=1<<A)-1,1===a&&E>852||2===a&&E>592)return 1;for(;;){s=w-C,k[x]+1<r?(t=0,u=k[x]):k[x]>=r?(t=J[k[x]-r],u=G[k[x]-r]):(t=96,u=0),m=1<<w-C,y=n=1<<B;do i[q+(F>>C)+(n-=m)]=s<<24|t<<16|u;while(0!==n)for(m=1<<w-1;F&m;)m>>=1;if(0!==m?(F&=m-1,F+=m):F=0,x++,0==--H[w]){if(w===z)break;w=b[c+k[x]]}if(w>A&&(F&p)!==o){for(0===C&&(C=A),q+=y,D=1<<(B=w-C);B+C<z&&!((D-=H[B+C])<=0);)B++,D<<=1;if(E+=1<<B,1===a&&E>852||2===a&&E>592)return 1;i[o=F&p]=A<<24|B<<16|q-j}}return 0!==F&&(i[q+F]=w-C<<24|4194304),l.bits=A,0}},350026,(a,b,c)=>{"use strict";let d,e,f=a.r(145628),g=a.r(680720),h=a.r(783628),i=a.r(478496),{Z_FINISH:j,Z_BLOCK:k,Z_TREES:l,Z_OK:m,Z_STREAM_END:n,Z_NEED_DICT:o,Z_STREAM_ERROR:p,Z_DATA_ERROR:q,Z_MEM_ERROR:r,Z_BUF_ERROR:s,Z_DEFLATED:t}=a.r(173414),u=a=>(a>>>24&255)+(a>>>8&65280)+((65280&a)<<8)+((255&a)<<24);function v(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}let w=a=>{if(!a)return 1;let b=a.state;return+(!b||b.strm!==a||b.mode<16180||b.mode>16211)},x=a=>{if(w(a))return p;let b=a.state;return a.total_in=a.total_out=b.total=0,a.msg="",b.wrap&&(a.adler=1&b.wrap),b.mode=16180,b.last=0,b.havedict=0,b.flags=-1,b.dmax=32768,b.head=null,b.hold=0,b.bits=0,b.lencode=b.lendyn=new Int32Array(852),b.distcode=b.distdyn=new Int32Array(592),b.sane=1,b.back=-1,m},y=a=>{if(w(a))return p;let b=a.state;return b.wsize=0,b.whave=0,b.wnext=0,x(a)},z=(a,b)=>{let c;if(w(a))return p;let d=a.state;return(b<0?(c=0,b=-b):(c=(b>>4)+5,b<48&&(b&=15)),b&&(b<8||b>15))?p:(null!==d.window&&d.wbits!==b&&(d.window=null),d.wrap=c,d.wbits=b,y(a))},A=(a,b)=>{if(!a)return p;let c=new v;a.state=c,c.strm=a,c.window=null,c.mode=16180;let d=z(a,b);return d!==m&&(a.state=null),d},B=!0,C=a=>{if(B){d=new Int32Array(512),e=new Int32Array(32);let b=0;for(;b<144;)a.lens[b++]=8;for(;b<256;)a.lens[b++]=9;for(;b<280;)a.lens[b++]=7;for(;b<288;)a.lens[b++]=8;for(i(1,a.lens,0,288,d,0,a.work,{bits:9}),b=0;b<32;)a.lens[b++]=5;i(2,a.lens,0,32,e,0,a.work,{bits:5}),B=!1}a.lencode=d,a.lenbits=9,a.distcode=e,a.distbits=5},D=(a,b,c,d)=>{let e,f=a.state;return null===f.window&&(f.wsize=1<<f.wbits,f.wnext=0,f.whave=0,f.window=new Uint8Array(f.wsize)),d>=f.wsize?(f.window.set(b.subarray(c-f.wsize,c),0),f.wnext=0,f.whave=f.wsize):((e=f.wsize-f.wnext)>d&&(e=d),f.window.set(b.subarray(c-d,c-d+e),f.wnext),(d-=e)?(f.window.set(b.subarray(c-d,c),0),f.wnext=d,f.whave=f.wsize):(f.wnext+=e,f.wnext===f.wsize&&(f.wnext=0),f.whave<f.wsize&&(f.whave+=e))),0};b.exports.inflateReset=y,b.exports.inflateReset2=z,b.exports.inflateResetKeep=x,b.exports.inflateInit=a=>A(a,15),b.exports.inflateInit2=A,b.exports.inflate=(a,b)=>{let c,d,e,v,x,y,z,A,B,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T=0,U=new Uint8Array(4),V=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(w(a)||!a.output||!a.input&&0!==a.avail_in)return p;16191===(c=a.state).mode&&(c.mode=16192),x=a.next_out,e=a.output,z=a.avail_out,v=a.next_in,d=a.input,y=a.avail_in,A=c.hold,B=c.bits,E=y,F=z,Q=m;c:for(;;)switch(c.mode){case 16180:if(0===c.wrap){c.mode=16192;break}for(;B<16;){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}if(2&c.wrap&&35615===A){0===c.wbits&&(c.wbits=15),c.check=0,U[0]=255&A,U[1]=A>>>8&255,c.check=g(c.check,U,2,0),A=0,B=0,c.mode=16181;break}if(c.head&&(c.head.done=!1),!(1&c.wrap)||(((255&A)<<8)+(A>>8))%31){a.msg="incorrect header check",c.mode=16209;break}if((15&A)!==t){a.msg="unknown compression method",c.mode=16209;break}if(A>>>=4,B-=4,P=(15&A)+8,0===c.wbits&&(c.wbits=P),P>15||P>c.wbits){a.msg="invalid window size",c.mode=16209;break}c.dmax=1<<c.wbits,c.flags=0,a.adler=c.check=1,c.mode=512&A?16189:16191,A=0,B=0;break;case 16181:for(;B<16;){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}if(c.flags=A,(255&c.flags)!==t){a.msg="unknown compression method",c.mode=16209;break}if(57344&c.flags){a.msg="unknown header flags set",c.mode=16209;break}c.head&&(c.head.text=A>>8&1),512&c.flags&&4&c.wrap&&(U[0]=255&A,U[1]=A>>>8&255,c.check=g(c.check,U,2,0)),A=0,B=0,c.mode=16182;case 16182:for(;B<32;){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}c.head&&(c.head.time=A),512&c.flags&&4&c.wrap&&(U[0]=255&A,U[1]=A>>>8&255,U[2]=A>>>16&255,U[3]=A>>>24&255,c.check=g(c.check,U,4,0)),A=0,B=0,c.mode=16183;case 16183:for(;B<16;){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}c.head&&(c.head.xflags=255&A,c.head.os=A>>8),512&c.flags&&4&c.wrap&&(U[0]=255&A,U[1]=A>>>8&255,c.check=g(c.check,U,2,0)),A=0,B=0,c.mode=16184;case 16184:if(1024&c.flags){for(;B<16;){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}c.length=A,c.head&&(c.head.extra_len=A),512&c.flags&&4&c.wrap&&(U[0]=255&A,U[1]=A>>>8&255,c.check=g(c.check,U,2,0)),A=0,B=0}else c.head&&(c.head.extra=null);c.mode=16185;case 16185:if(1024&c.flags&&((G=c.length)>y&&(G=y),G&&(c.head&&(P=c.head.extra_len-c.length,c.head.extra||(c.head.extra=new Uint8Array(c.head.extra_len)),c.head.extra.set(d.subarray(v,v+G),P)),512&c.flags&&4&c.wrap&&(c.check=g(c.check,d,G,v)),y-=G,v+=G,c.length-=G),c.length))break c;c.length=0,c.mode=16186;case 16186:if(2048&c.flags){if(0===y)break c;G=0;do P=d[v+G++],c.head&&P&&c.length<65536&&(c.head.name+=String.fromCharCode(P));while(P&&G<y)if(512&c.flags&&4&c.wrap&&(c.check=g(c.check,d,G,v)),y-=G,v+=G,P)break c}else c.head&&(c.head.name=null);c.length=0,c.mode=16187;case 16187:if(4096&c.flags){if(0===y)break c;G=0;do P=d[v+G++],c.head&&P&&c.length<65536&&(c.head.comment+=String.fromCharCode(P));while(P&&G<y)if(512&c.flags&&4&c.wrap&&(c.check=g(c.check,d,G,v)),y-=G,v+=G,P)break c}else c.head&&(c.head.comment=null);c.mode=16188;case 16188:if(512&c.flags){for(;B<16;){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}if(4&c.wrap&&A!==(65535&c.check)){a.msg="header crc mismatch",c.mode=16209;break}A=0,B=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0),a.adler=c.check=0,c.mode=16191;break;case 16189:for(;B<32;){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}a.adler=c.check=u(A),A=0,B=0,c.mode=16190;case 16190:if(0===c.havedict)return a.next_out=x,a.avail_out=z,a.next_in=v,a.avail_in=y,c.hold=A,c.bits=B,o;a.adler=c.check=1,c.mode=16191;case 16191:if(b===k||b===l)break c;case 16192:if(c.last){A>>>=7&B,B-=7&B,c.mode=16206;break}for(;B<3;){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}switch(c.last=1&A,B-=1,3&(A>>>=1)){case 0:c.mode=16193;break;case 1:if(C(c),c.mode=16199,b===l){A>>>=2,B-=2;break c}break;case 2:c.mode=16196;break;case 3:a.msg="invalid block type",c.mode=16209}A>>>=2,B-=2;break;case 16193:for(A>>>=7&B,B-=7&B;B<32;){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}if((65535&A)!=(A>>>16^65535)){a.msg="invalid stored block lengths",c.mode=16209;break}if(c.length=65535&A,A=0,B=0,c.mode=16194,b===l)break c;case 16194:c.mode=16195;case 16195:if(G=c.length){if(G>y&&(G=y),G>z&&(G=z),0===G)break c;e.set(d.subarray(v,v+G),x),y-=G,v+=G,z-=G,x+=G,c.length-=G;break}c.mode=16191;break;case 16196:for(;B<14;){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}if(c.nlen=(31&A)+257,B-=5,c.ndist=(31&(A>>>=5))+1,B-=5,c.ncode=(15&(A>>>=5))+4,A>>>=4,B-=4,c.nlen>286||c.ndist>30){a.msg="too many length or distance symbols",c.mode=16209;break}c.have=0,c.mode=16197;case 16197:for(;c.have<c.ncode;){for(;B<3;){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}c.lens[V[c.have++]]=7&A,A>>>=3,B-=3}for(;c.have<19;)c.lens[V[c.have++]]=0;if(c.lencode=c.lendyn,c.lenbits=7,R={bits:c.lenbits},Q=i(0,c.lens,0,19,c.lencode,0,c.work,R),c.lenbits=R.bits,Q){a.msg="invalid code lengths set",c.mode=16209;break}c.have=0,c.mode=16198;case 16198:for(;c.have<c.nlen+c.ndist;){for(;J=(T=c.lencode[A&(1<<c.lenbits)-1])>>>24,K=T>>>16&255,L=65535&T,!(J<=B);){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}if(L<16)A>>>=J,B-=J,c.lens[c.have++]=L;else{if(16===L){for(S=J+2;B<S;){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}if(A>>>=J,B-=J,0===c.have){a.msg="invalid bit length repeat",c.mode=16209;break}P=c.lens[c.have-1],G=3+(3&A),A>>>=2,B-=2}else if(17===L){for(S=J+3;B<S;){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}A>>>=J,B-=J,P=0,G=3+(7&A),A>>>=3,B-=3}else{for(S=J+7;B<S;){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}A>>>=J,B-=J,P=0,G=11+(127&A),A>>>=7,B-=7}if(c.have+G>c.nlen+c.ndist){a.msg="invalid bit length repeat",c.mode=16209;break}for(;G--;)c.lens[c.have++]=P}}if(16209===c.mode)break;if(0===c.lens[256]){a.msg="invalid code -- missing end-of-block",c.mode=16209;break}if(c.lenbits=9,R={bits:c.lenbits},Q=i(1,c.lens,0,c.nlen,c.lencode,0,c.work,R),c.lenbits=R.bits,Q){a.msg="invalid literal/lengths set",c.mode=16209;break}if(c.distbits=6,c.distcode=c.distdyn,R={bits:c.distbits},Q=i(2,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,R),c.distbits=R.bits,Q){a.msg="invalid distances set",c.mode=16209;break}if(c.mode=16199,b===l)break c;case 16199:c.mode=16200;case 16200:if(y>=6&&z>=258){a.next_out=x,a.avail_out=z,a.next_in=v,a.avail_in=y,c.hold=A,c.bits=B,h(a,F),x=a.next_out,e=a.output,z=a.avail_out,v=a.next_in,d=a.input,y=a.avail_in,A=c.hold,B=c.bits,16191===c.mode&&(c.back=-1);break}for(c.back=0;J=(T=c.lencode[A&(1<<c.lenbits)-1])>>>24,K=T>>>16&255,L=65535&T,!(J<=B);){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}if(K&&(240&K)==0){for(M=J,N=K,O=L;J=(T=c.lencode[O+((A&(1<<M+N)-1)>>M)])>>>24,K=T>>>16&255,L=65535&T,!(M+J<=B);){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}A>>>=M,B-=M,c.back+=M}if(A>>>=J,B-=J,c.back+=J,c.length=L,0===K){c.mode=16205;break}if(32&K){c.back=-1,c.mode=16191;break}if(64&K){a.msg="invalid literal/length code",c.mode=16209;break}c.extra=15&K,c.mode=16201;case 16201:if(c.extra){for(S=c.extra;B<S;){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}c.length+=A&(1<<c.extra)-1,A>>>=c.extra,B-=c.extra,c.back+=c.extra}c.was=c.length,c.mode=16202;case 16202:for(;J=(T=c.distcode[A&(1<<c.distbits)-1])>>>24,K=T>>>16&255,L=65535&T,!(J<=B);){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}if((240&K)==0){for(M=J,N=K,O=L;J=(T=c.distcode[O+((A&(1<<M+N)-1)>>M)])>>>24,K=T>>>16&255,L=65535&T,!(M+J<=B);){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}A>>>=M,B-=M,c.back+=M}if(A>>>=J,B-=J,c.back+=J,64&K){a.msg="invalid distance code",c.mode=16209;break}c.offset=L,c.extra=15&K,c.mode=16203;case 16203:if(c.extra){for(S=c.extra;B<S;){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}c.offset+=A&(1<<c.extra)-1,A>>>=c.extra,B-=c.extra,c.back+=c.extra}if(c.offset>c.dmax){a.msg="invalid distance too far back",c.mode=16209;break}c.mode=16204;case 16204:if(0===z)break c;if(G=F-z,c.offset>G){if((G=c.offset-G)>c.whave&&c.sane){a.msg="invalid distance too far back",c.mode=16209;break}G>c.wnext?(G-=c.wnext,H=c.wsize-G):H=c.wnext-G,G>c.length&&(G=c.length),I=c.window}else I=e,H=x-c.offset,G=c.length;G>z&&(G=z),z-=G,c.length-=G;do e[x++]=I[H++];while(--G)0===c.length&&(c.mode=16200);break;case 16205:if(0===z)break c;e[x++]=c.length,z--,c.mode=16200;break;case 16206:if(c.wrap){for(;B<32;){if(0===y)break c;y--,A|=d[v++]<<B,B+=8}if(F-=z,a.total_out+=F,c.total+=F,4&c.wrap&&F&&(a.adler=c.check=c.flags?g(c.check,e,F,x-F):f(c.check,e,F,x-F)),F=z,4&c.wrap&&(c.flags?A:u(A))!==c.check){a.msg="incorrect data check",c.mode=16209;break}A=0,B=0}c.mode=16207;case 16207:if(c.wrap&&c.flags){for(;B<32;){if(0===y)break c;y--,A+=d[v++]<<B,B+=8}if(4&c.wrap&&A!==(0|c.total)){a.msg="incorrect length check",c.mode=16209;break}A=0,B=0}c.mode=16208;case 16208:Q=n;break c;case 16209:Q=q;break c;case 16210:return r;default:return p}return a.next_out=x,a.avail_out=z,a.next_in=v,a.avail_in=y,c.hold=A,c.bits=B,(c.wsize||F!==a.avail_out&&c.mode<16209&&(c.mode<16206||b!==j))&&D(a,a.output,a.next_out,F-a.avail_out),E-=a.avail_in,F-=a.avail_out,a.total_in+=E,a.total_out+=F,c.total+=F,4&c.wrap&&F&&(a.adler=c.check=c.flags?g(c.check,e,F,a.next_out-F):f(c.check,e,F,a.next_out-F)),a.data_type=c.bits+64*!!c.last+128*(16191===c.mode)+256*(16199===c.mode||16194===c.mode),(0===E&&0===F||b===j)&&Q===m&&(Q=s),Q},b.exports.inflateEnd=a=>{if(w(a))return p;let b=a.state;return b.window&&(b.window=null),a.state=null,m},b.exports.inflateGetHeader=(a,b)=>{if(w(a))return p;let c=a.state;return(2&c.wrap)==0?p:(c.head=b,b.done=!1,m)},b.exports.inflateSetDictionary=(a,b)=>{let c,d=b.length;return w(a)||0!==(c=a.state).wrap&&16190!==c.mode?p:16190===c.mode&&f(1,b,d,0)!==c.check?q:D(a,b,d,d)?(c.mode=16210,r):(c.havedict=1,m)},b.exports.inflateInfo="pako inflate (from Nodeca project)"},298152,(a,b,c)=>{"use strict";b.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},409637,(a,b,c)=>{"use strict";let d=a.r(350026),e=a.r(680837),f=a.r(785455),g=a.r(793404),h=a.r(381481),i=a.r(298152),j=Object.prototype.toString,{Z_NO_FLUSH:k,Z_FINISH:l,Z_OK:m,Z_STREAM_END:n,Z_NEED_DICT:o,Z_STREAM_ERROR:p,Z_DATA_ERROR:q,Z_MEM_ERROR:r}=a.r(173414);function s(a){this.options=e.assign({chunkSize:65536,windowBits:15,to:""},a||{});let b=this.options;b.raw&&b.windowBits>=0&&b.windowBits<16&&(b.windowBits=-b.windowBits,0===b.windowBits&&(b.windowBits=-15)),b.windowBits>=0&&b.windowBits<16&&!(a&&a.windowBits)&&(b.windowBits+=32),b.windowBits>15&&b.windowBits<48&&(15&b.windowBits)==0&&(b.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;let c=d.inflateInit2(this.strm,b.windowBits);if(c!==m||(this.header=new i,d.inflateGetHeader(this.strm,this.header),b.dictionary&&("string"==typeof b.dictionary?b.dictionary=f.string2buf(b.dictionary):"[object ArrayBuffer]"===j.call(b.dictionary)&&(b.dictionary=new Uint8Array(b.dictionary)),b.raw)&&(c=d.inflateSetDictionary(this.strm,b.dictionary))!==m))throw Error(g[c])}function t(a,b){let c=new s(b);if(c.push(a),c.err)throw c.msg||g[c.err];return c.result}s.prototype.push=function(a,b){let c,e,g,h=this.strm,i=this.options.chunkSize,s=this.options.dictionary;if(this.ended)return!1;for(e=b===~~b?b:!0===b?l:k,"[object ArrayBuffer]"===j.call(a)?h.input=new Uint8Array(a):h.input=a,h.next_in=0,h.avail_in=h.input.length;;){for(0===h.avail_out&&(h.output=new Uint8Array(i),h.next_out=0,h.avail_out=i),(c=d.inflate(h,e))===o&&s&&((c=d.inflateSetDictionary(h,s))===m?c=d.inflate(h,e):c===q&&(c=o));h.avail_in>0&&c===n&&h.state.wrap>0&&0!==a[h.next_in];)d.inflateReset(h),c=d.inflate(h,e);switch(c){case p:case q:case o:case r:return this.onEnd(c),this.ended=!0,!1}if(g=h.avail_out,h.next_out&&(0===h.avail_out||c===n))if("string"===this.options.to){let a=f.utf8border(h.output,h.next_out),b=h.next_out-a,c=f.buf2string(h.output,a);h.next_out=b,h.avail_out=i-b,b&&h.output.set(h.output.subarray(a,a+b),0),this.onData(c)}else this.onData(h.output.length===h.next_out?h.output:h.output.subarray(0,h.next_out));if(c!==m||0!==g){if(c===n)return c=d.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,!0;if(0===h.avail_in)break}}return!0},s.prototype.onData=function(a){this.chunks.push(a)},s.prototype.onEnd=function(a){a===m&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=e.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg},b.exports.Inflate=s,b.exports.inflate=t,b.exports.inflateRaw=function(a,b){return(b=b||{}).raw=!0,t(a,b)},b.exports.ungzip=t,b.exports.constants=a.r(173414)},375779,(a,b,c)=>{"use strict";let{Deflate:d,deflate:e,deflateRaw:f,gzip:g}=a.r(388069),{Inflate:h,inflate:i,inflateRaw:j,ungzip:k}=a.r(409637),l=a.r(173414);b.exports.Deflate=d,b.exports.deflate=e,b.exports.deflateRaw=f,b.exports.gzip=g,b.exports.Inflate=h,b.exports.inflate=i,b.exports.inflateRaw=j,b.exports.ungzip=k,b.exports.constants=l},136551,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.expand_message_xmd=i,c.expand_message_xof=j,c.hash_to_field=k,c.isogenyMap=function(a,b){let c=b.map(a=>Array.from(a).reverse());return(b,d)=>{let[e,f,g,h]=c.map(c=>c.reduce((c,d)=>a.add(a.mul(c,b),d)));return b=a.div(e,f),d=a.mul(d,a.div(g,h)),{x:b,y:d}}},c.createHasher=function(a,b,c){if("function"!=typeof b)throw Error("mapToCurve() must be defined");return{hashToCurve(d,e){let f=k(d,2,{...c,DST:c.DST,...e}),g=a.fromAffine(b(f[0])),h=a.fromAffine(b(f[1])),i=g.add(h).clearCofactor();return i.assertValidity(),i},encodeToCurve(d,e){let f=k(d,1,{...c,DST:c.encodeDST,...e}),g=a.fromAffine(b(f[0])).clearCofactor();return g.assertValidity(),g},mapToCurve(c){if(!Array.isArray(c))throw Error("mapToCurve: expected array of bigints");for(let a of c)if("bigint"!=typeof a)throw Error("mapToCurve: expected array of bigints");let d=a.fromAffine(b(c)).clearCofactor();return d.assertValidity(),d}}};let d=a.r(123319),e=a.r(246367),f=e.bytesToNumberBE;function g(a,b){if(h(a),h(b),a<0||a>=1<<8*b)throw Error("invalid I2OSP input: "+a);let c=Array.from({length:b}).fill(0);for(let d=b-1;d>=0;d--)c[d]=255&a,a>>>=8;return new Uint8Array(c)}function h(a){if(!Number.isSafeInteger(a))throw Error("number expected")}function i(a,b,c,d){(0,e.abytes)(a),(0,e.abytes)(b),h(c),b.length>255&&(b=d((0,e.concatBytes)((0,e.utf8ToBytes)("H2C-OVERSIZE-DST-"),b)));let{outputLen:f,blockLen:i}=d,j=Math.ceil(c/f);if(c>65535||j>255)throw Error("expand_message_xmd: invalid lenInBytes");let k=(0,e.concatBytes)(b,g(b.length,1)),l=g(0,i),m=g(c,2),n=Array(j),o=d((0,e.concatBytes)(l,a,m,g(0,1),k));n[0]=d((0,e.concatBytes)(o,g(1,1),k));for(let a=1;a<=j;a++){let b=[function(a,b){let c=new Uint8Array(a.length);for(let d=0;d<a.length;d++)c[d]=a[d]^b[d];return c}(o,n[a-1]),g(a+1,1),k];n[a]=d((0,e.concatBytes)(...b))}return(0,e.concatBytes)(...n).slice(0,c)}function j(a,b,c,d,f){if((0,e.abytes)(a),(0,e.abytes)(b),h(c),b.length>255){let a=Math.ceil(2*d/8);b=f.create({dkLen:a}).update((0,e.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(b).digest()}if(c>65535||b.length>255)throw Error("expand_message_xof: invalid lenInBytes");return f.create({dkLen:c}).update(a).update(g(c,2)).update(b).update(g(b.length,1)).digest()}function k(a,b,c){let g;(0,e.validateObject)(c,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:k,k:l,m,hash:n,expand:o,DST:p}=c;(0,e.abytes)(a),h(b);let q="string"==typeof p?(0,e.utf8ToBytes)(p):p,r=Math.ceil((k.toString(2).length+l)/8),s=b*m*r;if("xmd"===o)g=i(a,q,s,n);else if("xof"===o)g=j(a,q,s,l,n);else if("_internal_pass"===o)g=a;else throw Error('expand must be "xmd" or "xof"');let t=Array(b);for(let a=0;a<b;a++){let b=Array(m);for(let c=0;c<m;c++){let e=r*(c+a*m),h=g.subarray(e,e+r);b[c]=(0,d.mod)(f(h),k)}t[a]=b}return t}},645723,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.encodeToCurve=c.hashToCurve=c.schnorr=c.secp256k1=void 0;let d=a.r(765288),e=a.r(428454),f=a.r(887782),g=a.r(136551),h=a.r(123319),i=a.r(246367),j=a.r(642585),k=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),l=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),m=BigInt(1),n=BigInt(2),o=(a,b)=>(a+b/n)/b;function p(a){let b=BigInt(3),c=BigInt(6),d=BigInt(11),e=BigInt(22),f=BigInt(23),g=BigInt(44),i=BigInt(88),j=a*a*a%k,l=j*j*a%k,m=(0,h.pow2)(l,b,k)*l%k,o=(0,h.pow2)(m,b,k)*l%k,p=(0,h.pow2)(o,n,k)*j%k,r=(0,h.pow2)(p,d,k)*p%k,s=(0,h.pow2)(r,e,k)*r%k,t=(0,h.pow2)(s,g,k)*s%k,u=(0,h.pow2)(t,i,k)*t%k,v=(0,h.pow2)(u,g,k)*s%k,w=(0,h.pow2)(v,b,k)*l%k,x=(0,h.pow2)(w,f,k)*r%k,y=(0,h.pow2)(x,c,k)*j%k,z=(0,h.pow2)(y,n,k);if(!q.eql(q.sqr(z),a))throw Error("Cannot find square root");return z}let q=(0,h.Field)(k,void 0,void 0,{sqrt:p});c.secp256k1=(0,f.createCurve)({a:BigInt(0),b:BigInt(7),Fp:q,n:l,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:a=>{let b=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),c=-m*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),d=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),e=BigInt("0x100000000000000000000000000000000"),f=o(b*a,l),g=o(-c*a,l),i=(0,h.mod)(a-f*b-g*d,l),j=(0,h.mod)(-f*c-g*b,l),k=i>e,n=j>e;if(k&&(i=l-i),n&&(j=l-j),i>e||j>e)throw Error("splitScalar: Endomorphism failed, k="+a);return{k1neg:k,k1:i,k2neg:n,k2:j}}}},d.sha256);let r=BigInt(0),s={};function t(a,...b){let c=s[a];if(void 0===c){let b=(0,d.sha256)(Uint8Array.from(a,a=>a.charCodeAt(0)));c=(0,i.concatBytes)(b,b),s[a]=c}return(0,d.sha256)((0,i.concatBytes)(c,...b))}let u=a=>a.toRawBytes(!0).slice(1),v=a=>(0,i.numberToBytesBE)(a,32),w=a=>(0,h.mod)(a,k),x=a=>(0,h.mod)(a,l),y=c.secp256k1.ProjectivePoint;function z(a){let b=c.secp256k1.utils.normPrivateKeyToScalar(a),d=y.fromPrivateKey(b);return{scalar:d.hasEvenY()?b:x(-b),bytes:u(d)}}function A(a){(0,i.aInRange)("x",a,m,k);let b=w(a*a),c=p(w(b*a+BigInt(7)));c%n!==r&&(c=w(-c));let d=new y(a,c,m);return d.assertValidity(),d}let B=i.bytesToNumberBE;function C(...a){return x(B(t("BIP0340/challenge",...a)))}function D(a,b,c){let d=(0,i.ensureBytes)("signature",a,64),e=(0,i.ensureBytes)("message",b),f=(0,i.ensureBytes)("publicKey",c,32);try{let a,b=A(B(f)),c=B(d.subarray(0,32));if(!(0,i.inRange)(c,m,k))return!1;let g=B(d.subarray(32,64));if(!(0,i.inRange)(g,m,l))return!1;let h=C(v(c),u(b),e),j=(a=x(-h),y.BASE.multiplyAndAddUnsafe(b,g,a));if(!j||!j.hasEvenY()||j.toAffine().x!==c)return!1;return!0}catch(a){return!1}}c.schnorr={getPublicKey:function(a){return z(a).bytes},sign:function(a,b,c=(0,e.randomBytes)(32)){let d=(0,i.ensureBytes)("message",a),{bytes:f,scalar:g}=z(b),h=v(g^B(t("BIP0340/aux",(0,i.ensureBytes)("auxRand",c,32)))),j=x(B(t("BIP0340/nonce",h,f,d)));if(j===r)throw Error("sign failed: k is zero");let{bytes:k,scalar:l}=z(j),m=C(k,f,d),n=new Uint8Array(64);if(n.set(k,0),n.set(v(x(l+m*g)),32),!D(n,d,f))throw Error("sign: Invalid signature produced");return n},verify:D,utils:{randomPrivateKey:c.secp256k1.utils.randomPrivateKey,lift_x:A,pointToBytes:u,numberToBytesBE:i.numberToBytesBE,bytesToNumberBE:i.bytesToNumberBE,taggedHash:t,mod:h.mod}};let E=(0,g.isogenyMap)(q,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(a=>a.map(a=>BigInt(a)))),F=(0,j.mapToCurveSimpleSWU)(q,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:q.create(BigInt("-11"))}),G=(0,g.createHasher)(c.secp256k1.ProjectivePoint,a=>{let{x:b,y:c}=F(q.create(a[0]));return E(b,c)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:q.ORDER,m:1,k:128,expand:"xmd",hash:d.sha256});c.hashToCurve=G.hashToCurve,c.encodeToCurve=G.encodeToCurve},877475,(a,b,c)=>{"use strict";var d=Object.create,e=Object.defineProperty,f=Object.getOwnPropertyDescriptor,g=Object.getOwnPropertyNames,h=Object.getPrototypeOf,i=Object.prototype.hasOwnProperty,j=(a,b)=>{for(var c in b)e(a,c,{get:b[c],enumerable:!0})},k=(a,b,c,d)=>{if(b&&"object"==typeof b||"function"==typeof b)for(let h of g(b))i.call(a,h)||h===c||e(a,h,{get:()=>b[h],enumerable:!(d=f(b,h))||d.enumerable});return a},l=(a,b,c)=>(c=null!=a?d(h(a)):{},k(!b&&a&&a.__esModule?c:e(c,"default",{value:a,enumerable:!0}),a)),m={};j(m,{Account:()=>ga,AccountInterface:()=>gb,BatchClient:()=>aT,BlockStatus:()=>as,BlockTag:()=>at,CairoCustomEnum:()=>cq,CairoFixedArray:()=>cC,CairoOption:()=>cs,CairoOptionVariant:()=>cr,CairoResult:()=>cu,CairoResultVariant:()=>ct,CairoUint256:()=>bV,CairoUint512:()=>bZ,CallData:()=>cR,Contract:()=>gu,ContractFactory:()=>gw,ContractInterface:()=>gv,EDAMode:()=>az,EDataAvailabilityMode:()=>ay,ETH_ADDRESS:()=>aH,ETransactionExecutionStatus:()=>aD,ETransactionStatus:()=>aC,ETransactionVersion:()=>av,ETransactionVersion2:()=>aw,ETransactionVersion3:()=>ax,EntryPointType:()=>ao,EthSigner:()=>fB,LedgerSigner:()=>fC,LedgerSigner111:()=>fC,LedgerSigner221:()=>fJ,LedgerSigner231:()=>fL,LibraryError:()=>d7,Literal:()=>aG,LogLevelIndex:()=>ak,NON_ZERO_PREFIX:()=>aI,OutsideExecutionTypesV1:()=>aJ,OutsideExecutionTypesV2:()=>aK,OutsideExecutionVersion:()=>aL,PaymasterInterface:()=>f8,PaymasterRpc:()=>f7,Provider:()=>fr,ProviderInterface:()=>fs,RPC:()=>o,RPC07:()=>am,RPC08:()=>ey,RPCResponseParser:()=>eF,ReceiptTx:()=>eG,ResponseParser:()=>gx,RpcChannel:()=>eA,RpcError:()=>d8,RpcProvider:()=>fr,Signer:()=>fv,SignerInterface:()=>fu,Subscription:()=>eD,TimeoutError:()=>d9,TransactionExecutionStatus:()=>ar,TransactionFinalityStatus:()=>aq,TransactionType:()=>ap,TypedDataRevision:()=>aM.TypedDataRevision,UINT_128_MAX:()=>bO,UINT_128_MIN:()=>bY,UINT_256_HIGH_MAX:()=>bS,UINT_256_HIGH_MIN:()=>bU,UINT_256_LOW_MAX:()=>bR,UINT_256_LOW_MIN:()=>bT,UINT_256_MAX:()=>bP,UINT_256_MIN:()=>bQ,UINT_512_MAX:()=>bW,UINT_512_MIN:()=>bX,Uint:()=>aF,ValidateType:()=>aE,WalletAccount:()=>gq,WebSocketChannel:()=>eE,WebSocketNotConnectedError:()=>ea,addAddressPadding:()=>fF,byteArray:()=>bJ,cairo:()=>bM,config:()=>aj,constants:()=>n,contractClassResponseToLegacyCompiledContract:()=>d4,defaultPaymaster:()=>f9,defaultProvider:()=>ft,ec:()=>cV,encode:()=>t,eth:()=>eb,events:()=>fM,extractContractHashes:()=>d3,getCalldata:()=>gt,getChecksumAddress:()=>fH,getLedgerPathBuffer:()=>fD,getLedgerPathBuffer111:()=>fD,getLedgerPathBuffer221:()=>fK,hash:()=>cS,isPendingBlock:()=>dM,isPendingStateUpdate:()=>dO,isPendingTransaction:()=>dN,isRPC08_FeeEstimate:()=>aA,isRPC08_ResourceBounds:()=>aB,isSierra:()=>d2,isSupportedSpecVersion:()=>dJ,isV3Tx:()=>dH,isVersion:()=>dI,json:()=>aN,logger:()=>al,merkle:()=>eI,num:()=>aW,outsideExecution:()=>fR,parseCalldataField:()=>cF,paymaster:()=>f_,provider:()=>eg,selector:()=>bo,shortString:()=>bz,src5:()=>fZ,stark:()=>dE,starknetId:()=>e0,toAnyPatchVersion:()=>dK,toApiVersion:()=>dL,transaction:()=>ep,typedData:()=>eH,types:()=>an,uint256:()=>fx,units:()=>gy,v2hash:()=>cU,v3hash:()=>c2,validateAndParseAddress:()=>fG,validateChecksumAddress:()=>fI,wallet:()=>gc}),b.exports=k(e({},"__esModule",{value:!0}),m);var n={};j(n,{ADDR_BOUND:()=>R,API_VERSION:()=>O,BaseUrl:()=>aa,DEFAULT_GLOBAL_CONFIG:()=>af,HARDENING_4BYTES:()=>_,HARDENING_BYTE:()=>$,IS_BROWSER:()=>v,MASK_250:()=>M,MASK_31:()=>N,MAX_STORAGE_ITEM_SIZE:()=>Q,NetworkName:()=>ab,OutsideExecutionCallerAny:()=>X,PAYMASTER_RPC_NODES:()=>ah,PRIME:()=>P,RANGE_FELT:()=>T,RANGE_I128:()=>U,RANGE_U128:()=>V,RPC_DEFAULT_NODES:()=>ag,SNIP9_V1_INTERFACE_ID:()=>Y,SNIP9_V2_INTERFACE_ID:()=>Z,SYSTEM_MESSAGES:()=>ai,StarknetChainId:()=>ac,SupportedRpcVersion:()=>ae,TEXT_TO_FELT_MAX_LEN:()=>J,TRANSACTION_VERSION:()=>K,TransactionHashPrefix:()=>ad,UDC:()=>W,ZERO:()=>L});var o={};j(o,{JRPC:()=>p,PAYMASTER_API:()=>s.PAYMASTER_API,RPCSPEC07:()=>q,RPCSPEC08:()=>r});var p={},q=l(a.r(356569)),r=l(a.r(895831)),s=a.r(895831);((a,b,c)=>(k(a,b,"default"),c&&k(c,b,"default")))(o,a.r(895831));var t={};j(t,{IS_BROWSER:()=>v,addHexPrefix:()=>C,arrayBufferToString:()=>w,atobUniversal:()=>y,btoaUniversal:()=>z,buf2hex:()=>A,calcByteLength:()=>E,concatenateArrayBuffer:()=>I,padLeft:()=>D,pascalToSnake:()=>H,removeHexPrefix:()=>B,sanitizeBytes:()=>F,sanitizeHex:()=>G,utf8ToArray:()=>x});var u=a.r(330320),v=!1;function w(a){return new Uint8Array(a).reduce((a,b)=>a+String.fromCharCode(b),"")}function x(a){return new TextEncoder().encode(a)}function y(a){return u.base64.decode(a)}function z(a){return u.base64.encode(new Uint8Array(a))}function A(a){return a.reduce((a,b)=>a+b.toString(16).padStart(2,"0"),"")}function B(a){return a.replace(/^0x/i,"")}function C(a){return`0x${B(a)}`}function D(a,b,c="0"){return function(a,b,c,d="0"){let e=b-a.length,f=a;if(e>0){let b=d.repeat(e);f=c?b+a:a+b}return f}(a,b,!0,c)}function E(a,b=8){let{length:c}=a,d=c%b;return d?(c-d)/b*b+b:c}function F(a,b=8,c="0"){return D(a,E(a,b),c)}function G(a){let b=F(B(a),2);return b?C(b):b}var H=a=>/[a-z]/.test(a)?a.split(/(?=[A-Z])/).join("_").toUpperCase():a;function I(a){let b=new Uint8Array(a.reduce((a,b)=>a+b.byteLength,0)),c=0;return a.forEach(a=>{b.set(a,c),c+=a.byteLength}),b}var J=31,{ETransactionVersion:K}=r,L=0n,M=2n**250n-1n,N=2n**31n-1n,O=L,P=2n**251n+17n*2n**192n+1n,Q=256n,R=2n**251n-Q,S=(a,b)=>({min:a,max:b}),T=S(L,P-1n),U=S(-(2n**127n),2n**127n-1n),V=S(L,2n**128n-1n),W={ADDRESS:"0x041a78e741e5af2fec34b695679bc6891742439f7afb8484ecd7766661ad02bf",ENTRYPOINT:"deployContract"},X="0x414e595f43414c4c4552",Y="0x68cfd18b92d1907b8ba3cc324900277f5a3622099431ea85dd8089255e4181",Z="0x1d1144bb2138366ff28d8e9ab57456b1d332ac42196230c3a602003c89872",$=128,_=2147483648n,aa={SN_MAIN:"https://alpha-mainnet.starknet.io",SN_SEPOLIA:"https://alpha-sepolia.starknet.io"},ab={SN_MAIN:"SN_MAIN",SN_SEPOLIA:"SN_SEPOLIA"},ac={SN_MAIN:"0x534e5f4d41494e",SN_SEPOLIA:"0x534e5f5345504f4c4941"},ad={DECLARE:"0x6465636c617265",DEPLOY:"0x6465706c6f79",DEPLOY_ACCOUNT:"0x6465706c6f795f6163636f756e74",INVOKE:"0x696e766f6b65",L1_HANDLER:"0x6c315f68616e646c6572"},ae={"0.7.1":"0.7.1","0.8.1":"0.8.1",v0_7_1:"0.7.1",v0_8_1:"0.8.1"},af={legacyMode:!1,rpcVersion:"0.8.1",transactionVersion:o.ETransactionVersion.V3,logLevel:"INFO",feeMarginPercentage:{bounds:{l1_gas:{max_amount:50,max_price_per_unit:50},l1_data_gas:{max_amount:50,max_price_per_unit:50},l2_gas:{max_amount:50,max_price_per_unit:50}},maxFee:50},fetch:void 0,websocket:void 0},ag={SN_MAIN:["https://starknet-mainnet.public.blastapi.io/rpc/"],SN_SEPOLIA:["https://starknet-sepolia.public.blastapi.io/rpc/"]},ah={SN_MAIN:["https://starknet.paymaster.avnu.fi"],SN_SEPOLIA:["https://sepolia.paymaster.avnu.fi"]},ai={legacyTxWarningMessage:"You are using a deprecated transaction version (V0,V1,V2)!\nUpdate to the latest V3 transactions!",legacyTxRPC08Message:"RPC 0.8 do not support legacy transactions",SWOldV3:"RPC 0.7 V3 tx (improper resource bounds) not supported in RPC 0.8",channelVersionMismatch:"Channel specification version is not compatible with the connected node Specification Version",unsupportedSpecVersion:"The connected node specification version is not supported by this library",maxFeeInV3:"maxFee is not supported in V3 transactions, use resourceBounds instead"},aj=(class a{static instance;config;constructor(){this.initialize()}initialize(){this.config={...af}}static getInstance(){return a.instance||(a.instance=new a),a.instance}get(a,b){return this.config[a]??b}set(a,b){this.config[a]=b}update(a){this.config={...this.config,...a}}getAll(){return{...this.config}}reset(){this.initialize()}delete(a){delete this.config[a]}hasKey(a){return a in this.config}}).getInstance(),ak={DEBUG:5,INFO:4,WARN:3,ERROR:2,FATAL:1,OFF:0},al=(class a{static instance;config;constructor(){this.config=aj}static getInstance(){return a.instance||(a.instance=new a),a.instance}getTimestamp(){return new Date().toISOString()}shouldLog(a){return a<=ak[this.config.get("logLevel","INFO")]}formatMessage(a){let{level:b,message:c,timestamp:d,data:e}=a,f=`[${d}] ${b}: ${c}`;if(e)try{f+=`
${JSON.stringify(e,null,2)}`}catch(a){f+=`
[JSON.stringify Error/Circular]: ${a}`}return f}log(a,b,c){if(!this.shouldLog(ak[a]))return;let d={level:a,message:b,timestamp:this.getTimestamp(),data:c},e=this.formatMessage(d);switch(a){case"DEBUG":console.debug(e);break;case"INFO":console.info(e);break;case"WARN":console.warn(e);break;case"ERROR":case"FATAL":console.error(e);break;case"OFF":break;default:console.log(e)}}debug(a,b){this.log("DEBUG",a,b)}info(a,b){this.log("INFO",a,b)}warn(a,b){this.log("WARN",a,b)}error(a,b){this.log("ERROR",a,b)}fatal(a,b){this.log("FATAL",a,b)}setLogLevel(a){this.config.set("logLevel",a)}getLogLevel(){return this.config.get("logLevel","INFO")}getEnabledLogLevels(){return Object.keys(ak).filter(a=>this.shouldLog(ak[a])&&"OFF"!==a)}}).getInstance(),am={};j(am,{RpcChannel:()=>ex});var an={};j(an,{BlockStatus:()=>as,BlockTag:()=>at,EDAMode:()=>az,EDataAvailabilityMode:()=>ay,ETH_ADDRESS:()=>aH,ETransactionExecutionStatus:()=>aD,ETransactionStatus:()=>aC,ETransactionVersion:()=>av,ETransactionVersion2:()=>aw,ETransactionVersion3:()=>ax,EntryPointType:()=>ao,Literal:()=>aG,NON_ZERO_PREFIX:()=>aI,OutsideExecutionTypesV1:()=>aJ,OutsideExecutionTypesV2:()=>aK,OutsideExecutionVersion:()=>aL,RPC:()=>o,TransactionExecutionStatus:()=>ar,TransactionFinalityStatus:()=>aq,TransactionType:()=>ap,TypedDataRevision:()=>aM.TypedDataRevision,Uint:()=>aF,ValidateType:()=>aE,isRPC08_FeeEstimate:()=>aA,isRPC08_ResourceBounds:()=>aB});var ao={EXTERNAL:"EXTERNAL",L1_HANDLER:"L1_HANDLER",CONSTRUCTOR:"CONSTRUCTOR"},ap={DECLARE:"DECLARE",DEPLOY:"DEPLOY",DEPLOY_ACCOUNT:"DEPLOY_ACCOUNT",INVOKE:"INVOKE_FUNCTION"},aq={NOT_RECEIVED:"NOT_RECEIVED",RECEIVED:"RECEIVED",ACCEPTED_ON_L2:"ACCEPTED_ON_L2",ACCEPTED_ON_L1:"ACCEPTED_ON_L1"},ar={REJECTED:"REJECTED",REVERTED:"REVERTED",SUCCEEDED:"SUCCEEDED"},as={PENDING:"PENDING",ACCEPTED_ON_L1:"ACCEPTED_ON_L1",ACCEPTED_ON_L2:"ACCEPTED_ON_L2",REJECTED:"REJECTED"},at={PENDING:"pending",LATEST:"latest"},au=l(a.r(895831)),{ETransactionVersion:av}=au,{ETransactionVersion2:aw}=au,{ETransactionVersion3:ax}=au,{EDataAvailabilityMode:ay}=au,{EDAMode:az}=au;function aA(a){return"l1_data_gas_consumed"in a}function aB(a){return"l1_data_gas"in a}var{ETransactionStatus:aC}=au,{ETransactionExecutionStatus:aD}=au,aE={DEPLOY:"DEPLOY",CALL:"CALL",INVOKE:"INVOKE"},aF={u8:"core::integer::u8",u16:"core::integer::u16",u32:"core::integer::u32",u64:"core::integer::u64",u128:"core::integer::u128",u256:"core::integer::u256",u512:"core::integer::u512"},aG={ClassHash:"core::starknet::class_hash::ClassHash",ContractAddress:"core::starknet::contract_address::ContractAddress",Secp256k1Point:"core::starknet::secp256k1::Secp256k1Point",U96:"core::internal::bounded_int::BoundedInt::<0, 79228162514264337593543950335>"},aH="core::starknet::eth_address::EthAddress",aI="core::zeroable::NonZero::",aJ={StarkNetDomain:[{name:"name",type:"felt"},{name:"version",type:"felt"},{name:"chainId",type:"felt"}],OutsideExecution:[{name:"caller",type:"felt"},{name:"nonce",type:"felt"},{name:"execute_after",type:"felt"},{name:"execute_before",type:"felt"},{name:"calls_len",type:"felt"},{name:"calls",type:"OutsideCall*"}],OutsideCall:[{name:"to",type:"felt"},{name:"selector",type:"felt"},{name:"calldata_len",type:"felt"},{name:"calldata",type:"felt*"}]},aK={StarknetDomain:[{name:"name",type:"shortstring"},{name:"version",type:"shortstring"},{name:"chainId",type:"shortstring"},{name:"revision",type:"shortstring"}],OutsideExecution:[{name:"Caller",type:"ContractAddress"},{name:"Nonce",type:"felt"},{name:"Execute After",type:"u128"},{name:"Execute Before",type:"u128"},{name:"Calls",type:"Call*"}],Call:[{name:"To",type:"ContractAddress"},{name:"Selector",type:"selector"},{name:"Calldata",type:"felt*"}]},aL={UNSUPPORTED:"0",V1:"1",V2:"2"},aM=a.r(356569),aN={};j(aN,{parse:()=>aQ,parseAlwaysAsBig:()=>aR,stringify:()=>aS});var aO=l(a.r(353361)),aP=a=>{if(!aO.isInteger(a))return parseFloat(a);let b=parseInt(a,10);return Number.isSafeInteger(b)?b:BigInt(a)},aQ=a=>aO.parse(String(a),void 0,aP),aR=a=>aO.parse(String(a),void 0,aO.parseNumberAndBigInt),aS=(a,b,c,d)=>aO.stringify(a,b,c,d),aT=class{nodeUrl;headers;interval;requestId=0;pendingRequests={};batchPromises={};delayTimer;delayPromise;delayPromiseResolve;baseFetch;constructor(a){this.nodeUrl=a.nodeUrl,this.headers=a.headers,this.interval=a.interval,this.baseFetch=a.baseFetch}async wait(){return this.delayPromise&&this.delayPromiseResolve||(this.delayPromise=new Promise(a=>{this.delayPromiseResolve=a})),this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=void 0),this.delayTimer=setTimeout(()=>{this.delayPromiseResolve&&(this.delayPromiseResolve(),this.delayPromise=void 0,this.delayPromiseResolve=void 0)},this.interval),this.delayPromise}addPendingRequest(a,b,c){let d={id:c??`batched_${this.requestId+=1}`,jsonrpc:"2.0",method:a,params:b??void 0};return this.pendingRequests[d.id]=d,d.id}async sendBatch(a){return(await this.baseFetch(this.nodeUrl,{method:"POST",body:aS(a),headers:this.headers})).json()}async fetch(a,b,c){let d=this.addPendingRequest(a,b,c);await this.wait();let e=this.pendingRequests;if(this.pendingRequests={},!this.batchPromises[d]){let a=this.sendBatch(Object.values(e));Object.keys(e).forEach(b=>{this.batchPromises[b]=a})}let f=await this.batchPromises[d];delete this.batchPromises[d];let g=f.find(a=>a.id===d);if(!g)throw Error(`Couldn't find the result for the request. Method: ${a}`);return g}};function aU(a,b){if(!a)throw Error(b||"Assertion failure")}function aV(a,b){if(!a)if(0===b.length)b();else throw Error("AssertionX failure: message function should not require arguments")}var aW={};j(aW,{addPercent:()=>bl,assertInRange:()=>bc,bigNumberishArrayToDecimalStringArray:()=>bd,bigNumberishArrayToHexadecimalStringArray:()=>be,cleanHex:()=>bb,getDecimalString:()=>bg,getHexString:()=>bh,getHexStringArray:()=>bi,hexToBytes:()=>bk,hexToDecimalString:()=>ba,isBigNumberish:()=>bn,isHex:()=>a3,isStringWholeNumber:()=>bf,stringToSha256ToArrayBuff4:()=>bm,toBigInt:()=>a4,toCairoBool:()=>bj,toHex:()=>a6,toHex64:()=>a9,toHexString:()=>a7,toStorageKey:()=>a8,tryToBigInt:()=>a5});var aX=a.r(246367),aY=a.r(765288),aZ=a=>void 0===a||void 0===a;function a$(a){return"number"==typeof a}function a_(a){return"boolean"==typeof a}function a0(a){return"bigint"==typeof a}function a1(a){return"string"==typeof a}function a2(a){return!!a&&"object"==typeof a&&!Array.isArray(a)}function a3(a){return/^0x[0-9a-f]*$/i.test(a)}function a4(a){return BigInt(a)}function a5(a){return a?BigInt(a):void 0}function a6(a){return C(a4(a).toString(16))}var a7=a6;function a8(a){return C(a4(a).toString(16).padStart(64,"0"))}function a9(a){let b=C(a4(a).toString(16).padStart(64,"0"));if(66!==b.length)throw TypeError("number is too big for hex 0x(64) representation");return b}function ba(a){return BigInt(C(a)).toString(10)}function bb(a){return a.toLowerCase().replace(/^(0x)0+/,"$1")}function bc(a,b,c,d=""){let e=""===d?"invalid length":`invalid ${d} length`,f=BigInt(a),g=BigInt(b),h=BigInt(c);aU(f>=g&&f<=h,`Message not signable, ${e}.`)}function bd(a){return a.map(a=>a4(a).toString(10))}function be(a){return a.map(a=>a6(a))}function bf(a){return/^\d+$/.test(a)}function bg(a){if(a3(a))return ba(a);if(bf(a))return a;throw Error(`${a} needs to be a hex-string or whole-number-string`)}function bh(a){if(a3(a))return a;if(bf(a))return a7(a);throw Error(`${a} needs to be a hex-string or whole-number-string`)}function bi(a){return a.map(bh)}function bj(a){return(+a).toString()}function bk(a){if(!a3(a))throw Error(`${a} needs to be a hex-string`);let b=B(a);return b.length%2!=0&&(b=`0${b}`),(0,aX.hexToBytes)(b)}function bl(a,b){let c=BigInt(a);return c+c*BigInt(b)/100n}function bm(a){return bk(a6(Number(BigInt(C(A((0,aY.sha256)(a))))&N)))}function bn(a){return a$(a)||a0(a)||a1(a)&&(a3(a)||bf(a))}var bo={};j(bo,{getL1MessageHash:()=>by,getL2MessageHash:()=>bx,getSelector:()=>bv,getSelectorFromName:()=>bu,keccakBn:()=>bs,solidityUint256PackedKeccak256:()=>bw,starknetKeccak:()=>bt});var bp=a.r(677716),bq=a.r(190999),br=a.r(246367);function bs(a){let b=B(a6(BigInt(a))),c=b.length%2==0?b:`0${b}`;return C((0,bp.keccak)(bk(C(c))).toString(16))}function bt(a){return BigInt(C((0,bp.keccak)(x(a)).toString(16)))&M}function bu(a){return a6(bt(a))}function bv(a){return a$(a)||a0(a)?a6(a):a3(a)?a:bf(a)?a6(a):bu(a)}function bw(a){let b=C(a.reduce((a,b)=>a+B(a6(b)).padStart(64,"0"),""));return C((0,br.bytesToHex)((0,bq.keccak_256)(bk(b))))}function bx(a,b,c,d,e){return bw([a,b,e,c,d.length,...d])}function by(a,b,c){return bw([a,b,c.length,...c])}var bz={};function bA(a){return/^[\x00-\x7F]*$/.test(a)}function bB(a){return a.length<=J}function bC(a){return/^[0-9]*$/i.test(a)}function bD(a){return a1(a)&&!a3(a)&&!bf(a)}j(bz,{decodeShortString:()=>bI,encodeShortString:()=>bH,isASCII:()=>bA,isDecimalString:()=>bC,isLongText:()=>bF,isShortString:()=>bB,isShortText:()=>bE,isText:()=>bD,splitLongString:()=>bG});var bE=a=>bD(a)&&bB(a),bF=a=>bD(a)&&!bB(a);function bG(a){let b=RegExp(`[^]{1,${J}}`,"g");return a.match(b)||[]}function bH(a){if(!bA(a))throw Error(`${a} is not an ASCII string`);if(!bB(a))throw Error(`${a} is too long`);return C(a.replace(/./g,a=>a.charCodeAt(0).toString(16)))}function bI(a){if(!bA(a))throw Error(`${a} is not an ASCII string`);if(a3(a))return B(a).replace(/.{2}/g,a=>String.fromCharCode(parseInt(a,16)));if(bC(a))return bI("0X".concat(BigInt(a).toString(16)));throw Error(`${a} is not Hex or decimal`)}var bJ={};function bK(a){let b=0n===BigInt(a.pending_word)?"":bI(a6(a.pending_word));return a.data.reduce((a,b)=>a+(0n===BigInt(b)?"":bI(a6(b))),"")+b}function bL(a){let b=bG(a),c=b[b.length-1],d=b.map(bH),[e,f]=void 0===c||31===c.length?["0x00",0]:[d.pop(),c.length];return{data:0===d.length?[]:d,pending_word:e,pending_word_len:f}}j(bJ,{byteArrayFromString:()=>bL,stringFromByteArray:()=>bK});var bM={};function bN(a){if(a0(a)||Number.isInteger(a))return a.toString();if(a1(a)){if(a3(a))return BigInt(a).toString();if(bD(a)){if(!bB(a))throw Error(`${a} is a long string > 31 chars. Please split it into an array of short strings.`);return BigInt(bH(a)).toString()}if(bf(a))return a}if(a_(a))return`${+a}`;throw Error(`${a} can't be computed by felt()`)}j(bM,{felt:()=>cp,getAbiContractVersion:()=>cl,getArrayType:()=>ci,isCairo1Abi:()=>cj,isCairo1Type:()=>ch,isLen:()=>b$,isTypeArray:()=>b0,isTypeBool:()=>ca,isTypeByteArray:()=>ce,isTypeBytes31:()=>cd,isTypeContractAddress:()=>cb,isTypeEnum:()=>b4,isTypeEthAddress:()=>cc,isTypeFelt:()=>b_,isTypeLiteral:()=>b9,isTypeNamedTuple:()=>b2,isTypeNonZero:()=>ck,isTypeOption:()=>b5,isTypeResult:()=>b6,isTypeSecp256k1Point:()=>cg,isTypeStruct:()=>b3,isTypeTuple:()=>b1,isTypeU96:()=>cf,isTypeUint:()=>b7,isTypeUint256:()=>b8,tuple:()=>co,uint256:()=>cm,uint512:()=>cn});var bO=(1n<<128n)-1n,bP=(1n<<256n)-1n,bQ=0n,bR=0xffffffffffffffffffffffffffffffffn,bS=0xffffffffffffffffffffffffffffffffn,bT=0n,bU=0n,bV=class a{low;high;static abiSelector="core::integer::u256";constructor(...b){if("object"==typeof b[0]&&1===b.length&&"low"in b[0]&&"high"in b[0]){let c=a.validateProps(b[0].low,b[0].high);this.low=c.low,this.high=c.high}else if(1===b.length){let c=a.validate(b[0]);this.low=c&bO,this.high=c>>128n}else if(2===b.length){let c=a.validateProps(b[0],b[1]);this.low=c.low,this.high=c.high}else throw Error("Incorrect constructor parameters")}static validate(a){let b=BigInt(a);if(b<bQ)throw Error("bigNumberish is smaller than UINT_256_MIN");if(b>bP)throw Error("bigNumberish is bigger than UINT_256_MAX");return b}static validateProps(a,b){let c=BigInt(a),d=BigInt(b);if(c<bT||c>bR)throw Error("low is out of range UINT_256_LOW_MIN - UINT_256_LOW_MAX");if(d<bU||d>bS)throw Error("high is out of range UINT_256_HIGH_MIN - UINT_256_HIGH_MAX");return{low:c,high:d}}static is(b){try{a.validate(b)}catch(a){return!1}return!0}static isAbiType(b){return b===a.abiSelector}toBigInt(){return(this.high<<128n)+this.low}toUint256HexString(){return{low:C(this.low.toString(16)),high:C(this.high.toString(16))}}toUint256DecimalString(){return{low:this.low.toString(10),high:this.high.toString(10)}}toApiRequest(){return[bN(this.low),bN(this.high)]}},bW=(1n<<512n)-1n,bX=0n,bY=0n,bZ=class a{limb0;limb1;limb2;limb3;static abiSelector="core::integer::u512";constructor(...b){if("object"==typeof b[0]&&1===b.length&&"limb0"in b[0]&&"limb1"in b[0]&&"limb2"in b[0]&&"limb3"in b[0]){let c=a.validateProps(b[0].limb0,b[0].limb1,b[0].limb2,b[0].limb3);this.limb0=c.limb0,this.limb1=c.limb1,this.limb2=c.limb2,this.limb3=c.limb3}else if(1===b.length){let c=a.validate(b[0]);this.limb0=c&bO,this.limb1=(c&bO<<128n)>>128n,this.limb2=(c&bO<<256n)>>256n,this.limb3=c>>384n}else if(4===b.length){let c=a.validateProps(b[0],b[1],b[2],b[3]);this.limb0=c.limb0,this.limb1=c.limb1,this.limb2=c.limb2,this.limb3=c.limb3}else throw Error("Incorrect Uint512 constructor parameters")}static validate(a){let b=BigInt(a);if(b<bX)throw Error("bigNumberish is smaller than UINT_512_MIN.");if(b>bW)throw Error("bigNumberish is bigger than UINT_512_MAX.");return b}static validateProps(a,b,c,d){let e=BigInt(a),f=BigInt(b),g=BigInt(c),h=BigInt(d);return[e,f,g,h].forEach((a,b)=>{if(a<bY||a>bO)throw Error(`limb${b} is not in the range of a u128 number`)}),{limb0:e,limb1:f,limb2:g,limb3:h}}static is(b){try{a.validate(b)}catch(a){return!1}return!0}static isAbiType(b){return b===a.abiSelector}toBigInt(){return(this.limb3<<384n)+(this.limb2<<256n)+(this.limb1<<128n)+this.limb0}toUint512HexString(){return{limb0:C(this.limb0.toString(16)),limb1:C(this.limb1.toString(16)),limb2:C(this.limb2.toString(16)),limb3:C(this.limb3.toString(16))}}toUint512DecimalString(){return{limb0:this.limb0.toString(10),limb1:this.limb1.toString(10),limb2:this.limb2.toString(10),limb3:this.limb3.toString(10)}}toApiRequest(){return[bN(this.limb0),bN(this.limb1),bN(this.limb2),bN(this.limb3)]}},b$=a=>/_len$/.test(a),b_=a=>"felt"===a||"core::felt252"===a,b0=a=>/\*/.test(a)||a.startsWith("core::array::Array::")||a.startsWith("core::array::Span::"),b1=a=>/^\(.*\)$/i.test(a),b2=a=>/\(.*\)/i.test(a)&&a.includes(":"),b3=(a,b)=>a in b,b4=(a,b)=>a in b,b5=a=>a.startsWith("core::option::Option::"),b6=a=>a.startsWith("core::result::Result::"),b7=a=>Object.values(aF).includes(a),b8=a=>bV.isAbiType(a),b9=a=>Object.values(aG).includes(a),ca=a=>"core::bool"===a,cb=a=>a===aG.ContractAddress,cc=a=>a===aH,cd=a=>"core::bytes_31::bytes31"===a,ce=a=>"core::byte_array::ByteArray"===a,cf=a=>"core::internal::bounded_int::BoundedInt::<0, 79228162514264337593543950335>"===a,cg=a=>a===aG.Secp256k1Point,ch=a=>a.includes("::"),ci=a=>ch(a)?a.substring(a.indexOf("<")+1,a.lastIndexOf(">")):a.replace("*","");function cj(a){let{cairo:b}=cl(a);if(void 0===b)throw Error("Unable to determine Cairo version");return"1"===b}function ck(a){return a.startsWith(aI)}function cl(a){if(a.find(a=>"interface"===a.type))return{cairo:"1",compiler:"2"};let b=a.find(a=>("function"===a.type||"constructor"===a.type)&&(a.inputs.length||a.outputs.length));return b?ch((b.inputs.length?b.inputs:b.outputs)[0].type)?{cairo:"1",compiler:"1"}:{cairo:"0",compiler:"0"}:{cairo:void 0,compiler:void 0}}var cm=a=>new bV(a).toUint256DecimalString(),cn=a=>new bZ(a).toUint512DecimalString(),co=(...a)=>({...a});function cp(a){return bN(a)}var cq=class{variant;constructor(a){let b=Object.values(a);if(0===b.length)throw Error("This Enum must have at least 1 variant");if(1!==b.filter(a=>!aZ(a)).length)throw Error("This Enum must have exactly one active variant");this.variant=a}unwrap(){return Object.values(this.variant).find(a=>!aZ(a))}activeVariant(){let a=Object.entries(this.variant).find(a=>!aZ(a[1]));return aZ(a)?"":a[0]}},cr={Some:0,None:1},cs=class{Some;None;constructor(a,b){if(!(a in Object.values(cr)))throw Error("Wrong variant! It should be CairoOptionVariant.Some or .None.");if(a===cr.Some){if(aZ(b))throw Error('The creation of a Cairo Option with "Some" variant needs a content as input.');this.Some=b,this.None=void 0}else this.Some=void 0,this.None=!0}unwrap(){return this.None?void 0:this.Some}isSome(){return!aZ(this.Some)}isNone(){return!0===this.None}},ct={Ok:0,Err:1},cu=class{Ok;Err;constructor(a,b){if(!(a in Object.values(ct)))throw Error("Wrong variant! It should be CairoResultVariant.Ok or .Err.");a===ct.Ok?(this.Ok=b,this.Err=void 0):(this.Ok=void 0,this.Err=b)}unwrap(){if(!aZ(this.Ok))return this.Ok;if(!aZ(this.Err))return this.Err;throw Error("Both Result.Ok and .Err are undefined. Not authorized.")}isOk(){return!aZ(this.Ok)}isErr(){return!aZ(this.Err)}},cv={isBN:(a,b,c)=>{if(!a0(a[c]))throw Error(`Data and formatter mismatch on ${c}:${b[c]}, expected response data ${c}:${a[c]} to be BN instead it is ${typeof a[c]}`)},unknown:(a,b,c)=>{throw Error(`Unhandled formatter type on ${c}:${b[c]} for data ${c}:${a[c]}`)}},cw=class{abi;constructor(a){this.abi=a}methodInputsLength(a){return a.inputs.reduce((a,b)=>b$(b.name)?a:a+1,0)}getMethod(a){return this.abi.find(b=>b.name===a)}getLegacyFormat(){return this.abi}},cx=class{abi;constructor(a){this.abi=a}methodInputsLength(a){return a.inputs.length}getMethod(a){let b=this.abi.find(a=>"interface"===a.type);return b?.items?.find(b=>b.name===a)}getLegacyFormat(){return this.abi.flatMap(a=>"interface"===a.type?a.items:a)}};function cy(a){var b;let c=(b=a).find(a=>"interface"===a.type)?2:+!!cj(b);if(0===c||1===c)return new cw(a);if(2===c)return new cx(a);throw Error(`Unsupported ABI version ${c}`)}function cz(a,b,c){return"constructor"===a&&!c&&!b.length}function cA(a,b,c){for(let d=0,e=0;d<a.length;d++)if(a[d]===b)e++;else if(a[d]===c&&0==--e)return d;return 1/0}function cB(a){return ch(a)?function(a){let b,c=a.slice(1,-1),d=[],e=0;for(;e<c.length;){switch(!0){case"("===c[e]:b=e+cA(c.slice(e),"(",")")+1;break;case c.startsWith("core::result::Result::<",e)||c.startsWith("core::array::Array::<",e)||c.startsWith("core::option::Option::<",e):b=e+cA(c.slice(e),"<",">")+1;break;default:{let a=c.indexOf(",",e);b=-1!==a?a:1/0}}d.push(c.slice(e,b)),e=b+2}return d}(a):function(a){let{subTuple:b,result:c}=function(a){if(!a.includes("("))return{subTuple:[],result:a};let b=[],c="",d=0;for(;d<a.length;){if("("===a[d]){let e=1,f=d;for(d++;e;)")"===a[d]&&e--,"("===a[d]&&e++,d++;b.push(a.substring(f,d)),c+=" ",d--}else c+=a[d];d++}return{subTuple:b,result:c}}(a.replace(/\s/g,"").slice(1,-1)),d=c.split(",").map(a=>b.length?a.replace(" ",b.shift()):a);return b2(a)&&(d=d.reduce((a,b)=>a.concat(function(a){let b=a.substring(0,a.indexOf(":")),c=a.substring(b.length+1);return{name:b,type:c}}(b)),[])),d}(a)}var cC=class a{content;arrayType;constructor(b,c){aU(a.isTypeFixedArray(c),`The type ${c} is not a Cairo fixed array. Needs [type; length].`);try{a.getFixedArrayType(c)}catch{throw Error(`The type ${c} do not includes any content type. Needs [type; length].`)}try{a.getFixedArraySize(c)}catch{throw Error(`The type ${c} type do not includes any length. Needs [type; length].`)}aU(a.getFixedArraySize(c)===b.length,`The ABI type ${c} is expecting ${a.getFixedArraySize(c)} items. ${b.length} items provided.`),this.content=b,this.arrayType=c}static getFixedArraySize(a){let b=a.match(/(?<=; )\d+(?=\])/);if(null===b)throw Error(`ABI type ${a} do not includes a valid number after ';' character.`);return Number(b[0])}getFixedArraySize(){return a.getFixedArraySize(this.arrayType)}static getFixedArrayType=a=>{let b=a.match(/(?<=\[).+(?=;)/);if(null===b)throw Error(`ABI type ${a} do not includes a valid type of data.`);return b[0]};getFixedArrayType(){return a.getFixedArrayType(this.arrayType)}static compile(a){return a.reduce((a,b,c)=>(a[c]=b,a),{})}compile(){return a.compile(this.content)}static isTypeFixedArray(a){return/^\[.*;\s.*\]$/.test(a)&&/(?<=\[).+(?=;)/.test(a)&&/(?<=; )\d+(?=\])/.test(a)}};function cD(a,b){switch(!0){case bV.isAbiType(a):return new bV(b).toApiRequest();case bZ.isAbiType(a):return new bZ(b).toApiRequest();case cd(a):return bH(b.toString());case cg(a):{let a=B(a6(b)).padStart(128,"0"),c=cm(C(a.slice(-64))),d=cm(C(a.slice(0,-64)));return[bN(d.low),bN(d.high),bN(c.low),bN(c.high)]}default:return bN(b)}}function cE(a,b,c,d){if(void 0===a)throw Error(`Missing parameter for type ${b}`);if(cC.isTypeFixedArray(b)){let e=cC.getFixedArrayType(b),f=[];if(Array.isArray(a))f=new cC(a,b).content;else if("object"==typeof a)aU((f=Object.values(a)).length===cC.getFixedArraySize(b),`ABI type ${b}: object provided do not includes  ${cC.getFixedArraySize(b)} items. ${f.length} items provided.`);else throw Error(`ABI type ${b}: not an Array representing a cairo.fixedArray() provided.`);return f.reduce((a,b)=>a.concat(cE(b,e,c,d)),[])}if(Array.isArray(a)){let e=[];e.push(bN(a.length));let f=ci(b);return a.reduce((a,b)=>a.concat(cE(b,f,c,d)),e)}if(c[b]&&c[b].members.length){if(bV.isAbiType(b))return new bV(a).toApiRequest();if(bZ.isAbiType(b))return new bZ(a).toApiRequest();if(cc(b))return cD(b,a);if(ce(b)){let b=bL(a);return[b.data.length.toString(),...b.data.map(a=>a.toString()),b.pending_word.toString(),b.pending_word_len.toString()]}let{members:e}=c[b];return e.reduce((b,e)=>b.concat(cE(a[e.name],e.type,c,d)),[])}if(b1(b))return(function(a,b){let c=cB(b),d=Object.values(a);if(d.length!==c.length)throw Error(`ParseTuple: provided and expected abi tuple size do not match.
      provided: ${d}
      expected: ${c}`);return c.map((a,b)=>({element:d[b],type:a.type??a}))})(a,b).reduce((a,b)=>{let e=cE(b.element,b.type,c,d);return a.concat(e)},[]);if(bV.isAbiType(b))return new bV(a).toApiRequest();if(bZ.isAbiType(b))return new bZ(a).toApiRequest();if(b4(b,d)){let{variants:e}=d[b];if(b5(b)){if(a.isSome()){let b=e.find(a=>"Some"===a.name);if(aZ(b))throw Error("Error in abi : Option has no 'Some' variant.");let f=b.type;if("()"===f)return cr.Some.toString();let g=cE(a.unwrap(),f,c,d);return Array.isArray(g)?[cr.Some.toString(),...g]:[cr.Some.toString(),g]}return cr.None.toString()}if(b6(b)){if(a.isOk()){let b=e.find(a=>"Ok"===a.name);if(aZ(b))throw Error("Error in abi : Result has no 'Ok' variant.");let f=b.type;if("()"===f)return ct.Ok.toString();let g=cE(a.unwrap(),f,c,d);return Array.isArray(g)?[ct.Ok.toString(),...g]:[ct.Ok.toString(),g]}let b=e.find(a=>"Err"===a.name);if(aZ(b))throw Error("Error in abi : Result has no 'Err' variant.");let f=b.type;if("()"===f)return ct.Err.toString();let g=cE(a.unwrap(),f,c,d);return Array.isArray(g)?[ct.Err.toString(),...g]:[ct.Err.toString(),g]}let f=a.activeVariant(),g=e.find(a=>a.name===f);if(aZ(g))throw Error(`Not find in abi : Enum has no '${f}' variant.`);let h=g.type,i=e.findIndex(a=>a.name===f);if("()"===h)return i.toString();let j=cE(a.unwrap(),h,c,d);return Array.isArray(j)?[i.toString(),...j]:[i.toString(),j]}if(ck(b))return cD(ci(b),a);if("object"==typeof a)throw Error(`Parameter ${a} do not align with abi parameter ${b}`);return cD(b,a)}function cF(a,b,c,d){let{name:e,type:f}=b,{value:g}=a.next();switch(!0){case cC.isTypeFixedArray(f):if(!Array.isArray(g)&&"object"!=typeof g)throw Error(`ABI expected parameter ${e} to be an array or an object, got ${g}`);return cE(g,b.type,c,d);case b0(f):if(!Array.isArray(g)&&!bD(g))throw Error(`ABI expected parameter ${e} to be array or long string, got ${g}`);return a1(g)&&(g=bG(g)),cE(g,b.type,c,d);case ck(f):return cD(ci(f),g);case cc(f):return cD(f,g);case b3(f,c)||b1(f)||bV.isAbiType(f):case b4(f,d):return cE(g,f,c,d);default:return cD(f,g)}}function cG(a,b){switch(!0){case ca(a):return!!BigInt(b.next().value);case bV.isAbiType(a):return new bV(b.next().value,b.next().value).toBigInt();case bZ.isAbiType(a):let c=b.next().value,d=b.next().value;return new bZ(c,d,b.next().value,b.next().value).toBigInt();case cc(a):return BigInt(b.next().value);case cd(a):return bI(b.next().value);case cg(a):let e=B(b.next().value).padStart(32,"0"),f=B(b.next().value).padStart(32,"0"),g=B(b.next().value).padStart(32,"0");return BigInt(C(f+e+B(b.next().value).padStart(32,"0")+g));default:return BigInt(b.next().value)}}function cH(a,b,c,d){if("()"===b.type)return{};if(bV.isAbiType(b.type))return new bV(a.next().value,a.next().value).toBigInt();if(bZ.isAbiType(b.type)){let b=a.next().value,c=a.next().value;return new bZ(b,c,a.next().value,a.next().value).toBigInt()}if(ce(b.type)){let b=[],c=BigInt(a.next().value);for(;b.length<c;)b.push(a6(a.next().value));let d=a6(a.next().value);return bK({data:b,pending_word:d,pending_word_len:BigInt(a.next().value)})}if(cC.isTypeFixedArray(b.type)){let e=[],f={name:"",type:cC.getFixedArrayType(b.type)},g=cC.getFixedArraySize(b.type);for(;e.length<g;)e.push(cH(a,f,c,d));return e}if(b0(b.type)){let e=[],f={name:"",type:ci(b.type)},g=BigInt(a.next().value);for(;e.length<g;)e.push(cH(a,f,c,d));return e}if(ck(b.type))return cH(a,{name:"",type:ci(b.type)},c,d);if(c&&b.type in c&&c[b.type])return cc(b.type)?cG(b.type,a):c[b.type].members.reduce((b,e)=>(b[e.name]=cH(a,e,c,d),b),{});if(d&&b.type in d&&d[b.type]){let e=Number(a.next().value),f=d[b.type].variants.reduce((b,f,g)=>(g===e?b[f.name]=cH(a,{name:"",type:f.type},c,d):b[f.name]=void 0,b),{});if(b.type.startsWith("core::option::Option")){let a=e===cr.Some?f.Some:void 0;return new cs(e,a)}if(b.type.startsWith("core::result::Result")){let a;return a=e===ct.Ok?f.Ok:f.Err,new cu(e,a)}return new cq(f)}if(b1(b.type))return cB(b.type).reduce((b,e,f)=>{let g=e?.name?e.name:f,h=e?.type?e.type:e;return b[g]=cH(a,{name:g,type:h},c,d),b},{});if(b0(b.type)){let e=[],f={name:"",type:ci(b.type)},g=BigInt(a.next().value);for(;e.length<g;)e.push(cH(a,f,c,d));return e}return cG(b.type,a)}function cI(a,b,c,d,e){let{name:f,type:g}=b;switch(!0){case b$(f):return BigInt(a.next().value);case c&&g in c||b1(g):case d&&b4(g,d):case cC.isTypeFixedArray(g):return cH(a,b,c,d);case b0(g):if(ch(g))return cH(a,b,c,d);let h=[];if(e&&e[`${f}_len`]){let g=e[`${f}_len`];for(;h.length<g;)h.push(cH(a,{name:f,type:b.type.replace("*","")},c,d))}return h;case ck(g):return cH(a,b,c,d);default:return cG(g,a)}}var cJ=(a,b)=>{if(aU(a1(a)||a$(a)||a0(a),`Validate: arg ${b.name} should be a felt typed as (String, Number or BigInt)`),a1(a)&&!a3(a))return;let c=BigInt(a.toString(10));aU(c>=0n&&c<=2n**252n-1n,`Validate: arg ${b.name} cairo typed ${b.type} should be in range [0, 2^252-1]`)},cK=(a,b)=>{let c;switch(a$(a)&&aU(a<=Number.MAX_SAFE_INTEGER,"Validation: Parameter is too large to be typed as Number use (BigInt or String)"),aU(a1(a)||a$(a)||a0(a)||a2(a)&&"low"in a&&"high"in a||a2(a)&&["limb0","limb1","limb2","limb3"].every(b=>b in a),`Validate: arg ${b.name} of cairo type ${b.type} should be type (String, Number or BigInt), but is ${typeof a} ${a}.`),b.type){case aF.u256:c=new bV(a).toBigInt();break;case aF.u512:c=new bZ(a).toBigInt();break;default:c=a4(a)}switch(b.type){case aF.u8:aU(c>=0n&&c<=255n,`Validate: arg ${b.name} cairo typed ${b.type} should be in range [0 - 255]`);break;case aF.u16:aU(c>=0n&&c<=65535n,`Validate: arg ${b.name} cairo typed ${b.type} should be in range [0, 65535]`);break;case aF.u32:aU(c>=0n&&c<=4294967295n,`Validate: arg ${b.name} cairo typed ${b.type} should be in range [0, 4294967295]`);break;case aF.u64:aU(c>=0n&&c<=2n**64n-1n,`Validate: arg ${b.name} cairo typed ${b.type} should be in range [0, 2^64-1]`);break;case aF.u128:aU(c>=0n&&c<=2n**128n-1n,`Validate: arg ${b.name} cairo typed ${b.type} should be in range [0, 2^128-1]`);break;case aF.u256:aU(c>=0n&&c<=2n**256n-1n,`Validate: arg ${b.name} is ${b.type} should be in range 0 - 2^256-1`);break;case aF.u512:aU(bZ.is(c),`Validate: arg ${b.name} is ${b.type} should be in range 0 - 2^512-1`);break;case aG.ClassHash:case aG.ContractAddress:aU(c>=0n&&c<=2n**252n-1n,`Validate: arg ${b.name} cairo typed ${b.type} should be in range [0, 2^252-1]`);break;case aG.Secp256k1Point:aU(c>=0n&&c<=2n**512n-1n,`Validate: arg ${b.name} must be ${b.type} : a 512 bits number.`);break;case aG.U96:aU(c>=0n&&c<=2n**96n-1n,`Validate: arg ${b.name} must be ${b.type} : a 96 bits number.`)}},cL=(a,b)=>{aU(a_(a),`Validate: arg ${b.name} of cairo type ${b.type} should be type (Boolean)`)},cM=(a,b,c)=>{if(b.type===aF.u256||b.type===aF.u512)return void cK(a,b);if(cc(b.type)){aU(!a2(a),`EthAddress type is waiting a BigNumberish. Got "${a}"`);let c=BigInt(a.toString(10));aU(c>=0n&&c<=2n**160n-1n,`Validate: arg ${b.name} cairo typed ${b.type} should be in range [0, 2^160-1]`);return}aU(a2(a),`Validate: arg ${b.name} is cairo type struct (${b.type}), and should be defined as a js object (not array)`),c[b.type].members.forEach(({name:c})=>{aU(Object.keys(a).includes(c),`Validate: arg ${b.name} should have a property ${c}`)})},cN=(a,b)=>{aU(a2(a),`Validate: arg ${b.name} is cairo type Enum (${b.type}), and should be defined as a js object (not array)`);let c=Object.getOwnPropertyNames(Object.getPrototypeOf(a)),d=[...Object.getOwnPropertyNames(a),...c];if(!(b5(b.type)&&d.includes("isSome")&&d.includes("isNone")||b6(b.type)&&d.includes("isOk")&&d.includes("isErr"))&&!(d.includes("variant")&&d.includes("activeVariant")))throw Error(`Validate Enum: argument ${b.name}, type ${b.type}, value received "${a}", is not an Enum.`)},cO=(a,b)=>{aU(a2(a),`Validate: arg ${b.name} should be a tuple (defined as object)`)},cP=(a,b,c,d)=>{let e=b0(b.type),f=e?ci(b.type):cC.getFixedArrayType(b.type);if(e&&b_(f)&&bF(a))return;let g=[];if(e)aU(Array.isArray(a),`Validate: arg ${b.name} should be an Array`),g=a;else switch(!0){case Array.isArray(a):g=a;break;case"object"==typeof a:g=Object.values(a);break;default:throw Error(`Validate: arg ${b.name} should be an Array or an object.`)}switch(!0){case b_(f):g.forEach(a=>cJ(a,b));break;case b1(f):g.forEach(a=>cO(a,{name:b.name,type:f}));break;case b0(f):g.forEach(a=>cP(a,{name:"",type:f},c,d));break;case b3(f,c):g.forEach(a=>cM(a,{name:b.name,type:f},c));break;case b4(f,d):g.forEach(a=>cN(a,{name:b.name,type:f}));break;case b7(f)||b9(f):g.forEach(a=>cK(a,{name:"",type:f}));break;case ca(f):g.forEach(a=>cL(a,b));break;default:throw Error(`Validate Unhandled: argument ${b.name}, type ${b.type}, value ${g}`)}};function cQ(a,b,c,d){a.inputs.reduce((a,e)=>{let f=b[a];switch(!0){case b$(e.name):return a;case b_(e.type):cJ(f,e);break;case cd(e.type):aU(a1(f),`Validate: arg ${e.name} should be a string.`),aU(f.length<32,`Validate: arg ${e.name} cairo typed ${e.type} should be a string of less than 32 characters.`);break;case b7(e.type)||b9(e.type):cK(f,e);break;case ca(e.type):cL(f,e);break;case ce(e.type):aU(a1(f),`Validate: arg ${e.name} should be a string.`);break;case b0(e.type)||cC.isTypeFixedArray(e.type):cP(f,e,c,d);break;case b3(e.type,c):cM(f,e,c);break;case b4(e.type,d):cN(f,e);break;case b1(e.type):cO(f,e);break;case ck(e.type):let g=ci(e.type);switch(aU(b7(g)&&g!==bZ.abiSelector||b_(g),`Validate: ${e.name} type is not authorized for NonZero type.`),!0){case b_(g):cJ(f,e),aU(BigInt(f.toString(10))>0,"Validate: value 0 is not authorized in NonZero felt252 type.");break;case b7(g):cK(f,{name:"",type:g}),g===aF.u256?aU(new bV(f).toBigInt()>0,"Validate: value 0 is not authorized in NonZero uint256 type."):aU(a4(f)>0,"Validate: value 0 is not authorized in NonZero uint type.");break;default:throw Error(`Validate Unhandled: argument ${e.name}, type ${e.type}, value "${f}"`)}break;default:throw Error(`Validate Unhandled: argument ${e.name}, type ${e.type}, value ${f}`)}return a+1},0)}var cR=class a{abi;parser;structs;enums;constructor(b){this.structs=a.getAbiStruct(b),this.enums=a.getAbiEnum(b),this.parser=cy(b),this.abi=this.parser.getLegacyFormat()}validate(a,b,c=[]){a!==aE.DEPLOY&&aU(this.abi.filter(b=>{if("function"!==b.type)return!1;let c="view"===b.stateMutability||"view"===b.state_mutability;return a===aE.INVOKE?!c:c}).map(a=>a.name).includes(b),`${a===aE.INVOKE?"invocable":"viewable"} method not found in abi`);let d=this.abi.find(c=>a===aE.DEPLOY?c.name===b&&"constructor"===c.type:c.name===b&&"function"===c.type);if(cz(b,c,d))return;let e=this.parser.methodInputsLength(d);if(c.length!==e)throw Error(`Invalid number of arguments, expected ${e} arguments, but got ${c.length}`);cQ(d,c,this.structs,this.enums)}compile(a,b){let c,d=this.abi.find(b=>b.name===a);if(cz(a,b,d))return[];Array.isArray(b)?c=b:(c=Object.values(function(a,b,c,d){let e=(a,b)=>{if(cC.isTypeFixedArray(b)){var h,i=a,j=b;let c=cC.getFixedArrayType(j),d=cC.getFixedArraySize(j);if(Array.isArray(i)){if(d!==i.length)throw Error(`ABI type ${j}: array provided do not includes  ${d} items. ${i.length} items provided.`);return i.map(a=>e(a,c))}if(d!==Object.keys(i).length)throw Error(`ABI type ${j}: object provided do not includes  ${d} properties. ${Object.keys(i).length} items provided.`);return e(i,c)}if(b0(b)){var k=a,l=b;let c=ci(l);return a1(k)?k:k.map(a=>e(a,c))}if(b4(b,d))return g(a,d[b]);if(b1(b)){return h=a,cB(b).reduce((a,b,c)=>{let d,f=Object.keys(h),g=b?.type?b.type:b;return d=e(h[f[c]],g),Object.defineProperty(a,c.toString(),{enumerable:!0,value:d??h[f[c]]}),a},{})}if(cc(b)||ck(b)||ce(b)||cf(b)||cg(b))return a;if(bV.isAbiType(b)){if("object"!=typeof a)return a;if(!("low"in a&&"high"in a))throw Error(`Your object includes the property : ${b}, containing an Uint256 object without the 'low' and 'high' keys.`);return{low:a.low,high:a.high}}if(bZ.isAbiType(b)){if("object"!=typeof a)return a;if(!["limb0","limb1","limb2","limb3"].every(b=>b in a))throw Error(`Your object includes the property : ${b}, containing an Uint512 object without the 'limb0' to 'limb3' keys.`);return{limb0:a.limb0,limb1:a.limb1,limb2:a.limb2,limb3:a.limb3}}return b3(b,c)?f(a,c[b].members):a},f=(a,b)=>b.reduce((b,c)=>{let d;if("undefined"===a[c.name]&&(ch(c.type)||!b$(c.name)))throw Error(`Your object needs a property with key : ${c.name} .`);return d=e(a[c.name],c.type),Object.defineProperty(b,c.name,{enumerable:!0,value:d??a[c.name]}),b},{}),g=(a,b)=>{if(b6(b.name)){let c=b.name.substring(b.name.indexOf("<")+1,b.name.lastIndexOf(",")),d=b.name.substring(b.name.indexOf(",")+1,b.name.lastIndexOf(">"));return a.isOk()?new cu(ct.Ok,e(a.unwrap(),c)):new cu(ct.Err,e(a.unwrap(),d))}if(b5(b.name)){let c=b.name.substring(b.name.indexOf("<")+1,b.name.lastIndexOf(">"));return a.isSome()?new cs(cr.Some,e(a.unwrap(),c)):new cs(cr.None,{})}return new cq(Object.fromEntries(Object.entries(a.variant).map(c=>{if(aZ(c[1]))return c;let d=b.type.substring(b.type.lastIndexOf("<")+1,b.type.lastIndexOf(">"));return"()"===d?c:[c[0],e(a.unwrap(),d)]})))};return b.reduce((b,c)=>{let d;return b$(c.name)&&!ch(c.type)?b:(d=e(a[c.name],c.type),Object.defineProperty(b,c.name,{enumerable:!0,value:d}),b)},{})}(b,d.inputs,this.structs,this.enums)),cQ(d,c,this.structs,this.enums));let e=c[Symbol.iterator](),f=d.inputs.reduce((a,b)=>b$(b.name)&&!ch(b.type)?a:a.concat(cF(e,b,this.structs,this.enums)),[]);return Object.defineProperty(f,"__compiled__",{enumerable:!1,writable:!1,value:!0}),f}static compile(a){let b,c=a=>{let b=(a,c=".")=>{let d=Array.isArray(a)?[a.length.toString(),...a]:a;return Object.entries(d).flatMap(([a,e])=>{let f=e;"entrypoint"===a?f=bu(f):bF(f)&&(f=bL(f));let g=Array.isArray(d)&&"0"===a?"$$len":a;if(a0(f))return[[`${c}${g}`,bN(f)]];if(Object(f)===f){let a=Object.getOwnPropertyNames(Object.getPrototypeOf(f)),d=[...Object.getOwnPropertyNames(f),...a];if(d.includes("isSome")&&d.includes("isNone")){let a=f,d=a.isSome()?cr.Some:cr.None;return a.isSome()?b({0:d,1:a.unwrap()},`${c}${g}.`):[[`${c}${g}`,bN(d)]]}if(d.includes("isOk")&&d.includes("isErr")){let a=f;return b({0:a.isOk()?ct.Ok:ct.Err,1:a.unwrap()},`${c}${g}.`)}if(d.includes("variant")&&d.includes("activeVariant")){let a=f,d=a.activeVariant(),e=Object.keys(a.variant).findIndex(a=>a===d);return"object"==typeof a.unwrap()&&0===Object.keys(a.unwrap()).length?[[`${c}${g}`,bN(e)]]:b({0:e,1:a.unwrap()},`${c}${g}.`)}return b(f,`${c}${g}.`)}return[[`${c}${g}`,bN(f)]]})};return Object.fromEntries(b(a))};return Object.defineProperty(b=Array.isArray(a)?Object.values(c({...a})):Object.values(c(a)),"__compiled__",{enumerable:!1,writable:!1,value:!0}),b}parse(a,b){let{outputs:c}=this.abi.find(b=>b.name===a),d=b.flat()[Symbol.iterator](),e=c.flat().reduce((a,b,c)=>{let e=b.name??c;return a[e]=cI(d,b,this.structs,this.enums,a),a[e]&&a[`${e}_len`]&&delete a[`${e}_len`],a},{});return 1===Object.keys(e).length&&0 in e?e[0]:e}format(a,b,c){return function a(b,c,d){return Object.entries(b).reduce((e,[f,g])=>{let h=d??c[f];if(!(f in c)&&!d)return e[f]=g,e;if("string"===h){if(Array.isArray(b[f])){let c=a(b[f],b[f].map(a=>h));return e[f]=Object.values(c).join(""),e}return cv.isBN(b,c,f),e[f]=bI(g),e}if("number"===h)return cv.isBN(b,c,f),e[f]=Number(g),e;if("function"==typeof h)return e[f]=h(g),e;if(Array.isArray(h)){let c=a(b[f],h,h[0]);return e[f]=Object.values(c),e}return a2(h)?e[f]=a(b[f],h):cv.unknown(b,c,f),e},{})}(this.parse(a,b),c)}static getAbiStruct(a){return a.filter(a=>"struct"===a.type).reduce((a,b)=>({...a,[b.name]:b}),{})}static getAbiEnum(a){let b=a.filter(a=>"enum"===a.type).reduce((a,b)=>({...a,[b.name]:b}),{});return delete b["core::bool"],b}static toCalldata(b=[]){return a.compile(b)}static toHex(b=[]){return a.compile(b).map(a=>a6(a))}decodeParameters(a,b){let c=Array.isArray(a)?a:[a],d=b.flat()[Symbol.iterator](),e=c.map(a=>cI(d,{name:"",type:a},this.structs,this.enums));return 1===e.length?e[0]:e}},cS={};j(cS,{calculateContractAddressFromHash:()=>dt,calculateDeclareTransactionHash:()=>dk,calculateDeployAccountTransactionHash:()=>dl,calculateInvokeTransactionHash:()=>dj,calculateL2MessageTxHash:()=>c1,computeCompiledClassHash:()=>dA,computeContractClassHash:()=>dD,computeHashOnElements:()=>dq,computeHintedClassHash:()=>dw,computeLegacyContractClassHash:()=>dx,computePedersenHash:()=>dn,computePedersenHashOnElements:()=>dr,computePoseidonHash:()=>dp,computePoseidonHashOnElements:()=>ds,computeSierraContractClassHash:()=>dC,formatSpaces:()=>dv,getL1MessageHash:()=>by,getL2MessageHash:()=>bx,getSelector:()=>bv,getSelectorFromName:()=>bu,hashByteCodeSegments:()=>dz,keccakBn:()=>bs,poseidon:()=>cT,solidityUint256PackedKeccak256:()=>bw,starknetKeccak:()=>bt});var cT=l(a.r(259418)),cU={};j(cU,{calculateDeclareTransactionHash:()=>c$,calculateDeployAccountTransactionHash:()=>c_,calculateL2MessageTxHash:()=>c1,calculateTransactionHash:()=>c0,calculateTransactionHashCommon:()=>cZ,computeHashOnElements:()=>cY});var cV={};j(cV,{starkCurve:()=>cW,weierstrass:()=>cX});var cW=l(a.r(677716)),cX=l(a.r(642585));function cY(a){return[...a,a.length].reduce((a,b)=>cW.pedersen(a4(a),a4(b)),0).toString()}function cZ(a,b,c,d,e,f,g,h=[]){let i=[a,b,c,d,cY(e),f,g,...h];return cY(i)}function c$(a,b,c,d,e,f,g){return cZ(ad.DECLARE,c,b,0,[a],d,e,[f,...g?[g]:[]])}function c_(a,b,c,d,e,f,g,h){let i=[b,d,...c];return cZ(ad.DEPLOY_ACCOUNT,e,a,0,i,f,g,[h])}function c0(a,b,c,d,e,f){return cZ(ad.INVOKE,b,a,0,c,d,e,[f])}function c1(a,b,c,d,e,f){let g=[a,...d];return cZ(ad.L1_HANDLER,0,b,bv(c),g,0,e,[f])}var c2={};j(c2,{calculateDeclareTransactionHash:()=>dh,calculateDeployAccountTransactionHash:()=>dg,calculateInvokeTransactionHash:()=>di,calculateTransactionHashCommon:()=>df,encodeDataResourceBoundsL1:()=>dc,encodeResourceBoundsL1:()=>da,encodeResourceBoundsL2:()=>db,hashDAMode:()=>c9,hashFeeField:()=>dd,hashFeeFieldV3B3:()=>de});var c3=a.r(677716),c4=a=>a.map(a=>BigInt(a)),c5=64n+128n,c6=BigInt(bH("L1_GAS")),c7=BigInt(bH("L2_GAS")),c8=BigInt(bH("L1_DATA"));function c9(a,b){return(BigInt(a)<<32n)+BigInt(b)}function da(a){return(c6<<c5)+(BigInt(a.l1_gas.max_amount)<<128n)+BigInt(a.l1_gas.max_price_per_unit)}function db(a){return(c7<<c5)+(BigInt(a.l2_gas.max_amount)<<128n)+BigInt(a.l2_gas.max_price_per_unit)}function dc(a){return(c8<<c5)+(BigInt(a.l1_data_gas.max_amount)<<128n)+BigInt(a.l1_data_gas.max_price_per_unit)}function dd(a,b){let c=da(b),d=db(b);return(0,c3.poseidonHashMany)([BigInt(a),c,d])}function de(a,b){let c=da(b),d=db(b),e=dc(b);return(0,c3.poseidonHashMany)([BigInt(a),c,d,e])}function df(a,b,c,d,e,f,g,h,i,j,k=[]){let l=aB(j)?de(f,j):dd(f,j),m=c9(h,i),n=c4([a,b,c,l,(0,c3.poseidonHashMany)(c4(g)),d,e,m,...c4(k)]);return a6((0,c3.poseidonHashMany)(n))}function dg(a,b,c,d,e,f,g,h,i,j,k,l){return df(ad.DEPLOY_ACCOUNT,e,a,f,g,k,l,h,i,j,[(0,c3.poseidonHashMany)(c4(c)),b,d])}function dh(a,b,c,d,e,f,g,h,i,j,k,l){return df(ad.DECLARE,d,c,e,f,k,c4(l),h,i,j,[(0,c3.poseidonHashMany)(c4(g)),a,b])}function di(a,b,c,d,e,f,g,h,i,j,k){return df(ad.INVOKE,b,a,d,e,j,k,g,h,i,[(0,c3.poseidonHashMany)(c4(f)),(0,c3.poseidonHashMany)(c4(c))])}function dj(a){return[o.ETransactionVersion.V3,o.ETransactionVersion.F3].includes(a.version)?di(a.senderAddress,a.version,a.compiledCalldata,a.chainId,a.nonce,a.accountDeploymentData,a.nonceDataAvailabilityMode,a.feeDataAvailabilityMode,a.resourceBounds,a.tip,a.paymasterData):c0(a.senderAddress,a.version,a.compiledCalldata,a.maxFee,a.chainId,a.nonce)}function dk(a){return[o.ETransactionVersion.V3,o.ETransactionVersion.F3].includes(a.version)?dh(a.classHash,a.compiledClassHash,a.senderAddress,a.version,a.chainId,a.nonce,a.accountDeploymentData,a.nonceDataAvailabilityMode,a.feeDataAvailabilityMode,a.resourceBounds,a.tip,a.paymasterData):c$(a.classHash,a.senderAddress,a.version,a.maxFee,a.chainId,a.nonce,a.compiledClassHash)}function dl(a){return[o.ETransactionVersion.V3,o.ETransactionVersion.F3].includes(a.version)?dg(a.contractAddress,a.classHash,a.compiledConstructorCalldata,a.salt,a.version,a.chainId,a.nonce,a.nonceDataAvailabilityMode,a.feeDataAvailabilityMode,a.resourceBounds,a.tip,a.paymasterData):c_(a.contractAddress,a.classHash,a.constructorCalldata,a.salt,a.version,a.maxFee,a.chainId,a.nonce)}var dm=a.r(677716);function dn(a,b){return cW.pedersen(BigInt(a),BigInt(b))}function dp(a,b){return a6(cW.poseidonHash(BigInt(a),BigInt(b)))}function dq(a){return[...a,a.length].reduce((a,b)=>cW.pedersen(BigInt(a),BigInt(b)),0).toString()}var dr=dq;function ds(a){return a6((0,dm.poseidonHashMany)(a.map(a=>BigInt(a))))}function dt(a,b,c,d){let e=dq(cR.compile(c));return a6(BigInt(dq([bN("0x535441524b4e45545f434f4e54524143545f41444452455353"),d,a,b,e]))%R)}function du(a,b){return"attributes"===a||"accessible_scopes"===a?Array.isArray(b)&&0===b.length?void 0:b:"debug_info"===a?null:null===b?void 0:b}function dv(a){let b=!1,c=[];for(let d of a)'"'===d&&!1==(c.length>0&&"\\"===c.slice(-1)[0])&&(b=!b),b?c.push(d):c.push(":"===d?": ":","===d?", ":d);return c.join("")}function dw(a){let{abi:b,program:c}=a,d=dv(aS({abi:b,program:c},du));return C(cW.keccak(x(d)).toString(16))}function dx(a){let b=a1(a)?aQ(a):a,c=a6(O),d=dq(b.entry_points_by_type.EXTERNAL.flatMap(a=>[a.selector,a.offset])),e=dq(b.entry_points_by_type.L1_HANDLER.flatMap(a=>[a.selector,a.offset])),f=dq(b.entry_points_by_type.CONSTRUCTOR.flatMap(a=>[a.selector,a.offset])),g=dq(b.program.builtins.map(a=>bH(a))),h=dw(b),i=dq(b.program.data);return dq([c,d,e,f,g,h,i])}function dy(a){let b=a.flatMap(a=>{var b;return[BigInt(a.selector),BigInt(a.offset),(b=a.builtins,(0,dm.poseidonHashMany)(b.flatMap(a=>BigInt(bH(a)))))]});return(0,dm.poseidonHashMany)(b)}function dz(a){let b=a.bytecode.map(a=>BigInt(a)),c=a.bytecode_segment_lengths??[],d=0,e=c.flatMap(a=>{let c=b.slice(d,d+=a);return[BigInt(a),(0,dm.poseidonHashMany)(c)]});return 1n+(0,dm.poseidonHashMany)(e)}function dA(a){let b=BigInt(bH("COMPILED_CLASS_V1")),c=dy(a.entry_points_by_type.EXTERNAL),d=dy(a.entry_points_by_type.L1_HANDLER),e=dy(a.entry_points_by_type.CONSTRUCTOR),f=a.bytecode_segment_lengths?dz(a):(0,dm.poseidonHashMany)(a.bytecode.map(a=>BigInt(a)));return a6((0,dm.poseidonHashMany)([b,c,d,e,f]))}function dB(a){let b=a.flatMap(a=>[BigInt(a.selector),BigInt(a.function_idx)]);return(0,dm.poseidonHashMany)(b)}function dC(a){let b=BigInt(bH("CONTRACT_CLASS_V0.1.0")),c=dB(a.entry_points_by_type.EXTERNAL),d=dB(a.entry_points_by_type.L1_HANDLER),e=dB(a.entry_points_by_type.CONSTRUCTOR),f=function(a){let b=dv(aS(a.abi,null));return BigInt(C(cW.keccak(x(b)).toString(16)))}(a),g=(0,dm.poseidonHashMany)(a.sierra_program.map(a=>BigInt(a)));return a6((0,dm.poseidonHashMany)([b,c,d,e,f,g]))}function dD(a){let b=a1(a)?aQ(a):a;return"sierra_program"in b?dC(b):dx(b)}var dE={};j(dE,{ZEROFee:()=>dX,compressProgram:()=>dP,decompressProgram:()=>dQ,estimateFeeToBounds:()=>dW,estimatedFeeToMaxFee:()=>dV,formatSignature:()=>dS,getFullPublicKey:()=>d1,intDAM:()=>dY,randomAddress:()=>dR,reduceV2:()=>d0,signatureToDecimalArray:()=>dT,signatureToHexArray:()=>dU,toFeeVersion:()=>d$,toTransactionVersion:()=>dZ,v3Details:()=>d_});var dF=a.r(677716),dG=a.r(375779);function dH(a){let b=a.version?a6(a.version):av.V3;return b===av.V3||b===av.F3}function dI(a,b){let c=a.split("."),d=b.split(".");return c.every((a,b)=>"*"===a||a===d[b])}function dJ(a,b={allowAnyPatchVersion:!1}){return Object.values(ae).some(c=>dI(b.allowAnyPatchVersion?dK(c):c,a))}function dK(a){let b=a.split(".");return b.length<3?a:`${b[0]}.${b[1]}.*`}function dL(a){let[b,c]=a.replace(/^v/,"").split(".");return`v${b}_${c}`}function dM(a){return"PENDING"===a.status}function dN(a){return!("block_hash"in a)}function dO(a){return!("block_hash"in a)}function dP(a){let b=a1(a)?a:aS(a);return z((0,dG.gzip)(b))}function dQ(a){return Array.isArray(a)?a:aQ(w((0,dG.ungzip)(y(a))))}function dR(){let a=dF.utils.randomPrivateKey();return(0,dF.getStarkKey)(a)}function dS(a){if(!a)throw Error("formatSignature: provided signature is undefined");if(Array.isArray(a))return a.map(a=>a6(a));try{let{r:b,s:c}=a;return[a6(b),a6(c)]}catch(a){throw Error("Signature need to be weierstrass.SignatureType or an array for custom")}}function dT(a){return bd(dS(a))}function dU(a){return be(dS(a))}function dV(a,b=aj.get("feeMarginPercentage").maxFee){return bl(a,b)}function dW(a,b=aj.get("feeMarginPercentage").bounds,c){if(a0(a))return{l2_gas:{max_amount:"0x0",max_price_per_unit:"0x0"},l1_gas:{max_amount:"0x0",max_price_per_unit:"0x0"},...c&&dI("0.8",c)&&{l1_data_gas:{max_amount:"0x0",max_price_per_unit:"0x0"}}};if(aA(a))return{l2_gas:{max_amount:a6(bl(a.l2_gas_consumed,b.l2_gas.max_amount)),max_price_per_unit:a6(bl(a.l2_gas_price,b.l2_gas.max_price_per_unit))},l1_gas:{max_amount:a6(bl(a.l1_gas_consumed,b.l1_gas.max_amount)),max_price_per_unit:a6(bl(a.l1_gas_price,b.l1_gas.max_price_per_unit))},l1_data_gas:{max_amount:a6(bl(a.l1_data_gas_consumed,b.l1_data_gas.max_amount)),max_price_per_unit:a6(bl(a.l1_data_gas_price,b.l1_data_gas.max_price_per_unit))}};return{l2_gas:{max_amount:"0x0",max_price_per_unit:"0x0"},l1_gas:{max_amount:void 0!==a.data_gas_consumed&&void 0!==a.data_gas_price?a6(bl(BigInt(a.overall_fee)/BigInt(a.gas_price),b.l1_gas.max_amount)):a6(bl(a.gas_consumed,b.l1_gas.max_amount)),max_price_per_unit:a6(bl(a.gas_price,b.l1_gas.max_price_per_unit))}}}function dX(a){return{l1_gas_consumed:0n,l1_gas_price:0n,l1_data_gas_consumed:0n,l1_data_gas_price:0n,l2_gas_consumed:0n,l2_gas_price:0n,overall_fee:L,unit:"FRI",suggestedMaxFee:L,resourceBounds:dW(L,void 0,a)}}function dY(a){if(a===ay.L1)return az.L1;if(a===ay.L2)return az.L2;throw Error("EDAM conversion")}function dZ(a,b){let c=b?a6(b):void 0,d=a6(a);if(b&&!Object.values(av).includes(c))throw Error(`providedVersion ${b} is not ETransactionVersion`);if(!Object.values(av).includes(d))throw Error(`defaultVersion ${a} is not ETransactionVersion`);return b?c:d}function d$(a){if(!a)return;let b=a6(a);if(b===av.V0)return av.F0;if(b===av.V1)return av.F1;if(b===av.V2)return av.F2;if(b===av.V3)return av.F3;throw Error(`toFeeVersion: ${b} is not supported`)}function d_(a,b){return{tip:a.tip||0,paymasterData:a.paymasterData||[],accountDeploymentData:a.accountDeploymentData||[],nonceDataAvailabilityMode:a.nonceDataAvailabilityMode||ay.L1,feeDataAvailabilityMode:a.feeDataAvailabilityMode||ay.L1,resourceBounds:a.resourceBounds??dW(L,void 0,b)}}function d0(a){return a===av.F2?av.F1:a===av.V2?av.V1:a}function d1(a){let b=a6(a);return C(A((0,dF.getPublicKey)(b,!1)))}function d2(a){return"sierra_program"in(a1(a)?aQ(a):a)}function d3(a){let b={...a};if(d2(a.contract)&&(!a.compiledClassHash&&a.casm&&(b.compiledClassHash=dA(a.casm)),!b.compiledClassHash))throw Error("Extract compiledClassHash failed, provide (CairoAssembly).casm file or compiledClassHash");if(b.classHash=a.classHash??dD(a.contract),!b.classHash)throw Error("Extract classHash failed, provide (CompiledContract).json file or classHash");return b}function d4(a){if(d2(a))throw Error("ContractClassResponse need to be LegacyContractClass (cairo0 response class)");return{...a,program:dQ(a.program)}}var d5={FAILED_TO_RECEIVE_TXN:1,NO_TRACE_AVAILABLE:10,CONTRACT_NOT_FOUND:20,ENTRYPOINT_NOT_FOUND:21,BLOCK_NOT_FOUND:24,INVALID_TXN_INDEX:27,CLASS_HASH_NOT_FOUND:28,TXN_HASH_NOT_FOUND:29,PAGE_SIZE_TOO_BIG:31,NO_BLOCKS:32,INVALID_CONTINUATION_TOKEN:33,TOO_MANY_KEYS_IN_FILTER:34,CONTRACT_ERROR:40,TRANSACTION_EXECUTION_ERROR:41,STORAGE_PROOF_NOT_SUPPORTED:42,CLASS_ALREADY_DECLARED:51,INVALID_TRANSACTION_NONCE:52,INSUFFICIENT_RESOURCES_FOR_VALIDATE:53,INSUFFICIENT_ACCOUNT_BALANCE:54,VALIDATION_FAILURE:55,COMPILATION_FAILED:56,CONTRACT_CLASS_SIZE_IS_TOO_LARGE:57,NON_ACCOUNT:58,DUPLICATE_TX:59,COMPILED_CLASS_HASH_MISMATCH:60,UNSUPPORTED_TX_VERSION:61,UNSUPPORTED_CONTRACT_CLASS_VERSION:62,UNEXPECTED_ERROR:63,INVALID_SUBSCRIPTION_ID:66,TOO_MANY_ADDRESSES_IN_FILTER:67,TOO_MANY_BLOCKS_BACK:68,COMPILATION_ERROR:100,INVALID_ADDRESS:150,TOKEN_NOT_SUPPORTED:151,INVALID_SIGNATURE:153,MAX_AMOUNT_TOO_LOW:154,CLASS_HASH_NOT_SUPPORTED:155,PAYMASTER_TRANSACTION_EXECUTION_ERROR:156,INVALID_TIME_BOUNDS:157,INVALID_DEPLOYMENT_DATA:158,INVALID_CLASS_HASH:159,INVALID_ID:160,UNKNOWN_ERROR:163},d6=class extends Error{name;constructor(a){super(a),Object.defineProperty(this,"name",{value:new.target.name,enumerable:!1,configurable:!0}),function(a,b){let{setPrototypeOf:c}=Object;c?c(a,b):a.__proto__=b}(this,new.target.prototype),function(a,b=a.constructor){let{captureStackTrace:c}=Error;c&&c(a,b)}(this)}},d7=class extends d6{},d8=class extends d7{constructor(a,b,c){super(`RPC: ${b} with params ${aS(c,null,2)}

      ${a.code}: ${a.message}: ${aS(a.data)}`),this.baseError=a,this.request={method:b,params:c}}request;get code(){return this.baseError.code}isType(a){return d5[a]===this.code}},d9=class extends d7{constructor(a){super(a),this.name="TimeoutError"}},ea=class extends d7{constructor(a){super(a),this.name="WebSocketNotConnectedError"}},eb={};j(eb,{ethRandomPrivateKey:()=>ed,validateAndParseEthAddress:()=>ee});var ec=a.r(645723);function ed(){return G(A(ec.secp256k1.utils.randomPrivateKey()))}function ee(a){bc(a,L,2n**160n-1n,"Ethereum Address ");let b=C(B(a6(a)).padStart(40,"0"));return aU(!!b.match(/^(0x)?[0-9a-f]{40}$/),"Invalid Ethereum Address Format"),b}var ef="undefined"!=typeof globalThis&&globalThis.fetch.bind(globalThis)||a.g.fetch.bind(a.g)||(()=>{throw new d7("'fetch()' not detected, use the 'baseFetch' constructor parameter to set it")}),eg={};function eh(a){return new Promise(b=>{setTimeout(b,a)})}function ei(a){let b={...a};return delete b.sierra_program_debug_info,b.abi=dv(aS(a.abi)),b.sierra_program=dv(aS(a.sierra_program)),b.sierra_program=dP(b.sierra_program),b}function ej(a){let b=a1(a)?aQ(a):a;return d2(a)?ei(b):{...b,..."program"in b&&{program:dP(b.program)}}}j(eg,{Block:()=>eo,createSierraContractClass:()=>ei,getDefaultNodeUrl:()=>ek,getDefaultNodes:()=>el,getSupportedRpcVersions:()=>em,parseContract:()=>ej,validBlockTags:()=>en,wait:()=>eh});var ek=(a,b=!1,c)=>{b||al.info("Using default public node url, please provide nodeUrl in provider options!");let d=el(c??aj.get("rpcVersion"))[a??ab.SN_SEPOLIA],e=Math.floor(Math.random()*d.length);return d[e]};function el(a){let b={...ag};return Object.keys(b).forEach(function(c,d){b[c]=b[c].map(b=>`${b}${dL(a)}`)}),b}function em(){return[...new Set(Object.values(ae))]}var en=Object.values(at),eo=class{hash=null;number=null;tag=null;setIdentifier(a){if(a1(a))if(bC(a))this.number=parseInt(a,10);else if(a3(a))this.hash=a;else if(en.includes(a))this.tag=a;else throw TypeError(`Block identifier unmanaged: ${a}`);else a0(a)?this.hash=a6(a):a$(a)?this.number=a:this.tag=at.PENDING;if(a$(this.number)&&this.number<0)throw TypeError(`Block number (${this.number}) can't be negative`)}constructor(a){this.setIdentifier(a)}get queryIdentifier(){return null!==this.number?`blockNumber=${this.number}`:null!==this.hash?`blockHash=${this.hash}`:`blockNumber=${this.tag}`}get identifier(){return null!==this.number?{block_number:this.number}:null!==this.hash?{block_hash:this.hash}:this.tag}set identifier(a){this.setIdentifier(a)}valueOf=()=>this.number;toString=()=>this.hash},ep={};j(ep,{buildUDCCall:()=>eu,fromCallsToExecuteCalldata:()=>er,fromCallsToExecuteCalldata_cairo1:()=>es,getExecuteCalldata:()=>et,getVersionsByType:()=>ev,transformCallsToMulticallArrays:()=>eq});var eq=a=>{let b=[],c=[];return a.forEach(a=>{let d=cR.compile(a.calldata||[]);b.push({to:a4(a.contractAddress).toString(10),selector:a4(bu(a.entrypoint)).toString(10),data_offset:c.length.toString(),data_len:d.length.toString()}),c.push(...d)}),{callArray:b,calldata:cR.compile({calldata:c})}},er=a=>{let{callArray:b,calldata:c}=eq(a);return[...cR.compile({callArray:b}),...c]},es=a=>{let b=a.map(a=>({contractAddress:a.contractAddress,entrypoint:a.entrypoint,calldata:Array.isArray(a.calldata)&&"__compiled__"in a.calldata?a.calldata:cR.compile(a.calldata)}));return cR.compile({orderCalls:b})},et=(a,b="0")=>"1"===b?es(a):er(a);function eu(a,b){let c=[].concat(a).map(a=>{let{classHash:c,salt:d,unique:e=!0,constructorCalldata:f=[]}=a,g=cR.compile(f),h=d??dR();return{call:{contractAddress:W.ADDRESS,entrypoint:W.ENTRYPOINT,calldata:[c,h,bj(e),g.length,...g]},address:dt(e?cW.pedersen(b,h):h,c,g,e?W.ADDRESS:0)}});return{calls:c.map(a=>a.call),addresses:c.map(a=>a.address)}}function ev(a){return"fee"===a?{v1:av.F1,v2:av.F2,v3:av.F3}:{v1:av.V1,v2:av.V2,v3:av.V3}}var ew={headers:{"Content-Type":"application/json"},blockIdentifier:at.PENDING,retries:200},ex=class{id="RPC071";channelSpecVersion=ae.v0_7_1;nodeUrl;headers;requestId;blockIdentifier;retries;waitMode;chainId;specVersion;transactionRetryIntervalFallback;batchClient;baseFetch;constructor(a){let{baseFetch:b,batch:c,blockIdentifier:d,chainId:e,headers:f,nodeUrl:g,retries:h,specVersion:i,transactionRetryIntervalFallback:j,waitMode:k}=a||{};Object.values(ab).includes(g)?this.nodeUrl=ek(g,a?.default,this.channelSpecVersion):g?this.nodeUrl=g:this.nodeUrl=ek(void 0,a?.default,this.channelSpecVersion),this.baseFetch=b||aj.get("fetch")||ef,this.blockIdentifier=d??ew.blockIdentifier,this.chainId=e,this.headers={...ew.headers,...f},this.retries=h??ew.retries,this.specVersion=i,this.transactionRetryIntervalFallback=j,this.waitMode=k??!1,this.requestId=0,"number"==typeof c&&(this.batchClient=new aT({nodeUrl:this.nodeUrl,headers:this.headers,interval:c,baseFetch:this.baseFetch})),al.debug("Using Channel",this.id)}readSpecVersion(){return this.specVersion}get transactionRetryIntervalDefault(){return this.transactionRetryIntervalFallback??5e3}setChainId(a){this.chainId=a}fetch(a,b,c=0){let d={id:c,jsonrpc:"2.0",method:a,...b&&{params:b}};return this.baseFetch(this.nodeUrl,{method:"POST",body:aS(d),headers:this.headers})}errorHandler(a,b,c,d){if(c)throw new d8(c,a,b);if(d instanceof d7)throw d;if(d)throw Error(d.message)}async fetchEndpoint(a,b){try{if(this.batchClient){let{error:c,result:d}=await this.batchClient.fetch(a,b,this.requestId+=1);return this.errorHandler(a,b,c),d}let c=await this.fetch(a,b,this.requestId+=1),{error:d,result:e}=await c.json();return this.errorHandler(a,b,d),e}catch(c){throw this.errorHandler(a,b,c?.response?.data,c),c}}async getChainId(){return this.chainId??=await this.fetchEndpoint("starknet_chainId"),this.chainId}getSpecVersion(){return this.fetchEndpoint("starknet_specVersion")}async setUpSpecVersion(){if(!this.specVersion){let a=await this.fetchEndpoint("starknet_specVersion");if(dI(this.channelSpecVersion,a)||al.error(ai.channelVersionMismatch,{channelId:this.id,channelSpecVersion:this.channelSpecVersion,nodeSpecVersion:this.specVersion}),!dJ(a))throw new d7(`${ai.unsupportedSpecVersion}, channelId: ${this.id}`);this.specVersion=a}return this.specVersion}getNonceForAddress(a,b=this.blockIdentifier){let c=a6(a),d=new eo(b).identifier;return this.fetchEndpoint("starknet_getNonce",{contract_address:c,block_id:d})}getBlockLatestAccepted(){return this.fetchEndpoint("starknet_blockHashAndNumber")}getBlockNumber(){return this.fetchEndpoint("starknet_blockNumber")}getBlockWithTxHashes(a=this.blockIdentifier){let b=new eo(a).identifier;return this.fetchEndpoint("starknet_getBlockWithTxHashes",{block_id:b})}getBlockWithTxs(a=this.blockIdentifier){let b=new eo(a).identifier;return this.fetchEndpoint("starknet_getBlockWithTxs",{block_id:b})}getBlockWithReceipts(a=this.blockIdentifier){let b=new eo(a).identifier;return this.fetchEndpoint("starknet_getBlockWithReceipts",{block_id:b})}getBlockStateUpdate(a=this.blockIdentifier){let b=new eo(a).identifier;return this.fetchEndpoint("starknet_getStateUpdate",{block_id:b})}getBlockTransactionsTraces(a=this.blockIdentifier){let b=new eo(a).identifier;return this.fetchEndpoint("starknet_traceBlockTransactions",{block_id:b})}getBlockTransactionCount(a=this.blockIdentifier){let b=new eo(a).identifier;return this.fetchEndpoint("starknet_getBlockTransactionCount",{block_id:b})}getTransactionByHash(a){let b=a6(a);return this.fetchEndpoint("starknet_getTransactionByHash",{transaction_hash:b})}getTransactionByBlockIdAndIndex(a,b){let c=new eo(a).identifier;return this.fetchEndpoint("starknet_getTransactionByBlockIdAndIndex",{block_id:c,index:b})}getTransactionReceipt(a){let b=a6(a);return this.fetchEndpoint("starknet_getTransactionReceipt",{transaction_hash:b})}getTransactionTrace(a){let b=a6(a);return this.fetchEndpoint("starknet_traceTransaction",{transaction_hash:b})}getTransactionStatus(a){let b=a6(a);return this.fetchEndpoint("starknet_getTransactionStatus",{transaction_hash:b})}simulateTransaction(a,b={}){let{blockIdentifier:c=this.blockIdentifier,skipValidate:d=!0,skipFeeCharge:e=!0}=b,f=new eo(c).identifier,g=[];return d&&g.push(q.ESimulationFlag.SKIP_VALIDATE),e&&g.push(q.ESimulationFlag.SKIP_FEE_CHARGE),this.fetchEndpoint("starknet_simulateTransactions",{block_id:f,transactions:a.map(a=>this.buildTransaction(a)),simulation_flags:g})}async waitForTransaction(a,b){let c,d=a6(a),{retries:e}=this,f=!1,g=!1,h=b?.retryInterval??this.transactionRetryIntervalDefault,i=b?.errorStates??[q.ETransactionStatus.REJECTED],j=b?.successStates??[q.ETransactionExecutionStatus.SUCCEEDED,q.ETransactionStatus.ACCEPTED_ON_L2,q.ETransactionStatus.ACCEPTED_ON_L1];for(;!f;){await eh(h);try{let a=(c=await this.getTransactionStatus(d)).execution_status,b=c.finality_status;if(!b)throw Error("waiting for transaction status");if(i.includes(a)||i.includes(b)){let d=`${a}: ${b}`,e=Error(d);throw e.response=c,g=!0,e}(j.includes(a)||j.includes(b))&&(f=!0)}catch(a){if(a instanceof Error&&g)throw a;if(e<=0)throw Error(`waitForTransaction timed-out with retries ${this.retries}`)}e-=1}let k=null;for(;null===k;){try{k=await this.getTransactionReceipt(d)}catch(a){if(e<=0)throw Error(`waitForTransaction timed-out with retries ${this.retries}`)}e-=1,await eh(h)}return k}getStorageAt(a,b,c=this.blockIdentifier){let d=a6(a),e=a8(b),f=new eo(c).identifier;return this.fetchEndpoint("starknet_getStorageAt",{contract_address:d,key:e,block_id:f})}getClassHashAt(a,b=this.blockIdentifier){let c=a6(a),d=new eo(b).identifier;return this.fetchEndpoint("starknet_getClassHashAt",{block_id:d,contract_address:c})}getClass(a,b=this.blockIdentifier){let c=a6(a),d=new eo(b).identifier;return this.fetchEndpoint("starknet_getClass",{class_hash:c,block_id:d})}getClassAt(a,b=this.blockIdentifier){let c=a6(a),d=new eo(b).identifier;return this.fetchEndpoint("starknet_getClassAt",{block_id:d,contract_address:c})}async getEstimateFee(a,{blockIdentifier:b=this.blockIdentifier,skipValidate:c=!0}){let d=new eo(b).identifier,e={simulation_flags:c?[q.ESimulationFlag.SKIP_VALIDATE]:[]};return this.fetchEndpoint("starknet_estimateFee",{request:a.map(a=>this.buildTransaction(a,"fee")),block_id:d,...e})}async invoke(a,b){let c;return dH(b)?(c=this.fetchEndpoint("starknet_addInvokeTransaction",{invoke_transaction:{type:q.ETransactionType.INVOKE,sender_address:a.contractAddress,calldata:cR.toHex(a.calldata),version:q.ETransactionVersion.V3,signature:dU(a.signature),nonce:a6(b.nonce),resource_bounds:b.resourceBounds,tip:a6(b.tip),paymaster_data:b.paymasterData.map(a=>a6(a)),account_deployment_data:b.accountDeploymentData.map(a=>a6(a)),nonce_data_availability_mode:b.nonceDataAvailabilityMode,fee_data_availability_mode:b.feeDataAvailabilityMode}}),aV(!b.maxFee,()=>{al.warn(ai.maxFeeInV3,{type:q.ETransactionType.INVOKE})})):(c=this.fetchEndpoint("starknet_addInvokeTransaction",{invoke_transaction:{sender_address:a.contractAddress,calldata:cR.toHex(a.calldata),type:q.ETransactionType.INVOKE,max_fee:a6(b.maxFee||0),version:q.ETransactionVersion.V1,signature:dU(a.signature),nonce:a6(b.nonce)}}),al.warn(ai.legacyTxWarningMessage,{version:q.ETransactionVersion.V1,type:q.ETransactionType.INVOKE})),this.waitMode?this.waitForTransaction((await c).transaction_hash):c}async declare({contract:a,signature:b,senderAddress:c,compiledClassHash:d},e){let f;if(d2(a)||dH(e))if(d2(a)&&!dH(e))f=this.fetchEndpoint("starknet_addDeclareTransaction",{declare_transaction:{type:q.ETransactionType.DECLARE,contract_class:{sierra_program:dQ(a.sierra_program),contract_class_version:a.contract_class_version,entry_points_by_type:a.entry_points_by_type,abi:a.abi},compiled_class_hash:d||"",version:q.ETransactionVersion.V2,max_fee:a6(e.maxFee||0),signature:dU(b),sender_address:c,nonce:a6(e.nonce)}}),al.warn(ai.legacyTxWarningMessage,{version:q.ETransactionVersion.V2,type:q.ETransactionType.DECLARE});else if(d2(a)&&dH(e))f=this.fetchEndpoint("starknet_addDeclareTransaction",{declare_transaction:{type:q.ETransactionType.DECLARE,sender_address:c,compiled_class_hash:d||"",version:q.ETransactionVersion.V3,signature:dU(b),nonce:a6(e.nonce),contract_class:{sierra_program:dQ(a.sierra_program),contract_class_version:a.contract_class_version,entry_points_by_type:a.entry_points_by_type,abi:a.abi},resource_bounds:e.resourceBounds,tip:a6(e.tip),paymaster_data:e.paymasterData.map(a=>a6(a)),account_deployment_data:e.accountDeploymentData.map(a=>a6(a)),nonce_data_availability_mode:e.nonceDataAvailabilityMode,fee_data_availability_mode:e.feeDataAvailabilityMode}}),aV(!e.maxFee,()=>{al.warn(ai.maxFeeInV3,{type:q.ETransactionType.DECLARE})});else throw Error("declare unspotted parameters");else f=this.fetchEndpoint("starknet_addDeclareTransaction",{declare_transaction:{type:q.ETransactionType.DECLARE,contract_class:{program:a.program,entry_points_by_type:a.entry_points_by_type,abi:a.abi},version:q.ETransactionVersion.V1,max_fee:a6(e.maxFee||0),signature:dU(b),sender_address:c,nonce:a6(e.nonce)}}),al.warn(ai.legacyTxWarningMessage,{version:q.ETransactionVersion.V1,type:q.ETransactionType.DECLARE});return this.waitMode?this.waitForTransaction((await f).transaction_hash):f}async deployAccount({classHash:a,constructorCalldata:b,addressSalt:c,signature:d},e){let f;return dH(e)?(f=this.fetchEndpoint("starknet_addDeployAccountTransaction",{deploy_account_transaction:{type:q.ETransactionType.DEPLOY_ACCOUNT,version:q.ETransactionVersion.V3,signature:dU(d),nonce:a6(e.nonce),contract_address_salt:a6(c||0),constructor_calldata:cR.toHex(b||[]),class_hash:a6(a),resource_bounds:e.resourceBounds,tip:a6(e.tip),paymaster_data:e.paymasterData.map(a=>a6(a)),nonce_data_availability_mode:e.nonceDataAvailabilityMode,fee_data_availability_mode:e.feeDataAvailabilityMode}}),aV(!e.maxFee,()=>{al.warn(ai.maxFeeInV3,{type:q.ETransactionType.DEPLOY_ACCOUNT})})):(f=this.fetchEndpoint("starknet_addDeployAccountTransaction",{deploy_account_transaction:{constructor_calldata:cR.toHex(b||[]),class_hash:a6(a),contract_address_salt:a6(c||0),type:q.ETransactionType.DEPLOY_ACCOUNT,max_fee:a6(e.maxFee||0),version:q.ETransactionVersion.V1,signature:dU(d),nonce:a6(e.nonce)}}),al.warn(ai.legacyTxWarningMessage,{version:q.ETransactionVersion.V1,type:q.ETransactionType.DEPLOY_ACCOUNT})),this.waitMode?this.waitForTransaction((await f).transaction_hash):f}callContract(a,b=this.blockIdentifier){let c=new eo(b).identifier;return this.fetchEndpoint("starknet_call",{request:{contract_address:a.contractAddress,entry_point_selector:bu(a.entrypoint),calldata:cR.toHex(a.calldata)},block_id:c})}estimateMessageFee(a,b=this.blockIdentifier){let{from_address:c,to_address:d,entry_point_selector:e,payload:f}=a,g={from_address:ee(c),to_address:a6(d),entry_point_selector:bv(e),payload:bi(f)},h=new eo(b).identifier;return this.fetchEndpoint("starknet_estimateMessageFee",{message:g,block_id:h})}getSyncingStats(){return this.fetchEndpoint("starknet_syncing")}getEvents(a){return this.fetchEndpoint("starknet_getEvents",{filter:a})}buildTransaction(a,b){let c,d=ev(b);if(dH(a)?(c={signature:dU(a.signature),nonce:a6(a.nonce),resource_bounds:a.resourceBounds,tip:a6(a.tip),paymaster_data:a.paymasterData.map(a=>a6(a)),nonce_data_availability_mode:a.nonceDataAvailabilityMode,fee_data_availability_mode:a.feeDataAvailabilityMode,account_deployment_data:a.accountDeploymentData.map(a=>a6(a))},aV(!a.maxFee,()=>{al.warn(ai.maxFeeInV3,{type:a.type,versionType:b})})):(c={signature:dU(a.signature),nonce:a6(a.nonce),max_fee:a6(a.maxFee||0)},al.warn(ai.legacyTxWarningMessage,{version:a.version,type:a.type})),a.type===ap.INVOKE)return{type:q.ETransactionType.INVOKE,sender_address:a.contractAddress,calldata:cR.toHex(a.calldata),version:a6(a.version||d.v3),...c};if(a.type===ap.DECLARE)return d2(a.contract)?{type:a.type,contract_class:{...a.contract,sierra_program:dQ(a.contract.sierra_program)},compiled_class_hash:a.compiledClassHash||"",sender_address:a.senderAddress,version:a6(a.version||d.v3),...c}:{type:a.type,contract_class:a.contract,sender_address:a.senderAddress,version:a6(a.version||d.v1),...c};if(a.type===ap.DEPLOY_ACCOUNT){let{account_deployment_data:b,...e}=c;return{type:a.type,constructor_calldata:cR.toHex(a.constructorCalldata||[]),class_hash:a6(a.classHash),contract_address_salt:a6(a.addressSalt||0),version:a6(a.version||d.v3),...e}}throw Error("RPC buildTransaction received unknown TransactionType")}},ey={};j(ey,{RpcChannel:()=>eA});var ez={headers:{"Content-Type":"application/json"},blockIdentifier:at.PENDING,retries:200},eA=class{id="RPC081";channelSpecVersion=ae.v0_8_1;nodeUrl;headers;requestId;blockIdentifier;retries;waitMode;chainId;specVersion;transactionRetryIntervalFallback;batchClient;baseFetch;constructor(a){let{baseFetch:b,batch:c,blockIdentifier:d,chainId:e,headers:f,nodeUrl:g,retries:h,specVersion:i,transactionRetryIntervalFallback:j,waitMode:k}=a||{};Object.values(ab).includes(g)?this.nodeUrl=ek(g,a?.default,this.channelSpecVersion):g?this.nodeUrl=g:this.nodeUrl=ek(void 0,a?.default,this.channelSpecVersion),this.baseFetch=b||aj.get("fetch")||ef,this.blockIdentifier=d??ez.blockIdentifier,this.chainId=e,this.headers={...ez.headers,...f},this.retries=h??ez.retries,this.specVersion=i,this.transactionRetryIntervalFallback=j,this.waitMode=k??!1,this.requestId=0,"number"==typeof c&&(this.batchClient=new aT({nodeUrl:this.nodeUrl,headers:this.headers,interval:c,baseFetch:this.baseFetch})),al.debug("Using Channel",this.id)}readSpecVersion(){return this.specVersion}get transactionRetryIntervalDefault(){return this.transactionRetryIntervalFallback??5e3}setChainId(a){this.chainId=a}fetch(a,b,c=0){let d={id:c,jsonrpc:"2.0",method:a,...b&&{params:b}};return this.baseFetch(this.nodeUrl,{method:"POST",body:aS(d),headers:this.headers})}errorHandler(a,b,c,d){if(c)throw new d8(c,a,b);if(d instanceof d7)throw d;if(d)throw Error(d.message)}async fetchEndpoint(a,b){try{if(this.batchClient){let{error:c,result:d}=await this.batchClient.fetch(a,b,this.requestId+=1);return this.errorHandler(a,b,c),d}let c=await this.fetch(a,b,this.requestId+=1),{error:d,result:e}=await c.json();return this.errorHandler(a,b,d),e}catch(c){throw this.errorHandler(a,b,c?.response?.data,c),c}}async getChainId(){return this.chainId??=await this.fetchEndpoint("starknet_chainId"),this.chainId}getSpecVersion(){return this.fetchEndpoint("starknet_specVersion")}async setUpSpecVersion(){if(!this.specVersion){let a=await this.fetchEndpoint("starknet_specVersion");if(dI(this.channelSpecVersion,a)||al.error(ai.channelVersionMismatch,{channelId:this.id,channelSpecVersion:this.channelSpecVersion,nodeSpecVersion:this.specVersion}),!dJ(a))throw new d7(`${ai.unsupportedSpecVersion}, channelId: ${this.id}`);this.specVersion=a}return this.specVersion}getMessagesStatus(a){let b=a6(a);return this.fetchEndpoint("starknet_getMessagesStatus",{transaction_hash:b})}getStorageProof(a=[],b=[],c=[],d=this.blockIdentifier){let e=new eo(d).identifier,f=be(a),g=be(b);return this.fetchEndpoint("starknet_getStorageProof",{block_id:e,class_hashes:f,contract_addresses:g,contracts_storage_keys:c})}getCompiledCasm(a){let b=a6(a);return this.fetchEndpoint("starknet_getCompiledCasm",{class_hash:b})}getNonceForAddress(a,b=this.blockIdentifier){let c=a6(a),d=new eo(b).identifier;return this.fetchEndpoint("starknet_getNonce",{contract_address:c,block_id:d})}getBlockLatestAccepted(){return this.fetchEndpoint("starknet_blockHashAndNumber")}getBlockNumber(){return this.fetchEndpoint("starknet_blockNumber")}getBlockWithTxHashes(a=this.blockIdentifier){let b=new eo(a).identifier;return this.fetchEndpoint("starknet_getBlockWithTxHashes",{block_id:b})}getBlockWithTxs(a=this.blockIdentifier){let b=new eo(a).identifier;return this.fetchEndpoint("starknet_getBlockWithTxs",{block_id:b})}getBlockWithReceipts(a=this.blockIdentifier){let b=new eo(a).identifier;return this.fetchEndpoint("starknet_getBlockWithReceipts",{block_id:b})}getBlockStateUpdate(a=this.blockIdentifier){let b=new eo(a).identifier;return this.fetchEndpoint("starknet_getStateUpdate",{block_id:b})}getBlockTransactionsTraces(a=this.blockIdentifier){let b=new eo(a).identifier;return this.fetchEndpoint("starknet_traceBlockTransactions",{block_id:b})}getBlockTransactionCount(a=this.blockIdentifier){let b=new eo(a).identifier;return this.fetchEndpoint("starknet_getBlockTransactionCount",{block_id:b})}getTransactionByHash(a){let b=a6(a);return this.fetchEndpoint("starknet_getTransactionByHash",{transaction_hash:b})}getTransactionByBlockIdAndIndex(a,b){let c=new eo(a).identifier;return this.fetchEndpoint("starknet_getTransactionByBlockIdAndIndex",{block_id:c,index:b})}getTransactionReceipt(a){let b=a6(a);return this.fetchEndpoint("starknet_getTransactionReceipt",{transaction_hash:b})}getTransactionTrace(a){let b=a6(a);return this.fetchEndpoint("starknet_traceTransaction",{transaction_hash:b})}getTransactionStatus(a){let b=a6(a);return this.fetchEndpoint("starknet_getTransactionStatus",{transaction_hash:b})}simulateTransaction(a,b={}){let{blockIdentifier:c=this.blockIdentifier,skipValidate:d=!0,skipFeeCharge:e=!0}=b,f=new eo(c).identifier,g=[];return d&&g.push(r.ESimulationFlag.SKIP_VALIDATE),e&&g.push(r.ESimulationFlag.SKIP_FEE_CHARGE),this.fetchEndpoint("starknet_simulateTransactions",{block_id:f,transactions:a.map(a=>this.buildTransaction(a)),simulation_flags:g})}async waitForTransaction(a,b){let c,d=a6(a),{retries:e}=this,f=!1,g=!1,h=b?.retryInterval??this.transactionRetryIntervalDefault,i=b?.errorStates??[r.ETransactionStatus.REJECTED],j=b?.successStates??[r.ETransactionExecutionStatus.SUCCEEDED,r.ETransactionStatus.ACCEPTED_ON_L2,r.ETransactionStatus.ACCEPTED_ON_L1];for(;!f;){await eh(h);try{let a=(c=await this.getTransactionStatus(d)).execution_status,b=c.finality_status;if(!b)throw Error("waiting for transaction status");if(i.includes(a)||i.includes(b)){let d=`${a}: ${b}`,e=Error(d);throw e.response=c,g=!0,e}(j.includes(a)||j.includes(b))&&(f=!0)}catch(a){if(a instanceof Error&&g)throw a;if(e<=0)throw Error(`waitForTransaction timed-out with retries ${this.retries}`)}e-=1}let k=null;for(;null===k;){try{k=await this.getTransactionReceipt(d)}catch(a){if(e<=0)throw Error(`waitForTransaction timed-out with retries ${this.retries}`)}e-=1,await eh(h)}return k}getStorageAt(a,b,c=this.blockIdentifier){let d=a6(a),e=a8(b),f=new eo(c).identifier;return this.fetchEndpoint("starknet_getStorageAt",{contract_address:d,key:e,block_id:f})}getClassHashAt(a,b=this.blockIdentifier){let c=a6(a),d=new eo(b).identifier;return this.fetchEndpoint("starknet_getClassHashAt",{block_id:d,contract_address:c})}getClass(a,b=this.blockIdentifier){let c=a6(a),d=new eo(b).identifier;return this.fetchEndpoint("starknet_getClass",{class_hash:c,block_id:d})}getClassAt(a,b=this.blockIdentifier){let c=a6(a),d=new eo(b).identifier;return this.fetchEndpoint("starknet_getClassAt",{block_id:d,contract_address:c})}async getEstimateFee(a,{blockIdentifier:b=this.blockIdentifier,skipValidate:c=!0}){let d=new eo(b).identifier,e={simulation_flags:c?[r.ESimulationFlag.SKIP_VALIDATE]:[]};return this.fetchEndpoint("starknet_estimateFee",{request:a.map(a=>this.buildTransaction(a,"fee")),block_id:d,...e})}async invoke(a,b){let c;if(dH(b))if(aB(b.resourceBounds))c=this.fetchEndpoint("starknet_addInvokeTransaction",{invoke_transaction:{type:r.ETransactionType.INVOKE,sender_address:a.contractAddress,calldata:cR.toHex(a.calldata),version:r.ETransactionVersion.V3,signature:dU(a.signature),nonce:a6(b.nonce),resource_bounds:b.resourceBounds,tip:a6(b.tip),paymaster_data:b.paymasterData.map(a=>a6(a)),account_deployment_data:b.accountDeploymentData.map(a=>a6(a)),nonce_data_availability_mode:b.nonceDataAvailabilityMode,fee_data_availability_mode:b.feeDataAvailabilityMode}});else throw Error(ai.SWOldV3);else throw Error(ai.legacyTxRPC08Message);return this.waitMode?this.waitForTransaction((await c).transaction_hash):c}async declare({contract:a,signature:b,senderAddress:c,compiledClassHash:d},e){let f;if(d2(a)&&dH(e))if(aB(e.resourceBounds))f=this.fetchEndpoint("starknet_addDeclareTransaction",{declare_transaction:{type:r.ETransactionType.DECLARE,sender_address:c,compiled_class_hash:d||"",version:r.ETransactionVersion.V3,signature:dU(b),nonce:a6(e.nonce),contract_class:{sierra_program:dQ(a.sierra_program),contract_class_version:a.contract_class_version,entry_points_by_type:a.entry_points_by_type,abi:a.abi},resource_bounds:e.resourceBounds,tip:a6(e.tip),paymaster_data:e.paymasterData.map(a=>a6(a)),account_deployment_data:e.accountDeploymentData.map(a=>a6(a)),nonce_data_availability_mode:e.nonceDataAvailabilityMode,fee_data_availability_mode:e.feeDataAvailabilityMode}});else throw Error(ai.SWOldV3);else throw Error(ai.legacyTxRPC08Message);return this.waitMode?this.waitForTransaction((await f).transaction_hash):f}async deployAccount({classHash:a,constructorCalldata:b,addressSalt:c,signature:d},e){let f;if(dH(e))if(aB(e.resourceBounds))f=this.fetchEndpoint("starknet_addDeployAccountTransaction",{deploy_account_transaction:{type:r.ETransactionType.DEPLOY_ACCOUNT,version:r.ETransactionVersion.V3,signature:dU(d),nonce:a6(e.nonce),contract_address_salt:a6(c||0),constructor_calldata:cR.toHex(b||[]),class_hash:a6(a),resource_bounds:e.resourceBounds,tip:a6(e.tip),paymaster_data:e.paymasterData.map(a=>a6(a)),nonce_data_availability_mode:e.nonceDataAvailabilityMode,fee_data_availability_mode:e.feeDataAvailabilityMode}});else throw Error(ai.SWOldV3);else throw Error(ai.legacyTxRPC08Message);return this.waitMode?this.waitForTransaction((await f).transaction_hash):f}callContract(a,b=this.blockIdentifier){let c=new eo(b).identifier;return this.fetchEndpoint("starknet_call",{request:{contract_address:a.contractAddress,entry_point_selector:bu(a.entrypoint),calldata:cR.toHex(a.calldata)},block_id:c})}estimateMessageFee(a,b=this.blockIdentifier){let{from_address:c,to_address:d,entry_point_selector:e,payload:f}=a,g={from_address:ee(c),to_address:a6(d),entry_point_selector:bv(e),payload:bi(f)},h=new eo(b).identifier;return this.fetchEndpoint("starknet_estimateMessageFee",{message:g,block_id:h})}getSyncingStats(){return this.fetchEndpoint("starknet_syncing")}getEvents(a){return this.fetchEndpoint("starknet_getEvents",{filter:a})}buildTransaction(a,b){let c,d=ev(b);if(dH(a))c={signature:dU(a.signature),nonce:a6(a.nonce),resource_bounds:a.resourceBounds,tip:a6(a.tip),paymaster_data:a.paymasterData.map(a=>a6(a)),nonce_data_availability_mode:a.nonceDataAvailabilityMode,fee_data_availability_mode:a.feeDataAvailabilityMode,account_deployment_data:a.accountDeploymentData.map(a=>a6(a))};else throw Error("v0,v1,v2 tx are not supported on RPC 0.8");if(a.type===ap.INVOKE)return{type:r.ETransactionType.INVOKE,sender_address:a.contractAddress,calldata:cR.toHex(a.calldata),version:a6(a.version||d.v3),...c};if(a.type===ap.DECLARE){if(!d2(a.contract))throw al.error("Cairo 0 -  non Sierra v1 tx are not supported"),Error("Declaring non Sierra contract using RPC 0.8");return{type:a.type,contract_class:{...a.contract,sierra_program:dQ(a.contract.sierra_program)},compiled_class_hash:a.compiledClassHash||"",sender_address:a.senderAddress,version:a6(a.version||d.v3),...c}}if(a.type===ap.DEPLOY_ACCOUNT){let{account_deployment_data:b,...e}=c;return{type:a.type,constructor_calldata:cR.toHex(a.constructorCalldata||[]),class_hash:a6(a.classHash),contract_address_salt:a6(a.addressSalt||0),version:a6(a.version||d.v3),...e}}throw Error("RPC buildTransaction received unknown TransactionType")}},eB=class{listeners={};on(a,b){this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push(b)}off(a,b){this.listeners[a]&&(this.listeners[a]=this.listeners[a].filter(a=>a!==b))}emit(a,b){this.listeners[a]&&this.listeners[a].forEach(a=>a(b))}clear(){this.listeners={}}},eC="undefined"!=typeof WebSocket&&WebSocket||"undefined"!=typeof globalThis&&globalThis.WebSocket||a.g.WebSocket||class{constructor(){throw new d7("WebSocket module not detected, use the 'websocket' constructor parameter to set a compatible connection")}},eD=class{channel;method;params;id;events=new eB;buffer=[];maxBufferSize;handler=null;_isClosed=!1;constructor(a,b,c,d,e){this.channel=a,this.method=b,this.params=c,this.id=d,this.maxBufferSize=e}get isClosed(){return this._isClosed}_handleEvent(a){if(this.handler)this.handler(a);else{if(this.buffer.length>=this.maxBufferSize){let a=this.buffer.shift();al.warn(`Subscription ${this.id}: Buffer full. Dropping oldest event:`,a)}this.buffer.push(a)}}on(a){if(this.handler)throw Error("A handler is already attached to this subscription.");for(this.handler=a;this.buffer.length>0;){let a=this.buffer.shift();a&&this.handler(a)}}async unsubscribe(){if(this._isClosed)return!0;let a=await this.channel.unsubscribe(this.id);return a&&(this._isClosed=!0,this.channel.removeSubscription(this.id),this.events.emit("unsubscribe",void 0),this.events.clear()),a}},eE=class{nodeUrl;websocket;WsImplementation;activeSubscriptions=new Map;maxBufferSize;autoReconnect;reconnectOptions;requestTimeout;isReconnecting=!1;reconnectAttempts=0;userInitiatedClose=!1;reconnectTimeoutId=null;requestQueue=[];events=new eB;openListener=a=>this.events.emit("open",a);closeListener=this.onCloseProxy.bind(this);messageListener=this.onMessageProxy.bind(this);errorListener=a=>this.events.emit("error",a);sendId=0;constructor(a){this.nodeUrl=a.nodeUrl,this.maxBufferSize=a.maxBufferSize??1e3,this.autoReconnect=a.autoReconnect??!0,this.reconnectOptions={retries:a.reconnectOptions?.retries??5,delay:a.reconnectOptions?.delay??2e3},this.requestTimeout=a.requestTimeout??6e4,this.WsImplementation=a.websocket||aj.get("websocket")||eC,this.websocket=new this.WsImplementation(this.nodeUrl),this.websocket.addEventListener("open",this.openListener),this.websocket.addEventListener("close",this.closeListener),this.websocket.addEventListener("message",this.messageListener),this.websocket.addEventListener("error",this.errorListener)}idResolver(a){return a||this.sendId++}send(a,b,c){if(!this.isConnected())throw new ea("WebSocketChannel.send() failed due to socket being disconnected");let d=this.idResolver(c),e={id:d,jsonrpc:"2.0",method:a,...b&&{params:b}};return this.websocket.send(aS(e)),d}sendReceive(a,b){if(this.isReconnecting||!this.isConnected()&&this.autoReconnect&&!this.userInitiatedClose)return al.info(`WebSocket: Connection unavailable, queueing request: ${a}`),new Promise((c,d)=>{this.requestQueue.push({method:a,params:b,resolve:c,reject:d})});let c=this.send(a,b);return new Promise((b,d)=>{let e;if(!this.websocket||this.websocket.readyState!==eC.OPEN)return void d(new ea("WebSocket not available or not connected."));let f=h=>{if(!a1(h.data))return void al.warn("WebSocket received non-string message data:",h.data);let i=JSON.parse(h.data);i.id===c&&(clearTimeout(e),this.websocket.removeEventListener("message",f),this.websocket.removeEventListener("error",g),"result"in i?b(i.result):d(Error(`Error on ${a} (id: ${c}): ${JSON.stringify(i.error)}`)))},g=b=>{clearTimeout(e),this.websocket.removeEventListener("message",f),this.websocket.removeEventListener("error",g),d(Error(`WebSocket error during ${a} (id: ${c}): ${b.type||"Unknown error"}`))};this.websocket.addEventListener("message",f),this.websocket.addEventListener("error",g),e=setTimeout(()=>{this.websocket.removeEventListener("message",f),this.websocket.removeEventListener("error",g),d(new d9(`Request ${a} (id: ${c}) timed out after ${this.requestTimeout}ms`))},this.requestTimeout)})}isConnected(){return this.websocket.readyState===eC.OPEN}async waitForConnection(){return this.websocket.readyState!==eC.OPEN?new Promise((a,b)=>{this.websocket&&(this.websocket.onopen=()=>a(this.websocket.readyState),this.websocket.onerror=a=>b(a))}):this.websocket.readyState}disconnect(a,b){this.reconnectTimeoutId&&(clearTimeout(this.reconnectTimeoutId),this.reconnectTimeoutId=null),this.websocket.close(a,b),this.userInitiatedClose=!0}async waitForDisconnection(){return this.websocket.readyState!==eC.CLOSED?new Promise((a,b)=>{this.websocket&&(this.websocket.onclose=()=>a(this.websocket.readyState),this.websocket.onerror=b)}):this.websocket.readyState}async unsubscribe(a){let b=await this.sendReceive("starknet_unsubscribe",{subscription_id:a});return b&&this.events.emit("unsubscribe",a),b}waitForUnsubscription(a){return new Promise(b=>{let c=d=>{d===a&&(this.events.off("unsubscribe",c),b())};this.events.on("unsubscribe",c)})}reconnect(){this.userInitiatedClose=!1,this.websocket=new this.WsImplementation(this.nodeUrl),this.websocket.addEventListener("open",this.openListener),this.websocket.addEventListener("close",this.closeListener),this.websocket.addEventListener("message",this.messageListener),this.websocket.addEventListener("error",this.errorListener)}_processRequestQueue(){for(al.info(`WebSocket: Processing ${this.requestQueue.length} queued requests.`);this.requestQueue.length>0;){let{method:a,params:b,resolve:c,reject:d}=this.requestQueue.shift();this.sendReceive(a,b).then(c).catch(d)}}async _restoreSubscriptions(){let a=Array.from(this.activeSubscriptions.values());this.activeSubscriptions.clear();let b=a.map(async a=>{try{let b=await this.sendReceive(a.method,a.params);a.id=b,this.activeSubscriptions.set(b,a),al.info(`Subscription ${a.method} restored with new ID: ${b}`)}catch(b){al.error(`Failed to restore subscription ${a.method}:`,b)}});await Promise.all(b)}_startReconnect(){if(this.isReconnecting||!this.autoReconnect)return;this.isReconnecting=!0,this.reconnectAttempts=0;let a=()=>{if(this.reconnectAttempts>=this.reconnectOptions.retries){al.error("WebSocket: Maximum reconnection retries reached. Giving up."),this.isReconnecting=!1;return}this.reconnectAttempts+=1,al.info(`WebSocket: Connection lost. Attempting to reconnect... (${this.reconnectAttempts}/${this.reconnectOptions.retries})`),this.reconnect(),this.websocket.onopen=async()=>{al.info("WebSocket: Reconnection successful."),this.isReconnecting=!1,this.reconnectAttempts=0,await this._restoreSubscriptions(),this._processRequestQueue(),this.events.emit("open",new Event("open"))},this.websocket.onerror=()=>{let b=this.reconnectOptions.delay*2**(this.reconnectAttempts-1);al.info(`WebSocket: Reconnect attempt failed. Retrying in ${b}ms.`),this.reconnectTimeoutId=setTimeout(a,b)}};a()}onCloseProxy(a){this.websocket.removeEventListener("open",this.openListener),this.websocket.removeEventListener("close",this.closeListener),this.websocket.removeEventListener("message",this.messageListener),this.websocket.removeEventListener("error",this.errorListener),this.events.emit("close",a),this.userInitiatedClose||this._startReconnect()}onMessageProxy(a){let b;try{b=JSON.parse(a.data)}catch(b){al.error(`WebSocketChannel: Error parsing incoming message: ${a.data}, Error: ${b}`);return}if(b.method&&a2(b.params)&&"subscription_id"in b.params){let{result:a,subscription_id:c}=b.params,d=this.activeSubscriptions.get(c);d?d._handleEvent(a):al.warn(`WebSocketChannel: Received event for untracked subscription ID: ${c}.`)}al.debug("onMessageProxy:",a.data),this.events.emit("message",a)}async subscribeNewHeads(a){let b="starknet_subscribeNewHeads",c={block_id:a?new eo(a).identifier:void 0},d=await this.sendReceive(b,c),e=new eD(this,b,c,d,this.maxBufferSize);return this.activeSubscriptions.set(d,e),e}async subscribeEvents(a,b,c){let d="starknet_subscribeEvents",e={from_address:void 0!==a?a6(a):void 0,keys:b,block_id:c?new eo(c).identifier:void 0},f=await this.sendReceive(d,e),g=new eD(this,d,e,f,this.maxBufferSize);return this.activeSubscriptions.set(f,g),g}async subscribeTransactionStatus(a,b){let c="starknet_subscribeTransactionStatus",d={transaction_hash:a6(a),block_id:b?new eo(b).identifier:void 0},e=await this.sendReceive(c,d),f=new eD(this,c,d,e,this.maxBufferSize);return this.activeSubscriptions.set(e,f),f}async subscribePendingTransaction(a,b){let c="starknet_subscribePendingTransactions",d={transaction_details:a,sender_address:b&&be(b)},e=await this.sendReceive(c,d),f=new eD(this,c,d,e,this.maxBufferSize);return this.activeSubscriptions.set(e,f),f}removeSubscription(a){this.activeSubscriptions.delete(a)}on(a,b){this.events.on(a,b)}off(a,b){this.events.off(a,b)}},eF=class{margin;constructor(a){this.margin=a}estimatedFeeToMaxFee(a){return dV(a,this.margin?.maxFee)}estimateFeeToBounds(a){return dW(a,this.margin?.bounds)}parseGetBlockResponse(a){return a}parseTransactionReceipt(a){return a}parseFeeEstimateResponse(a){let b=a[0];return{overall_fee:a4(b.overall_fee),unit:b.unit,l1_gas_consumed:a5(b.l1_gas_consumed)??a5(b.gas_consumed)??0n,l1_gas_price:a5(b.l1_gas_price)??a5(b.gas_price)??0n,l2_gas_consumed:a5(b.l2_gas_consumed)??void 0,l2_gas_price:a5(b.l2_gas_price)??void 0,l1_data_gas_consumed:a5(b.l1_data_gas_consumed)??a5(b.data_gas_consumed)??0n,l1_data_gas_price:a5(b.l1_data_gas_price)??a5(b.gas_price)??0n,suggestedMaxFee:this.estimatedFeeToMaxFee(b.overall_fee),resourceBounds:this.estimateFeeToBounds(b)}}parseFeeEstimateBulkResponse(a){return a.map(a=>({overall_fee:a4(a.overall_fee),unit:a.unit,l1_gas_consumed:a5(a.l1_gas_consumed)??a5(a.gas_consumed)??0n,l1_gas_price:a5(a.l1_gas_price)??a5(a.gas_price)??0n,l2_gas_consumed:a5(a.l2_gas_consumed)??void 0,l2_gas_price:a5(a.l2_gas_price)??void 0,l1_data_gas_consumed:a5(a.l1_data_gas_consumed)??a5(a.data_gas_consumed)??0n,l1_data_gas_price:a5(a.l1_data_gas_price)??a5(a.gas_price)??0n,suggestedMaxFee:this.estimatedFeeToMaxFee(a.overall_fee),resourceBounds:this.estimateFeeToBounds(a)}))}parseSimulateTransactionResponse(a){return a.map(a=>({...a,suggestedMaxFee:this.estimatedFeeToMaxFee(a.fee_estimation.overall_fee),resourceBounds:this.estimateFeeToBounds(a.fee_estimation)}))}parseContractClassResponse(a){return{...a,abi:a1(a.abi)?JSON.parse(a.abi):a.abi}}parseL1GasPriceResponse(a){return a.l1_gas_price.price_in_wei}},eG=class a{statusReceipt;value;constructor(b){for(let[c]of([this.statusReceipt,this.value]=a.isSuccess(b)?["success",b]:a.isReverted(b)?["reverted",b]:["error",Error("Unknown response type")],Object.entries(this)))Object.defineProperty(this,c,{enumerable:!1});for(let[a,c]of Object.entries(b))Object.defineProperty(this,a,{enumerable:!0,writable:!1,value:c})}match(a){return this.statusReceipt in a?a[this.statusReceipt](this.value):a._()}isSuccess(){return"success"===this.statusReceipt}isReverted(){return"reverted"===this.statusReceipt}isError(){return"error"===this.statusReceipt}static isSuccess(a){return a.execution_status===ar.SUCCEEDED}static isReverted(a){return a.execution_status===ar.REVERTED}},eH={};j(eH,{encodeData:()=>eW,encodeType:()=>eT,encodeValue:()=>eV,getDependencies:()=>eS,getMessageHash:()=>eY,getStructHash:()=>eX,getTypeHash:()=>eU,isMerkleTreeType:()=>eR,prepareSelector:()=>eQ,validateTypedData:()=>eP,verifyMessage:()=>eZ});var eI={};j(eI,{MerkleTree:()=>eJ,proofMerklePath:()=>function a(b,c,d,e=dn){if(0===d.length)return b===c;let[f,...g]=d;return a(b,eJ.hash(c,f,e),g,e)}});var eJ=class a{leaves;branches=[];root;hashMethod;constructor(a,b=dn){this.hashMethod=b,this.leaves=a,this.root=this.build(a)}build(b){if(1===b.length)return b[0];b.length!==this.leaves.length&&this.branches.push(b);let c=[];for(let d=0;d<b.length;d+=2)d+1===b.length?c.push(a.hash(b[d],"0x0",this.hashMethod)):c.push(a.hash(b[d],b[d+1],this.hashMethod));return this.build(c)}static hash(a,b,c=dn){let[d,e]=[BigInt(a),BigInt(b)].sort((a,b)=>a>=b?1:-1);return c(d,e)}getProof(b,c=this.leaves,d=[]){let e=c.indexOf(b);if(-1===e)throw Error("leaf not found");if(1===c.length)return d;let f=e%2==0,g=(f?c[e+1]:c[e-1])??"0x0",h=[...d,g],i=this.leaves.length===c.length?-1:this.branches.findIndex(a=>a.length===c.length),j=this.branches[i+1]??[this.root];return this.getProof(a.hash(f?b:g,f?g:b,this.hashMethod),j,h)}},eK={u256:JSON.parse('[{ "name": "low", "type": "u128" }, { "name": "high", "type": "u128" }]'),TokenAmount:JSON.parse('[{ "name": "token_address", "type": "ContractAddress" }, { "name": "amount", "type": "u256" }]'),NftId:JSON.parse('[{ "name": "collection_address", "type": "ContractAddress" }, { "name": "token_id", "type": "u256" }]')},eL={[aM.TypedDataRevision.ACTIVE]:{domain:"StarknetDomain",hashMethod:ds,hashMerkleMethod:dp,escapeTypeString:a=>`"${a}"`,presetTypes:eK},[aM.TypedDataRevision.LEGACY]:{domain:"StarkNetDomain",hashMethod:dr,hashMerkleMethod:dn,escapeTypeString:a=>a,presetTypes:{}}};function eM(a,b,{min:c,max:d}){let e=BigInt(a);aU(e>=c&&e<=d,`${e} (${b}) is out of bounds [${c}, ${d}]`)}function eN({types:a,domain:b}){return eL[aM.TypedDataRevision.ACTIVE].domain in a&&b.revision?.toString()===aM.TypedDataRevision.ACTIVE?aM.TypedDataRevision.ACTIVE:eL[aM.TypedDataRevision.LEGACY].domain in a&&(b.revision??aM.TypedDataRevision.LEGACY)===aM.TypedDataRevision.LEGACY?aM.TypedDataRevision.LEGACY:void 0}function eO(a){try{return a6(a)}catch(b){if(a1(a))return a6(bH(a));throw Error(`Invalid BigNumberish: ${a}`)}}function eP(a){return!!(a.message&&a.primaryType&&a.types&&eN(a))}function eQ(a){return a3(a)?a:bu(a)}function eR(a){return"merkletree"===a.type}function eS(a,b,c=[],d="",e=aM.TypedDataRevision.LEGACY){let f=[b];return"*"===b[b.length-1]?f=[b.slice(0,-1)]:e===aM.TypedDataRevision.ACTIVE&&("enum"===b?f=[d]:b.match(/^\(.*\)$/)&&(f=b.slice(1,-1).split(",").map(a=>"*"===a[a.length-1]?a.slice(0,-1):a))),f.filter(b=>!c.includes(b)&&a[b]).reduce((b,c)=>[...b,...[c,...a[c].reduce((b,c)=>[...b,...eS(a,c.type,b,c.contains,e).filter(a=>!b.includes(a))],[])].filter(a=>!b.includes(a))],[])}function eT(a,b,c=aM.TypedDataRevision.LEGACY){let d=c===aM.TypedDataRevision.ACTIVE?{...a,...eL[c].presetTypes}:a,[e,...f]=eS(d,b,void 0,void 0,c),g=e?[e,...f.sort()]:[],h=eL[c].escapeTypeString;return g.map(a=>{let b=d[a].map(a=>{let b="enum"===a.type&&c===aM.TypedDataRevision.ACTIVE?a.contains:a.type,d=b.match(/^\(.*\)$/)?`(${b.slice(1,-1).split(",").map(a=>a?h(a):a).join(",")})`:h(b);return`${h(a.name)}:${d}`});return`${h(a)}(${b})`}).join("")}function eU(a,b,c=aM.TypedDataRevision.LEGACY){return bu(eT(a,b,c))}function eV(a,b,c,d={},e=aM.TypedDataRevision.LEGACY){if(a[b])return[b,eX(a,b,c,e)];if(eL[e].presetTypes[b])return[b,eX(eL[e].presetTypes,b,c,e)];if(b.endsWith("*")){let d=c.map(c=>eV(a,b.slice(0,-1),c,void 0,e)[1]);return[b,eL[e].hashMethod(d)]}switch(b){case"enum":if(e===aM.TypedDataRevision.ACTIVE){let[f,g]=Object.entries(c)[0],h=a[d.parent].find(a=>a.name===d.key),i=a[h.contains],j=i.find(a=>a.name===f),k=i.indexOf(j),l=j.type.slice(1,-1).split(",").map((b,c)=>b?eV(a,b,g[c],void 0,e)[1]:b);return[b,eL[e].hashMethod([k,...l])]}return[b,eO(c)];case"merkletree":{let b=function(a,b){if(b.parent&&b.key){let c=a[b.parent].find(a=>a.name===b.key);if(!eR(c))throw Error(`${b.key} is not a merkle tree`);if(c.contains.endsWith("*"))throw Error(`Merkle tree contain property must not be an array but was given ${b.key}`);return c.contains}return"raw"}(a,d),{root:f}=new eJ(c.map(c=>eV(a,b,c,void 0,e)[1]),eL[e].hashMerkleMethod);return["felt",f]}case"selector":return["felt",eQ(c)];case"string":if(e===aM.TypedDataRevision.ACTIVE){let a=bL(c),d=[a.data.length,...a.data,a.pending_word,a.pending_word_len];return[b,eL[e].hashMethod(d)]}return[b,eO(c)];case"i128":if(e===aM.TypedDataRevision.ACTIVE){let a=BigInt(c);return eM(a,b,U),[b,eO(a<0n?P+a:a)]}return[b,eO(c)];case"timestamp":case"u128":return e===aM.TypedDataRevision.ACTIVE&&eM(c,b,V),[b,eO(c)];case"felt":case"shortstring":return e===aM.TypedDataRevision.ACTIVE&&eM(eO(c),b,T),[b,eO(c)];case"ClassHash":case"ContractAddress":return e===aM.TypedDataRevision.ACTIVE&&eM(c,b,T),[b,eO(c)];case"bool":return e===aM.TypedDataRevision.ACTIVE&&aU(a_(c),`Type mismatch for ${b} ${c}`),[b,eO(c)];default:if(e===aM.TypedDataRevision.ACTIVE)throw Error(`Unsupported type: ${b}`);return[b,eO(c)]}}function eW(a,b,c,d=aM.TypedDataRevision.LEGACY){let[e,f]=(a[b]??eL[d].presetTypes[b]).reduce(([e,f],g)=>{if(void 0===c[g.name]||null===c[g.name]&&"enum"!==g.type)throw Error(`Cannot encode data: missing data for '${g.name}'`);let h=c[g.name],i={parent:b,key:g.name},[j,k]=eV(a,g.type,h,i,d);return[[...e,j],[...f,k]]},[["felt"],[eU(a,b,d)]]);return[e,f]}function eX(a,b,c,d=aM.TypedDataRevision.LEGACY){return eL[d].hashMethod(eW(a,b,c,d)[1])}function eY(a,b){if(!eP(a))throw Error("Typed data does not match JSON schema");let c=eN(a),{domain:d,hashMethod:e}=eL[c];return e([bH("StarkNet Message"),eX(a.types,d,a.domain,c),b,eX(a.types,a.primaryType,a.message,c)])}function eZ(a,b,c,d){let e=eP(a);if(!bn(a)&&!e)throw Error("message has a wrong format.");if(e&&void 0===d)throw Error("When providing a TypedData in message parameter, the accountAddress parameter has to be provided.");if(e&&!bn(d))throw Error("accountAddress shall be a BigNumberish");let f=e?eY(a,d):a6(a),g=Array.isArray(b)?new cW.Signature(BigInt(b[0]),BigInt(b[1])):b,h=a6(c);return cW.verify(g,f,h)}var e$=class{responseParser;channel;constructor(a){if(a&&"channel"in a)this.channel=a.channel,this.responseParser="responseParser"in a?a.responseParser:new eF;else{if(a&&a.specVersion)if(dI("0.8",a.specVersion))this.channel=new ey.RpcChannel({...a,waitMode:!1});else if(dI("0.7",a.specVersion))this.channel=new am.RpcChannel({...a,waitMode:!1});else throw Error(`unsupported channel for spec version: ${a.specVersion}`);else if(dI("0.8",aj.get("rpcVersion")))this.channel=new ey.RpcChannel({...a,waitMode:!1});else if(dI("0.7",aj.get("rpcVersion")))this.channel=new am.RpcChannel({...a,waitMode:!1});else throw Error("unable to define spec version for channel");this.responseParser=new eF(a?.feeMarginPercentage)}}static async create(a){let b=new am.RpcChannel({...a}),c=await b.getSpecVersion();if(dJ(c)||al.warn(`Using incompatible node spec version ${c}`),dI("0.7",c))return new this({...a,specVersion:ae.v0_7_1});if(dI("0.8",c))return new this({...a,specVersion:ae.v0_8_1});throw new d7(`Provided RPC node specification version ${c} is not compatible with the SDK. SDK supported RPC versions ${Object.keys(ae).toString()}`)}fetch(a,b,c=0){return this.channel.fetch(a,b,c)}async getChainId(){return this.channel.getChainId()}readSpecVersion(){return this.channel.readSpecVersion()}async getSpecVersion(){return this.channel.getSpecVersion()}setUpSpecVersion(){return this.channel.setUpSpecVersion()}async getNonceForAddress(a,b){return this.channel.getNonceForAddress(a,b)}async getBlock(a){return this.channel.getBlockWithTxHashes(a).then(this.responseParser.parseGetBlockResponse)}async getBlockLatestAccepted(){return this.channel.getBlockLatestAccepted()}async getBlockNumber(){return this.channel.getBlockNumber()}async getBlockWithTxHashes(a){return this.channel.getBlockWithTxHashes(a)}async getBlockWithTxs(a){return this.channel.getBlockWithTxs(a)}async waitForBlock(a="pending",b=5e3){if(a===at.LATEST)return;let c=await this.getBlockNumber(),d=a===at.PENDING?c+1:Number(a6(a));if(d<=c)return;let{retries:e}=this.channel,f=e,g=!1;for(;!g;)if(await this.getBlockNumber()===d?g=!0:await eh(b),(f-=1)<=0)throw Error(`waitForBlock() timed-out after ${e} tries.`)}async getL1GasPrice(a){return this.channel.getBlockWithTxHashes(a).then(this.responseParser.parseL1GasPriceResponse)}async getL1MessageHash(a){let b=await this.channel.getTransactionByHash(a);aU("L1_HANDLER"===b.type,"This L2 transaction is not a L1 message.");let{calldata:c,contract_address:d,entry_point_selector:e,nonce:f}=b;return bw([c[0],d,f,e,c.length-1,...c.slice(1)])}async getBlockWithReceipts(a){return this.channel.getBlockWithReceipts(a)}getStateUpdate=this.getBlockStateUpdate;async getBlockStateUpdate(a){return this.channel.getBlockStateUpdate(a)}async getBlockTransactionsTraces(a){return this.channel.getBlockTransactionsTraces(a)}async getBlockTransactionCount(a){return this.channel.getBlockTransactionCount(a)}async getTransaction(a){return this.channel.getTransactionByHash(a)}async getTransactionByHash(a){return this.channel.getTransactionByHash(a)}async getTransactionByBlockIdAndIndex(a,b){return this.channel.getTransactionByBlockIdAndIndex(a,b)}async getTransactionReceipt(a){let b=await this.channel.getTransactionReceipt(a);return new eG(this.responseParser.parseTransactionReceipt(b))}async getTransactionTrace(a){return this.channel.getTransactionTrace(a)}async getTransactionStatus(a){return this.channel.getTransactionStatus(a)}async getSimulateTransaction(a,b){return this.channel.simulateTransaction(a,b).then(a=>this.responseParser.parseSimulateTransactionResponse(a))}async waitForTransaction(a,b){return new eG(await this.channel.waitForTransaction(a,b))}async getStorageAt(a,b,c){return this.channel.getStorageAt(a,b,c)}async getClassHashAt(a,b){return this.channel.getClassHashAt(a,b)}async getClassByHash(a){return this.getClass(a)}async getClass(a,b){return this.channel.getClass(a,b).then(this.responseParser.parseContractClassResponse)}async getClassAt(a,b){return this.channel.getClassAt(a,b).then(this.responseParser.parseContractClassResponse)}async getContractVersion(a,b,{blockIdentifier:c=this.channel.blockIdentifier,compiler:d=!0}={}){let e;if(a)e=await this.getClassAt(a,c);else if(b)e=await this.getClass(b,c);else throw Error("getContractVersion require contractAddress or classHash");return d2(e)?d?{cairo:"1",compiler:cl(e.abi).compiler}:{cairo:"1",compiler:void 0}:{cairo:"0",compiler:"0"}}async getInvokeEstimateFee(a,b,c,d){return this.channel.getEstimateFee([{type:ap.INVOKE,...a,...b}],{blockIdentifier:c,skipValidate:d}).then(a=>this.responseParser.parseFeeEstimateResponse(a))}async getDeclareEstimateFee(a,b,c,d){return this.channel.getEstimateFee([{type:ap.DECLARE,...a,...b}],{blockIdentifier:c,skipValidate:d}).then(a=>this.responseParser.parseFeeEstimateResponse(a))}async getDeployAccountEstimateFee(a,b,c,d){return this.channel.getEstimateFee([{type:ap.DEPLOY_ACCOUNT,...a,...b}],{blockIdentifier:c,skipValidate:d}).then(a=>this.responseParser.parseFeeEstimateResponse(a))}async getEstimateFeeBulk(a,b){return this.channel.getEstimateFee(a,b).then(a=>this.responseParser.parseFeeEstimateBulkResponse(a))}async invokeFunction(a,b){return this.channel.invoke(a,b)}async declareContract(a,b){return this.channel.declare(a,b)}async deployAccountContract(a,b){return this.channel.deployAccount(a,b)}async callContract(a,b){return this.channel.callContract(a,b)}async estimateMessageFee(a,b){return this.channel.estimateMessageFee(a,b)}async getSyncingStats(){return this.channel.getSyncingStats()}async getEvents(a){return this.channel.getEvents(a)}async verifyMessageInStarknet(a,b,c,d,e){let f,g=eP(a);if(!bn(a)&&!g)throw Error("message has a wrong format.");if(!bn(c))throw Error("accountAddress shall be a BigNumberish");let h=g?eY(a,c):a6(a),i=e||{okResponse:[],nokResponse:["0x0","0x00"],error:["argent/invalid-signature","0x617267656e742f696e76616c69642d7369676e6174757265","is invalid, with respect to the public key","0x697320696e76616c6964","INVALID_SIG","0x494e56414c49445f534947"]};for(let a of d?[d]:["isValidSignature","is_valid_signature"])try{let d=await this.callContract({contractAddress:a6(c),entrypoint:a,calldata:cR.compile({hash:a4(h).toString(),signature:dS(b)})});if(i.nokResponse.includes(d[0].toString()))return!1;if(0===i.okResponse.length||i.okResponse.includes(d[0].toString()))return!0;throw Error("signatureVerificationResponse Error: response is not part of known responses")}catch(a){if(i.error.some(b=>a.message.includes(b)))return!1;f=a}throw Error(`Signature verification Error: ${f}`)}async isClassDeclared(a,b){let c;if(!a.classHash&&"contract"in a)c=d3(a).classHash;else if(a.classHash)c=a.classHash;else throw Error("contractClassIdentifier type not satisfied");try{return await this.getClass(c,b) instanceof Object}catch(a){if(a instanceof d7)return!1;throw a}}async prepareInvocations(a){let b=[];for(let c of a)c.type===ap.DECLARE?await this.isClassDeclared("payload"in c?c.payload:c)||b.unshift(c):b.push(c);return b}async getL1MessagesStatus(a){if(this.channel instanceof ey.RpcChannel)return this.channel.getMessagesStatus(a);throw new d7("Unsupported method for RPC version")}async getStorageProof(a,b,c,d){if(this.channel instanceof ey.RpcChannel)return this.channel.getStorageProof(a,b,c,d);throw new d7("Unsupported method for RPC version")}async getCompiledCasm(a){if(this.channel instanceof ey.RpcChannel)return this.channel.getCompiledCasm(a);throw new d7("Unsupported method for RPC version")}},e_=a.r(753363),e0={};j(e0,{StarknetIdContract:()=>fa,StarknetIdIdentityContract:()=>fc,StarknetIdMulticallContract:()=>fe,StarknetIdPfpContract:()=>fi,StarknetIdPopContract:()=>fk,StarknetIdVerifierContract:()=>fg,dynamicCallData:()=>fo,dynamicFelt:()=>fn,execution:()=>fm,getStarknetIdContract:()=>fb,getStarknetIdIdentityContract:()=>fd,getStarknetIdMulticallContract:()=>ff,getStarknetIdPfpContract:()=>fj,getStarknetIdPopContract:()=>fl,getStarknetIdVerifierContract:()=>fh,isStarkDomain:()=>fp,useDecoded:()=>e8,useEncoded:()=>e9});var e1="abcdefghijklmnopqrstuvwxyz0123456789-",e2=BigInt(e1.length+1),e3="",e4=BigInt(e1.length),e5=BigInt(e3.length),e6=BigInt(e3.length+1);function e7(a){let b=0;for(;a.endsWith(e3[e3.length-1]);)a=a.substring(0,a.length-1),b+=1;return[a,b]}function e8(a){let b="";return(a.forEach(a=>{for(;a!==L;){let c=a%e2;if(a/=e2,c===BigInt(e1.length)){let c=a/e6;if(c===L){let d=a%e6;a=c,d===L?b+=e1[0]:b+=e3[Number(d)-1]}else b+=e3[Number(a%e5)],a/=e5}else b+=e1[Number(c)]}let[c,d]=e7(b);d&&(b=c+(d%2==0?e3[e3.length-1].repeat(d/2-1)+e3[0]+e1[1]:e3[e3.length-1].repeat((d-1)/2+1))),b+="."}),b)?b.concat("stark"):b}function e9(a){let b=BigInt(0),c=BigInt(1);if(a.endsWith(e3[0]+e1[1])){let[b,c]=e7(a.substring(0,a.length-2));a=b+e3[e3.length-1].repeat(2*(c+1))}else{let[b,c]=e7(a);c&&(a=b+e3[e3.length-1].repeat(1+2*(c-1)))}for(let d=0;d<a.length;d+=1){let e=a[d],f=e1.indexOf(e),g=BigInt(e1.indexOf(e));-1!==f?d===a.length-1&&a[d]===e1[0]?(b+=c*e4,c*=e2*e2):(b+=c*g,c*=e2):-1!==e3.indexOf(e)&&(b+=c*e4,c*=e2,b+=c*BigInt(+(d===a.length-1)+e3.indexOf(e)),c*=e5)}return b}var fa={MAINNET:"0x6ac597f8116f886fa1c97a23fa4e08299975ecaf6b598873ca6792b9bbfb678",TESTNET_SEPOLIA:"0x154bc2e1af9260b9e66af0e9c46fc757ff893b3ff6a85718a810baf1474"};function fb(a){switch(a){case ac.SN_MAIN:return fa.MAINNET;case ac.SN_SEPOLIA:return fa.TESTNET_SEPOLIA;default:throw Error("Starknet.id is not yet deployed on this network")}}var fc={MAINNET:"0x05dbdedc203e92749e2e746e2d40a768d966bd243df04a6b712e222bc040a9af",TESTNET_SEPOLIA:"0x3697660a0981d734780731949ecb2b4a38d6a58fc41629ed611e8defda"};function fd(a){switch(a){case ac.SN_MAIN:return fc.MAINNET;case ac.SN_SEPOLIA:return fc.TESTNET_SEPOLIA;default:throw Error("Starknet.id verifier contract is not yet deployed on this network")}}var fe="0x034ffb8f4452df7a613a0210824d6414dbadcddce6c6e19bf4ddc9e22ce5f970";function ff(a){switch(a){case ac.SN_MAIN:case ac.SN_SEPOLIA:return fe;default:throw Error("Starknet.id multicall contract is not yet deployed on this network")}}var fg={MAINNET:"0x07d14dfd8ee95b41fce179170d88ba1f0d5a512e13aeb232f19cfeec0a88f8bf",TESTNET_SEPOLIA:"0x60B94fEDe525f815AE5E8377A463e121C787cCCf3a36358Aa9B18c12c4D566"};function fh(a){switch(a){case ac.SN_MAIN:return fg.MAINNET;case ac.SN_SEPOLIA:return fg.TESTNET_SEPOLIA;default:throw Error("Starknet.id verifier contract is not yet deployed on this network")}}var fi={MAINNET:"0x070aaa20ec4a46da57c932d9fd89ca5e6bb9ca3188d3df361a32306aff7d59c7",TESTNET_SEPOLIA:"0x9e7bdb8dabd02ea8cfc23b1d1c5278e46490f193f87516ed5ff2dfec02"};function fj(a){switch(a){case ac.SN_MAIN:return fi.MAINNET;case ac.SN_SEPOLIA:return fi.TESTNET_SEPOLIA;default:throw Error("Starknet.id profile picture verifier contract is not yet deployed on this network")}}var fk={MAINNET:"0x0293eb2ba9862f762bd3036586d5755a782bd22e6f5028320f1d0405fd47bff4",TESTNET_SEPOLIA:"0x15ae88ae054caa74090b89025c1595683f12edf7a4ed2ad0274de3e1d4a"};function fl(a){switch(a){case ac.SN_MAIN:return fk.MAINNET;case ac.SN_SEPOLIA:return fk.TESTNET_SEPOLIA;default:throw Error("Starknet.id proof of personhood verifier contract is not yet deployed on this network")}}function fm(a,b,c){return new cq({Static:a,IfEqual:b?co(b[0],b[1],b[2]):void 0,IfNotEqual:c?co(c[0],c[1],c[2]):void 0})}function fn(a,b){return new cq({Hardcoded:a,Reference:b?co(b[0],b[1]):void 0})}function fo(a,b,c){return new cq({Hardcoded:a,Reference:b?co(b[0],b[1]):void 0,ArrayReference:c?co(c[0],c[1]):void 0})}function fp(a){return/^(?:[a-z0-9-]{1,48}(?:[a-z0-9-]{1,48}[a-z0-9-])?\.)*[a-z0-9-]{1,48}\.stark$/.test(a)}var fq=class a{async getStarkName(b,c){return a.getStarkName(this,b,c)}async getAddressFromStarkName(b,c){return a.getAddressFromStarkName(this,b,c)}async getStarkProfile(b,c,d,e,f,g,h){return a.getStarkProfile(this,b,c,d,e,f,g,h)}static async getStarkName(a,b,c){let d=await a.getChainId(),e=c??fb(d);try{let c=(await a.callContract({contractAddress:e,entrypoint:"address_to_domain",calldata:cR.compile({address:b,hint:[]})})).map(a=>BigInt(a)).slice(1),d=e8(c);if(!d)throw Error("Starkname not found");return d}catch(a){if(a instanceof Error&&"Starkname not found"===a.message)throw a;throw Error("Could not get stark name")}}static async getAddressFromStarkName(a,b,c){let d=b.endsWith(".stark")?b:`${b}.stark`;if(!fp(d))throw Error("Invalid domain, must be a valid .stark domain");let e=await a.getChainId(),f=c??fb(e);try{let b=d.replace(".stark","").split(".").map(a=>e9(a).toString(10));return(await a.callContract({contractAddress:f,entrypoint:"domain_to_address",calldata:cR.compile({domain:b,hint:[]})}))[0]}catch{throw Error("Could not get address from stark name")}}static async getStarkProfile(a,b,c,d,e,f,g,h){let i=await a.getChainId(),j=c??fb(i),k=d??fd(i),l=e??fh(i),m=f??fj(i),n=g??fl(i),o=h??ff(i);try{let c=[{execution:fm({}),to:fo(j),selector:fo(bu("address_to_domain")),calldata:[fo(b),fo("0")]},{execution:fm({}),to:fn(j),selector:fn(bu("domain_to_id")),calldata:[fo(void 0,void 0,[0,0])]},{execution:fm({}),to:fn(k),selector:fn(bu("get_verifier_data")),calldata:[fo(void 0,[1,0]),fo(bH("twitter")),fo(l),fo("0")]},{execution:fm({}),to:fn(k),selector:fn(bu("get_verifier_data")),calldata:[fo(void 0,[1,0]),fo(bH("github")),fo(l),fo("0")]},{execution:fm({}),to:fn(k),selector:fn(bu("get_verifier_data")),calldata:[fo(void 0,[1,0]),fo(bH("discord")),fo(l),fo("0")]},{execution:fm({}),to:fn(k),selector:fn(bu("get_verifier_data")),calldata:[fo(void 0,[1,0]),fo(bH("proof_of_personhood")),fo(n),fo("0")]},{execution:fm({}),to:fn(k),selector:fn(bu("get_verifier_data")),calldata:[fo(void 0,[1,0]),fo(bH("nft_pp_contract")),fo(m),fo("0")]},{execution:fm({}),to:fn(k),selector:fn(bu("get_extended_verifier_data")),calldata:[fo(void 0,[1,0]),fo(bH("nft_pp_id")),fo("2"),fo(m),fo("0")]},{execution:fm(void 0,void 0,[6,0,0]),to:fn(void 0,[6,0]),selector:fn(bu("tokenURI")),calldata:[fo(void 0,[7,1]),fo(void 0,[7,2])]}],d=await a.callContract({contractAddress:o,entrypoint:"aggregate",calldata:cR.compile({calls:c})});if(Array.isArray(d)){let a=parseInt(d[0],16),b=[],c=1;for(let e=0;e<a;e+=1)if(c<d.length){let a=parseInt(d[c],16);c+=1;let e=d.slice(c,c+a);b.push(e),c+=a}else break;let e=e8(b[0].slice(1).map(a=>BigInt(a))),f="0x0"!==b[2][0]?BigInt(b[2][0]).toString():void 0,g="0x0"!==b[3][0]?BigInt(b[3][0]).toString():void 0,h="0x0"!==b[4][0]?BigInt(b[4][0]).toString():void 0,i="0x1"===b[5][0],j=("0x9"===d[0]?b[8].slice(1).map(a=>bI(a)).join(""):void 0)||`https://starknet.id/api/identicons/${BigInt(b[1][0]).toString()}`;return{name:e,twitter:f,github:g,discord:h,proofOfPersonhood:i,profilePicture:j}}throw Error("Error while calling aggregate function")}catch(a){if(a instanceof Error)throw a;throw Error("Could not get user stark profile data from address")}}},fr=class extends(0,e_.Mixin)(e$,fq){},fs=class{},ft=new e$({default:!0}),fu=class{},fv=class{pk;constructor(a=cW.utils.randomPrivateKey()){this.pk=a instanceof Uint8Array?A(a):a6(a)}async getPubKey(){return cW.getStarkKey(this.pk)}async signMessage(a,b){let c=eY(a,b);return this.signRaw(c)}async signTransaction(a,b){let c,d=et(a,b.cairoVersion);if(Object.values(o.ETransactionVersion2).includes(b.version))c=dj({...b,senderAddress:b.walletAddress,compiledCalldata:d,version:b.version});else if(Object.values(o.ETransactionVersion3).includes(b.version))c=dj({...b,senderAddress:b.walletAddress,compiledCalldata:d,version:b.version,nonceDataAvailabilityMode:dY(b.nonceDataAvailabilityMode),feeDataAvailabilityMode:dY(b.feeDataAvailabilityMode)});else throw Error("unsupported signTransaction version");return this.signRaw(c)}async signDeployAccountTransaction(a){let b,c=cR.compile(a.constructorCalldata);if(Object.values(o.ETransactionVersion2).includes(a.version))b=dl({...a,salt:a.addressSalt,constructorCalldata:c,version:a.version});else if(Object.values(o.ETransactionVersion3).includes(a.version))b=dl({...a,salt:a.addressSalt,compiledConstructorCalldata:c,version:a.version,nonceDataAvailabilityMode:dY(a.nonceDataAvailabilityMode),feeDataAvailabilityMode:dY(a.feeDataAvailabilityMode)});else throw Error("unsupported signDeployAccountTransaction version");return this.signRaw(b)}async signDeclareTransaction(a){let b;if(Object.values(o.ETransactionVersion2).includes(a.version))b=dk({...a,version:a.version});else if(Object.values(o.ETransactionVersion3).includes(a.version))b=dk({...a,version:a.version,nonceDataAvailabilityMode:dY(a.nonceDataAvailabilityMode),feeDataAvailabilityMode:dY(a.feeDataAvailabilityMode)});else throw Error("unsupported signDeclareTransaction version");return this.signRaw(b)}async signRaw(a){return cW.sign(a,this.pk)}},fw=a.r(645723),fx={};function fy(a){return new bV(a).toBigInt()}function fz(a){return bV.is(a)}function fA(a){return new bV(a).toUint256HexString()}j(fx,{bnToUint256:()=>fA,isUint256:()=>fz,uint256ToBN:()=>fy});var fB=class{pk;constructor(a=ed()){this.pk=a instanceof Uint8Array?A(a).padStart(64,"0"):B(a6(a)).padStart(64,"0")}async getPubKey(){return C(A(fw.secp256k1.getPublicKey(this.pk,!1)).padStart(130,"0").slice(2))}async signMessage(a,b){let c=eY(a,b),d=fw.secp256k1.sign(B(G(c)),this.pk);return this.formatEthSignature(d)}async signTransaction(a,b){let c,d=et(a,b.cairoVersion);if(Object.values(o.ETransactionVersion2).includes(b.version))c=dj({...b,senderAddress:b.walletAddress,compiledCalldata:d,version:b.version});else if(Object.values(o.ETransactionVersion3).includes(b.version))c=dj({...b,senderAddress:b.walletAddress,compiledCalldata:d,version:b.version,nonceDataAvailabilityMode:dY(b.nonceDataAvailabilityMode),feeDataAvailabilityMode:dY(b.feeDataAvailabilityMode)});else throw Error("unsupported signTransaction version");let e=fw.secp256k1.sign(B(G(c)),this.pk);return this.formatEthSignature(e)}async signDeployAccountTransaction(a){let b,c=cR.compile(a.constructorCalldata);if(Object.values(o.ETransactionVersion2).includes(a.version))b=dl({...a,salt:a.addressSalt,constructorCalldata:c,version:a.version});else if(Object.values(o.ETransactionVersion3).includes(a.version))b=dl({...a,salt:a.addressSalt,compiledConstructorCalldata:c,version:a.version,nonceDataAvailabilityMode:dY(a.nonceDataAvailabilityMode),feeDataAvailabilityMode:dY(a.feeDataAvailabilityMode)});else throw Error("unsupported signDeployAccountTransaction version");let d=fw.secp256k1.sign(B(G(b)),this.pk);return this.formatEthSignature(d)}async signDeclareTransaction(a){let b;if(Object.values(o.ETransactionVersion2).includes(a.version))b=dk({...a,version:a.version});else if(Object.values(o.ETransactionVersion3).includes(a.version))b=dk({...a,version:a.version,nonceDataAvailabilityMode:dY(a.nonceDataAvailabilityMode),feeDataAvailabilityMode:dY(a.feeDataAvailabilityMode)});else throw Error("unsupported signDeclareTransaction version");let c=fw.secp256k1.sign(B(G(b)),this.pk);return this.formatEthSignature(c)}formatEthSignature(a){let b=fA(a.r),c=fA(a.s);return[a6(b.low),a6(b.high),a6(c.low),a6(c.high),a6(a.recovery)]}},fC=class{transporter;_transporter;accountID;eip2645applicationName;pathBuffer;appVersion;pubKey;fullPubKey;constructor(a,b,c="LedgerW",d=fD){aU(b>=0,"Ledger account ID shall not be a negative number."),aU(b<=N,"Ledger account ID shall be < 2**31."),aU(!!c,"Ledger application name shall not be empty."),this.transporter=a,this._transporter=this.transporter,this.accountID=b,this.pubKey="",this.fullPubKey="",this.eip2645applicationName=c,this.appVersion="",this.pathBuffer=d(this.accountID,this.eip2645applicationName)}async getPubKey(){return this.pubKey||await this.getPublicKeys(),this.pubKey}async getFullPubKey(){return this.fullPubKey||await this.getPublicKeys(),this.fullPubKey}async getAppVersion(){if(!this.appVersion){let a=await this._transporter.send(Number("0x5a"),0,0,0);this.appVersion=`${a[0]}.${a[1]}.${a[2]}`}return this.appVersion}async signMessage(a,b){let c=eY(a,b);return this.signRaw(c)}async signTransaction(a,b){let c,d=et(a,b.cairoVersion);if(Object.values(o.ETransactionVersion2).includes(b.version))c=dj({...b,senderAddress:b.walletAddress,compiledCalldata:d,version:b.version});else if(Object.values(o.ETransactionVersion3).includes(b.version))c=dj({...b,senderAddress:b.walletAddress,compiledCalldata:d,version:b.version,nonceDataAvailabilityMode:dY(b.nonceDataAvailabilityMode),feeDataAvailabilityMode:dY(b.feeDataAvailabilityMode)});else throw Error("unsupported signTransaction version");return this.signRaw(c)}async signDeployAccountTransaction(a){let b,c=cR.compile(a.constructorCalldata);if(Object.values(o.ETransactionVersion2).includes(a.version))b=dl({...a,salt:a.addressSalt,constructorCalldata:c,version:a.version});else if(Object.values(o.ETransactionVersion3).includes(a.version))b=dl({...a,salt:a.addressSalt,compiledConstructorCalldata:c,version:a.version,nonceDataAvailabilityMode:dY(a.nonceDataAvailabilityMode),feeDataAvailabilityMode:dY(a.feeDataAvailabilityMode)});else throw Error("unsupported signDeployAccountTransaction version");return this.signRaw(b)}async signDeclareTransaction(a){let b;if(Object.values(o.ETransactionVersion2).includes(a.version))b=dk({...a,version:a.version});else if(Object.values(o.ETransactionVersion3).includes(a.version))b=dk({...a,version:a.version,nonceDataAvailabilityMode:dY(a.nonceDataAvailabilityMode),feeDataAvailabilityMode:dY(a.feeDataAvailabilityMode)});else throw Error("unsupported signDeclareTransaction version");return this.signRaw(b)}async signRaw(a){C(A(await this._transporter.send(Number("0x5a"),2,0,0,Buffer.from(this.pathBuffer))));let b=bk(a6(BigInt(a)<<4n)),c=Uint8Array.from(await this._transporter.send(Number("0x5a"),2,1,0,Buffer.from(b))),d=BigInt(C(A(c.subarray(1,33)))),e=BigInt(C(A(c.subarray(33,65)))),f=c[65];return new cW.Signature(d,e).addRecoveryBit(f)}async getPublicKeys(){let a=this.pathBuffer,b=Uint8Array.from(await this._transporter.send(Number("0x5a"),1,0,0,Buffer.from(a)));this.pubKey=C(A(b.subarray(1,33))),this.fullPubKey=C(A(b.subarray(0,65)))}};function fD(a,b="LedgerW"){let c=new Uint8Array([128,0,10,85]),d=new Uint8Array([71,65,233,201]),e="LedgerW"===b?new Uint8Array([43,206,231,219]):bm(b),f=new Uint8Array([0,0,0,0]);return I([c,d,e,f,bk(C(B(a6(a)).padStart(8,"0"))),new Uint8Array([0,0,0,0])])}var fE=a.r(246367);function fF(a){let b=B(a6(a1(a)?C(a):a)).padStart(64,"0");return C(b)}function fG(a){let b=fF(a);if(!b.match(/^(0x)?[0-9a-fA-F]{64}$/))throw Error("Invalid Address Format");return bc(b,L,R-1n,"Starknet Address"),b}function fH(a){let b=B(fG(a)).toLowerCase().split(""),c=B(bs(a)),d=(0,fE.hexToBytes)(c.padStart(64,"0"));for(let a=0;a<b.length;a+=2)d[a>>1]>>4>=8&&(b[a]=b[a].toUpperCase()),(15&d[a>>1])>=8&&(b[a+1]=b[a+1].toUpperCase());return C(b.join(""))}function fI(a){return fH(a)===a}var fJ=class extends fC{constructor(a,b,c="LedgerW",d=fK){super(a,b,c,d)}async signTransaction(a,b){let c=et(a,b.cairoVersion);if(Object.values(o.ETransactionVersion2).includes(b.version)){let d=dj({...b,senderAddress:b.walletAddress,compiledCalldata:c,version:b.version}),e=await this.signTxV1(b,a);return aU(a4(d)===e.hash,"The V1 transaction hash calculated by Starknet.js is different from the one calculated by the Ledger."),e.signature}if(Object.values(o.ETransactionVersion3).includes(b.version)){let d=dj({...b,senderAddress:b.walletAddress,compiledCalldata:c,version:b.version,nonceDataAvailabilityMode:dY(b.nonceDataAvailabilityMode),feeDataAvailabilityMode:dY(b.feeDataAvailabilityMode)}),e=await this.signTxV3(b,a);return aU(a4(d)===e.hash,"The V3 transaction hash calculated by Starknet.js is different from the one calculated by the Ledger."),e.signature}throw Error("unsupported signTransaction version")}async signDeployAccountTransaction(a){let b,c=cR.compile(a.constructorCalldata);if(Object.values(o.ETransactionVersion2).includes(a.version)){b=dl({...a,salt:a.addressSalt,constructorCalldata:c,version:a.version});let d=await this.signDeployAccountV1(a);return aU(a4(b)===d.hash,"The transaction hash calculated by Starknet.js is different from the one calculated by the Ledger."),d.signature}if(Object.values(o.ETransactionVersion3).includes(a.version)){b=dl({...a,salt:a.addressSalt,compiledConstructorCalldata:c,version:a.version,nonceDataAvailabilityMode:dY(a.nonceDataAvailabilityMode),feeDataAvailabilityMode:dY(a.feeDataAvailabilityMode)});let d=await this.signDeployAccountV3(a);return aU(a4(b)===d.hash,"The transaction hash calculated by Starknet.js is different from the one calculated by the Ledger."),d.signature}throw Error("unsupported signDeployAccountTransaction version")}convertBnToLedger(a){return bk(fF(a6(a)))}decodeSignatureLedger(a){let b=BigInt(C(A(a.subarray(0,32)))),c=BigInt(C(A(a.subarray(33,65)))),d=BigInt(C(A(a.subarray(65,97)))),e=a[97];return{hash:b,signature:new cW.Signature(c,d).addRecoveryBit(e)}}encodeCall(a){let b=this.convertBnToLedger(a.contractAddress),c=bk(fF(bv(a.entrypoint))),d=new Uint8Array([]);a.calldata&&(d=I(cR.compile(a.calldata).map(a=>this.convertBnToLedger(a))));let e=I([b,c,d]),f=[];for(let a=0;a<e.length;a+=224)f.push(e.subarray(a,a+224));return f}async signTxV1(a,b){await this._transporter.send(Number("0x5a"),4,0,0,Buffer.from(this.pathBuffer));let c=this.convertBnToLedger(a.walletAddress),d=this.convertBnToLedger(a.maxFee),e=I([c,d,this.convertBnToLedger(a.chainId),this.convertBnToLedger(a.nonce)]);await this._transporter.send(Number("0x5a"),4,1,0,Buffer.from(e));let f=this.convertBnToLedger(b.length);await this._transporter.send(Number("0x5a"),4,2,0,Buffer.from(f));let g=new Uint8Array(0);for(let a of b){let b=this.encodeCall(a);await this._transporter.send(Number("0x5a"),4,3,0,Buffer.from(b[0])),b.length>1&&b.slice(1).forEach(async a=>{await this._transporter.send(Number("0x5a"),4,3,1,Buffer.from(a))}),g=await this._transporter.send(Number("0x5a"),4,3,2)}return this.decodeSignatureLedger(g)}async signTxV3(a,b){aU(a.paymasterData.length<=7,"Paymaster data includes more than 7 items."),aU(a.accountDeploymentData.length<=7,"accountDeploymentData includes more than 7 items"),await this._transporter.send(Number("0x5a"),3,0,0,Buffer.from(this.pathBuffer));let c=this.convertBnToLedger(a.walletAddress),d=this.convertBnToLedger(a.tip),e=this.convertBnToLedger(a.chainId),f=this.convertBnToLedger(a.nonce),g=this.convertBnToLedger(c9(a.nonceDataAvailabilityMode===o.EDataAvailabilityMode.L1?o.EDAMode.L1:o.EDAMode.L2,a.feeDataAvailabilityMode===o.EDataAvailabilityMode.L1?o.EDAMode.L1:o.EDAMode.L2)),h=I([c,d,this.convertBnToLedger(da(a.resourceBounds)),this.convertBnToLedger(db(a.resourceBounds)),e,f,g]);await this._transporter.send(Number("0x5a"),3,1,0,Buffer.from(h));let i=I(a.paymasterData.map(a=>this.convertBnToLedger(a)));await this._transporter.send(Number("0x5a"),3,2,0,Buffer.from(i));let j=I(a.paymasterData.map(a=>this.convertBnToLedger(a)));await this._transporter.send(Number("0x5a"),3,3,0,Buffer.from(j));let k=this.convertBnToLedger(b.length);await this._transporter.send(Number("0x5a"),3,4,0,Buffer.from(k));let l=new Uint8Array(0);for(let a of b){let b=this.encodeCall(a);await this._transporter.send(Number("0x5a"),3,5,0,Buffer.from(b[0])),b.length>1&&b.slice(1).forEach(async a=>{await this._transporter.send(Number("0x5a"),3,5,1,Buffer.from(a))}),l=await this._transporter.send(Number("0x5a"),3,5,2)}return this.decodeSignatureLedger(l)}async signDeployAccountV1(a){await this._transporter.send(Number("0x5a"),6,0,0,Buffer.from(this.pathBuffer));let b=this.convertBnToLedger(a.contractAddress),c=this.convertBnToLedger(a.classHash),d=this.convertBnToLedger(a.addressSalt),e=I([b,c,d,this.convertBnToLedger(a.chainId),this.convertBnToLedger(a.nonce)]);await this._transporter.send(Number("0x5a"),6,1,0,Buffer.from(e));let f=this.convertBnToLedger(a.maxFee);await this._transporter.send(Number("0x5a"),6,2,0,Buffer.from(f));let g=cR.compile(a.constructorCalldata),h=this.convertBnToLedger(g.length);await this._transporter.send(Number("0x5a"),6,3,0,Buffer.from(h));let i=I(g.map(a=>this.convertBnToLedger(a))),j=[];for(let a=0;a<i.length;a+=224)j.push(i.subarray(a,a+224));let k=new Uint8Array(0);for(let a of j)k=await this._transporter.send(Number("0x5a"),6,4,0,Buffer.from(a));return this.decodeSignatureLedger(k)}async signDeployAccountV3(a){await this._transporter.send(Number("0x5a"),5,0,0,Buffer.from(this.pathBuffer));let b=this.convertBnToLedger(a.contractAddress),c=this.convertBnToLedger(a.chainId),d=this.convertBnToLedger(a.nonce),e=this.convertBnToLedger(c9(a.nonceDataAvailabilityMode===o.EDataAvailabilityMode.L1?o.EDAMode.L1:o.EDAMode.L2,a.feeDataAvailabilityMode===o.EDataAvailabilityMode.L1?o.EDAMode.L1:o.EDAMode.L2)),f=I([b,c,d,e,this.convertBnToLedger(a.classHash),this.convertBnToLedger(a.addressSalt)]);await this._transporter.send(Number("0x5a"),5,1,0,Buffer.from(f));let g=this.convertBnToLedger(a.tip),h=I([g,this.convertBnToLedger(da(a.resourceBounds)),this.convertBnToLedger(db(a.resourceBounds))]);await this._transporter.send(Number("0x5a"),5,2,0,Buffer.from(h));let i=I(a.paymasterData.map(a=>this.convertBnToLedger(a)));await this._transporter.send(Number("0x5a"),5,3,0,Buffer.from(i));let j=cR.compile(a.constructorCalldata),k=this.convertBnToLedger(j.length);await this._transporter.send(Number("0x5a"),5,4,0,Buffer.from(k));let l=I(j.map(a=>this.convertBnToLedger(a))),m=[];for(let a=0;a<l.length;a+=224)m.push(l.subarray(a,a+224));let n=new Uint8Array(0);for(let a of m)n=await this._transporter.send(Number("0x5a"),5,5,0,Buffer.from(a));return this.decodeSignatureLedger(n)}};function fK(a,b="LedgerW"){let c=new Uint8Array([$,0,10,85]),d=new Uint8Array([71|$,65,233,201]),e="LedgerW"===b?new Uint8Array([43,206,231,219]):bm(b),f=I([new Uint8Array([e[0]|$]),e.subarray(1)]),g=new Uint8Array([$,0,0,0]);return I([c,d,f,g,bk(C(B(a6(BigInt(a)|_)).padStart(8,"0"))),new Uint8Array([0,0,0,0])])}var fL=class extends fJ{constructor(a,b,c="LedgerW",d=fK){super(a,b,c,d)}async signTxV1(a,b){await this._transporter.send(Number("0x5a"),4,0,0,Buffer.from(this.pathBuffer));let c=this.convertBnToLedger(a.walletAddress),d=this.convertBnToLedger(a.maxFee),e=I([c,d,this.convertBnToLedger(a.chainId),this.convertBnToLedger(a.nonce)]);await this._transporter.send(Number("0x5a"),4,1,0,Buffer.from(e));let f=this.convertBnToLedger(b.length);await this._transporter.send(Number("0x5a"),4,2,0,Buffer.from(f));let g=new Uint8Array(0);for(let a of b){let b=this.encodeCall(a);g=await this._transporter.send(Number("0x5a"),4,3,0,Buffer.from(b[0])),b.length>1&&b.slice(1).forEach(async a=>{g=await this._transporter.send(Number("0x5a"),4,3,1,Buffer.from(a))})}return this.decodeSignatureLedger(g)}async signTxV3(a,b){aU(a.paymasterData.length<=7,"Paymaster data includes more than 7 items."),aU(a.accountDeploymentData.length<=7,"accountDeploymentData includes more than 7 items"),await this._transporter.send(Number("0x5a"),3,0,0,Buffer.from(this.pathBuffer));let c=this.convertBnToLedger(a.walletAddress),d=this.convertBnToLedger(a.chainId),e=I([c,d,this.convertBnToLedger(a.nonce),this.convertBnToLedger(c9(dY(a.nonceDataAvailabilityMode),dY(a.feeDataAvailabilityMode)))]);if(await this._transporter.send(Number("0x5a"),3,1,0,Buffer.from(e)),aB(a.resourceBounds)){let b=this.convertBnToLedger(a.tip),c=this.convertBnToLedger(da(a.resourceBounds)),d=I([b,c,this.convertBnToLedger(db(a.resourceBounds)),this.convertBnToLedger(dc(a.resourceBounds))]);await this._transporter.send(Number("0x5a"),3,2,0,Buffer.from(d))}else{let b=this.convertBnToLedger(a.tip),c=I([b,this.convertBnToLedger(da(a.resourceBounds)),this.convertBnToLedger(db(a.resourceBounds))]);await this._transporter.send(Number("0x5a"),3,2,0,Buffer.from(c))}let f=I(a.paymasterData.map(a=>this.convertBnToLedger(a)));await this._transporter.send(Number("0x5a"),3,3,0,Buffer.from(f));let g=I(a.paymasterData.map(a=>this.convertBnToLedger(a)));await this._transporter.send(Number("0x5a"),3,4,0,Buffer.from(g));let h=this.convertBnToLedger(b.length);await this._transporter.send(Number("0x5a"),3,5,0,Buffer.from(h));let i=new Uint8Array(0);for(let a of b){let b=this.encodeCall(a);i=await this._transporter.send(Number("0x5a"),3,6,0,Buffer.from(b[0])),b.length>1&&b.slice(1).forEach(async a=>{i=await this._transporter.send(Number("0x5a"),3,6,1,Buffer.from(a))})}return this.decodeSignatureLedger(i)}async signDeployAccountV1(a){await this._transporter.send(Number("0x5a"),6,0,0,Buffer.from(this.pathBuffer));let b=this.convertBnToLedger(a.contractAddress),c=this.convertBnToLedger(a.classHash),d=this.convertBnToLedger(a.addressSalt),e=this.convertBnToLedger(a.maxFee),f=I([b,c,d,e,this.convertBnToLedger(a.chainId),this.convertBnToLedger(a.nonce)]);await this._transporter.send(Number("0x5a"),6,1,0,Buffer.from(f));let g=cR.compile(a.constructorCalldata),h=this.convertBnToLedger(g.length);await this._transporter.send(Number("0x5a"),6,2,0,Buffer.from(h));let i=I(g.map(a=>this.convertBnToLedger(a))),j=[];for(let a=0;a<i.length;a+=224)j.push(i.subarray(a,a+224));let k=new Uint8Array(0);for(let a of j)k=await this._transporter.send(Number("0x5a"),6,3,0,Buffer.from(a));return this.decodeSignatureLedger(k)}async signDeployAccountV3(a){await this._transporter.send(Number("0x5a"),5,0,0,Buffer.from(this.pathBuffer));let b=this.convertBnToLedger(a.contractAddress),c=this.convertBnToLedger(a.chainId),d=this.convertBnToLedger(a.nonce),e=this.convertBnToLedger(c9(dY(a.nonceDataAvailabilityMode),dY(a.feeDataAvailabilityMode))),f=I([b,c,d,e,this.convertBnToLedger(a.classHash),this.convertBnToLedger(a.addressSalt)]);if(await this._transporter.send(Number("0x5a"),5,1,0,Buffer.from(f)),aB(a.resourceBounds)){let b=this.convertBnToLedger(a.tip),c=this.convertBnToLedger(da(a.resourceBounds)),d=I([b,c,this.convertBnToLedger(db(a.resourceBounds)),this.convertBnToLedger(dc(a.resourceBounds))]);await this._transporter.send(Number("0x5a"),5,2,0,Buffer.from(d))}else{let b=this.convertBnToLedger(a.tip),c=I([b,this.convertBnToLedger(da(a.resourceBounds)),this.convertBnToLedger(db(a.resourceBounds))]);await this._transporter.send(Number("0x5a"),5,2,0,Buffer.from(c))}let g=I(a.paymasterData.map(a=>this.convertBnToLedger(a)));await this._transporter.send(Number("0x5a"),5,3,0,Buffer.from(g));let h=cR.compile(a.constructorCalldata),i=this.convertBnToLedger(h.length);await this._transporter.send(Number("0x5a"),5,4,0,Buffer.from(i));let j=I(h.map(a=>this.convertBnToLedger(a))),k=[];for(let a=0;a<j.length;a+=224)k.push(j.subarray(a,a+224));let l=new Uint8Array(0);for(let a of k)l=await this._transporter.send(Number("0x5a"),5,5,0,Buffer.from(a));return this.decodeSignatureLedger(l)}encodeCall(a){let b=this.convertBnToLedger(a.contractAddress),c=bk(fF(bv(a.entrypoint))),d=new Uint8Array([]);if(a.calldata){let b=cR.compile(a.calldata);d=I([this.convertBnToLedger(b.length),...b.map(a=>this.convertBnToLedger(a))])}else d=this.convertBnToLedger("0x00");let e=I([b,c,d]),f=[];for(let a=0;a<e.length;a+=224)f.push(e.subarray(a,a+224));return f}},fM={};function fN(a){return"event"===a.type}function fO(a){return cj(a)?function(a){let b=a.filter(a=>fN(a)&&"struct"===a.kind),c=a.filter(a=>fN(a)&&"enum"===a.kind);return b.reduce((a,b)=>{let d=[],{name:e}=b,f=!1,g=a=>a.type===e;for(;;){let a=c.find(a=>a.variants.some(g));if(aZ(a))break;let b=a.variants.find(g);d.unshift(b.name),"flat"===b.kind&&(f=!0),e=a.name}if(0===d.length)throw Error("inconsistency in ABI events definition.");f&&(d=[d[d.length-1]]);let h=d.pop(),i={[C(cW.keccak(x(h)).toString(16))]:b};for(;d.length>0;)i={[C(cW.keccak(x(d.pop())).toString(16))]:i};return function a(b,c){let d={...b};return a2(b)&&a2(c)&&Object.keys(c).forEach(e=>{a2(c[e])&&e in b?d[e]=a(b[e],c[e]):Object.assign(d,{[e]:c[e]})}),d}(a,i={...i})},{})}(a):a.filter(a=>"event"===a.type).reduce((a,b)=>{let c=b.name,d={...b};return d.name=c,{...a,[C(cW.keccak(x(c)).toString(16))]:d}},{})}function fP(a,b,c,d){return a.flat().reduce((a,e)=>{let f=JSON.parse(JSON.stringify(e)),g=b[f.keys.shift()??0];if(!g)return a;for(;!g.name;){let a=f.keys.shift();aU(!!a,'Not enough data in "keys" property of this event.'),g=g[a]}let h={};h[g.name]={};let i=f.keys[Symbol.iterator](),j=f.data[Symbol.iterator](),k=g.members?.filter(a=>"key"===a.kind)||g.keys,l=g.members?.filter(a=>"data"===a.kind)||g.data;return k.forEach(a=>{h[g.name][a.name]=cI(i,a,c,d,h[g.name])}),l.forEach(a=>{h[g.name][a.name]=cI(j,a,c,d,h[g.name])}),"block_hash"in f&&(h.block_hash=f.block_hash),"block_number"in f&&(h.block_number=f.block_number),"transaction_hash"in f&&(h.transaction_hash=f.transaction_hash),a.push(h),a},[])}function fQ(a){if(!a.events?.length)throw Error("UDC emitted event is empty");let b=a.events.find(a=>bb(a.from_address)===bb(W.ADDRESS))||{data:[]};return{transaction_hash:a.transaction_hash,contract_address:b.data[0],address:b.data[0],deployer:b.data[1],unique:b.data[2],classHash:b.data[3],calldata_len:b.data[4],calldata:b.data.slice(5,5+parseInt(b.data[4],16)),salt:b.data[b.data.length-1]}}j(fM,{getAbiEvents:()=>fO,isAbiEvent:()=>fN,parseEvents:()=>fP,parseUDCEvent:()=>fQ});var fR={};function fS(a){return"calldata_len"in a?{To:a.to,Selector:a.selector,Calldata:a.calldata}:a}function fT(a){let b=a.calldata??[],c=Array.isArray(b)?b:cR.compile(b);return{to:a.contractAddress,selector:bu(a.entrypoint),calldata:c}}function fU(a,b){let c=fT(a);return"1"===b?{...c,calldata_len:c.calldata.length,calldata:c.calldata}:{To:c.to,Selector:c.selector,Calldata:c.calldata}}function fV(a,b){return{name:"Account.execute_from_outside",version:b,chainId:a,..."2"===b?{revision:"1"}:{}}}function fW(a,b,c,d,e){return"1"===e?{types:aJ,primaryType:"OutsideExecution",domain:fV(a,e),message:{...b,nonce:c,calls_len:d.length,calls:d.map(a=>fU(a,e))}}:{types:aK,primaryType:"OutsideExecution",domain:fV(a,e),message:{Caller:b.caller,Nonce:c,"Execute After":b.execute_after,"Execute Before":b.execute_before,Calls:d.map(a=>fU(a,e))}}}function fX(a){let b=a.outsideExecution,c=dS(a.signature);return cR.compile({outside_execution:b,signature:c})}function fY(a){return(Array.isArray(a)?a:[a]).map(a=>{let b;if(a.version===aL.V1)b="execute_from_outside";else if(a.version===aL.V2)b="execute_from_outside_v2";else throw Error("Unsupported OutsideExecution version");return{contractAddress:a6(a.signerAddress),entrypoint:b,calldata:fX(a)}})}j(fR,{buildExecuteFromOutsideCall:()=>fY,buildExecuteFromOutsideCallData:()=>fX,getOutsideCall:()=>fT,getTypedData:()=>fW,toOutsideCallV2:()=>fS});var fZ={};async function f$(a,b,c){let d={contractAddress:a6(b),entrypoint:"supports_interface",calldata:[a6(c)]};try{let b=await a.callContract(d);return 0n!==BigInt(b[0])}catch{return!1}}j(fZ,{supportsInterface:()=>f$});var f_={};j(f_,{assertCallsAreStrictlyEqual:()=>f1,assertPaymasterTransactionSafety:()=>f2,getDefaultPaymasterNodeUrl:()=>f0});var f0=(a,b=!1)=>{b||al.info("Using default public node url, please provide nodeUrl in provider options!");let c=ah[a??ab.SN_SEPOLIA],d=Math.floor(Math.random()*c.length);return c[d]};function f1(a,b){let c="Provided calls are not strictly equal to the returned calls";aU(b.length-1===a.length,`${c}: Expected ${a.length+1} calls, got ${b.length}`);for(let d=0;d<a.length;d+=1){let e=a[d],f=fS(b[d]),g=a=>a4(a).toString(16).toLowerCase();aU(g(e.contractAddress)===g(f.To),`${c}: Contract address mismatch at call ${d}. Expected: ${e.contractAddress}, Got: ${f.To}`),aU(bu(e.entrypoint)===f.Selector,`${c}: Entrypoint mismatch at call ${d}. Expected: ${e.entrypoint}, Got: ${f.Selector}`);let h=cR.toCalldata(e.calldata),i=cR.toCalldata(f.Calldata);aU(h.length===i.length,`${c}: Calldata length mismatch at call ${d}. Expected length: ${h.length}, Got length: ${i.length}`);for(let a=0;a<h.length;a+=1)aU(BigInt(h[a])===BigInt(i[a]),`${c}: Calldata value mismatch at call ${d}, parameter ${a}. Expected: ${h[a]}, Got: ${i[a]}`)}}var f2=(a,b,c,d)=>{if("sponsored"!==c.feeMode.mode&&("invoke"===a.type||"deploy_and_invoke"===a.type)){let e="calls"in a.typed_data.message?a.typed_data.message.calls:a.typed_data.message.Calls;f1(b,e),((a,b)=>{aU(BigInt(fS(a[a.length-1]).To)===BigInt(b),"Gas token address is not equal to the provided gas token")})(e,c.feeMode.gasToken),d&&(aU(a.fee.suggested_max_fee_in_gas_token<=d,"Gas token price is too high"),((a,b)=>{let c=fS(a[a.length-1]);aU(BigInt(cR.toCalldata(c.Calldata)[1])===BigInt(b),"Gas token value is not equal to the provided gas fees")})(e,a.fee.suggested_max_fee_in_gas_token))}},f3=a=>"sponsored"===a.mode?{mode:"sponsored"}:{mode:"default",gas_token:a.gasToken},f4=a=>a?{execute_after:a.executeAfter||1,execute_before:a.executeBefore}:void 0,f5=a=>({version:a.version,feeMode:(a=>"sponsored"===a.mode?{mode:"sponsored"}:{mode:"default",gasToken:a.gas_token})(a.fee_mode),timeBounds:(a=>a?{executeAfter:a.execute_after,executeBefore:a.execute_before}:void 0)(a.time_bounds)}),f6={headers:{"Content-Type":"application/json"}},f7=class a{nodeUrl;headers;baseFetch;requestId;constructor(b){if(b instanceof a){this.nodeUrl=b.nodeUrl,this.headers={...f6.headers,...b.headers},this.baseFetch=b.baseFetch,this.requestId=b.requestId;return}if(b&&"nodeUrl"in b&&"headers"in b&&"baseFetch"in b){this.nodeUrl=b.nodeUrl??f0(void 0),this.headers={...f6.headers,...b.headers},this.baseFetch=b.baseFetch??ef,this.requestId=0;return}let{nodeUrl:c,headers:d,baseFetch:e}=b||{};c&&Object.values(ab).includes(c)?this.nodeUrl=f0(c,b?.default):c?this.nodeUrl=c:this.nodeUrl=f0(void 0,b?.default),this.baseFetch=e??ef,this.headers={...f6.headers,...d},this.requestId=0}fetch(a,b,c=0){let d={id:c,jsonrpc:"2.0",method:a,...b&&{params:b}};return this.baseFetch(this.nodeUrl,{method:"POST",body:aS(d),headers:this.headers})}errorHandler(a,b,c,d){if(c)throw new d8(c,a,b);if(d instanceof d7)throw d;if(d)throw Error(d.message)}async fetchEndpoint(a,b){try{this.requestId+=1;let c=await this.fetch(a,b,this.requestId),{error:d,result:e}=await c.json();return this.errorHandler(a,b,d),e}catch(c){throw this.errorHandler(a,b,c?.response?.data,c),c}}async isAvailable(){return this.fetchEndpoint("paymaster_isAvailable")}async buildTransaction(a,b){let c;switch(a.type){case"invoke":case"deploy_and_invoke":c={...a,invoke:{user_address:a.invoke.userAddress,calls:a.invoke.calls.map(a=>({to:a.contractAddress,selector:bu(a.entrypoint),calldata:cR.toHex(a.calldata)}))}};break;default:c=a}let d={version:b.version,fee_mode:f3(b.feeMode),time_bounds:f4(b.timeBounds)},e=await this.fetchEndpoint("paymaster_buildTransaction",{transaction:c,parameters:d}),f={gas_token_price_in_strk:BigInt(e.fee.gas_token_price_in_strk),estimated_fee_in_strk:BigInt(e.fee.estimated_fee_in_strk),estimated_fee_in_gas_token:BigInt(e.fee.estimated_fee_in_gas_token),suggested_max_fee_in_strk:BigInt(e.fee.suggested_max_fee_in_strk),suggested_max_fee_in_gas_token:BigInt(e.fee.suggested_max_fee_in_gas_token)};switch(e.type){case"invoke":return{type:"invoke",typed_data:e.typed_data,parameters:f5(e.parameters),fee:f};case"deploy_and_invoke":return{type:"deploy_and_invoke",deployment:e.deployment,typed_data:e.typed_data,parameters:f5(e.parameters),fee:f};default:return{type:"deploy",deployment:e.deployment,parameters:f5(e.parameters),fee:f}}}async executeTransaction(a,b){let c;switch(a.type){case"invoke":case"deploy_and_invoke":c={...a,invoke:{user_address:a.invoke.userAddress,typed_data:a.invoke.typedData,signature:dU(a.invoke.signature)}};break;default:c=a}let d={version:b.version,fee_mode:f3(b.feeMode),time_bounds:f4(b.timeBounds)};return this.fetchEndpoint("paymaster_executeTransaction",{transaction:c,parameters:d})}async getSupportedTokens(){return this.fetchEndpoint("paymaster_getSupportedTokens").then(a=>a.map(a=>({token_address:a.token_address,decimals:a.decimals,priceInStrk:BigInt(a.price_in_strk)})))}},f8=class{},f9=new f7({default:!0}),ga=class extends fr{signer;address;cairoVersion;transactionVersion;paymaster;constructor(a,b,c,d,e=aj.get("transactionVersion"),f){super(a),this.address=b.toLowerCase(),this.signer=a1(c)||c instanceof Uint8Array?new fv(c):c,d&&(this.cairoVersion=d.toString()),this.transactionVersion=e,this.paymaster=f?new f7(f):f9,al.debug("Account setup",{transactionVersion:this.transactionVersion,cairoVersion:this.cairoVersion,channel:this.channel.id})}static async create(){throw new d7("Not supported")}getPreferredVersion(a,b){return this.transactionVersion===av.V3?b:this.transactionVersion===av.V2?a:av.V3}async getNonce(a){return super.getNonceForAddress(this.address,a)}async getNonceSafe(a){try{return a4(a??await this.getNonce())}catch(a){return 0n}}async getCairoVersion(a){if(!this.cairoVersion){let{cairo:b}=a?await super.getContractVersion(void 0,a):await super.getContractVersion(this.address);this.cairoVersion=b}return this.cairoVersion}async estimateFee(a,b={}){return this.estimateInvokeFee(a,b)}async estimateInvokeFee(a,b={}){let{nonce:c,blockIdentifier:d,version:e,skipValidate:f=!0}=b,g=Array.isArray(a)?a:[a],h=a4(c??await this.getNonce()),i=dZ(this.getPreferredVersion(av.F1,av.F3),d$(e)),j=await this.getChainId(),k={...d_(b,await this.channel.setUpSpecVersion()),walletAddress:this.address,nonce:h,maxFee:L,version:i,chainId:j,cairoVersion:await this.getCairoVersion(),skipValidate:f},l=await this.buildInvocation(g,k);return super.getInvokeEstimateFee({...l},{...d_(b,await this.channel.setUpSpecVersion()),version:i,nonce:h},d,b.skipValidate)}async estimateDeclareFee(a,b={}){let{blockIdentifier:c,nonce:d,version:e,skipValidate:f=!0}=b,g=a4(d??await this.getNonce()),h=dZ(d2(a.contract)?this.getPreferredVersion(av.F2,av.F3):av.F1,d$(e)),i=await this.getChainId(),j=await this.buildDeclarePayload(a,{...d_(b,await this.channel.setUpSpecVersion()),nonce:g,chainId:i,version:h,walletAddress:this.address,maxFee:L,cairoVersion:void 0,skipValidate:f});return super.getDeclareEstimateFee(j,{...d_(b,await this.channel.setUpSpecVersion()),version:h,nonce:g},c,b.skipValidate)}async estimateAccountDeployFee({classHash:a,addressSalt:b=0,constructorCalldata:c=[],contractAddress:d},e={}){let{blockIdentifier:f,version:g,skipValidate:h=!0}=e,i=dZ(this.getPreferredVersion(av.F1,av.F3),d$(g)),j=await this.getChainId(),k=await this.buildAccountDeployPayload({classHash:a,addressSalt:b,constructorCalldata:c,contractAddress:d},{...d_(e,await this.channel.setUpSpecVersion()),nonce:L,chainId:j,version:i,walletAddress:this.address,maxFee:L,cairoVersion:void 0,skipValidate:h});return super.getDeployAccountEstimateFee({...k},{...d_(e,await this.channel.setUpSpecVersion()),version:i,nonce:L},f,e.skipValidate)}async estimateDeployFee(a,b={}){let c=this.buildUDCContractPayload(a);return this.estimateInvokeFee(c,b)}async estimateFeeBulk(a,b={}){if(!a.length)throw TypeError("Invocations should be non-empty array");let{nonce:c,blockIdentifier:d,version:e,skipValidate:f}=b,g=await this.accountInvocationsFactory(a,{...d_(b,await this.channel.setUpSpecVersion()),versions:[av.F1,dZ(this.getPreferredVersion(av.F2,av.F3),e)],nonce:c,blockIdentifier:d,skipValidate:f});return super.getEstimateFeeBulk(g,{blockIdentifier:d,skipValidate:f})}async simulateTransaction(a,b={}){if(!a.length)throw TypeError("Invocations should be non-empty array");let{nonce:c,blockIdentifier:d,skipValidate:e=!0,skipExecute:f,version:g}=b,h=await this.accountInvocationsFactory(a,{...d_(b,await this.channel.setUpSpecVersion()),versions:[av.V1,dZ(this.getPreferredVersion(av.V2,av.V3),g)],nonce:c,blockIdentifier:d,skipValidate:e});return super.getSimulateTransaction(h,{blockIdentifier:d,skipValidate:e,skipExecute:f})}async execute(a,b={}){let c=Array.isArray(a)?a:[a],d=a4(b.nonce??await this.getNonce()),e=dZ(this.getPreferredVersion(av.V1,av.V3),b.version),f=await this.getUniversalSuggestedFee(e,{type:ap.INVOKE,payload:a},{...b,version:e}),g=await this.getChainId(),h={...d_(b,await this.channel.setUpSpecVersion()),resourceBounds:f.resourceBounds,walletAddress:this.address,nonce:d,maxFee:f.maxFee,version:e,chainId:g,cairoVersion:await this.getCairoVersion()},i=await this.signer.signTransaction(c,h),j=et(c,await this.getCairoVersion());return this.invokeFunction({contractAddress:this.address,calldata:j,signature:i},{...d_(b,await this.channel.setUpSpecVersion()),resourceBounds:f.resourceBounds,nonce:d,maxFee:f.maxFee,version:e})}async buildPaymasterTransaction(a,b){let c;if(!b.deploymentData&&await this.getSnip9Version()===aL.UNSUPPORTED)throw Error("Account is not compatible with SNIP-9");let d={version:"0x1",feeMode:b.feeMode,timeBounds:b.timeBounds};return c=b.deploymentData?a.length>0?{type:"deploy_and_invoke",invoke:{userAddress:this.address,calls:a},deployment:b.deploymentData}:{type:"deploy",deployment:b.deploymentData}:{type:"invoke",invoke:{userAddress:this.address,calls:a}},this.paymaster.buildTransaction(c,d)}async estimatePaymasterTransactionFee(a,b){return(await this.buildPaymasterTransaction(a,b)).fee}async preparePaymasterTransaction(a){let b;switch(a.type){case"deploy_and_invoke":{let c=await this.signMessage(a.typed_data);b={type:"deploy_and_invoke",invoke:{userAddress:this.address,typedData:a.typed_data,signature:dU(c)},deployment:a.deployment};break}case"invoke":{let c=await this.signMessage(a.typed_data);b={type:"invoke",invoke:{userAddress:this.address,typedData:a.typed_data,signature:dU(c)}};break}case"deploy":b={type:"deploy",deployment:a.deployment};break;default:throw Error("Invalid transaction type")}return b}async executePaymasterTransaction(a,b,c){let d=await this.buildPaymasterTransaction(a,b);f2(d,a,b,c);let e=await this.preparePaymasterTransaction(d);return this.paymaster.executeTransaction(e,d.parameters).then(a=>({transaction_hash:a.transaction_hash}))}async declareIfNot(a,b={}){let c=d3(a);try{await this.getClassByHash(c.classHash)}catch(c){return this.declare(a,b)}return{transaction_hash:"",class_hash:c.classHash}}async declare(a,b={}){let c=d3(a),{nonce:d,version:e}=b,f=dZ(d2(a.contract)?this.getPreferredVersion(av.V2,av.V3):av.V1,e),g=await this.getUniversalSuggestedFee(f,{type:ap.DECLARE,payload:c},{...b,version:f}),h={...d_(b,await this.channel.setUpSpecVersion()),resourceBounds:g.resourceBounds,maxFee:g.maxFee,nonce:a4(d??await this.getNonce()),version:f,chainId:await this.getChainId(),walletAddress:this.address,cairoVersion:void 0},i=await this.buildDeclarePayload(c,h);return this.declareContract(i,h)}async deploy(a,b={}){let{calls:c,addresses:d}=eu(a,this.address);return{...await this.execute(c,b),contract_address:d}}async deployContract(a,b={}){let c=await this.deploy(a,b);return fQ(await this.waitForTransaction(c.transaction_hash))}async declareAndDeploy(a,b={}){let{constructorCalldata:c,salt:d,unique:e}=a,f=await this.declareIfNot(a,b);if(""!==f.transaction_hash){let a=await this.waitForTransaction(f.transaction_hash);f={...f,...a}}let g=await this.deployContract({classHash:f.class_hash,salt:d,unique:e,constructorCalldata:c},b);return{declare:{...f},deploy:g}}deploySelf=this.deployAccount;async deployAccount({classHash:a,constructorCalldata:b=[],addressSalt:c=0,contractAddress:d},e={}){let f=dZ(this.getPreferredVersion(av.V1,av.V3),e.version),g=await this.getChainId(),h=cR.compile(b),i=d??dt(c,a,h,0),j=await this.getUniversalSuggestedFee(f,{type:ap.DEPLOY_ACCOUNT,payload:{classHash:a,constructorCalldata:h,addressSalt:c,contractAddress:i}},e),k=await this.signer.signDeployAccountTransaction({...d_(e,await this.channel.setUpSpecVersion()),classHash:a,constructorCalldata:h,contractAddress:i,addressSalt:c,chainId:g,resourceBounds:j.resourceBounds,maxFee:j.maxFee,version:f,nonce:L});return this.deployAccountContract({classHash:a,addressSalt:c,constructorCalldata:b,signature:k},{...d_(e,await this.channel.setUpSpecVersion()),nonce:L,resourceBounds:j.resourceBounds,maxFee:j.maxFee,version:f})}async signMessage(a){return this.signer.signMessage(a,this.address)}async hashMessage(a){return eY(a,this.address)}async getSnip9Version(){return await f$(this,this.address,Z)?aL.V2:await f$(this,this.address,Y)?aL.V1:aL.UNSUPPORTED}async isValidSnip9Nonce(a){try{let b={contractAddress:this.address,entrypoint:"is_valid_outside_execution_nonce",calldata:[a6(a)]},c=await this.callContract(b);return 0n!==BigInt(c[0])}catch(a){throw Error(`Failed to check if nonce is valid: ${a}`)}}async getSnip9Nonce(){let a=dR();return await this.isValidSnip9Nonce(a)?a:this.getSnip9Nonce()}async getOutsideTransaction(a,b,c,d){if(!a3(a.caller)&&"ANY_CALLER"!==a.caller)throw Error(`The caller ${a.caller} is not valid.`);let e=a3(a.caller)?a.caller:X,f=Array.isArray(b)?b:[b],g=c??await this.getSnip9Version();if(!g)throw Error("This account is not handling outside transactions.");let h=d?a6(d):await this.getSnip9Nonce(),i=fW(await this.getChainId(),{caller:e,execute_after:a.execute_after,execute_before:a.execute_before},h,f,g),j=await this.signMessage(i);return{outsideExecution:{caller:e,nonce:h,execute_after:a.execute_after,execute_before:a.execute_before,calls:f.map(fT)},signature:j,signerAddress:this.address,version:g}}async executeFromOutside(a,b){let c=fY(a);return this.execute(c,b)}async getUniversalSuggestedFee(a,{type:b,payload:c},d){let e=0,f=dW(L,void 0,await this.channel.setUpSpecVersion());return a===av.V3?f=d.resourceBounds??(await this.getSuggestedFee({type:b,payload:c},d)).resourceBounds:e=d.maxFee??(await this.getSuggestedFee({type:b,payload:c},d)).suggestedMaxFee,{maxFee:e,resourceBounds:f}}async getSuggestedFee({type:a,payload:b},c){switch(a){case ap.INVOKE:return this.estimateInvokeFee(b,c);case ap.DECLARE:return this.estimateDeclareFee(b,c);case ap.DEPLOY_ACCOUNT:return this.estimateAccountDeployFee(b,c);case ap.DEPLOY:return this.estimateDeployFee(b,c);default:return dX(await this.channel.setUpSpecVersion())}}async buildInvocation(a,b){let c=et(a,await this.getCairoVersion()),d=b.skipValidate?[]:await this.signer.signTransaction(a,b);return{...d_(b,await this.channel.setUpSpecVersion()),contractAddress:this.address,calldata:c,signature:d}}async buildDeclarePayload(a,b){let{classHash:c,contract:d,compiledClassHash:e}=d3(a),f=ej(d);if(aZ(e)&&(b.version===ax.F3||b.version===ax.V3))throw Error("V3 Transaction work with Cairo1 Contracts and require compiledClassHash");let g=b.skipValidate?[]:await this.signer.signDeclareTransaction({...b,...d_(b,await this.channel.setUpSpecVersion()),classHash:c,compiledClassHash:e,senderAddress:b.walletAddress});return{senderAddress:b.walletAddress,signature:g,contract:f,compiledClassHash:e}}async buildAccountDeployPayload({classHash:a,addressSalt:b=0,constructorCalldata:c=[],contractAddress:d},e){let f=cR.compile(c),g=d??dt(b,a,f,0),h=e.skipValidate?[]:await this.signer.signDeployAccountTransaction({...e,...d_(e,await this.channel.setUpSpecVersion()),classHash:a,contractAddress:g,addressSalt:b,constructorCalldata:f});return{...d_(e,await this.channel.setUpSpecVersion()),classHash:a,addressSalt:b,constructorCalldata:f,signature:h}}buildUDCContractPayload(a){return[].concat(a).map(a=>{let{classHash:b,salt:c="0",unique:d=!0,constructorCalldata:e=[]}=a,f=cR.compile(e);return{contractAddress:W.ADDRESS,entrypoint:W.ENTRYPOINT,calldata:[b,c,bj(d),f.length,...f]}})}async accountInvocationsFactory(a,b){let{nonce:c,blockIdentifier:d,skipValidate:e=!0}=b,f=await this.getNonceSafe(c),g=await this.getChainId(),h=b.versions.map(a=>dZ(a)),i="payload"in a[0]?a[0].payload:a[0],j=a[0].type===ap.DEPLOY_ACCOUNT?await this.getCairoVersion(i.classHash):await this.getCairoVersion();return Promise.all([].concat(a).map(async(a,c)=>{let i="payload"in a?a.payload:a,k={...d_(b,await this.channel.setUpSpecVersion()),walletAddress:this.address,nonce:a4(Number(f)+c),maxFee:L,chainId:g,cairoVersion:j,version:"",skipValidate:e},l={type:a.type,nonce:a4(Number(f)+c),blockIdentifier:d,version:""};if(a.type===ap.INVOKE){let a=d0(h[1]);k.version=a,l.version=a;let b=await this.buildInvocation([].concat(i),k);return{...l,...b,...k}}if(a.type===ap.DEPLOY){let a=d0(h[1]);k.version=a,l.version=a;let b=this.buildUDCContractPayload(i),c=await this.buildInvocation(b,k);return{...l,...c,...k,type:ap.INVOKE}}if(a.type===ap.DECLARE){let a=d2(i.contract)?h[1]:h[0];k.version=a,l.version=a;let b=await this.buildDeclarePayload(i,k);return{...l,...b,...k}}if(a.type===ap.DEPLOY_ACCOUNT){let a=d0(h[1]);k.version=a,l.version=a;let b=await this.buildAccountDeployPayload(i,k);return{...l,...b,...k}}throw Error(`accountInvocationsFactory: unsupported transaction type: ${a}`)}))}async getStarkName(a=this.address,b){return super.getStarkName(a,b)}},gb=class extends fs{},gc={};function gd(a,b=!1){return a.request({type:"wallet_requestAccounts",params:{silent_mode:b}})}function ge(a){return a.request({type:"wallet_getPermissions"})}function gf(a,b){return a.request({type:"wallet_watchAsset",params:b})}function gg(a,b){return a.request({type:"wallet_addStarknetChain",params:b})}function gh(a,b){return a.request({type:"wallet_switchStarknetChain",params:{chainId:b}})}function gi(a){return a.request({type:"wallet_requestChainId"})}function gj(a){return a.request({type:"wallet_deploymentData"})}function gk(a,b){return a.request({type:"wallet_addInvokeTransaction",params:b})}function gl(a,b){return a.request({type:"wallet_addDeclareTransaction",params:b})}function gm(a,b){return a.request({type:"wallet_signTypedData",params:b})}function gn(a){return a.request({type:"wallet_supportedSpecs"})}function go(a,b){a.on("accountsChanged",b)}function gp(a,b){a.on("networkChanged",b)}j(gc,{addDeclareTransaction:()=>gl,addInvokeTransaction:()=>gk,addStarknetChain:()=>gg,deploymentData:()=>gj,getPermissions:()=>ge,onAccountChange:()=>go,onNetworkChanged:()=>gp,requestAccounts:()=>gd,requestChainId:()=>gi,signMessage:()=>gm,supportedSpecs:()=>gn,switchStarknetChain:()=>gh,watchAsset:()=>gf});var gq=class a extends ga{walletProvider;constructor(a,b,c,d,e){super(a,c,"",d,void 0,e),this.walletProvider=b,this.walletProvider.on("accountsChanged",a=>{a&&(this.address=a[0].toLowerCase())}),this.walletProvider.on("networkChanged",a=>{a&&this.channel.setChainId(a)})}onAccountChange(a){go(this.walletProvider,a)}onNetworkChanged(a){gp(this.walletProvider,a)}requestAccounts(a=!1){return gd(this.walletProvider,a)}getPermissions(){return ge(this.walletProvider)}switchStarknetChain(a){return gh(this.walletProvider,a)}watchAsset(a){return gf(this.walletProvider,a)}addStarknetChain(a){return gg(this.walletProvider,a)}execute(a){let b=[].concat(a).map(a=>{let{contractAddress:b,entrypoint:c,calldata:d}=a;return{contract_address:b,entry_point:c,calldata:d}});return gk(this.walletProvider,{calls:b})}declare(a){let b=d3(a),c=a.contract,d={...c,abi:aS(c.abi)};if(!b.compiledClassHash)throw Error("compiledClassHash is required");let e={compiled_class_hash:b.compiledClassHash,contract_class:d};return gl(this.walletProvider,e)}async deploy(a){let{calls:b,addresses:c}=eu(a,this.address);return{...await this.execute(b),contract_address:c}}signMessage(a){return gm(this.walletProvider,a)}static async connect(b,c,d,e,f=!1){let[g]=await gd(c,f);return new a(b,c,g,d,e)}static async connectSilent(b,c,d,e){return a.connect(b,c,d,e,!0)}};function gr(a,b){return async function(...c){let d={...a.contractOptions};return a.contractOptions=void 0,a.call(b.name,c,{parseRequest:!0,parseResponse:!0,...d})}}function gs(a,b){return"view"===b.stateMutability||"view"===b.state_mutability?gr(a,b):async function(...c){let d={...a.contractOptions};return a.contractOptions=void 0,a.invoke(b.name,c,{parseRequest:!0,...d})}}function gt(a,b){return Array.isArray(a)&&"__compiled__"in a?a:Array.isArray(a)&&Array.isArray(a[0])&&"__compiled__"in a[0]?a[0]:b()}var gu=class{abi;address;providerOrAccount;deployTransactionHash;structs;events;functions;callStatic;populateTransaction;estimateFee;callData;contractOptions;constructor(a,b,c=ft){this.address=b&&b.toLowerCase(),this.providerOrAccount=c,this.callData=new cR(a),this.structs=cR.getAbiStruct(a),this.events=fO(a);let d=cy(a);this.abi=d.getLegacyFormat();let e={enumerable:!0,value:{},writable:!1};Object.defineProperties(this,{functions:{enumerable:!0,value:{},writable:!1},callStatic:{enumerable:!0,value:{},writable:!1},populateTransaction:{enumerable:!0,value:{},writable:!1},estimateFee:{enumerable:!0,value:{},writable:!1}}),this.abi.forEach(a=>{var b,c;if("function"!==a.type)return;let d=a.name;this[d]||Object.defineProperty(this,d,{...e,value:gs(this,a)}),this.functions[d]||Object.defineProperty(this.functions,d,{...e,value:gs(this,a)}),this.callStatic[d]||Object.defineProperty(this.callStatic,d,{...e,value:gr(this,a)}),this.populateTransaction[d]||Object.defineProperty(this.populateTransaction,d,{...e,value:(b=this,function(...c){return b.populate(a.name,c)})}),this.estimateFee[d]||Object.defineProperty(this.estimateFee,d,{...e,value:(c=this,function(...b){return c.estimate(a.name,b)})})})}withOptions(a){return this.contractOptions=a,this}attach(a){this.address=a}connect(a){this.providerOrAccount=a}async deployed(){return this.deployTransactionHash&&(await this.providerOrAccount.waitForTransaction(this.deployTransactionHash),this.deployTransactionHash=void 0),this}async call(a,b=[],{parseRequest:c=!0,parseResponse:d=!0,formatResponse:e,blockIdentifier:f}={}){aU(null!==this.address,"contract is not connected to an address");let g=gt(b,()=>c?(this.callData.validate(aE.CALL,a,b),this.callData.compile(a,b)):(al.warn("Call skipped parsing but provided rawArgs, possible malfunction request"),b));return this.providerOrAccount.callContract({contractAddress:this.address,calldata:g,entrypoint:a},f).then(b=>d?e?this.callData.format(a,b,e):this.callData.parse(a,b):b)}invoke(a,b=[],{parseRequest:c=!0,signature:d,...e}={}){aU(null!==this.address,"contract is not connected to an address");let f=gt(b,()=>c?(this.callData.validate(aE.INVOKE,a,b),this.callData.compile(a,b)):(al.warn("Invoke skipped parsing but provided rawArgs, possible malfunction request"),b)),g={contractAddress:this.address,calldata:f,entrypoint:a};if("execute"in this.providerOrAccount)return this.providerOrAccount.execute(g,{...e});if(!e.nonce)throw Error("Nonce is required when invoking a function without an account");return al.warn(`Invoking ${a} without an account. This will not work on a public node.`),this.providerOrAccount.invokeFunction({...g,signature:d},{...e,nonce:e.nonce})}async estimate(a,b=[]){aU(null!==this.address,"contract is not connected to an address"),gt(b,()=>!1)||this.callData.validate(aE.INVOKE,a,b);let c=this.populate(a,b);if("estimateInvokeFee"in this.providerOrAccount)return this.providerOrAccount.estimateInvokeFee(c);throw Error("Contract must be connected to the account contract to estimate")}populate(a,b=[]){let c=gt(b,()=>this.callData.compile(a,b));return{contractAddress:this.address,entrypoint:a,calldata:c}}parseEvents(a){let b;return a.match({success:a=>{b=fP(a.events?.map(b=>({block_hash:a.block_hash,block_number:a.block_number,transaction_hash:a.transaction_hash,...b})).filter(a=>bb(a.from_address)===bb(this.address),[])||[],this.events,this.structs,cR.getAbiEnum(this.abi))},_:()=>{throw Error("This transaction was not successful.")}}),b}isCairo1(){return bM.isCairo1Abi(this.abi)}async getVersion(){return this.providerOrAccount.getContractVersion(this.address)}typedv2(a){return this}},gv=class{functions;callStatic;populateTransaction;estimateFee},gw=class{compiledContract;account;abi;classHash;casm;compiledClassHash;CallData;contractOptions;constructor(a){this.compiledContract=a.compiledContract,this.account=a.account,this.casm=a.casm,this.abi=a.abi??a.compiledContract.abi,this.classHash=a.classHash,this.compiledClassHash=a.compiledClassHash,this.CallData=new cR(this.abi),this.contractOptions=a.contractOptions}async deploy(...a){let b=gt(a,()=>this.contractOptions?.parseRequest?(this.CallData.validate(aE.DEPLOY,"constructor",a),this.CallData.compile("constructor",a)):(al.warn("Call skipped parsing but provided rawArgs, possible malfunction request"),a)),{deploy:{contract_address:c,transaction_hash:d}}=await this.account.declareAndDeploy({contract:this.compiledContract,casm:this.casm,classHash:this.classHash,compiledClassHash:this.compiledClassHash,constructorCalldata:b,salt:this.contractOptions?.addressSalt});aU(!!c,"Deployment of the contract failed");let e=new gu(this.compiledContract.abi,c,this.account);return e.deployTransactionHash=d,e}connect(a){return this.account=a,this}attach(a){return new gu(this.abi,a,this.account)}},gx=class{};function gy(a,b="fri"){if("strk"===b){let b="";"bigint"==typeof a?b=a.toString():"string"==typeof a&&(b=a3(a)?BigInt(a).toString():a);let[c,d="0"]=b.split("."),e=d.padEnd(18,"0");return`${c}${e}`.replace(/\b0+/g,"")}let c=BigInt(a).toString();return(c.length<=18?`0.${c.padStart(18,"0")}`:`${c.slice(0,c.length-18)}.${c.slice(c.length-18)}`).replace(/(\.[0-9]*[1-9])0+$|\.0*$/,"$1")}},280002,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.TimelockRefundHandler=void 0;let d=a.r(461392);class e{constructor(a){this.address=a}getCommitment(a){return a}getWitness(a,b){if(e.getExpiry(b)>BigInt(Math.floor(Date.now()/1e3)))throw Error("Not expired yet!");return Promise.resolve({initialTxns:[],witness:[]})}getGas(){return e.gas}static getExpiry(a){return(0,d.bigNumberishToBuffer)(a.refundData,32).readBigUInt64BE(24).valueOf()}}c.TimelockRefundHandler=e,e.gas={l1DataGas:0,l2Gas:4e6,l1Gas:0}},593507,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetSwapData=void 0;let d=a.r(163846),e=a.r(280002),f=a.r(877475),g=a.r(461392);class h extends d.SwapData{static toFlags(a){let b=(0,g.toBigInt)(a);return{sequence:b>>64n,payOut:(1n&b)===1n,payIn:(2n&b)===2n,reputation:(4n&b)===4n}}getFlags(){return(this.sequence<<64n)+(this.payOut?1n:0n)+(this.payIn?2n:0n)+(this.reputation?4n:0n)}constructor(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){super(),null!=b||null!=c||null!=d||null!=e||null!=f||null!=g||null!=h||null!=i||null!=j||null!=k||null!=l||null!=m||null!=n||null!=o?(this.offerer=a,this.claimer=b,this.token=c,this.refundHandler=d,this.claimHandler=e,this.payOut=f,this.payIn=g,this.reputation=h,this.sequence=i,this.claimData=j,this.refundData=k,this.amount=l,this.feeToken=m,this.securityDeposit=n,this.claimerBounty=o,this.kind=p,this.extraData=q):(this.offerer=a.offerer,this.claimer=a.claimer,this.token=a.token,this.refundHandler=a.refundHandler,this.claimHandler=a.claimHandler,this.payOut=a.payOut,this.payIn=a.payIn,this.reputation=a.reputation,this.sequence=null==a.sequence?null:BigInt(a.sequence),this.claimData=a.claimData,this.refundData=a.refundData,this.amount=null==a.amount?null:BigInt(a.amount),this.feeToken=a.feeToken,this.securityDeposit=null==a.securityDeposit?null:BigInt(a.securityDeposit),this.claimerBounty=null==a.claimerBounty?null:BigInt(a.claimerBounty),this.kind=a.kind,this.extraData=a.extraData)}getOfferer(){return this.offerer}setOfferer(a){this.offerer=a,this.payIn=!0}getClaimer(){return this.claimer}setClaimer(a){this.claimer=a,this.payIn=!1,this.payOut=!0,this.reputation=!1}serialize(){return{type:"strk",offerer:this.offerer,claimer:this.claimer,token:this.token,refundHandler:this.refundHandler,claimHandler:this.claimHandler,payOut:this.payOut,payIn:this.payIn,reputation:this.reputation,sequence:null==this.sequence?null:this.sequence.toString(10),claimData:this.claimData,refundData:this.refundData,amount:null==this.amount?null:this.amount.toString(10),feeToken:this.feeToken,securityDeposit:null==this.securityDeposit?null:this.securityDeposit.toString(10),claimerBounty:null==this.claimerBounty?null:this.claimerBounty.toString(10),kind:this.kind,extraData:this.extraData}}getAmount(){return this.amount}getToken(){return this.token}isToken(a){return this.token.toLowerCase()===a.toLowerCase()}getType(){return this.kind}getExpiry(){return e.TimelockRefundHandler.getExpiry(this)}isPayIn(){return this.payIn}isPayOut(){return this.payOut}getEscrowHash(){let a=f.cairo.uint256("0x"+this.amount.toString(16)),b=f.cairo.uint256("0x"+this.securityDeposit.toString(16)),c=f.cairo.uint256("0x"+this.claimerBounty.toString(16)),d=f.hash.computePoseidonHashOnElements([this.offerer,this.claimer,this.token,this.refundHandler,this.claimHandler,this.getFlags(),this.claimData,this.refundData,a.low,a.high,this.feeToken,b.low,b.high,c.low,c.high]);return d.startsWith("0x")&&(d=d.slice(2)),d.padStart(64,"0")}getClaimHash(){let a=this.claimData;return a.startsWith("0x")&&(a=a.slice(2)),a.padStart(64,"0")}getSequence(){return this.sequence}getConfirmationsHint(){return null==this.extraData||84!=this.extraData.length?null:parseInt(this.extraData.slice(80),16)}getNonceHint(){return null==this.extraData||84!=this.extraData.length?null:BigInt("0x"+this.extraData.slice(64,80))}getTxoHashHint(){return null==this.extraData||84!=this.extraData.length?null:this.extraData.slice(0,64)}getExtraData(){return this.extraData}setExtraData(a){this.extraData=a}getSecurityDeposit(){return this.securityDeposit}getClaimerBounty(){return this.claimerBounty}getTotalDeposit(){return this.claimerBounty<this.securityDeposit?this.securityDeposit:this.claimerBounty}getDepositToken(){return this.feeToken}isDepositToken(a){return a.startsWith("0x")||(a="0x"+a),(0,g.toHex)(this.feeToken)===(0,g.toHex)(a)}isClaimer(a){return a.startsWith("0x")||(a="0x"+a),(0,g.toHex)(this.claimer)===(0,g.toHex)(a)}isOfferer(a){return a.startsWith("0x")||(a="0x"+a),(0,g.toHex)(this.offerer)===(0,g.toHex)(a)}isRefundHandler(a){return a.startsWith("0x")||(a="0x"+a),(0,g.toHex)(this.refundHandler)===(0,g.toHex)(a)}isClaimHandler(a){return a.startsWith("0x")||(a="0x"+a),(0,g.toHex)(this.claimHandler)===(0,g.toHex)(a)}isClaimData(a){return a.startsWith("0x")||(a="0x"+a),(0,g.toHex)(this.claimData)===(0,g.toHex)(a)}equals(a){return a.offerer.toLowerCase()===this.offerer.toLowerCase()&&a.claimer.toLowerCase()===this.claimer.toLowerCase()&&a.token.toLowerCase()===this.token.toLowerCase()&&a.refundHandler.toLowerCase()===this.refundHandler.toLowerCase()&&a.claimHandler.toLowerCase()===this.claimHandler.toLowerCase()&&a.payIn===this.payIn&&a.payOut===this.payOut&&a.reputation===this.reputation&&this.sequence===a.sequence&&a.claimData.toLowerCase()===this.claimData.toLowerCase()&&a.refundData.toLowerCase()===this.refundData.toLowerCase()&&a.amount===this.amount&&a.securityDeposit===this.securityDeposit&&a.claimerBounty===this.claimerBounty}toEscrowStruct(){return{offerer:this.offerer,claimer:this.claimer,token:this.token,refund_handler:this.refundHandler,claim_handler:this.claimHandler,flags:this.getFlags(),claim_data:this.claimData,refund_data:this.refundData,amount:f.cairo.uint256((0,g.toBigInt)(this.amount)),fee_token:this.feeToken,security_deposit:f.cairo.uint256((0,g.toBigInt)(this.securityDeposit)),claimer_bounty:f.cairo.uint256((0,g.toBigInt)(this.claimerBounty)),success_action:new f.CairoOption(f.CairoOptionVariant.None)}}static fromSerializedFeltArray(a,b){let c=(0,g.toHex)(a.shift()),d=(0,g.toHex)(a.shift()),e=(0,g.toHex)(a.shift()),f=(0,g.toHex)(a.shift()),i=(0,g.toHex)(a.shift()),{payOut:j,payIn:k,reputation:l,sequence:m}=h.toFlags(a.shift()),n=(0,g.toHex)(a.shift()),o=(0,g.toHex)(a.shift()),p=(0,g.toBigInt)({low:a.shift(),high:a.shift()}),q=(0,g.toHex)(a.shift()),r=(0,g.toBigInt)({low:a.shift(),high:a.shift()}),s=(0,g.toBigInt)({low:a.shift(),high:a.shift()});return 0n===(0,g.toBigInt)(a.shift())&&((0,g.toHex)(a.shift()),(0,g.toBigInt)(a.shift()),(0,g.toBigInt)({low:a.shift(),high:a.shift()})),new h(c,d,e,f,i,j,k,l,m,n,o,p,q,r,s,b.getType(),null)}}c.StarknetSwapData=h,d.SwapData.deserializers.strk=h},461392,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.findLastIndex=c.parseInitFunctionCalldata=c.poseidonHashRange=c.bufferToByteArray=c.bufferToBytes31Span=c.bytes31SpanToBuffer=c.toBigInt=c.bigNumberishToBuffer=c.u32ReverseEndianness=c.bufferToU32Array=c.u32ArrayToBuffer=c.calculateHash=c.toHex=c.tryWithRetries=c.getLogger=c.onceAsync=c.timeoutPromise=c.isUint256=void 0;let d=a.r(895831),e=a.r(877475),f=a.r(500874),g=a.r(593507);function h(a){return null!=a.low&&null!=a.high}function i(a,b){return new Promise((c,d)=>{let e=setTimeout(c,a);null!=b&&b.addEventListener("abort",()=>{clearTimeout(e),d(Error("Aborted"))})})}function j(b){return{debug:(c,...d)=>a.g.atomiqLogLevel>=3&&console.debug(b+c,...d),info:(c,...d)=>a.g.atomiqLogLevel>=2&&console.info(b+c,...d),warn:(c,...d)=>(null==a.g.atomiqLogLevel||a.g.atomiqLogLevel>=1)&&console.warn(b+c,...d),error:(c,...d)=>(null==a.g.atomiqLogLevel||a.g.atomiqLogLevel>=0)&&console.error(b+c,...d)}}c.isUint256=h,c.timeoutPromise=i,c.onceAsync=function(a){let b;return()=>null==b?b=a():b.catch(()=>b=a())},c.getLogger=j;let k=j("Utils: ");function l(a,b){if(h(a))return f.Buffer.concat([l(a.high,16),l(a.low,16)]);a="string"==typeof a?a.startsWith("0x")?a.slice(2):BigInt(a).toString(16):a.toString(16),null!=b&&(a=a.padStart(2*b,"0"));let c=f.Buffer.from(a,"hex");return c.length>b?c.slice(c.length-b):c}function m(a){return null==a?null:h(a)?m(a.high)<<128n|m(a.low):"string"==typeof a?(a.startsWith("0x")||(a="0x"+a),BigInt(a)):"bigint"==typeof a?a:BigInt(a)}function n(a,b=0,c=a.length){let d=[];for(let e=b+31;e<c;e+=31)d.push(BigInt("0x"+a.slice(e-31,e).toString("hex")));return c>b+31*d.length&&d.push(BigInt("0x"+a.slice(b+31*d.length,c).toString("hex"))),d}c.tryWithRetries=async function(a,b,c,d){(b=b||{}).maxRetries=b.maxRetries||5,b.delay=b.delay||500,b.exponential=null==b.exponential||b.exponential;let e=null;for(let f=0;f<b.maxRetries;f++){try{return await a()}catch(a){if(null!=c&&c(a))throw a;e=a,k.error("tryWithRetries(): error on try number: "+f,a)}if(null!=d&&d.aborted)throw Error("Aborted");f!==b.maxRetries-1&&await i(b.exponential?b.delay*Math.pow(2,f):b.delay,d)}throw e},c.toHex=function(a,b=64){if(null==a)return null;switch(typeof a){case"string":if(a.startsWith("0x"))return"0x"+a.slice(2).padStart(b,"0").toLowerCase();return"0x"+BigInt(a).toString(16).padStart(b,"0");case"number":case"bigint":return"0x"+a.toString(16).padStart(b,"0")}return"0x"+a.toString("hex").padStart(b,"0")},c.calculateHash=function(a){let b={version:a.details.version,maxFee:a.details.maxFee,chainId:a.details.chainId,nonce:a.details.nonce,accountDeploymentData:"0x3"===a.details.version?a.details.accountDeploymentData:null,nonceDataAvailabilityMode:"0x3"===a.details.version?d.EDAMode[a.details.nonceDataAvailabilityMode]:null,feeDataAvailabilityMode:"0x3"===a.details.version?d.EDAMode[a.details.feeDataAvailabilityMode]:null,resourceBounds:"0x3"===a.details.version?a.details.resourceBounds:null,tip:"0x3"===a.details.version?a.details.tip:null,paymasterData:"0x3"===a.details.version?a.details.paymasterData:null};switch(a.type){case"INVOKE":let c=e.CallData.compile(a.signed.calldata);return a.txId=e.hash.calculateInvokeTransactionHash({senderAddress:a.details.walletAddress,compiledCalldata:c,...b});case"DEPLOY_ACCOUNT":let f=e.CallData.compile(a.signed.constructorCalldata);return a.txId=e.hash.calculateDeployAccountTransactionHash({contractAddress:a.tx.contractAddress,classHash:a.signed.classHash,constructorCalldata:f,compiledConstructorCalldata:f,salt:a.signed.addressSalt,...b});default:throw Error("Unsupported tx type!")}},c.u32ArrayToBuffer=function(a){let b=f.Buffer.alloc(4*a.length);for(let c=0;c<a.length;c++)b.writeUInt32BE(Number(a[c]),4*c);return b},c.bufferToU32Array=function(a){let b=[];for(let c=0;c<a.length;c+=4)b.push(a.readUInt32BE(c));return b},c.u32ReverseEndianness=function(a){let b=BigInt(a);return Number((255n&b)<<24n|(65280n&b)<<8n|b>>8n&65280n|b>>24n&255n)},c.bigNumberishToBuffer=l,c.toBigInt=m,c.bytes31SpanToBuffer=function(a,b){let c=[],d=Math.floor(b/31),e=b-31*d,g=d+ +(0!==e);if(a.length<g)throw Error("Not enough bytes in the felt array!");let h=0;for(;h<d;h++)c.push(l(a[h],31));return 0!==e&&c.push(l(a[h],e)),f.Buffer.concat(c)},c.bufferToBytes31Span=n,c.bufferToByteArray=function(a,b=0,c=a.length){let d=[];for(let e=b+31;e<c;e+=31)d.push(BigInt("0x"+a.slice(e-31,e).toString("hex")));let e=BigInt(0),f=BigInt(c-(b+31*d.length));return f!==BigInt(0)&&(e=BigInt("0x"+a.slice(b+31*d.length,c).toString("hex"))),[BigInt(d.length),...d,e,f]},c.poseidonHashRange=function(a,b=0,c=a.length){return e.hash.computePoseidonHashOnElements(n(a,b,c))},c.parseInitFunctionCalldata=function(a,b){let c=g.StarknetSwapData.fromSerializedFeltArray(a,b),d=Number(m(a.shift())),e=a.splice(0,d),f=m(a.shift()),h=Number(m(a.shift())),i=a.splice(0,h);if(0!==a.length)throw Error("Calldata not read fully!");return{escrow:c,signature:e,timeout:f,extraData:i}},c.findLastIndex=function(a,b){for(let c=a.length-1;c>=0;c--)if(b(a[c],c))return c;return -1}},816953,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetModule=void 0;let d=a.r(461392);c.StarknetModule=class{constructor(a){this.logger=(0,d.getLogger)(this.constructor.name+": "),this.provider=a.provider,this.retryPolicy=a.retryPolicy,this.root=a}}},375267,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ERC20Abi=void 0,c.ERC20Abi=[{type:"impl",name:"MintableToken",interface_name:"src::mintable_token_interface::IMintableToken"},{type:"struct",name:"core::integer::u256",members:[{name:"low",type:"core::integer::u128"},{name:"high",type:"core::integer::u128"}]},{type:"interface",name:"src::mintable_token_interface::IMintableToken",items:[{type:"function",name:"permissioned_mint",inputs:[{name:"account",type:"core::starknet::contract_address::ContractAddress"},{name:"amount",type:"core::integer::u256"}],outputs:[],state_mutability:"external"},{type:"function",name:"permissioned_burn",inputs:[{name:"account",type:"core::starknet::contract_address::ContractAddress"},{name:"amount",type:"core::integer::u256"}],outputs:[],state_mutability:"external"}]},{type:"impl",name:"MintableTokenCamelImpl",interface_name:"src::mintable_token_interface::IMintableTokenCamel"},{type:"interface",name:"src::mintable_token_interface::IMintableTokenCamel",items:[{type:"function",name:"permissionedMint",inputs:[{name:"account",type:"core::starknet::contract_address::ContractAddress"},{name:"amount",type:"core::integer::u256"}],outputs:[],state_mutability:"external"},{type:"function",name:"permissionedBurn",inputs:[{name:"account",type:"core::starknet::contract_address::ContractAddress"},{name:"amount",type:"core::integer::u256"}],outputs:[],state_mutability:"external"}]},{type:"impl",name:"Replaceable",interface_name:"src::replaceability_interface::IReplaceable"},{type:"struct",name:"core::array::Span::<core::felt252>",members:[{name:"snapshot",type:"@core::array::Array::<core::felt252>"}]},{type:"struct",name:"src::replaceability_interface::EICData",members:[{name:"eic_hash",type:"core::starknet::class_hash::ClassHash"},{name:"eic_init_data",type:"core::array::Span::<core::felt252>"}]},{type:"enum",name:"core::option::Option::<src::replaceability_interface::EICData>",variants:[{name:"Some",type:"src::replaceability_interface::EICData"},{name:"None",type:"()"}]},{type:"enum",name:"core::bool",variants:[{name:"False",type:"()"},{name:"True",type:"()"}]},{type:"struct",name:"src::replaceability_interface::ImplementationData",members:[{name:"impl_hash",type:"core::starknet::class_hash::ClassHash"},{name:"eic_data",type:"core::option::Option::<src::replaceability_interface::EICData>"},{name:"final",type:"core::bool"}]},{type:"interface",name:"src::replaceability_interface::IReplaceable",items:[{type:"function",name:"get_upgrade_delay",inputs:[],outputs:[{type:"core::integer::u64"}],state_mutability:"view"},{type:"function",name:"get_impl_activation_time",inputs:[{name:"implementation_data",type:"src::replaceability_interface::ImplementationData"}],outputs:[{type:"core::integer::u64"}],state_mutability:"view"},{type:"function",name:"add_new_implementation",inputs:[{name:"implementation_data",type:"src::replaceability_interface::ImplementationData"}],outputs:[],state_mutability:"external"},{type:"function",name:"remove_implementation",inputs:[{name:"implementation_data",type:"src::replaceability_interface::ImplementationData"}],outputs:[],state_mutability:"external"},{type:"function",name:"replace_to",inputs:[{name:"implementation_data",type:"src::replaceability_interface::ImplementationData"}],outputs:[],state_mutability:"external"}]},{type:"impl",name:"AccessControlImplExternal",interface_name:"src::access_control_interface::IAccessControl"},{type:"interface",name:"src::access_control_interface::IAccessControl",items:[{type:"function",name:"has_role",inputs:[{name:"role",type:"core::felt252"},{name:"account",type:"core::starknet::contract_address::ContractAddress"}],outputs:[{type:"core::bool"}],state_mutability:"view"},{type:"function",name:"get_role_admin",inputs:[{name:"role",type:"core::felt252"}],outputs:[{type:"core::felt252"}],state_mutability:"view"}]},{type:"impl",name:"RolesImpl",interface_name:"src::roles_interface::IMinimalRoles"},{type:"interface",name:"src::roles_interface::IMinimalRoles",items:[{type:"function",name:"is_governance_admin",inputs:[{name:"account",type:"core::starknet::contract_address::ContractAddress"}],outputs:[{type:"core::bool"}],state_mutability:"view"},{type:"function",name:"is_upgrade_governor",inputs:[{name:"account",type:"core::starknet::contract_address::ContractAddress"}],outputs:[{type:"core::bool"}],state_mutability:"view"},{type:"function",name:"register_governance_admin",inputs:[{name:"account",type:"core::starknet::contract_address::ContractAddress"}],outputs:[],state_mutability:"external"},{type:"function",name:"remove_governance_admin",inputs:[{name:"account",type:"core::starknet::contract_address::ContractAddress"}],outputs:[],state_mutability:"external"},{type:"function",name:"register_upgrade_governor",inputs:[{name:"account",type:"core::starknet::contract_address::ContractAddress"}],outputs:[],state_mutability:"external"},{type:"function",name:"remove_upgrade_governor",inputs:[{name:"account",type:"core::starknet::contract_address::ContractAddress"}],outputs:[],state_mutability:"external"},{type:"function",name:"renounce",inputs:[{name:"role",type:"core::felt252"}],outputs:[],state_mutability:"external"}]},{type:"impl",name:"ERC20Impl",interface_name:"openzeppelin::token::erc20::interface::IERC20"},{type:"interface",name:"openzeppelin::token::erc20::interface::IERC20",items:[{type:"function",name:"name",inputs:[],outputs:[{type:"core::felt252"}],state_mutability:"view"},{type:"function",name:"symbol",inputs:[],outputs:[{type:"core::felt252"}],state_mutability:"view"},{type:"function",name:"decimals",inputs:[],outputs:[{type:"core::integer::u8"}],state_mutability:"view"},{type:"function",name:"total_supply",inputs:[],outputs:[{type:"core::integer::u256"}],state_mutability:"view"},{type:"function",name:"balance_of",inputs:[{name:"account",type:"core::starknet::contract_address::ContractAddress"}],outputs:[{type:"core::integer::u256"}],state_mutability:"view"},{type:"function",name:"allowance",inputs:[{name:"owner",type:"core::starknet::contract_address::ContractAddress"},{name:"spender",type:"core::starknet::contract_address::ContractAddress"}],outputs:[{type:"core::integer::u256"}],state_mutability:"view"},{type:"function",name:"transfer",inputs:[{name:"recipient",type:"core::starknet::contract_address::ContractAddress"},{name:"amount",type:"core::integer::u256"}],outputs:[{type:"core::bool"}],state_mutability:"external"},{type:"function",name:"transfer_from",inputs:[{name:"sender",type:"core::starknet::contract_address::ContractAddress"},{name:"recipient",type:"core::starknet::contract_address::ContractAddress"},{name:"amount",type:"core::integer::u256"}],outputs:[{type:"core::bool"}],state_mutability:"external"},{type:"function",name:"approve",inputs:[{name:"spender",type:"core::starknet::contract_address::ContractAddress"},{name:"amount",type:"core::integer::u256"}],outputs:[{type:"core::bool"}],state_mutability:"external"}]},{type:"impl",name:"ERC20CamelOnlyImpl",interface_name:"openzeppelin::token::erc20::interface::IERC20CamelOnly"},{type:"interface",name:"openzeppelin::token::erc20::interface::IERC20CamelOnly",items:[{type:"function",name:"totalSupply",inputs:[],outputs:[{type:"core::integer::u256"}],state_mutability:"view"},{type:"function",name:"balanceOf",inputs:[{name:"account",type:"core::starknet::contract_address::ContractAddress"}],outputs:[{type:"core::integer::u256"}],state_mutability:"view"},{type:"function",name:"transferFrom",inputs:[{name:"sender",type:"core::starknet::contract_address::ContractAddress"},{name:"recipient",type:"core::starknet::contract_address::ContractAddress"},{name:"amount",type:"core::integer::u256"}],outputs:[{type:"core::bool"}],state_mutability:"external"}]},{type:"constructor",name:"constructor",inputs:[{name:"name",type:"core::felt252"},{name:"symbol",type:"core::felt252"},{name:"decimals",type:"core::integer::u8"},{name:"initial_supply",type:"core::integer::u256"},{name:"recipient",type:"core::starknet::contract_address::ContractAddress"},{name:"permitted_minter",type:"core::starknet::contract_address::ContractAddress"},{name:"provisional_governance_admin",type:"core::starknet::contract_address::ContractAddress"},{name:"upgrade_delay",type:"core::integer::u64"}]},{type:"function",name:"increase_allowance",inputs:[{name:"spender",type:"core::starknet::contract_address::ContractAddress"},{name:"added_value",type:"core::integer::u256"}],outputs:[{type:"core::bool"}],state_mutability:"external"},{type:"function",name:"decrease_allowance",inputs:[{name:"spender",type:"core::starknet::contract_address::ContractAddress"},{name:"subtracted_value",type:"core::integer::u256"}],outputs:[{type:"core::bool"}],state_mutability:"external"},{type:"function",name:"increaseAllowance",inputs:[{name:"spender",type:"core::starknet::contract_address::ContractAddress"},{name:"addedValue",type:"core::integer::u256"}],outputs:[{type:"core::bool"}],state_mutability:"external"},{type:"function",name:"decreaseAllowance",inputs:[{name:"spender",type:"core::starknet::contract_address::ContractAddress"},{name:"subtractedValue",type:"core::integer::u256"}],outputs:[{type:"core::bool"}],state_mutability:"external"},{type:"event",name:"openzeppelin::token::erc20_v070::erc20::ERC20::Transfer",kind:"struct",members:[{name:"from",type:"core::starknet::contract_address::ContractAddress",kind:"data"},{name:"to",type:"core::starknet::contract_address::ContractAddress",kind:"data"},{name:"value",type:"core::integer::u256",kind:"data"}]},{type:"event",name:"openzeppelin::token::erc20_v070::erc20::ERC20::Approval",kind:"struct",members:[{name:"owner",type:"core::starknet::contract_address::ContractAddress",kind:"data"},{name:"spender",type:"core::starknet::contract_address::ContractAddress",kind:"data"},{name:"value",type:"core::integer::u256",kind:"data"}]},{type:"event",name:"src::replaceability_interface::ImplementationAdded",kind:"struct",members:[{name:"implementation_data",type:"src::replaceability_interface::ImplementationData",kind:"data"}]},{type:"event",name:"src::replaceability_interface::ImplementationRemoved",kind:"struct",members:[{name:"implementation_data",type:"src::replaceability_interface::ImplementationData",kind:"data"}]},{type:"event",name:"src::replaceability_interface::ImplementationReplaced",kind:"struct",members:[{name:"implementation_data",type:"src::replaceability_interface::ImplementationData",kind:"data"}]},{type:"event",name:"src::replaceability_interface::ImplementationFinalized",kind:"struct",members:[{name:"impl_hash",type:"core::starknet::class_hash::ClassHash",kind:"data"}]},{type:"event",name:"src::access_control_interface::RoleGranted",kind:"struct",members:[{name:"role",type:"core::felt252",kind:"data"},{name:"account",type:"core::starknet::contract_address::ContractAddress",kind:"data"},{name:"sender",type:"core::starknet::contract_address::ContractAddress",kind:"data"}]},{type:"event",name:"src::access_control_interface::RoleRevoked",kind:"struct",members:[{name:"role",type:"core::felt252",kind:"data"},{name:"account",type:"core::starknet::contract_address::ContractAddress",kind:"data"},{name:"sender",type:"core::starknet::contract_address::ContractAddress",kind:"data"}]},{type:"event",name:"src::access_control_interface::RoleAdminChanged",kind:"struct",members:[{name:"role",type:"core::felt252",kind:"data"},{name:"previous_admin_role",type:"core::felt252",kind:"data"},{name:"new_admin_role",type:"core::felt252",kind:"data"}]},{type:"event",name:"src::roles_interface::GovernanceAdminAdded",kind:"struct",members:[{name:"added_account",type:"core::starknet::contract_address::ContractAddress",kind:"data"},{name:"added_by",type:"core::starknet::contract_address::ContractAddress",kind:"data"}]},{type:"event",name:"src::roles_interface::GovernanceAdminRemoved",kind:"struct",members:[{name:"removed_account",type:"core::starknet::contract_address::ContractAddress",kind:"data"},{name:"removed_by",type:"core::starknet::contract_address::ContractAddress",kind:"data"}]},{type:"event",name:"src::roles_interface::UpgradeGovernorAdded",kind:"struct",members:[{name:"added_account",type:"core::starknet::contract_address::ContractAddress",kind:"data"},{name:"added_by",type:"core::starknet::contract_address::ContractAddress",kind:"data"}]},{type:"event",name:"src::roles_interface::UpgradeGovernorRemoved",kind:"struct",members:[{name:"removed_account",type:"core::starknet::contract_address::ContractAddress",kind:"data"},{name:"removed_by",type:"core::starknet::contract_address::ContractAddress",kind:"data"}]},{type:"event",name:"openzeppelin::token::erc20_v070::erc20::ERC20::Event",kind:"enum",variants:[{name:"Transfer",type:"openzeppelin::token::erc20_v070::erc20::ERC20::Transfer",kind:"nested"},{name:"Approval",type:"openzeppelin::token::erc20_v070::erc20::ERC20::Approval",kind:"nested"},{name:"ImplementationAdded",type:"src::replaceability_interface::ImplementationAdded",kind:"nested"},{name:"ImplementationRemoved",type:"src::replaceability_interface::ImplementationRemoved",kind:"nested"},{name:"ImplementationReplaced",type:"src::replaceability_interface::ImplementationReplaced",kind:"nested"},{name:"ImplementationFinalized",type:"src::replaceability_interface::ImplementationFinalized",kind:"nested"},{name:"RoleGranted",type:"src::access_control_interface::RoleGranted",kind:"nested"},{name:"RoleRevoked",type:"src::access_control_interface::RoleRevoked",kind:"nested"},{name:"RoleAdminChanged",type:"src::access_control_interface::RoleAdminChanged",kind:"nested"},{name:"GovernanceAdminAdded",type:"src::roles_interface::GovernanceAdminAdded",kind:"nested"},{name:"GovernanceAdminRemoved",type:"src::roles_interface::GovernanceAdminRemoved",kind:"nested"},{name:"UpgradeGovernorAdded",type:"src::roles_interface::UpgradeGovernorAdded",kind:"nested"},{name:"UpgradeGovernorRemoved",type:"src::roles_interface::UpgradeGovernorRemoved",kind:"nested"}]}]},571690,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetAddresses=void 0;let d=a.r(816953),e=a.r(877475);class f extends d.StarknetModule{static isValidAddress(a){if(66!==a.length)return!1;try{return(0,e.validateAndParseAddress)(a),!0}catch(a){return!1}}}c.StarknetAddresses=f},94067,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetTokens=void 0;let d=a.r(816953),e=a.r(286962),f=a.r(375267),g=a.r(877475),h=a.r(461392),i=a.r(571690);class j extends d.StarknetModule{getContract(a){return new g.Contract(f.ERC20Abi,a,this.root.provider).typedv2(f.ERC20Abi)}Transfer(a,b,c,d){let f=this.getContract(c);return new e.StarknetAction(a,this.root,f.populateTransaction.transfer(b,d),j.GasCosts.TRANSFER)}Approve(a,b,c,d){let f=this.getContract(c);return new e.StarknetAction(a,this.root,f.populateTransaction.approve(b,d),j.GasCosts.APPROVE)}isValidToken(a){return i.StarknetAddresses.isValidAddress(a)}async getTokenBalance(a,b){let c=this.getContract(b),d=await c.balance_of(a),e=(0,h.toBigInt)(d);return this.logger.debug("getTokenBalance(): token balance fetched, token: "+b+" address: "+a+" amount: "+e.toString()),e}getNativeCurrencyAddress(){return this.root.Fees.getDefaultGasToken()}async txsTransfer(a,b,c,d,e){let f=this.Transfer(a,d,b,c);return e=e??await this.root.Fees.getFeeRate(),this.logger.debug("txsTransfer(): transfer TX created, recipient: "+d.toString()+" token: "+b.toString()+" amount: "+c.toString(10)),[await f.tx(e)]}}c.StarknetTokens=j,j.ERC20_ETH="0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7",j.ERC20_STRK="0x04718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d",j.GasCosts={TRANSFER:{l1DataGas:400,l2Gas:4e6,l1Gas:0},APPROVE:{l1DataGas:400,l2Gas:4e6,l1Gas:0}}},187245,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetFees=c.starknetGasAdd=c.starknetGasMul=void 0;let d=a.r(461392),e=a.r(94067);c.starknetGasMul=function(a,b){return{l1Gas:a.l1Gas*b,l2Gas:a.l2Gas*b,l1DataGas:a.l1DataGas*b}},c.starknetGasAdd=function(a,b){return{l1Gas:a.l1Gas+b.l1Gas,l2Gas:a.l2Gas+b.l2Gas,l1DataGas:a.l1DataGas+b.l1DataGas}},c.StarknetFees=class{constructor(a,b={l1GasCost:0x470de4df820000n,l2GasCost:4000000000000000n,l1DataGasCost:0x2386f26fc10000n},c=1.25,e){this.logger=(0,d.getLogger)("StarknetFees: "),this.blockFeeCache=null,this.provider=a,this.maxFeeRate=b,this.feeDA=e?.fee??"L1",this.nonceDA=e?.nonce??"L1",this.feeMultiplierPPM=BigInt(Math.floor(1e6*c))}async _getFeeRate(){let a=await this.provider.getBlock("latest"),b=(0,d.toBigInt)(a.l1_gas_price.price_in_fri)*this.feeMultiplierPPM/1000000n,c=(0,d.toBigInt)(a.l1_data_gas_price.price_in_fri)*this.feeMultiplierPPM/1000000n,e=(0,d.toBigInt)(a.l2_gas_price.price_in_fri)*this.feeMultiplierPPM/1000000n;return this.logger.debug("_getFeeRate(): L1 fee rate: ",[b.toString(10),c.toString(10),e.toString(10)]),{l1GasCost:b,l2GasCost:e,l1DataGasCost:c}}async getFeeRate(){if(null==this.blockFeeCache||Date.now()-this.blockFeeCache.timestamp>5e3){let a={timestamp:Date.now(),feeRate:null};a.feeRate=this._getFeeRate().catch(b=>{throw this.blockFeeCache===a&&(this.blockFeeCache=null),b}),this.blockFeeCache=a}let{l1GasCost:a,l2GasCost:b,l1DataGasCost:c}=await this.blockFeeCache.feeRate;a>this.maxFeeRate.l1GasCost&&(a=this.maxFeeRate.l1GasCost),b>this.maxFeeRate.l2GasCost&&(b=this.maxFeeRate.l2GasCost),c>this.maxFeeRate.l1DataGasCost&&(c=this.maxFeeRate.l1DataGasCost);let d=a.toString(10)+","+b.toString(10)+","+c.toString(10)+";v3";return this.logger.debug("getFeeRate(): calculated fee: "+d),d}getDefaultGasToken(){return e.StarknetTokens.ERC20_STRK}static getGasFee(a,b){if(null==b)return 0n;let[c,d,e]=b.split(";")[0].split(",");return BigInt(a.l1Gas)*BigInt(c)+BigInt(a.l2Gas)*BigInt(d)+BigInt(a.l1DataGas)*BigInt(e)}static getGasToken(a){return null==a?null:"v1"===a.split(";")[1]?e.StarknetTokens.ERC20_ETH:e.StarknetTokens.ERC20_STRK}getFeeDetails(a,b){if(null==b)return null;let[c,e,f]=b.split(";")[0].split(",");return{version:"0x3",resourceBounds:{l1_gas:{max_amount:(0,d.toHex)(a.l1Gas,16),max_price_per_unit:(0,d.toHex)(BigInt(c),16)},l2_gas:{max_amount:(0,d.toHex)(a.l2Gas,16),max_price_per_unit:(0,d.toHex)(BigInt(e),16)},l1_data_gas:{max_amount:(0,d.toHex)(a.l1DataGas,16),max_price_per_unit:(0,d.toHex)(BigInt(f),16)}},tip:"0x0",paymasterData:[],nonceDataAvailabilityMode:this.nonceDA,feeDataAvailabilityMode:this.feeDA}}}},286962,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetAction=void 0;let d=a.r(187245);c.StarknetAction=class{constructor(a,b,c=[],d,e){this.mainSigner=a,this.root=b,this.instructions=Array.isArray(c)?c:[c],this.gas={l1Gas:d?.l1Gas??0,l2Gas:d?.l2Gas??0,l1DataGas:d?.l1DataGas??0},this.feeRate=e}estimateFeeRate(){return this.root.Fees.getFeeRate()}addIx(a,b){this.instructions.push(a),this.gas=(0,d.starknetGasAdd)(this.gas,b)}add(a){return this.addAction(a)}addAction(a,b=this.instructions.length){if(a.mainSigner!==this.mainSigner)throw Error("Actions need to have the same signer!");return null==this.gas.l1Gas&&null!=a.gas.l1Gas&&(this.gas.l1Gas=a.gas.l1Gas),null==this.gas.l2Gas&&null!=a.gas.l2Gas&&(this.gas.l2Gas=a.gas.l2Gas),null==this.gas.l1DataGas&&null!=a.gas.l1DataGas&&(this.gas.l1DataGas=a.gas.l1DataGas),null!=this.gas.l1Gas&&null!=a.gas.l1Gas&&(this.gas.l1Gas+=a.gas.l1Gas),null!=this.gas.l2Gas&&null!=a.gas.l2Gas&&(this.gas.l2Gas+=a.gas.l2Gas),null!=this.gas.l1DataGas&&null!=a.gas.l1DataGas&&(this.gas.l1DataGas+=a.gas.l1DataGas),this.instructions.splice(b,0,...a.instructions),null==this.feeRate&&(this.feeRate=a.feeRate),this}async tx(a){return null==a&&(a=this.feeRate),null==a&&(a=await this.estimateFeeRate()),{type:"INVOKE",tx:this.instructions,details:{...this.root.Fees.getFeeDetails(this.gas,a),walletAddress:this.mainSigner,cairoVersion:"1",chainId:this.root.starknetChainId,nonce:null,accountDeploymentData:[],skipValidate:!1}}}async addToTxs(a,b){a.push(await this.tx(b))}ixsLength(){return this.instructions.length}}},998647,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetTransactions=void 0;let d=a.r(816953),e=a.r(461392);class f extends d.StarknetModule{constructor(){super(...arguments),this.latestConfirmedNonces={}}async confirmTransaction(a,b){let c="pending";for(;"pending"===c||"not_found"===c;)await (0,e.timeoutPromise)(3e3,b),"not_found"===(c=await this._getTxIdStatus(a.txId))&&null!=a.signed&&await this.sendSignedTransaction(a).catch(a=>{a.baseError?.code!==59&&this.logger.error("confirmTransaction(): Error on transaction re-send: ",a)});if("rejected"===c)throw Error("Transaction rejected!");let d=(0,e.toBigInt)(a.details.nonce)+1n,f=this.latestConfirmedNonces[a.details.walletAddress];if((null==f||d>f)&&(this.latestConfirmedNonces[a.details.walletAddress]=d),"reverted"===c)throw Error("Transaction reverted!")}async prepareTransactions(a,b){let c=await a.getNonce(),d=this.latestConfirmedNonces[a.getAddress()];null!=d&&d>c&&(this.logger.debug("prepareTransactions(): Using nonce from local cache!"),c=d),c===BigInt(0)&&a.isWalletAccount()&&(c=BigInt(1));let e=await a.checkAndGetDeployPayload(c);null!=e&&b.unshift(await this.root.Accounts.getAccountDeployTransaction(e));for(let d=0;d<b.length;d++){let e=b[d];null!=e.details.nonce&&(c=BigInt(e.details.nonce)),null==c&&(c=BigInt(await this.root.provider.getNonceForAddress(a.getAddress()))),null==e.details.nonce&&(e.details.nonce=c),this.logger.debug("sendAndConfirm(): transaction prepared ("+(d+1)+"/"+b.length+"), nonce: "+e.details.nonce),c+=BigInt(1),null!=this.cbkBeforeTxSigned&&await this.cbkBeforeTxSigned(e)}}async sendSignedTransaction(a,b,c){let d;if(null!=b&&await b(a.txId,await this.serializeTx(a)),this.logger.debug("sendSignedTransaction(): sending transaction: ",a.txId),null==a.signed){let b;switch(a.type){case"INVOKE":b=(await c.account.execute(a.tx,a.details)).transaction_hash;break;case"DEPLOY_ACCOUNT":b=(await c.account.deployAccount(a.tx,a.details)).transaction_hash;break;default:throw Error("Unsupported tx type!")}return a.txId=b,b}switch(a.type){case"INVOKE":d=await this.provider.channel.invoke(a.signed,a.details).then(a=>a.transaction_hash);break;case"DEPLOY_ACCOUNT":d=await this.provider.channel.deployAccount(a.signed,a.details).then(a=>a.transaction_hash);break;default:throw Error("Unsupported tx type!")}return a.txId!==d&&this.logger.warn("sendSignedTransaction(): sent tx hash not matching the precomputed hash!"),this.logger.info("sendSignedTransaction(): tx sent, expected txHash: "+a.txId+", txHash: "+d),d}async sendAndConfirm(a,b,c,d,f,g){if(await this.prepareTransactions(a,b),!a.isWalletAccount())for(let c=0;c<b.length;c++){let d=b[c];switch(d.type){case"INVOKE":d.signed=await a.account.buildInvocation(d.tx,d.details),(0,e.calculateHash)(d);break;case"DEPLOY_ACCOUNT":d.signed=await a.account.buildAccountDeployPayload(d.tx,d.details),(0,e.calculateHash)(d);break;default:throw Error("Unsupported tx type!")}this.logger.debug("sendAndConfirm(): transaction signed ("+(c+1)+"/"+b.length+"): "+d.txId)}this.logger.debug("sendAndConfirm(): sending transactions, count: "+b.length+" waitForConfirmation: "+c+" parallel: "+f);let h=[];if(f){let e=[];for(let f=0;f<b.length;f++){let i=b[f],j=await this.sendSignedTransaction(i,g,a);c&&e.push(this.confirmTransaction(i,d)),h.push(j),this.logger.debug("sendAndConfirm(): transaction sent ("+(f+1)+"/"+b.length+"): "+i.txId)}e.length>0&&await Promise.all(e)}else for(let e=0;e<b.length;e++){let f=b[e],i=await this.sendSignedTransaction(f,g,a),j=this.confirmTransaction(f,d);this.logger.debug("sendAndConfirm(): transaction sent ("+(e+1)+"/"+b.length+"): "+f.txId),(e<b.length-1||c)&&await j,h.push(i)}return this.logger.info("sendAndConfirm(): sent transactions, count: "+b.length+" waitForConfirmation: "+c+" parallel: "+f),h}serializeTx(a){return Promise.resolve(JSON.stringify(a,(a,b)=>"bigint"==typeof b?(0,e.toHex)(b):b))}deserializeTx(a){return Promise.resolve(JSON.parse(a))}async getTxStatus(a){let b=await this.deserializeTx(a);return await this.getTxIdStatus(b.txId)}async _getTxIdStatus(a){let b=await this.provider.getTransactionStatus(a).catch(a=>{if(null!=a.message&&a.message.includes("29: Transaction hash not found"))return null;throw a});return null==b?"not_found":"RECEIVED"===b.finality_status?"pending":"REJECTED"===b.finality_status?"rejected":"SUCCEEDED"===b.execution_status?"success":"reverted"}async getTxIdStatus(a){let b=await this._getTxIdStatus(a);return"rejected"===b?"reverted":b}onBeforeTxSigned(a){this.cbkBeforeTxSigned=a}offBeforeTxSigned(a){return this.cbkBeforeTxSigned=null,!0}}c.StarknetTransactions=f},217402,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetEvents=void 0;let d=a.r(816953);class e extends d.StarknetModule{constructor(){super(...arguments),this.EVENTS_LIMIT=100,this.FORWARD_BLOCK_RANGE=2e3}async getBlockEvents(a,b,c,d=c,e){let f=[],g=null;for(;null==g||g?.continuation_token!=null;)g=await this.root.provider.getEvents({address:a,from_block:null==c?"pending":{block_number:c},to_block:null==d?"pending":{block_number:d},keys:b,chunk_size:this.EVENTS_LIMIT,continuation_token:g?.continuation_token}),null!=e&&e.throwIfAborted(),f.push(...g.events);return f}async findInEvents(a,b,c,d){let e=await this.provider.getBlockNumber();for(let f=e;f>=0;f-=this.FORWARD_BLOCK_RANGE){let g=await this.getBlockEvents(a,b,Math.max(f-this.FORWARD_BLOCK_RANGE,0),f===e?null:f,d),h=await c(g.reverse());if(null!=h)return h}return null}async findInEventsForward(a,b,c,d,e){(null==e||e>this.EVENTS_LIMIT)&&(e=this.EVENTS_LIMIT);let f=null;for(;null==f||f?.continuation_token!=null;){f=await this.root.provider.getEvents({address:a,to_block:"latest",keys:b,chunk_size:e??this.EVENTS_LIMIT,continuation_token:f?.continuation_token}),null!=d&&d.throwIfAborted();let g=await c(f.events);if(null!=g)return g}return null}}c.StarknetEvents=e},781274,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetSignatures=void 0;let d=a.r(500874),e=a.r(816953),f=a.r(877475),g=a.r(461392),h=a.r(404322),i=[{name:"name",type:"shortstring"},{name:"version",type:"shortstring"},{name:"chainId",type:"shortstring"},{name:"revision",type:"shortstring"}],j=[{name:"Data hash",type:"u256"}];class k extends e.StarknetModule{constructor(a,b="atomiq.exchange"){super(a),this.domain={name:b,version:"1",chainId:f.shortString.decodeShortString(a.starknetChainId),revision:"1"}}getTypedMessage(a,b,c){return{types:{StarknetDomain:i,[b]:a},primaryType:b,domain:this.domain,message:c}}async signTypedMessage(a,b,c,d){let e=await a.account.signMessage(this.getTypedMessage(b,c,d));return JSON.stringify(f.stark.formatSignature(e))}async isValidSignature(a,b,c,d,e){return this.provider.verifyMessageInStarknet(this.getTypedMessage(c,d,e),JSON.parse(a),b)}getDataSignature(a,b){let c=d.Buffer.from((0,h.sha256)(b));return this.signTypedMessage(a,j,"DataHash",{"Data hash":f.cairo.uint256((0,g.toHex)(c))})}isValidDataSignature(a,b,c){let e=d.Buffer.from((0,h.sha256)(a));return this.isValidSignature(b,c,j,"DataHash",{"Data hash":f.cairo.uint256((0,g.toHex)(e))})}}c.StarknetSignatures=k},868160,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetAccounts=void 0;let d=a.r(816953);class e extends d.StarknetModule{async getAccountDeployTransaction(a){let b={...this.root.Fees.getFeeDetails({l1DataGas:500,l2Gas:2e8,l1Gas:0},await this.root.Fees.getFeeRate()),walletAddress:a.contractAddress,cairoVersion:"1",chainId:this.root.starknetChainId,nonce:0,accountDeploymentData:[],skipValidate:!1};return{type:"DEPLOY_ACCOUNT",tx:a,details:b}}}c.StarknetAccounts=e},958777,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetBlocks=void 0;let d=a.r(816953);class e extends d.StarknetModule{constructor(){super(...arguments),this.BLOCK_CACHE_TIME=5e3,this.blockCache={}}fetchAndSaveBlockTime(a){let b=a.toString(10),c=this.provider.getBlockWithTxHashes(a).then(a=>a.timestamp),d=Date.now();return this.blockCache[b]={blockTime:c,timestamp:d},c.catch(a=>{throw null!=this.blockCache[b]&&this.blockCache[b].blockTime===c&&delete this.blockCache[b],a}),{blockTime:c,timestamp:d}}cleanupBlocks(){let a=Date.now();for(let b in this.blockCache)if(a-this.blockCache[b].timestamp>this.BLOCK_CACHE_TIME)delete this.blockCache[b];else break}getBlockTime(a){this.cleanupBlocks();let b=this.blockCache[a.toString(10)];return(null==b||Date.now()-b.timestamp>this.BLOCK_CACHE_TIME)&&(b=this.fetchAndSaveBlockTime(a)),b.blockTime}}c.StarknetBlocks=e},196032,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetSigner=void 0;let d=a.r(461392);c.StarknetSigner=class{constructor(a){this.isDeployed=null,this.account=a}getPublicKey(){return this.account.signer.getPubKey()}getAddress(){return(0,d.toHex)(this.account.address)}isWalletAccount(){return null!=this.account.walletProvider}async getNonce(){try{return BigInt(await this.account.getNonceForAddress(this.getAddress(),"pending"))}catch(a){if(null!=a.message&&a.message.includes("20: Contract not found"))return BigInt(0);throw a}}async checkAndGetDeployPayload(a){if(this.isDeployed)return null;let b=this.account;return null==b.getDeploymentData||(a??(a=BigInt(await this.getNonce())),this.isDeployed=a!=BigInt(0),this.isDeployed)?null:b.getDeploymentData()}}},496368,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetKeypairWallet=void 0;let d=a.r(877475),e=a.r(461392),f=a.r(500874),g="0x00261c293c8084cd79086214176b33e5911677cec55104fddc8d25b0b736dcad";class h extends d.Account{constructor(a,b){let c=d.ec.starkCurve.getStarkKey((0,e.toHex)(b));super(a,d.hash.calculateContractAddressFromHash(c,g,d.CallData.compile({publicKey:c}),0),b,"1"),this.publicKey=c}getDeploymentData(){return{classHash:g,constructorCalldata:d.CallData.compile({publicKey:this.publicKey}),addressSalt:this.publicKey,contractAddress:this.address}}static generateRandomPrivateKey(){return"0x"+f.Buffer.from(d.ec.starkCurve.utils.randomPrivateKey()).toString("hex")}}c.StarknetKeypairWallet=h},406299,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetChainInterface=void 0;let d=a.r(877475),e=a.r(461392),f=a.r(998647),g=a.r(187245),h=a.r(571690),i=a.r(94067),j=a.r(217402),k=a.r(781274),l=a.r(868160),m=a.r(958777),n=a.r(196032),o=a.r(500874),p=a.r(496368);c.StarknetChainInterface=class{constructor(a,b,c,d=new g.StarknetFees(b)){this.chainId="STARKNET",this.logger=(0,e.getLogger)("StarknetChainInterface: "),this.starknetChainId=a,this.provider=b,this.retryPolicy=c,this.Fees=d,this.Tokens=new i.StarknetTokens(this),this.Transactions=new f.StarknetTransactions(this),this.Signatures=new k.StarknetSignatures(this),this.Events=new j.StarknetEvents(this),this.Accounts=new l.StarknetAccounts(this),this.Blocks=new m.StarknetBlocks(this)}async getBalance(a,b){return await this.Tokens.getTokenBalance(a,b)}getNativeCurrencyAddress(){return this.Tokens.getNativeCurrencyAddress()}isValidToken(a){return this.Tokens.isValidToken(a)}isValidAddress(a){return h.StarknetAddresses.isValidAddress(a)}offBeforeTxReplace(a){return!0}onBeforeTxReplace(a){}onBeforeTxSigned(a){this.Transactions.onBeforeTxSigned(a)}offBeforeTxSigned(a){return this.Transactions.offBeforeTxSigned(a)}randomAddress(){return(0,e.toHex)(d.stark.randomAddress())}randomSigner(){let a="0x"+o.Buffer.from(d.ec.starkCurve.utils.randomPrivateKey()).toString("hex"),b=new p.StarknetKeypairWallet(this.provider,a);return new n.StarknetSigner(b)}sendAndConfirm(a,b,c,d,e,f){return this.Transactions.sendAndConfirm(a,b,c,d,e,f)}serializeTx(a){return this.Transactions.serializeTx(a)}deserializeTx(a){return this.Transactions.deserializeTx(a)}getTxIdStatus(a){return this.Transactions.getTxIdStatus(a)}getTxStatus(a){return this.Transactions.getTxStatus(a)}txsTransfer(a,b,c,d,e){return this.Tokens.txsTransfer(a,b,c,d,e)}async transfer(a,b,c,d,e){let f=await this.Tokens.txsTransfer(a.getAddress(),b,c,d,e?.feeRate),[g]=await this.Transactions.sendAndConfirm(a,f,e?.waitForConfirmation,e?.abortSignal,!1);return g}}},671949,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetBtcHeader=void 0;let d=a.r(500874),e=a.r(461392),f=a.r(404322);class g{constructor(a){this.reversed_version=Number(a.reversed_version),this.previous_blockhash=a.previous_blockhash.map(a=>Number(a)),this.merkle_root=a.merkle_root.map(a=>Number(a)),this.reversed_timestamp=Number(a.reversed_timestamp),this.nbits=Number(a.nbits),this.nonce=Number(a.nonce),this.hash=a.hash}getMerkleRoot(){return(0,e.u32ArrayToBuffer)(this.merkle_root)}getNbits(){return(0,e.u32ReverseEndianness)(this.nbits)}getNonce(){return(0,e.u32ReverseEndianness)(this.nonce)}getReversedPrevBlockhash(){return(0,e.u32ArrayToBuffer)(this.previous_blockhash)}getTimestamp(){return(0,e.u32ReverseEndianness)(this.reversed_timestamp)}getVersion(){return(0,e.u32ReverseEndianness)(this.reversed_version)}getHash(){if(null!=this.hash)return this.hash;let a=d.Buffer.alloc(80);return a.writeUInt32BE(this.reversed_version,0),(0,e.u32ArrayToBuffer)(this.previous_blockhash).copy(a,4),(0,e.u32ArrayToBuffer)(this.merkle_root).copy(a,36),a.writeUInt32BE(this.reversed_timestamp,68),a.writeUInt32BE(this.nbits,72),a.writeUInt32BE(this.nonce,76),d.Buffer.from((0,f.sha256)((0,f.sha256)(a)))}serialize(){return[this.reversed_version,...this.previous_blockhash,...this.merkle_root,this.reversed_timestamp,this.nbits,this.nonce]}static fromSerializedFeltArray(a){let b=(0,e.toHex)(a.shift()),c=a.splice(0,8).map(e.toHex),d=a.splice(0,8).map(e.toHex),f=(0,e.toHex)(a.shift());return new g({reversed_version:b,previous_blockhash:c,merkle_root:d,reversed_timestamp:f,nbits:(0,e.toHex)(a.shift()),nonce:(0,e.toHex)(a.shift())})}}c.StarknetBtcHeader=g},612579,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetBtcStoredHeader=void 0;let d=a.r(163846),e=a.r(671949),f=a.r(500874),g=a.r(877475),h=a.r(461392);class i{constructor(a){this.blockheader=a.blockheader instanceof e.StarknetBtcHeader?a.blockheader:new e.StarknetBtcHeader(a.blockheader),this.block_hash=a.block_hash.map(a=>Number(a)),this.chain_work=(0,h.isUint256)(a.chain_work)?a.chain_work:g.cairo.uint256(a.chain_work),this.block_height=Number(a.block_height),this.last_diff_adjustment=Number(a.last_diff_adjustment),this.prev_block_timestamps=a.prev_block_timestamps.map(a=>Number(a))}getBlockheight(){return this.block_height}getChainWork(){return(0,h.bigNumberishToBuffer)(this.chain_work,32)}getHeader(){return this.blockheader}getLastDiffAdjustment(){return this.last_diff_adjustment}getPrevBlockTimestamps(){return this.prev_block_timestamps}getBlockHash(){return(0,h.u32ArrayToBuffer)(this.block_hash).reverse()}computeNextBlockTimestamps(){let a=[...this.prev_block_timestamps];for(let b=1;b<10;b++)a[b-1]=a[b];return a[9]=this.blockheader.getTimestamp(),a}computeNextChainWork(a){let b=[...this.getChainWork()];return d.StatePredictorUtils.addInPlace(b,[...d.StatePredictorUtils.getChainwork(a)]),f.Buffer.from(b)}computeNextLastDiffAdjustment(a){let b=this.block_height+1,c=this.last_diff_adjustment;return b%d.StatePredictorUtils.DIFF_ADJUSTMENT_PERIOD==0&&(c=a),c}computeNext(a){return new i({chain_work:"0x"+this.computeNextChainWork(a.getNbits()).toString("hex"),prev_block_timestamps:this.computeNextBlockTimestamps(),block_height:this.block_height+1,last_diff_adjustment:this.computeNextLastDiffAdjustment(a.getTimestamp()),block_hash:(0,h.bufferToU32Array)(a.getHash()),blockheader:a})}serialize(){return[...this.blockheader.serialize(),...this.block_hash,this.chain_work.low,this.chain_work.high,this.block_height,this.last_diff_adjustment,...this.prev_block_timestamps]}static fromSerializedFeltArray(a){let b=e.StarknetBtcHeader.fromSerializedFeltArray(a),c=a.splice(0,8).map(h.toHex),d={low:a.shift(),high:a.shift()},f=(0,h.toHex)(a.shift());return new i({blockheader:b,block_hash:c,chain_work:d,block_height:f,last_diff_adjustment:(0,h.toHex)(a.shift()),prev_block_timestamps:a.splice(0,10).map(h.toHex)})}}c.StarknetBtcStoredHeader=i},235445,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetContractEvents=void 0;let d=a.r(217402),e=a.r(877475),f=a.r(461392);class g extends d.StarknetEvents{constructor(a,b,c){super(a),this.contract=b,this.abi=c}toStarknetAbiEvents(a){let b=e.events.getAbiEvents(this.abi),c=e.CallData.getAbiStruct(this.abi),d=e.CallData.getAbiEnum(this.abi),f=e.events.parseEvents(a,b,c,d);if(f.length!==a.length)throw Error("Invalid event detected, please check provided ABI");return f.map((b,c)=>{let d=a[c],e=Object.keys(b)[0];return{name:e,txHash:d.transaction_hash,params:b[e],blockNumber:d.block_number,blockHash:d.block_hash,data:d.data,keys:d.keys}})}toFilter(a,b){let c=[];return c.push(a.map(a=>{let b=a.split(":"),c=b[b.length-1];return(0,f.toHex)(e.hash.starknetKeccak(c))})),null!=b&&b.forEach(a=>c.push(null==a?[]:[a])),c}async getContractBlockEvents(a,b,c,d=c){let e=await super.getBlockEvents(this.contract.contract.address,this.toFilter(a,b),c,d);return this.toStarknetAbiEvents(e)}async findInContractEvents(a,b,c,d){return this.findInEvents(this.contract.contract.address,this.toFilter(a,b),async a=>{for(let b of this.toStarknetAbiEvents(a)){let a=await c(b);if(null!=a)return a}},d)}async findInContractEventsForward(a,b,c,d){return this.findInEventsForward(this.contract.contract.address,this.toFilter(a,b),async a=>{for(let b of this.toStarknetAbiEvents(a)){let a=await c(b);if(null!=a)return a}},d)}}c.StarknetContractEvents=g},562857,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetContractBase=void 0;let d=a.r(877475),e=a.r(235445);c.StarknetContractBase=class{constructor(a,b,c){this.Chain=a,this.contract=new d.Contract(c,b,a.provider).typedv2(c),this.Events=new e.StarknetContractEvents(a,this,c)}}},331381,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BtcRelayAbi=void 0,c.BtcRelayAbi=[{type:"impl",name:"BtcRelayImpl",interface_name:"btc_relay::IBtcRelay"},{type:"struct",name:"btc_relay::structs::blockheader::BlockHeader",members:[{name:"reversed_version",type:"core::integer::u32"},{name:"previous_blockhash",type:"[core::integer::u32; 8]"},{name:"merkle_root",type:"[core::integer::u32; 8]"},{name:"reversed_timestamp",type:"core::integer::u32"},{name:"nbits",type:"core::integer::u32"},{name:"nonce",type:"core::integer::u32"}]},{type:"struct",name:"core::array::Span::<btc_relay::structs::blockheader::BlockHeader>",members:[{name:"snapshot",type:"@core::array::Array::<btc_relay::structs::blockheader::BlockHeader>"}]},{type:"struct",name:"core::integer::u256",members:[{name:"low",type:"core::integer::u128"},{name:"high",type:"core::integer::u128"}]},{type:"struct",name:"btc_relay::structs::stored_blockheader::StoredBlockHeader",members:[{name:"blockheader",type:"btc_relay::structs::blockheader::BlockHeader"},{name:"block_hash",type:"[core::integer::u32; 8]"},{name:"chain_work",type:"core::integer::u256"},{name:"block_height",type:"core::integer::u32"},{name:"last_diff_adjustment",type:"core::integer::u32"},{name:"prev_block_timestamps",type:"[core::integer::u32; 10]"}]},{type:"interface",name:"btc_relay::IBtcRelay",items:[{type:"function",name:"submit_main_blockheaders",inputs:[{name:"block_headers",type:"core::array::Span::<btc_relay::structs::blockheader::BlockHeader>"},{name:"stored_header",type:"btc_relay::structs::stored_blockheader::StoredBlockHeader"}],outputs:[],state_mutability:"external"},{type:"function",name:"submit_short_fork_blockheaders",inputs:[{name:"block_headers",type:"core::array::Span::<btc_relay::structs::blockheader::BlockHeader>"},{name:"stored_header",type:"btc_relay::structs::stored_blockheader::StoredBlockHeader"}],outputs:[],state_mutability:"external"},{type:"function",name:"submit_fork_blockheaders",inputs:[{name:"fork_id",type:"core::felt252"},{name:"block_headers",type:"core::array::Span::<btc_relay::structs::blockheader::BlockHeader>"},{name:"stored_header",type:"btc_relay::structs::stored_blockheader::StoredBlockHeader"}],outputs:[],state_mutability:"external"}]},{type:"impl",name:"BtcRelayReadOnlyImpl",interface_name:"btc_relay::IBtcRelayReadOnly"},{type:"interface",name:"btc_relay::IBtcRelayReadOnly",items:[{type:"function",name:"get_chainwork",inputs:[],outputs:[{type:"core::integer::u256"}],state_mutability:"view"},{type:"function",name:"get_blockheight",inputs:[],outputs:[{type:"core::integer::u32"}],state_mutability:"view"},{type:"function",name:"verify_blockheader",inputs:[{name:"stored_header",type:"btc_relay::structs::stored_blockheader::StoredBlockHeader"}],outputs:[{type:"core::integer::u32"}],state_mutability:"view"},{type:"function",name:"get_commit_hash",inputs:[{name:"height",type:"core::integer::u32"}],outputs:[{type:"core::felt252"}],state_mutability:"view"},{type:"function",name:"get_tip_commit_hash",inputs:[],outputs:[{type:"core::felt252"}],state_mutability:"view"}]},{type:"constructor",name:"constructor",inputs:[{name:"stored_header",type:"btc_relay::structs::stored_blockheader::StoredBlockHeader"}]},{type:"event",name:"btc_relay::events::StoreHeader",kind:"struct",members:[{name:"commit_hash",type:"core::felt252",kind:"key"},{name:"block_hash_poseidon",type:"core::felt252",kind:"key"},{name:"header",type:"btc_relay::structs::stored_blockheader::StoredBlockHeader",kind:"data"}]},{type:"event",name:"btc_relay::events::StoreForkHeader",kind:"struct",members:[{name:"commit_hash",type:"core::felt252",kind:"key"},{name:"block_hash_poseidon",type:"core::felt252",kind:"key"},{name:"fork_id",type:"core::felt252",kind:"key"},{name:"header",type:"btc_relay::structs::stored_blockheader::StoredBlockHeader",kind:"data"}]},{type:"event",name:"btc_relay::events::ChainReorg",kind:"struct",members:[{name:"fork_submitter",type:"core::starknet::contract_address::ContractAddress",kind:"key"},{name:"fork_id",type:"core::felt252",kind:"key"},{name:"tip_block_hash_poseidon",type:"core::felt252",kind:"key"},{name:"tip_commit_hash",type:"core::felt252",kind:"key"},{name:"start_height",type:"core::felt252",kind:"data"}]},{type:"event",name:"btc_relay::BtcRelay::Event",kind:"enum",variants:[{name:"StoreHeader",type:"btc_relay::events::StoreHeader",kind:"nested"},{name:"StoreForkHeader",type:"btc_relay::events::StoreForkHeader",kind:"nested"},{name:"ChainReorg",type:"btc_relay::events::ChainReorg",kind:"nested"}]}]},385410,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetBtcRelay=void 0;let d=a.r(500874),e=a.r(671949),f=a.r(163846),g=a.r(461392),h=a.r(562857),i=a.r(612579),j=a.r(331381),k=a.r(877475),l=a.r(187245),m=a.r(286962);function n(a){return new e.StarknetBtcHeader({reversed_version:(0,g.u32ReverseEndianness)(a.getVersion()),previous_blockhash:(0,g.bufferToU32Array)(d.Buffer.from(a.getPrevBlockhash(),"hex").reverse()),merkle_root:(0,g.bufferToU32Array)(d.Buffer.from(a.getMerkleRoot(),"hex").reverse()),reversed_timestamp:(0,g.u32ReverseEndianness)(a.getTimestamp()),nbits:(0,g.u32ReverseEndianness)(a.getNbits()),nonce:(0,g.u32ReverseEndianness)(a.getNonce()),hash:d.Buffer.from(a.getHash(),"hex").reverse()})}let o={l1DataGas:600,l2Gas:24e6,l1Gas:0},p={l1DataGas:1e3,l2Gas:4e7,l1Gas:0},q={[f.BitcoinNetwork.TESTNET4]:"0x0099b63f39f0cabb767361de3d8d3e97212351a51540e2687c2571f4da490dbe",[f.BitcoinNetwork.TESTNET]:"0x068601c79da2231d21e015ccfd59c243861156fa523a12c9f987ec28eb8dbc8c",[f.BitcoinNetwork.MAINNET]:"0x057b14a4231b82f1e525ff35a722d893ca3dd2bde0baa6cee97937c5be861dbc"};function r(a,b,c){return c.push((0,g.toHex)(a.length)),a.forEach(a=>{c.push(...a.serialize())}),c.push(...b.serialize()),c}let s=(0,g.getLogger)("StarknetBtcRelay: ");class t extends h.StarknetContractBase{SaveMainHeaders(a,b,c){return new m.StarknetAction(a,this.Chain,{contractAddress:this.contract.address,entrypoint:"submit_main_blockheaders",calldata:r(b,c,[])},(0,l.starknetGasMul)(o,b.length))}SaveShortForkHeaders(a,b,c){return new m.StarknetAction(a,this.Chain,{contractAddress:this.contract.address,entrypoint:"submit_short_fork_blockheaders",calldata:r(b,c,[])},(0,l.starknetGasMul)(o,b.length))}SaveLongForkHeaders(a,b,c,d,e=100){return new m.StarknetAction(a,this.Chain,{contractAddress:this.contract.address,entrypoint:"submit_fork_blockheaders",calldata:r(c,d,[(0,g.toHex)(b)])},(0,l.starknetGasAdd)((0,l.starknetGasMul)(o,c.length),(0,l.starknetGasMul)(p,e)))}constructor(a,b,c,d=q[c]){super(a,d,j.BtcRelayAbi),this.maxHeadersPerTx=100,this.maxForkHeadersPerTx=100,this.maxShortForkHeadersPerTx=100,this.bitcoinRpc=b}computeCommitedHeaders(a,b){let c=[a];for(let a of b)c.push(c[c.length-1].computeNext(a));return c}async _saveHeaders(a,b,c,d,e,g){let h,i=b.map(n);switch(e){case -1:h=this.SaveShortForkHeaders(a,i,c);break;case 0:h=this.SaveMainHeaders(a,i,c);break;default:h=this.SaveLongForkHeaders(a,e,i,c)}let j=await h.tx(g),k=this.computeCommitedHeaders(c,i),l=k[k.length-1];return 0!==e&&f.StatePredictorUtils.gtBuffer(l.getBlockHash(),d)&&(e=0),{forkId:e,lastStoredHeader:l,tx:j,computedCommitedHeaders:k}}getBlock(a,b){let c=[null==a?null:(0,g.toHex)(a)];if(null!=b){let a=k.hash.computePoseidonHashOnElements((0,g.bufferToU32Array)(d.Buffer.from([...b]).reverse()));c.push(a)}return this.Events.findInContractEvents(["btc_relay::events::StoreHeader","btc_relay::events::StoreForkHeader"],c,a=>Promise.resolve([i.StarknetBtcStoredHeader.fromSerializedFeltArray(a.data),BigInt(a.params.commit_hash)]))}async getBlockHeight(){return Number(await this.contract.get_blockheight())}async getTipData(){let a=await this.contract.get_tip_commit_hash();if(null==a||BigInt(a)===BigInt(0))return null;let b=await this.getBlock(a);if(null==b)return null;let[c]=b;return{blockheight:c.getBlockheight(),commitHash:(0,g.bigNumberishToBuffer)(a,32).toString("hex"),blockhash:c.getBlockHash().toString("hex"),chainWork:c.getChainWork()}}async retrieveLogAndBlockheight(a,b){let c=await this.getBlockHeight();if(null!=b&&c<b)return null;let e=await this.getBlock(null,d.Buffer.from(a.blockhash,"hex"));if(null==e)return null;let[f,h]=e;return BigInt(await this.contract.get_commit_hash(f.block_height))!==BigInt(h)?null:(s.debug("retrieveLogAndBlockheight(): block found, commit hash: "+(0,g.toHex)(h)+" blockhash: "+a.blockhash+" current btc relay height: "+c),{header:f,height:c})}async retrieveLogByCommitHash(a,b){let c=await this.getBlock(a,d.Buffer.from(b.blockhash,"hex"));if(null==c)return null;let[e,f]=c;return BigInt(await this.contract.get_commit_hash(e.block_height))!==BigInt(f)?null:(s.debug("retrieveLogByCommitHash(): block found, commit hash: "+a+" blockhash: "+b.blockhash+" height: "+e.block_height),e)}async retrieveLatestKnownBlockLog(){let a=await this.Events.findInContractEvents(["btc_relay::events::StoreHeader","btc_relay::events::StoreForkHeader"],null,async a=>{let b=i.StarknetBtcStoredHeader.fromSerializedFeltArray(a.data),c=b.getBlockHash().toString("hex"),d=a.params.commit_hash,[e,f]=await Promise.all([this.bitcoinRpc.isInMainChain(c).catch(()=>!1),this.contract.get_commit_hash(b.block_height)]);return e&&BigInt(d)===BigInt(f)?{resultStoredHeader:b,resultBitcoinHeader:await this.bitcoinRpc.getBlockHeader(c),commitHash:d}:null});return null!=a&&s.debug("retrieveLatestKnownBlockLog(): block found, commit hash: "+(0,g.toHex)(a.commitHash)+" blockhash: "+a.resultBitcoinHeader.getHash()+" height: "+a.resultStoredHeader.getBlockheight()),a}saveMainHeaders(a,b,c,d){return s.debug("saveMainHeaders(): submitting main blockheaders, count: "+b.length),this._saveHeaders(a,b,c,null,0,d)}async saveNewForkHeaders(a,b,c,d,e){let f=Math.floor(0xffffffffffff*Math.random());return s.debug("saveNewForkHeaders(): submitting new fork & blockheaders, count: "+b.length+" forkId: 0x"+f.toString(16)),await this._saveHeaders(a,b,c,d,f,e)}saveForkHeaders(a,b,c,d,e,f){return s.debug("saveForkHeaders(): submitting blockheaders to existing fork, count: "+b.length+" forkId: 0x"+d.toString(16)),this._saveHeaders(a,b,c,e,d,f)}saveShortForkHeaders(a,b,c,d,e){return s.debug("saveShortForkHeaders(): submitting short fork blockheaders, count: "+b.length),this._saveHeaders(a,b,c,d,-1,e)}async estimateSynchronizeFee(a,b){let c=a-(await this.getTipData()).blockheight;if(c<=0)return 0n;let d=BigInt(c)*await this.getFeePerBlock(b);return s.debug("estimateSynchronizeFee(): required blockheight: "+a+" blockheight delta: "+c+" fee: "+d.toString(10)),d}async getFeePerBlock(a){return a??(a=await this.Chain.Fees.getFeeRate()),l.StarknetFees.getGasFee(o,a)}getMainFeeRate(a){return this.Chain.Fees.getFeeRate()}getForkFeeRate(a,b){return this.Chain.Fees.getFeeRate()}saveInitialHeader(a,b,c,d,e){throw Error("Not supported, starknet contract is initialized with constructor!")}static async getCommitedHeadersAndSynchronize(a,b,c,d,e,f){let h=[],i={};for(let a of c){let c=a.blockheight+a.requiredConfirmations-1,d=await (0,g.tryWithRetries)(()=>b.retrieveLogAndBlockheight({blockhash:a.blockhash},c));null!=d?i[d.header.getBlockHash().toString("hex")]=d.header:h.push(a)}if(0===h.length)return i;if(null==e)return null;let j=await e.syncToLatestTxs(a.toString(),f);for(let a in s.debug("getCommitedHeaderAndSynchronize(): BTC Relay not synchronized to required blockheight, synchronizing ourselves in "+j.txs.length+" txs"),s.debug("getCommitedHeaderAndSynchronize(): BTC Relay computed header map: ",j.computedHeaderMap),d.push(...j.txs),j.computedHeaderMap){let b=j.computedHeaderMap[a];i[b.getBlockHash().toString("hex")]=b}for(let a of h)if(null==i[a.blockhash])return null;return i}}c.StarknetBtcRelay=t},400129,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.EscrowManagerAbi=void 0,c.EscrowManagerAbi=[{type:"impl",name:"EscrowManagerImpl",interface_name:"escrow_manager::IEscrowManager"},{type:"struct",name:"core::integer::u256",members:[{name:"low",type:"core::integer::u128"},{name:"high",type:"core::integer::u128"}]},{type:"struct",name:"escrow_manager::structs::escrow::EscrowExecution",members:[{name:"hash",type:"core::felt252"},{name:"expiry",type:"core::integer::u64"},{name:"fee",type:"core::integer::u256"}]},{type:"enum",name:"core::option::Option::<escrow_manager::structs::escrow::EscrowExecution>",variants:[{name:"Some",type:"escrow_manager::structs::escrow::EscrowExecution"},{name:"None",type:"()"}]},{type:"struct",name:"escrow_manager::structs::escrow::EscrowData",members:[{name:"offerer",type:"core::starknet::contract_address::ContractAddress"},{name:"claimer",type:"core::starknet::contract_address::ContractAddress"},{name:"token",type:"core::starknet::contract_address::ContractAddress"},{name:"refund_handler",type:"core::starknet::contract_address::ContractAddress"},{name:"claim_handler",type:"core::starknet::contract_address::ContractAddress"},{name:"flags",type:"core::integer::u128"},{name:"claim_data",type:"core::felt252"},{name:"refund_data",type:"core::felt252"},{name:"amount",type:"core::integer::u256"},{name:"fee_token",type:"core::starknet::contract_address::ContractAddress"},{name:"security_deposit",type:"core::integer::u256"},{name:"claimer_bounty",type:"core::integer::u256"},{name:"success_action",type:"core::option::Option::<escrow_manager::structs::escrow::EscrowExecution>"}]},{type:"struct",name:"core::array::Span::<core::felt252>",members:[{name:"snapshot",type:"@core::array::Array::<core::felt252>"}]},{type:"interface",name:"escrow_manager::IEscrowManager",items:[{type:"function",name:"initialize",inputs:[{name:"escrow",type:"escrow_manager::structs::escrow::EscrowData"},{name:"signature",type:"core::array::Array::<core::felt252>"},{name:"timeout",type:"core::integer::u64"},{name:"extra_data",type:"core::array::Span::<core::felt252>"}],outputs:[],state_mutability:"external"},{type:"function",name:"claim",inputs:[{name:"escrow",type:"escrow_manager::structs::escrow::EscrowData"},{name:"witness",type:"core::array::Array::<core::felt252>"}],outputs:[],state_mutability:"external"},{type:"function",name:"refund",inputs:[{name:"escrow",type:"escrow_manager::structs::escrow::EscrowData"},{name:"witness",type:"core::array::Array::<core::felt252>"}],outputs:[],state_mutability:"external"},{type:"function",name:"cooperative_refund",inputs:[{name:"escrow",type:"escrow_manager::structs::escrow::EscrowData"},{name:"signature",type:"core::array::Array::<core::felt252>"},{name:"timeout",type:"core::integer::u64"}],outputs:[],state_mutability:"external"}]},{type:"impl",name:"LPVaultImpl",interface_name:"escrow_manager::components::lp_vault::ILPVault"},{type:"struct",name:"core::array::Span::<(core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress)>",members:[{name:"snapshot",type:"@core::array::Array::<(core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress)>"}]},{type:"interface",name:"escrow_manager::components::lp_vault::ILPVault",items:[{type:"function",name:"deposit",inputs:[{name:"token",type:"core::starknet::contract_address::ContractAddress"},{name:"amount",type:"core::integer::u256"}],outputs:[],state_mutability:"external"},{type:"function",name:"withdraw",inputs:[{name:"token",type:"core::starknet::contract_address::ContractAddress"},{name:"amount",type:"core::integer::u256"},{name:"destination",type:"core::starknet::contract_address::ContractAddress"}],outputs:[],state_mutability:"external"},{type:"function",name:"get_balance",inputs:[{name:"data",type:"core::array::Span::<(core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress)>"}],outputs:[{type:"core::array::Array::<core::integer::u256>"}],state_mutability:"view"}]},{type:"impl",name:"ReputationTrackerImpl",interface_name:"escrow_manager::components::reputation::IReputationTracker"},{type:"struct",name:"core::array::Span::<(core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress)>",members:[{name:"snapshot",type:"@core::array::Array::<(core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress)>"}]},{type:"struct",name:"escrow_manager::state::reputation::Reputation",members:[{name:"amount",type:"core::integer::u256"},{name:"count",type:"core::integer::u128"}]},{type:"interface",name:"escrow_manager::components::reputation::IReputationTracker",items:[{type:"function",name:"get_reputation",inputs:[{name:"data",type:"core::array::Span::<(core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress, core::starknet::contract_address::ContractAddress)>"}],outputs:[{type:"core::array::Array::<[escrow_manager::state::reputation::Reputation; 3]>"}],state_mutability:"view"}]},{type:"impl",name:"EscrowStorageImpl",interface_name:"escrow_manager::components::escrow_storage::IEscrowStorage"},{type:"struct",name:"escrow_manager::state::escrow::EscrowState",members:[{name:"init_blockheight",type:"core::integer::u64"},{name:"finish_blockheight",type:"core::integer::u64"},{name:"state",type:"core::integer::u8"}]},{type:"struct",name:"core::array::Span::<escrow_manager::state::escrow::EscrowState>",members:[{name:"snapshot",type:"@core::array::Array::<escrow_manager::state::escrow::EscrowState>"}]},{type:"interface",name:"escrow_manager::components::escrow_storage::IEscrowStorage",items:[{type:"function",name:"get_state",inputs:[{name:"escrow",type:"escrow_manager::structs::escrow::EscrowData"}],outputs:[{type:"escrow_manager::state::escrow::EscrowState"}],state_mutability:"view"},{type:"function",name:"get_hash_state",inputs:[{name:"escrow_hash",type:"core::felt252"}],outputs:[{type:"escrow_manager::state::escrow::EscrowState"}],state_mutability:"view"},{type:"function",name:"get_hash_state_multiple",inputs:[{name:"escrow_hashes",type:"core::array::Span::<core::felt252>"}],outputs:[{type:"core::array::Span::<escrow_manager::state::escrow::EscrowState>"}],state_mutability:"view"}]},{type:"event",name:"escrow_manager::components::lp_vault::lp_vault::Event",kind:"enum",variants:[]},{type:"event",name:"escrow_manager::components::reputation::reputation::Event",kind:"enum",variants:[]},{type:"event",name:"escrow_manager::components::escrow_storage::escrow_storage::Event",kind:"enum",variants:[]},{type:"event",name:"escrow_manager::events::Initialize",kind:"struct",members:[{name:"offerer",type:"core::starknet::contract_address::ContractAddress",kind:"key"},{name:"claimer",type:"core::starknet::contract_address::ContractAddress",kind:"key"},{name:"claim_data",type:"core::felt252",kind:"key"},{name:"escrow_hash",type:"core::felt252",kind:"key"},{name:"claim_handler",type:"core::starknet::contract_address::ContractAddress",kind:"data"},{name:"refund_handler",type:"core::starknet::contract_address::ContractAddress",kind:"data"}]},{type:"event",name:"escrow_manager::events::Claim",kind:"struct",members:[{name:"offerer",type:"core::starknet::contract_address::ContractAddress",kind:"key"},{name:"claimer",type:"core::starknet::contract_address::ContractAddress",kind:"key"},{name:"claim_data",type:"core::felt252",kind:"key"},{name:"escrow_hash",type:"core::felt252",kind:"key"},{name:"witness_result",type:"core::array::Span::<core::felt252>",kind:"data"},{name:"claim_handler",type:"core::starknet::contract_address::ContractAddress",kind:"data"}]},{type:"event",name:"escrow_manager::events::Refund",kind:"struct",members:[{name:"offerer",type:"core::starknet::contract_address::ContractAddress",kind:"key"},{name:"claimer",type:"core::starknet::contract_address::ContractAddress",kind:"key"},{name:"claim_data",type:"core::felt252",kind:"key"},{name:"escrow_hash",type:"core::felt252",kind:"key"},{name:"witness_result",type:"core::array::Span::<core::felt252>",kind:"data"},{name:"refund_handler",type:"core::starknet::contract_address::ContractAddress",kind:"data"}]},{type:"event",name:"escrow_manager::EscrowManager::Event",kind:"enum",variants:[{name:"LPVaultEvent",type:"escrow_manager::components::lp_vault::lp_vault::Event",kind:"nested"},{name:"ReputationTrackerEvent",type:"escrow_manager::components::reputation::reputation::Event",kind:"nested"},{name:"EscrowStorageEvent",type:"escrow_manager::components::escrow_storage::escrow_storage::Event",kind:"nested"},{name:"Initialize",type:"escrow_manager::events::Initialize",kind:"nested"},{name:"Claim",type:"escrow_manager::events::Claim",kind:"nested"},{name:"Refund",type:"escrow_manager::events::Refund",kind:"nested"}]}]},776305,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetContractModule=void 0;let d=a.r(816953);class e extends d.StarknetModule{constructor(a,b){super(a),this.contract=b}}c.StarknetContractModule=e},943810,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetSwapModule=void 0;let d=a.r(776305);class e extends d.StarknetContractModule{constructor(a,b){super(a,b),this.swapContract=b.contract}}c.StarknetSwapModule=e},634890,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetLpVault=void 0;let d=a.r(461392),e=a.r(943810),f=a.r(286962),g=a.r(877475);class h extends e.StarknetSwapModule{Withdraw(a,b,c){return new f.StarknetAction(a,this.root,this.swapContract.populateTransaction.withdraw(b,g.cairo.uint256(c),a),h.GasCosts.WITHDRAW)}Deposit(a,b,c){return new f.StarknetAction(a,this.root,this.swapContract.populateTransaction.deposit(b,g.cairo.uint256(c)),h.GasCosts.WITHDRAW)}async getIntermediaryData(a,b){let[c,d]=await Promise.all([this.getIntermediaryBalance(a,b),this.getIntermediaryReputation(a,b)]);return{balance:c,reputation:d}}async getIntermediaryReputation(a,b){let c=Object.keys(this.contract.claimHandlersByAddress).map(c=>g.cairo.tuple(a,b,c)),e=await this.provider.callContract(this.swapContract.populateTransaction.get_reputation(c));if(Number((0,d.toBigInt)(e.shift()))!==c.length)throw Error("getIntermediaryReputation(): Invalid response length");let f={};return Object.keys(this.contract.claimHandlersByAddress).forEach(a=>{f[this.contract.claimHandlersByAddress[a].getType()]={successVolume:(0,d.toBigInt)({low:e.shift(),high:e.shift()}),successCount:(0,d.toBigInt)(e.shift()),coopCloseVolume:(0,d.toBigInt)({low:e.shift(),high:e.shift()}),coopCloseCount:(0,d.toBigInt)(e.shift()),failVolume:(0,d.toBigInt)({low:e.shift(),high:e.shift()}),failCount:(0,d.toBigInt)(e.shift())}}),f}async getIntermediaryBalance(a,b){let c=(0,d.toBigInt)((await this.swapContract.get_balance([g.cairo.tuple(a,b)]))[0]);return this.logger.debug("getIntermediaryBalance(): token LP balance fetched, token: "+b.toString()+" address: "+a+" amount: "+(null==c?"null":c.toString())),c}async txsWithdraw(a,b,c,d){let e=await this.Withdraw(a,b,c);return d??(d=await this.root.Fees.getFeeRate()),this.logger.debug("txsWithdraw(): withdraw TX created, token: "+b.toString()+" amount: "+c.toString(10)),[await e.tx(d)]}async txsDeposit(a,b,c,d){let e=await this.root.Tokens.Approve(a,this.swapContract.address,b,c);return e.add(this.Deposit(a,b,c)),d??(d=await this.root.Fees.getFeeRate()),this.logger.debug("txsDeposit(): deposit TX created, token: "+b.toString()+" amount: "+c.toString(10)),[await e.tx(d)]}}c.StarknetLpVault=h,h.GasCosts={WITHDRAW:{l1DataGas:500,l2Gas:32e5,l1Gas:0},DEPOSIT:{l1:500,l2Gas:4e6,l1Gas:0}}},664211,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetSwapInit=void 0;let d=a.r(163846),e=a.r(461392),f=a.r(500874),g=a.r(286962),h=a.r(943810),i=a.r(877475),j=a.r(187245),k=[{name:"Swap hash",type:"felt"},{name:"Offerer",type:"ContractAddress"},{name:"Claimer",type:"ContractAddress"},{name:"Token amount",type:"TokenAmount"},{name:"Pay in",type:"bool"},{name:"Pay out",type:"bool"},{name:"Tracking reputation",type:"bool"},{name:"Claim handler",type:"ContractAddress"},{name:"Claim data",type:"felt"},{name:"Refund handler",type:"ContractAddress"},{name:"Refund data",type:"felt"},{name:"Security deposit",type:"TokenAmount"},{name:"Claimer bounty",type:"TokenAmount"},{name:"Claim action hash",type:"felt"},{name:"Deadline",type:"timestamp"}];class l extends h.StarknetSwapModule{Init(a,b,c){return new g.StarknetAction(a.payIn?a.offerer:a.claimer,this.root,this.swapContract.populateTransaction.initialize(a.toEscrowStruct(),c,b,null==a.extraData||""===a.extraData?[]:(0,e.bufferToBytes31Span)(f.Buffer.from(a.extraData,"hex")).map(e.toHex)),a.payIn?l.GasCosts.INIT_PAY_IN:l.GasCosts.INIT)}getAuthPrefix(a){return a.isPayIn()?"claim_initialize":"initialize"}async preFetchForInitSignatureVerification(){return{pendingBlockTime:await this.root.Blocks.getBlockTime("pending")}}async signSwapInitialization(a,b,c){let d=Math.floor(Date.now()/1e3)+c,f=await this.root.Signatures.signTypedMessage(a,k,"Initialize",{"Swap hash":"0x"+b.getEscrowHash(),Offerer:b.offerer,Claimer:b.claimer,"Token amount":{token_address:b.token,amount:i.cairo.uint256(b.amount)},"Pay in":b.isPayIn(),"Pay out":b.isPayOut(),"Tracking reputation":b.reputation,"Refund handler":b.refundHandler,"Claim handler":b.claimHandler,"Claim data":"0x"+b.getClaimHash(),"Refund data":b.refundData.startsWith("0x")?b.refundData:"0x"+b.refundData,"Security deposit":{token_address:b.feeToken,amount:i.cairo.uint256(b.securityDeposit)},"Claimer bounty":{token_address:b.feeToken,amount:i.cairo.uint256(b.claimerBounty)},"Claim action hash":0n,Deadline:(0,e.toHex)(d)});return{prefix:this.getAuthPrefix(b),timeout:d.toString(10),signature:f}}async isSignatureValid(a,b,c,f,g,h){if(!b.isOfferer(a)&&!b.isClaimer(a))throw new d.SignatureVerificationError("TX sender not offerer nor claimer");let j=b.isOfferer(a)?b.claimer:b.offerer;if(!b.isPayIn()&&await this.contract.isExpired(a.toString(),b))throw new d.SignatureVerificationError("Swap will expire too soon!");if(f!==this.getAuthPrefix(b))throw new d.SignatureVerificationError("Invalid prefix");let l=BigInt(Math.floor(Date.now()/1e3)),m=BigInt(c);if(m-l<BigInt(this.contract.authGracePeriod)||await this.isSignatureExpired(c,h))throw new d.SignatureVerificationError("Authorization expired!");if(!await this.root.Signatures.isValidSignature(g,j,k,"Initialize",{"Swap hash":"0x"+b.getEscrowHash(),Offerer:b.offerer,Claimer:b.claimer,"Token amount":{token_address:b.token,amount:i.cairo.uint256(b.amount)},"Pay in":b.isPayIn(),"Pay out":b.isPayOut(),"Tracking reputation":b.reputation,"Refund handler":b.refundHandler,"Claim handler":b.claimHandler,"Claim data":"0x"+b.getClaimHash(),"Refund data":b.refundData.startsWith("0x")?b.refundData:"0x"+b.refundData,"Security deposit":{token_address:b.feeToken,amount:i.cairo.uint256(b.securityDeposit)},"Claimer bounty":{token_address:b.feeToken,amount:i.cairo.uint256(b.claimerBounty)},"Claim action hash":0n,Deadline:(0,e.toHex)(m)}))throw new d.SignatureVerificationError("Invalid signature!");return null}async getSignatureExpiry(a){let b=Date.now(),c=(parseInt(a)-this.contract.authGracePeriod)*1e3;return c<b?0:c}async isSignatureExpired(a,b){return(null==b||null==b.pendingBlockTime)&&(b=await this.preFetchForInitSignatureVerification()),b.pendingBlockTime>parseInt(a)}async txsInit(a,b,c,f,g,h,i){if(!h){let[h,i]=await Promise.all([(0,e.tryWithRetries)(()=>this.isSignatureValid(a,b,c,f,g),this.retryPolicy,a=>a instanceof d.SignatureVerificationError),(0,e.tryWithRetries)(()=>this.contract.getCommitStatus(a,b),this.retryPolicy)]);if(i.type!==d.SwapCommitStateType.NOT_COMMITED)throw new d.SwapDataVerificationError("Invoice already being paid for or paid")}i??(i=await this.root.Fees.getFeeRate());let j=this.Init(b,BigInt(c),JSON.parse(g));return b.payIn&&b.isOfferer(a)&&j.addAction(this.root.Tokens.Approve(a,this.swapContract.address,b.token,b.amount),0),0n!==b.getTotalDeposit()&&j.addAction(this.root.Tokens.Approve(a,this.swapContract.address,b.feeToken,b.getTotalDeposit()),0),this.logger.debug("txsInitPayIn(): create swap init TX, swap: "+b.getClaimHash()+" feerate: "+i),[await j.tx(i)]}async getInitFee(a,b){return b??(b=await this.root.Fees.getFeeRate()),j.StarknetFees.getGasFee(a.payIn?l.GasCosts.INIT_PAY_IN:l.GasCosts.INIT,b)}}c.StarknetSwapInit=l,l.GasCosts={INIT:{l1DataGas:750,l2Gas:8e6,l1Gas:0},INIT_PAY_IN:{l1DataGas:500,l2Gas:48e5,l1Gas:0}}},904440,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetSwapRefund=void 0;let d=a.r(163846),e=a.r(461392),f=a.r(943810),g=a.r(286962),h=a.r(187245),i=[{name:"Swap hash",type:"felt"},{name:"Timeout",type:"timestamp"}];class j extends f.StarknetSwapModule{Refund(a,b,c,d){return new g.StarknetAction(a,this.root,this.swapContract.populateTransaction.refund(b.toEscrowStruct(),c),(0,h.starknetGasAdd)(b.payIn?j.GasCosts.REFUND_PAY_OUT:j.GasCosts.REFUND,d))}RefundWithSignature(a,b,c,d){return new g.StarknetAction(a,this.root,this.swapContract.populateTransaction.cooperative_refund(b.toEscrowStruct(),d,BigInt(c)),b.payIn?j.GasCosts.REFUND_PAY_OUT:j.GasCosts.REFUND)}async signSwapRefund(a,b,c){let d=Math.floor(Date.now()/1e3)+c,f=await this.root.Signatures.signTypedMessage(a,i,"Refund",{"Swap hash":"0x"+b.getEscrowHash(),Timeout:(0,e.toHex)(d)});return{prefix:"refund",timeout:d.toString(10),signature:f}}async isSignatureValid(a,b,c,f){if("refund"!==c)throw new d.SignatureVerificationError("Invalid prefix");let g=BigInt(b);if(g-BigInt(Math.floor(Date.now()/1e3))<BigInt(this.contract.authGracePeriod))throw new d.SignatureVerificationError("Authorization expired!");if(!await this.root.Signatures.isValidSignature(f,a.claimer,i,"Refund",{"Swap hash":"0x"+a.getEscrowHash(),Timeout:(0,e.toHex)(g)}))throw new d.SignatureVerificationError("Invalid signature!");return null}async txsRefund(a,b,c,f,g){let h=this.contract.refundHandlersByAddress[b.refundHandler.toLowerCase()];if(null==h)throw Error("Invalid refund handler");if(c&&!await (0,e.tryWithRetries)(()=>this.contract.isRequestRefundable(b.offerer.toString(),b),this.retryPolicy))throw new d.SwapDataVerificationError("Not refundable yet!");f??(f=await this.root.Fees.getFeeRate());let{initialTxns:i,witness:j}=await h.getWitness(a,b,g,f),k=this.Refund(a,b,j,h.getGas(b));return await k.addToTxs(i,f),this.logger.debug("txsRefund(): creating refund transaction, swap: "+b.getClaimHash()),i}async txsRefundWithAuthorization(a,b,c,f,g,h,i){if(h&&!await (0,e.tryWithRetries)(()=>this.contract.isCommited(b),this.retryPolicy))throw new d.SwapDataVerificationError("Not correctly committed");await (0,e.tryWithRetries)(()=>this.isSignatureValid(b,c,f,g),this.retryPolicy,a=>a instanceof d.SignatureVerificationError);let j=this.RefundWithSignature(a,b,c,JSON.parse(g));return i??(i=await this.root.Fees.getFeeRate()),this.logger.debug("txsRefundWithAuthorization(): creating refund transaction, swap: "+b.getClaimHash()+" auth expiry: "+c+" signature: "+g),[await j.tx(i)]}async getRefundFee(a,b){return b??(b=await this.root.Fees.getFeeRate()),h.StarknetFees.getGasFee(a.payIn?j.GasCosts.REFUND_PAY_OUT:j.GasCosts.REFUND,b)}}c.StarknetSwapRefund=j,j.GasCosts={REFUND:{l1DataGas:750,l2Gas:4e6,l1Gas:0},REFUND_PAY_OUT:{l1DataGas:900,l2Gas:6e6,l1Gas:0}}},804707,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.HashlockClaimHandler=void 0;let d=a.r(461392),e=a.r(877475),f=a.r(163846),g=a.r(500874),h=a.r(404322);class i{constructor(a){this.address=a}getCommitment(a){if(32!==a.length)throw Error("Invalid swap hash");return e.hash.computePoseidonHashOnElements((0,d.bufferToU32Array)(a))}getWitness(a,b,c){if(!b.isClaimHandler(this.address))throw Error("Invalid claim handler");if(64!==c.length)throw Error("Invalid hash secret: string length");let e=g.Buffer.from(c,"hex");if(32!==e.length)throw Error("Invalid hash secret: buff length");let f=g.Buffer.from((0,h.sha256)(e));if(!b.isClaimData((0,d.toHex)(this.getCommitment(f))))throw Error("Invalid hash secret: poseidon hash doesn't match");return Promise.resolve({initialTxns:[],witness:(0,d.bufferToU32Array)(e)})}getGas(){return i.gas}getType(){return i.type}parseWitnessResult(a){return(0,d.u32ArrayToBuffer)(a).toString("hex")}}c.HashlockClaimHandler=i,i.type=f.ChainSwapType.HTLC,i.gas={l1DataGas:0,l2Gas:16e6,l1Gas:0}},544985,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.IBitcoinClaimHandler=void 0;let d=a.r(163846),e=a.r(877475),f=a.r(385410),g=a.r(461392),h=(0,g.getLogger)("IBitcoinClaimHandler: ");class i{constructor(a){this.address=a}serializeCommitment(a){return[a.confirmations,a.btcRelay.contract.address]}getCommitment(a){return e.hash.computePoseidonHashOnElements(this.serializeCommitment(a))}async _getWitness(a,b,{tx:c,btcRelay:d,commitedHeader:i,synchronizer:j,requiredConfirmations:k},l,m){let n=this.serializeCommitment({...l,btcRelay:d,confirmations:k}),o=e.hash.computePoseidonHashOnElements(n);if(!b.isClaimData(o))throw Error("Invalid commit data");let p=await d.bitcoinRpc.getMerkleProof(c.txid,c.blockhash);h.debug("getWitness(): merkle proof computed: ",p);let q=[];if(null==i){let b=await f.StarknetBtcRelay.getCommitedHeadersAndSynchronize(a,d,[{blockheight:c.height,requiredConfirmations:k,blockhash:c.blockhash}],q,j,m);if(null==b)throw Error("Cannot fetch committed header!");i=b[c.blockhash]}return n.push(...i.serialize()),n.push(p.merkle.length,...p.merkle.map(g.bufferToU32Array).flat()),n.push(p.pos),{initialTxns:q,witness:n}}parseWitnessResult(a){return(0,g.u32ArrayToBuffer)(a).toString("hex")}}c.IBitcoinClaimHandler=i,i.address="",i.type=d.ChainSwapType.CHAIN_TXID,i.gas={l1DataGas:0,l2Gas:4e8,l1Gas:0}},989962,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BitcoinTxIdClaimHandler=void 0;let d=a.r(163846),e=a.r(461392),f=a.r(544985),g=a.r(500874);(0,e.getLogger)("BitcoinTxIdClaimHandler: ");class h extends f.IBitcoinClaimHandler{serializeCommitment(a){return[...(0,e.bufferToU32Array)(g.Buffer.from(a.txId,"hex").reverse()),...super.serializeCommitment(a)]}getWitness(a,b,c,d){if(!b.isClaimHandler(this.address))throw Error("Invalid claim handler");return this._getWitness(a,b,c,{txId:c.tx.txid})}getGas(a){return h.gas}getType(){return h.type}}c.BitcoinTxIdClaimHandler=h,h.type=d.ChainSwapType.CHAIN_TXID,h.gas={l1DataGas:0,l2Gas:4e8,l1Gas:0}},621915,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BitcoinOutputClaimHandler=void 0;let d=a.r(163846),e=a.r(877475),f=a.r(461392),g=a.r(544985),h=a.r(680302),i=a.r(500874);(0,f.getLogger)("BitcoinOutputClaimHandler: ");class j extends g.IBitcoinClaimHandler{serializeCommitment(a){return[e.hash.computePoseidonHashOnElements([(0,f.toBigInt)(a.amount),(0,f.poseidonHashRange)(a.output)]),...super.serializeCommitment(a)]}async getWitness(a,b,c,d){if(!b.isClaimHandler(this.address))throw Error("Invalid claim handler");let e=h.Transaction.fromRaw(i.Buffer.from(c.tx.hex,"hex")).getOutput(c.vout),{initialTxns:g,witness:j}=await this._getWitness(a,b,c,{output:i.Buffer.from(e.script),amount:e.amount});return j.push(...(0,f.bufferToByteArray)(i.Buffer.from(c.tx.hex,"hex"))),j.push(BigInt(c.vout)),{initialTxns:g,witness:j}}getGas(a){return j.gas}getType(){return j.type}}c.BitcoinOutputClaimHandler=j,j.type=d.ChainSwapType.CHAIN,j.gas={l1DataGas:0,l2Gas:4e8,l1Gas:0}},935930,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BitcoinNoncedOutputClaimHandler=void 0;let d=a.r(163846),e=a.r(877475),f=a.r(461392),g=a.r(544985),h=a.r(680302),i=a.r(500874);(0,f.getLogger)("BitcoinNoncedOutputClaimHandler: ");class j extends g.IBitcoinClaimHandler{serializeCommitment(a){return[e.hash.computePoseidonHashOnElements([(0,f.toBigInt)(a.nonce),(0,f.toBigInt)(a.amount),(0,f.poseidonHashRange)(a.output)]),...super.serializeCommitment(a)]}async getWitness(a,b,c,d){if(!b.isClaimHandler(this.address))throw Error("Invalid claim handler");let e=h.Transaction.fromRaw(i.Buffer.from(c.tx.hex,"hex")),g=e.getOutput(c.vout),{initialTxns:j,witness:k}=await this._getWitness(a,b,c,{output:i.Buffer.from(g.script),amount:g.amount,nonce:function(a){let b=BigInt(a.lockTime-5e8);if(b<0n)throw Error("Locktime too low!");return b<<24n|16777215n&BigInt(a.getInput(0).sequence)}(e)});return k.push(...(0,f.bufferToByteArray)(i.Buffer.from(c.tx.hex,"hex"))),k.push(BigInt(c.vout)),{initialTxns:j,witness:k}}getGas(a){return j.gas}getType(){return j.type}}c.BitcoinNoncedOutputClaimHandler=j,j.type=d.ChainSwapType.CHAIN_NONCED,j.gas={l1DataGas:0,l2Gas:4e8,l1Gas:0}},745422,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.claimHandlersList=void 0;let d=a.r(804707),e=a.r(989962),f=a.r(621915),g=a.r(935930);c.claimHandlersList=[d.HashlockClaimHandler,e.BitcoinTxIdClaimHandler,f.BitcoinOutputClaimHandler,g.BitcoinNoncedOutputClaimHandler]},773154,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetSwapClaim=void 0;let d=a.r(163846),e=a.r(461392),f=a.r(943810),g=a.r(286962),h=a.r(187245);class i extends f.StarknetSwapModule{Claim(a,b,c,d){return new g.StarknetAction(a,this.root,this.swapContract.populateTransaction.claim(b.toEscrowStruct(),c),(0,h.starknetGasAdd)(b.payOut?i.GasCosts.CLAIM_PAY_OUT:i.GasCosts.CLAIM,d))}async txsClaimWithSecret(a,b,c,f,g){if(f&&await this.contract.isExpired(b.claimer.toString(),b))throw new d.SwapDataVerificationError("Not enough time to reliably pay the invoice");let h=this.contract.claimHandlersByAddress[(0,e.toHex)(b.claimHandler)];if(null==h)throw new d.SwapDataVerificationError("Unknown claim handler!");if(h.getType()!==d.ChainSwapType.HTLC)throw new d.SwapDataVerificationError("Invalid claim handler!");g??(g=await this.root.Fees.getFeeRate());let{initialTxns:i,witness:j}=await h.getWitness(a,b,c,g),k=this.Claim(a,b,j,h.getGas(b));return await k.addToTxs(i,g),this.logger.debug("txsClaimWithSecret(): creating claim transaction, swap: "+b.getClaimHash()+" witness: ",j.map(e.toHex)),i}async txsClaimWithTxData(a,b,c,f,g,h,i,j){let k=this.contract.claimHandlersByAddress[(0,e.toHex)(b.claimHandler)];if(null==k)throw new d.SwapDataVerificationError("Unknown claim handler!");if(k.getType()!==d.ChainSwapType.CHAIN_NONCED&&k.getType()!==d.ChainSwapType.CHAIN_TXID&&k.getType()!==d.ChainSwapType.CHAIN)throw new d.SwapDataVerificationError("Invalid claim handler!");j??(j=await this.root.Fees.getFeeRate());let{initialTxns:l,witness:m}=await k.getWitness(a,b,{tx:c,vout:g,requiredConfirmations:f,commitedHeader:h,btcRelay:this.contract.btcRelay,synchronizer:i},j),n=this.Claim(a,b,m,k.getGas(b));return await n.addToTxs(l,j),l}async getClaimFee(a,b){b??(b=await this.root.Fees.getFeeRate());let c=a.payOut?i.GasCosts.CLAIM_PAY_OUT:i.GasCosts.CLAIM,d=this.contract.claimHandlersByAddress[(0,e.toHex)(a.claimHandler)];return null!=d&&(c=(0,h.starknetGasAdd)(c,d.getGas(a))),h.StarknetFees.getGasFee(c,b)}}c.StarknetSwapClaim=i,i.GasCosts={CLAIM:{l1DataGas:750,l2Gas:4e6,l1Gas:0},CLAIM_PAY_OUT:{l1DataGas:900,l2Gas:6e6,l1Gas:0}}},531679,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetSwapContract=void 0;let d=a.r(163846),e=a.r(500874),f=a.r(400129),g=a.r(562857),h=a.r(877475),i=a.r(593507),j=a.r(461392),k=a.r(280002),l=a.r(634890),m=a.r(664211),n=a.r(904440),o=a.r(745422),p=a.r(773154),q=a.r(404322),r={[h.constants.StarknetChainId.SN_SEPOLIA]:"0x017bf50dd28b6d823a231355bb25813d4396c8e19d2df03026038714a22f0413",[h.constants.StarknetChainId.SN_MAIN]:"0x04f278e1f19e495c3b1dd35ef307c4f7510768ed95481958fbae588bd173f79a"},s={[h.constants.StarknetChainId.SN_SEPOLIA]:{[d.ChainSwapType.HTLC]:"0x04a57ea54d4637c352aad1bbee046868926a11702216a0aaf7eeec1568be2d7b",[d.ChainSwapType.CHAIN_TXID]:"0x04c7cde88359e14b6f6f779f8b9d8310cee37e91a6f143f855ae29fab33c396e",[d.ChainSwapType.CHAIN]:"0x051bef6f5fd12e2832a7d38653bdfc8eb84ba7eb7a4aada5b87ef38a9999cf17",[d.ChainSwapType.CHAIN_NONCED]:"0x050e50eacd16da414f2c3a7c3570fd5e248974c6fe757d41acbf72d2836fa0a1"},[h.constants.StarknetChainId.SN_MAIN]:{[d.ChainSwapType.HTLC]:"0x07b74b50a883ebee262b6db0e3c0c697670c6f30e3d610e75faf33a89c46aa2a",[d.ChainSwapType.CHAIN_TXID]:"0x016c2db2b03f39cf4fd7f871035000f66b62307d9983056e33a38315da8a44dc",[d.ChainSwapType.CHAIN]:"0x02c45a81c4a48d0645a0a199e620061e8a55dcc9c2b5946d050eaeeddba64e9a",[d.ChainSwapType.CHAIN_NONCED]:"0x0019b5480dd7ed8ded10a09437b0a7a30b8997b4ef139deb24ff8c86f995d84f"}},t={[h.constants.StarknetChainId.SN_SEPOLIA]:{timelock:"0x034b8f28b3ca979036cb2849cfa3af7f67207459224b6ca5ce2474aa398ec3e7"},[h.constants.StarknetChainId.SN_MAIN]:{timelock:"0x06a59659990c2aefbf7239f6d911617b3ae60b79cb3364f3bd242a6ca8f4f4f7"}};class u extends g.StarknetContractBase{constructor(a,b,c=r[a.starknetChainId],d){super(a,c,f.EscrowManagerAbi),this.chainId="STARKNET",this.claimWithSecretTimeout=180,this.claimWithTxDataTimeout=180,this.refundTimeout=180,this.claimGracePeriod=600,this.refundGracePeriod=600,this.authGracePeriod=30,this.claimHandlersByAddress={},this.claimHandlersBySwapType={},this.refundHandlersByAddress={},this.Init=new m.StarknetSwapInit(a,this),this.Refund=new n.StarknetSwapRefund(a,this),this.Claim=new p.StarknetSwapClaim(a,this),this.LpVault=new l.StarknetLpVault(a,this),this.btcRelay=b,d??(d={}),d.refund??(d.refund={}),d.refund={...t[a.starknetChainId],...d.refund},d.claim??(d.claim={}),d.claim={...s[a.starknetChainId],...d.claim},o.claimHandlersList.forEach(a=>{let b=new a(d.claim[a.type]);this.claimHandlersByAddress[(0,j.toHex)(b.address)]=b,this.claimHandlersBySwapType[a.type]=b}),this.timelockRefundHandler=new k.TimelockRefundHandler(d.refund.timelock),this.refundHandlersByAddress[this.timelockRefundHandler.address]=this.timelockRefundHandler}async start(){}preFetchForInitSignatureVerification(){return this.Init.preFetchForInitSignatureVerification()}getInitSignature(a,b,c,d,e){return this.Init.signSwapInitialization(a,b,c)}isValidInitAuthorization(a,b,{timeout:c,prefix:d,signature:e},f,g){return this.Init.isSignatureValid(a,b,c,d,e,g)}getInitAuthorizationExpiry(a,{timeout:b,prefix:c,signature:d},e){return this.Init.getSignatureExpiry(b)}isInitAuthorizationExpired(a,{timeout:b,prefix:c,signature:d}){return this.Init.isSignatureExpired(b)}getRefundSignature(a,b,c){return this.Refund.signSwapRefund(a,b,c)}isValidRefundAuthorization(a,{timeout:b,prefix:c,signature:d}){return this.Refund.isSignatureValid(a,b,c,d)}getDataSignature(a,b){return this.Chain.Signatures.getDataSignature(a,b)}isValidDataSignature(a,b,c){return this.Chain.Signatures.isValidDataSignature(a,b,c)}async isClaimable(a,b){return!(!b.isClaimer(a)||await this.isExpired(a,b))&&await this.isCommited(b)}async isCommited(a){return 1===Number((await this.contract.get_hash_state("0x"+a.getEscrowHash())).state)}isExpired(a,b){let c=BigInt(Math.floor(Date.now()/1e3));return b.isClaimer(a)&&(c+=BigInt(this.claimGracePeriod)),b.isOfferer(a)&&(c-=BigInt(this.refundGracePeriod)),Promise.resolve(b.getExpiry()<c)}async isRequestRefundable(a,b){return!!b.isOfferer(a)&&!!await this.isExpired(a,b)&&await this.isCommited(b)}getHashForTxId(a,b){return(0,j.bigNumberishToBuffer)(this.claimHandlersBySwapType[d.ChainSwapType.CHAIN_TXID].getCommitment({txId:a,confirmations:b,btcRelay:this.btcRelay}),32)}getHashForOnchain(a,b,c,e){let f;return f=null==e||0n===e?this.claimHandlersBySwapType[d.ChainSwapType.CHAIN].getCommitment({output:a,amount:b,confirmations:c,btcRelay:this.btcRelay}):this.claimHandlersBySwapType[d.ChainSwapType.CHAIN_NONCED].getCommitment({output:a,amount:b,nonce:e,confirmations:c,btcRelay:this.btcRelay}),(0,j.bigNumberishToBuffer)(f,32)}getHashForHtlc(a){return(0,j.bigNumberishToBuffer)(this.claimHandlersBySwapType[d.ChainSwapType.HTLC].getCommitment(a),32)}getExtraData(a,b,c,f){null==f&&(f=0n);let g=e.Buffer.from((0,q.sha256)(e.Buffer.concat([d.BigIntBufferUtils.toBuffer(b,"le",8),a])));return e.Buffer.concat([g,d.BigIntBufferUtils.toBuffer(f,"be",8),d.BigIntBufferUtils.toBuffer(BigInt(c),"be",2)])}async getCommitStatus(a,b){let c=b.getEscrowHash(),e=await this.contract.get_hash_state("0x"+c),f=Number(e.state),g=Number(e.finish_blockheight);switch(f){case 1:if(b.isOfferer(a)&&await this.isExpired(a,b))return{type:d.SwapCommitStateType.REFUNDABLE};return{type:d.SwapCommitStateType.COMMITED};case 2:return{type:d.SwapCommitStateType.PAID,getTxBlock:async()=>({blockTime:await this.Chain.Blocks.getBlockTime(g),blockHeight:g}),getClaimTxId:async()=>{let a=await this.Events.getContractBlockEvents(["escrow_manager::events::Claim"],[null,null,null,"0x"+c],g,g);return 0===a.length?null:a[0].txHash},getClaimResult:async()=>{let a=await this.Events.getContractBlockEvents(["escrow_manager::events::Claim"],[null,null,null,"0x"+c],g,g);if(0===a.length)return null;let b=a[0],d=(0,j.toHex)(b.params.claim_handler),e=this.claimHandlersByAddress[d];return null==e?(h.logger.warn("getCommitStatus(): getClaimResult("+c+"): Unknown claim handler with claim: "+d),null):e.parseWitnessResult(b.params.witness_result)}};default:return{type:await this.isExpired(a,b)?d.SwapCommitStateType.EXPIRED:d.SwapCommitStateType.NOT_COMMITED,getTxBlock:async()=>({blockTime:await this.Chain.Blocks.getBlockTime(g),blockHeight:g}),getClaimTxId:async()=>{let a=await this.Events.getContractBlockEvents(["escrow_manager::events::Refund"],[null,null,null,"0x"+c],g,g);return 0===a.length?null:a[0].txHash}}}}async getCommitedData(a){return null}createSwapData(a,b,c,d,e,f,g,h,k,l,m,n,o=this.Chain.Tokens.getNativeCurrencyAddress()){return Promise.resolve(new i.StarknetSwapData(b,c,d,this.timelockRefundHandler.address,this.claimHandlersBySwapType?.[a]?.address,l,k,k,g,"0x"+f,(0,j.toHex)(h),e,o,m,n,a,null))}async getBalance(a,b,c){return c?await this.getIntermediaryBalance(a,b):await this.Chain.getBalance(a,b)}getIntermediaryData(a,b){return this.LpVault.getIntermediaryData(a,b)}getIntermediaryReputation(a,b){return this.LpVault.getIntermediaryReputation(a,b)}getIntermediaryBalance(a,b){return this.LpVault.getIntermediaryBalance(a,b)}async txsClaimWithSecret(a,b,c,d,e,f,g){return this.Claim.txsClaimWithSecret("string"==typeof a?a:a.getAddress(),b,c,d,f)}async txsClaimWithTxData(a,b,c,d,e,f,g,h,i){return this.Claim.txsClaimWithTxData("string"==typeof a?a:a.getAddress(),b,c,d,e,f,g,i)}txsRefund(a,b,c,d,e){return this.Refund.txsRefund(a,b,c,e)}txsRefundWithAuthorization(a,b,{timeout:c,prefix:d,signature:e},f,g,h){return this.Refund.txsRefundWithAuthorization(a,b,c,d,e,f,h)}txsInit(a,b,{timeout:c,prefix:d,signature:e},f,g){return this.Init.txsInit(a,b,c,d,e,f,g)}txsWithdraw(a,b,c,d){return this.LpVault.txsWithdraw(a,b,c,d)}txsDeposit(a,b,c,d){return this.LpVault.txsDeposit(a,b,c,d)}async claimWithSecret(a,b,c,d,e,f){let g=await this.Claim.txsClaimWithSecret(a.getAddress(),b,c,d,f?.feeRate),[h]=await this.Chain.sendAndConfirm(a,g,f?.waitForConfirmation,f?.abortSignal);return h}async claimWithTxData(a,b,c,d,e,f,g,h,i){let j=await this.Claim.txsClaimWithTxData(a.getAddress(),b,c,d,e,f,g,i?.feeRate);if(null===j)throw Error("Btc relay not synchronized to required blockheight!");let[k]=await this.Chain.sendAndConfirm(a,j,i?.waitForConfirmation,i?.abortSignal);return k}async refund(a,b,c,d,e){let f=await this.txsRefund(a.getAddress(),b,c,d,e?.feeRate),[g]=await this.Chain.sendAndConfirm(a,f,e?.waitForConfirmation,e?.abortSignal);return g}async refundWithAuthorization(a,b,c,d,e,f){let g=await this.txsRefundWithAuthorization(a.getAddress(),b,c,d,e,f?.feeRate),[h]=await this.Chain.sendAndConfirm(a,g,f?.waitForConfirmation,f?.abortSignal);return h}async init(a,b,c,d,e){if(b.isPayIn()){if(!b.isOfferer(a.getAddress()))throw Error("Invalid signer provided!")}else if(!b.isClaimer(a.getAddress()))throw Error("Invalid signer provided!");let f=await this.txsInit(a.getAddress(),b,c,d,e?.feeRate),[g]=await this.Chain.sendAndConfirm(a,f,e?.waitForConfirmation,e?.abortSignal);return g}async withdraw(a,b,c,d){let e=await this.LpVault.txsWithdraw(a.getAddress(),b,c,d?.feeRate),[f]=await this.Chain.sendAndConfirm(a,e,d?.waitForConfirmation,d?.abortSignal,!1);return f}async deposit(a,b,c,d){let e=await this.LpVault.txsDeposit(a.getAddress(),b,c,d?.feeRate),[f]=await this.Chain.sendAndConfirm(a,e,d?.waitForConfirmation,d?.abortSignal,!1);return f}getInitPayInFeeRate(a,b,c,d){return this.Chain.Fees.getFeeRate()}getInitFeeRate(a,b,c,d){return this.Chain.Fees.getFeeRate()}getRefundFeeRate(a){return this.Chain.Fees.getFeeRate()}getClaimFeeRate(a,b){return this.Chain.Fees.getFeeRate()}getClaimFee(a,b,c){return this.Claim.getClaimFee(b,c)}getCommitFee(a,b){return this.Init.getInitFee(a,b)}getRefundFee(a,b){return this.Refund.getRefundFee(a,b)}}c.StarknetSwapContract=u},844912,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},6127,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetChainEventsBrowser=void 0;let d=a.r(163846),e=a.r(461392),f=a.r(877475);c.StarknetChainEventsBrowser=class{constructor(a,b,c,d=5){this.listeners=[],this.logger=(0,e.getLogger)("StarknetChainEventsBrowser: "),this.initFunctionName="initialize",this.initEntryPointSelector=BigInt(f.hash.starknetKeccak(this.initFunctionName)),this.provider=a.provider,this.starknetSwapContract=b,this.starknetSpvVaultContract=c,this.pollIntervalSeconds=d}findInitSwapData(a,b,c){if(BigInt(a.contract_address)===BigInt(this.starknetSwapContract.contract.address)&&BigInt(a.entry_point_selector)===this.initEntryPointSelector){let{escrow:d,extraData:f}=(0,e.parseInitFunctionCalldata)(a.calldata,c);if("0x"+d.getEscrowHash()===(0,e.toHex)(b))return 0!==f.length&&d.setExtraData((0,e.bytes31SpanToBuffer)(f,42).toString("hex")),d}for(let d of a.calls){let a=this.findInitSwapData(d,b,c);if(null!=a)return a}return null}getSwapDataGetter(a,b){return async()=>{let c;try{c=await this.provider.getTransactionTrace(a.txHash)}catch(d){this.logger.warn("getSwapDataGetter(): getter: starknet_traceTransaction not supported by the RPC: ",d);let b=(await this.provider.getBlockTransactionsTraces(a.blockHash)).find(b=>(0,e.toHex)(b.transaction_hash)===(0,e.toHex)(a.txHash));if(null==b)throw Error(`Cannot find ${a.txHash} in the block traces, block: ${a.blockHash}`);c=b.trace_root}return null==c||null!=c.execute_invocation.revert_reason?null:this.findInitSwapData(c.execute_invocation,a.params.escrow_hash,b)}}parseInitializeEvent(a){let b=(0,e.bigNumberishToBuffer)(a.params.escrow_hash,32).toString("hex"),c=(0,e.toHex)(a.params.claim_handler),f=this.starknetSwapContract.claimHandlersByAddress[c];if(null==f)return this.logger.warn("parseInitializeEvent("+b+"): Unknown claim handler with claim: "+c),null;let g=f.getType();return this.logger.debug("InitializeEvent claimHash: "+(0,e.toHex)(a.params.claim_data)+" escrowHash: "+b),new d.InitializeEvent(b,g,(0,e.onceAsync)(this.getSwapDataGetter(a,f)))}parseRefundEvent(a){let b=(0,e.bigNumberishToBuffer)(a.params.escrow_hash,32).toString("hex");return this.logger.debug("RefundEvent claimHash: "+(0,e.toHex)(a.params.claim_data)+" escrowHash: "+b),new d.RefundEvent(b)}parseClaimEvent(a){let b=(0,e.bigNumberishToBuffer)(a.params.escrow_hash,32).toString("hex"),c=(0,e.toHex)(a.params.claim_handler),f=this.starknetSwapContract.claimHandlersByAddress[c];if(null==f)return this.logger.warn("parseClaimEvent("+b+"): Unknown claim handler with claim: "+c),null;let g=f.parseWitnessResult(a.params.witness_result);return this.logger.debug("ClaimEvent claimHash: "+(0,e.toHex)(a.params.claim_data)+" witnessResult: "+g+" escrowHash: "+b),new d.ClaimEvent(b,g)}parseSpvOpenEvent(a){let b=(0,e.toHex)(a.params.owner),c=(0,e.toBigInt)(a.params.vault_id),f=(0,e.bigNumberishToBuffer)(a.params.btc_tx_hash,32).reverse().toString("hex"),g=Number((0,e.toBigInt)(a.params.vout));return this.logger.debug("SpvOpenEvent owner: "+b+" vaultId: "+c+" utxo: "+f+":"+g),new d.SpvVaultOpenEvent(b,c,f,g)}parseSpvDepositEvent(a){let b=(0,e.toHex)(a.params.owner),c=(0,e.toBigInt)(a.params.vault_id),f=[(0,e.toBigInt)(a.params.amounts["0"]),(0,e.toBigInt)(a.params.amounts["1"])],g=Number((0,e.toBigInt)(a.params.deposit_count));return this.logger.debug("SpvDepositEvent owner: "+b+" vaultId: "+c+" depositCount: "+g+" amounts: ",f),new d.SpvVaultDepositEvent(b,c,f,g)}parseSpvFrontEvent(a){let b=(0,e.toHex)(a.params.owner),c=(0,e.toBigInt)(a.params.vault_id),f=(0,e.bigNumberishToBuffer)(a.params.btc_tx_hash,32).reverse().toString("hex"),g=(0,e.toHex)(a.params.recipient),h=(0,e.toHex)(a.params.execution_hash),i=[(0,e.toBigInt)(a.params.amounts["0"]),(0,e.toBigInt)(a.params.amounts["1"])],j=(0,e.toHex)(a.params.caller);return this.logger.debug("SpvFrontEvent owner: "+b+" vaultId: "+c+" btcTxId: "+f+" recipient: "+g+" frontedBy: "+j+" amounts: ",i),new d.SpvVaultFrontEvent(b,c,f,g,h,i,j)}parseSpvClaimEvent(a){let b=(0,e.toHex)(a.params.owner),c=(0,e.toBigInt)(a.params.vault_id),f=(0,e.bigNumberishToBuffer)(a.params.btc_tx_hash,32).reverse().toString("hex"),g=(0,e.toHex)(a.params.recipient),h=(0,e.toHex)(a.params.execution_hash),i=[(0,e.toBigInt)(a.params.amounts["0"]),(0,e.toBigInt)(a.params.amounts["1"])],j=(0,e.toHex)(a.params.caller),k=(0,e.toHex)(a.params.fronting_address),l=Number((0,e.toBigInt)(a.params.withdraw_count));return this.logger.debug("SpvClaimEvent owner: "+b+" vaultId: "+c+" btcTxId: "+f+" withdrawCount: "+l+" recipient: "+g+" frontedBy: "+k+" claimedBy: "+j+" amounts: ",i),new d.SpvVaultClaimEvent(b,c,f,g,h,i,j,k,l)}parseSpvCloseEvent(a){let b=(0,e.toHex)(a.params.owner),c=(0,e.toBigInt)(a.params.vault_id),f=(0,e.bigNumberishToBuffer)(a.params.btc_tx_hash,32).reverse().toString("hex"),g=(0,e.bigNumberishToBuffer)(a.params.error).toString();return new d.SpvVaultCloseEvent(b,c,f,g)}async processEvents(a,b,c,d){let e={},f=async a=>{if(a===b)return c;let d=a.toString();return e[d]??(e[d]=(await this.provider.getBlockWithTxHashes(a)).timestamp),e[d]},g=[];for(let b of a){let a;switch(b.name){case"escrow_manager::events::Claim":a=this.parseClaimEvent(b);break;case"escrow_manager::events::Refund":a=this.parseRefundEvent(b);break;case"escrow_manager::events::Initialize":a=this.parseInitializeEvent(b);break;case"spv_swap_vault::events::Opened":a=this.parseSpvOpenEvent(b);break;case"spv_swap_vault::events::Deposited":a=this.parseSpvDepositEvent(b);break;case"spv_swap_vault::events::Fronted":a=this.parseSpvFrontEvent(b);break;case"spv_swap_vault::events::Claimed":a=this.parseSpvClaimEvent(b);break;case"spv_swap_vault::events::Closed":a=this.parseSpvCloseEvent(b)}if(null==a)continue;let c=null==b.blockNumber?d:await f(b.blockNumber);a.meta={blockTime:c,txId:b.txHash,timestamp:c},g.push(a)}for(let a of this.listeners)await a(g)}async checkEventsEcrowManager(a,b,c){let d=c.block_number;b??(b=d);let f=await this.starknetSwapContract.Events.getContractBlockEvents(["escrow_manager::events::Initialize","escrow_manager::events::Claim","escrow_manager::events::Refund"],[],b,null);if(null!=a){let b=(0,e.findLastIndex)(f,b=>b.txHash===a);-1!==b&&f.splice(0,b+1)}return f.length>0&&(await this.processEvents(f,c?.block_number,c?.timestamp,Math.floor(Date.now()/1e3)),a=f[f.length-1].txHash),a}async checkEventsSpvVaults(a,b,c){let d=c.block_number;b??(b=d);let f=await this.starknetSpvVaultContract.Events.getContractBlockEvents(["spv_swap_vault::events::Opened","spv_swap_vault::events::Deposited","spv_swap_vault::events::Closed","spv_swap_vault::events::Fronted","spv_swap_vault::events::Claimed"],[],b,null);if(null!=a){let b=(0,e.findLastIndex)(f,b=>b.txHash===a);-1!==b&&f.splice(0,b+1)}return f.length>0&&(await this.processEvents(f,c?.block_number,c?.timestamp,Math.floor(Date.now()/1e3)),a=f[f.length-1].txHash),a}async checkEvents(a,b){b??(b=[]);let c=await this.provider.getBlockWithTxHashes("latest"),d=c.block_number;return b[0]=await this.checkEventsEcrowManager(b[0],a,c),b[1]=await this.checkEventsSpvVaults(b[1],a,c),{txHashes:b,blockNumber:d}}async setupPoll(a,b,c){let d;this.stopped=!1,d=async()=>{await this.checkEvents(a,b).then(({blockNumber:d,txHashes:e})=>{if(a=d,b=e,null!=c)return c(d,b)}).catch(a=>{this.logger.error("setupPoll(): Failed to fetch starknet log: ",a)}),this.stopped||(this.timeout=setTimeout(d,1e3*this.pollIntervalSeconds))},await d()}init(){return this.setupPoll(),Promise.resolve()}async stop(){this.stopped=!0,null!=this.timeout&&clearTimeout(this.timeout)}registerListener(a){this.listeners.push(a)}unregisterListener(a){let b=this.listeners.indexOf(a);return b>=0&&(this.listeners.splice(b,1),!0)}}},575196,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},202529,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SpvVaultContractAbi=void 0,c.SpvVaultContractAbi=[{type:"impl",name:"SpvVaultManagerImpl",interface_name:"spv_swap_vault::ISpvVaultManager"},{type:"struct",name:"core::integer::u256",members:[{name:"low",type:"core::integer::u128"},{name:"high",type:"core::integer::u128"}]},{type:"struct",name:"spv_swap_vault::structs::BitcoinVaultTransactionData",members:[{name:"recipient",type:"core::starknet::contract_address::ContractAddress"},{name:"amount",type:"(core::integer::u64, core::integer::u64)"},{name:"caller_fee",type:"(core::integer::u64, core::integer::u64)"},{name:"fronting_fee",type:"(core::integer::u64, core::integer::u64)"},{name:"execution_handler_fee_amount_0",type:"core::integer::u64"},{name:"execution_hash",type:"core::felt252"},{name:"execution_expiry",type:"core::integer::u32"}]},{type:"struct",name:"core::byte_array::ByteArray",members:[{name:"data",type:"core::array::Array::<core::bytes_31::bytes31>"},{name:"pending_word",type:"core::felt252"},{name:"pending_word_len",type:"core::integer::u32"}]},{type:"struct",name:"btc_relay::structs::blockheader::BlockHeader",members:[{name:"reversed_version",type:"core::integer::u32"},{name:"previous_blockhash",type:"[core::integer::u32; 8]"},{name:"merkle_root",type:"[core::integer::u32; 8]"},{name:"reversed_timestamp",type:"core::integer::u32"},{name:"nbits",type:"core::integer::u32"},{name:"nonce",type:"core::integer::u32"}]},{type:"struct",name:"btc_relay::structs::stored_blockheader::StoredBlockHeader",members:[{name:"blockheader",type:"btc_relay::structs::blockheader::BlockHeader"},{name:"block_hash",type:"[core::integer::u32; 8]"},{name:"chain_work",type:"core::integer::u256"},{name:"block_height",type:"core::integer::u32"},{name:"last_diff_adjustment",type:"core::integer::u32"},{name:"prev_block_timestamps",type:"[core::integer::u32; 10]"}]},{type:"struct",name:"core::array::Span::<[core::integer::u32; 8]>",members:[{name:"snapshot",type:"@core::array::Array::<[core::integer::u32; 8]>"}]},{type:"interface",name:"spv_swap_vault::ISpvVaultManager",items:[{type:"function",name:"open",inputs:[{name:"vault_id",type:"core::felt252"},{name:"relay_contract",type:"core::starknet::contract_address::ContractAddress"},{name:"utxo",type:"(core::integer::u256, core::integer::u32)"},{name:"confirmations",type:"core::integer::u8"},{name:"token_0",type:"core::starknet::contract_address::ContractAddress"},{name:"token_1",type:"core::starknet::contract_address::ContractAddress"},{name:"token_0_multiplier",type:"core::felt252"},{name:"token_1_multiplier",type:"core::felt252"}],outputs:[],state_mutability:"external"},{type:"function",name:"deposit",inputs:[{name:"owner",type:"core::starknet::contract_address::ContractAddress"},{name:"vault_id",type:"core::felt252"},{name:"raw_token_0_amount",type:"core::integer::u64"},{name:"raw_token_1_amount",type:"core::integer::u64"}],outputs:[],state_mutability:"external"},{type:"function",name:"front",inputs:[{name:"owner",type:"core::starknet::contract_address::ContractAddress"},{name:"vault_id",type:"core::felt252"},{name:"withdraw_sequence",type:"core::integer::u32"},{name:"btc_tx_hash",type:"core::integer::u256"},{name:"data",type:"spv_swap_vault::structs::BitcoinVaultTransactionData"}],outputs:[],state_mutability:"external"},{type:"function",name:"claim",inputs:[{name:"owner",type:"core::starknet::contract_address::ContractAddress"},{name:"vault_id",type:"core::felt252"},{name:"transaction",type:"core::byte_array::ByteArray"},{name:"blockheader",type:"btc_relay::structs::stored_blockheader::StoredBlockHeader"},{name:"merkle_proof",type:"core::array::Span::<[core::integer::u32; 8]>"},{name:"position",type:"core::integer::u32"}],outputs:[],state_mutability:"external"}]},{type:"impl",name:"SpvVaultManagerReadOnlyImpl",interface_name:"spv_swap_vault::ISpvVaultManagerReadOnly"},{type:"struct",name:"spv_swap_vault::state::SpvVaultState",members:[{name:"relay_contract",type:"core::starknet::contract_address::ContractAddress"},{name:"token_0",type:"core::starknet::contract_address::ContractAddress"},{name:"token_1",type:"core::starknet::contract_address::ContractAddress"},{name:"token_0_multiplier",type:"core::felt252"},{name:"token_1_multiplier",type:"core::felt252"},{name:"utxo",type:"(core::integer::u256, core::integer::u32)"},{name:"confirmations",type:"core::integer::u8"},{name:"withdraw_count",type:"core::integer::u32"},{name:"deposit_count",type:"core::integer::u32"},{name:"token_0_amount",type:"core::integer::u64"},{name:"token_1_amount",type:"core::integer::u64"}]},{type:"enum",name:"core::option::Option::<spv_swap_vault::structs::BitcoinVaultTransactionData>",variants:[{name:"Some",type:"spv_swap_vault::structs::BitcoinVaultTransactionData"},{name:"None",type:"()"}]},{type:"interface",name:"spv_swap_vault::ISpvVaultManagerReadOnly",items:[{type:"function",name:"get_vault",inputs:[{name:"owner",type:"core::starknet::contract_address::ContractAddress"},{name:"vault_id",type:"core::felt252"}],outputs:[{type:"spv_swap_vault::state::SpvVaultState"}],state_mutability:"view"},{type:"function",name:"get_fronter_address",inputs:[{name:"owner",type:"core::starknet::contract_address::ContractAddress"},{name:"vault_id",type:"core::felt252"},{name:"btc_tx_hash",type:"core::integer::u256"},{name:"data",type:"spv_swap_vault::structs::BitcoinVaultTransactionData"}],outputs:[{type:"core::starknet::contract_address::ContractAddress"}],state_mutability:"view"},{type:"function",name:"get_fronter_address_by_id",inputs:[{name:"owner",type:"core::starknet::contract_address::ContractAddress"},{name:"vault_id",type:"core::felt252"},{name:"fronting_id",type:"core::felt252"}],outputs:[{type:"core::starknet::contract_address::ContractAddress"}],state_mutability:"view"},{type:"function",name:"parse_bitcoin_tx",inputs:[{name:"transaction",type:"core::byte_array::ByteArray"}],outputs:[{type:"core::option::Option::<spv_swap_vault::structs::BitcoinVaultTransactionData>"}],state_mutability:"view"}]},{type:"constructor",name:"constructor",inputs:[{name:"execution_contract",type:"core::starknet::contract_address::ContractAddress"}]},{type:"event",name:"spv_swap_vault::events::Opened",kind:"struct",members:[{name:"btc_tx_hash",type:"core::integer::u256",kind:"key"},{name:"owner",type:"core::starknet::contract_address::ContractAddress",kind:"key"},{name:"vault_id",type:"core::felt252",kind:"key"},{name:"vout",type:"core::integer::u32",kind:"key"}]},{type:"event",name:"spv_swap_vault::events::Deposited",kind:"struct",members:[{name:"owner",type:"core::starknet::contract_address::ContractAddress",kind:"key"},{name:"vault_id",type:"core::felt252",kind:"key"},{name:"amounts",type:"(core::integer::u64, core::integer::u64)",kind:"data"},{name:"deposit_count",type:"core::integer::u32",kind:"data"}]},{type:"event",name:"spv_swap_vault::events::Claimed",kind:"struct",members:[{name:"btc_tx_hash",type:"core::integer::u256",kind:"key"},{name:"owner",type:"core::starknet::contract_address::ContractAddress",kind:"key"},{name:"vault_id",type:"core::felt252",kind:"key"},{name:"recipient",type:"core::starknet::contract_address::ContractAddress",kind:"key"},{name:"execution_hash",type:"core::felt252",kind:"key"},{name:"caller",type:"core::starknet::contract_address::ContractAddress",kind:"key"},{name:"amounts",type:"(core::integer::u64, core::integer::u64)",kind:"data"},{name:"withdraw_count",type:"core::integer::u32",kind:"data"},{name:"fronting_address",type:"core::starknet::contract_address::ContractAddress",kind:"data"}]},{type:"event",name:"spv_swap_vault::events::Fronted",kind:"struct",members:[{name:"btc_tx_hash",type:"core::integer::u256",kind:"key"},{name:"owner",type:"core::starknet::contract_address::ContractAddress",kind:"key"},{name:"vault_id",type:"core::felt252",kind:"key"},{name:"recipient",type:"core::starknet::contract_address::ContractAddress",kind:"key"},{name:"execution_hash",type:"core::felt252",kind:"key"},{name:"caller",type:"core::starknet::contract_address::ContractAddress",kind:"key"},{name:"amounts",type:"(core::integer::u64, core::integer::u64)",kind:"data"}]},{type:"event",name:"spv_swap_vault::events::Closed",kind:"struct",members:[{name:"btc_tx_hash",type:"core::integer::u256",kind:"key"},{name:"owner",type:"core::starknet::contract_address::ContractAddress",kind:"key"},{name:"vault_id",type:"core::felt252",kind:"key"},{name:"error",type:"core::felt252",kind:"data"}]},{type:"event",name:"spv_swap_vault::SpvVaultManager::Event",kind:"enum",variants:[{name:"Opened",type:"spv_swap_vault::events::Opened",kind:"nested"},{name:"Deposited",type:"spv_swap_vault::events::Deposited",kind:"nested"},{name:"Claimed",type:"spv_swap_vault::events::Claimed",kind:"nested"},{name:"Fronted",type:"spv_swap_vault::events::Fronted",kind:"nested"},{name:"Closed",type:"spv_swap_vault::events::Closed",kind:"nested"}]}]},12538,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetSpvWithdrawalData=void 0;let d=a.r(163846),e=a.r(500874),f=a.r(877475),g=a.r(461392),h=a.r(982711);class i extends d.SpvWithdrawalTransactionData{fromOpReturnData(a){return h.StarknetSpvVaultContract.fromOpReturnData(a)}isRecipient(a){return this.getRecipient().toLowerCase()===a.toLowerCase()}getTxHash(){return BigInt("0x"+e.Buffer.from(this.btcTx.txid,"hex").reverse().toString("hex"))}getFrontingAmount(){return[this.rawAmounts[0]+this.getExecutionFee()[0],this.rawAmounts[1]]}serialize(){return{type:"STARKNET",...super.serialize()}}serializeToStruct(){let a=this.getCallerFee(),b=this.getFrontingFee(),c=this.getExecutionFee();return{recipient:this.recipient,amount:f.cairo.tuple(this.rawAmounts[0],this.rawAmounts[1]),caller_fee:f.cairo.tuple(a[0],a[1]),fronting_fee:f.cairo.tuple(b[0],b[1]),execution_handler_fee_amount_0:c[0],execution_hash:(0,g.toBigInt)(this.executionHash)??0n,execution_expiry:BigInt(this.executionExpiry)}}serializeToFelts(){let a=this.getCallerFee(),b=this.getFrontingFee(),c=this.getExecutionFee();return[this.recipient,this.rawAmounts[0],this.rawAmounts[1],a[0],a[1],b[0],b[1],c[0],(0,g.toBigInt)(this.executionHash)??0n,BigInt(this.executionExpiry)]}}c.StarknetSpvWithdrawalData=i,d.SpvWithdrawalTransactionData.deserializers.STARKNET=i},393476,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetSpvVaultData=void 0;let d=a.r(163846),e=a.r(461392),f=a.r(500874),g=a.r(12538);class h extends d.SpvVaultData{constructor(a,b,c,d){if(super(),"string"==typeof a){this.owner=a,this.vaultId=b,this.relayContract=(0,e.toHex)(c.relay_contract),this.token0={token:(0,e.toHex)(c.token_0),multiplier:(0,e.toBigInt)(c.token_0_multiplier),rawAmount:(0,e.toBigInt)(c.token_0_amount)},this.token1={token:(0,e.toHex)(c.token_1),multiplier:(0,e.toBigInt)(c.token_1_multiplier),rawAmount:(0,e.toBigInt)(c.token_1_amount)};let g=f.Buffer.from((0,e.toBigInt)(c.utxo["0"]).toString(16).padStart(64,"0"),"hex"),h=(0,e.toBigInt)(c.utxo["1"]);this.utxo=g.reverse().toString("hex")+":"+h.toString(10),this.confirmations=Number((0,e.toBigInt)(c.confirmations)),this.withdrawCount=Number((0,e.toBigInt)(c.withdraw_count)),this.depositCount=Number((0,e.toBigInt)(c.deposit_count)),this.initialUtxo=d}else this.owner=a.owner,this.vaultId=BigInt(a.vaultId),this.relayContract=a.relayContract,this.token0={token:a.token0.token,multiplier:BigInt(a.token0.multiplier),rawAmount:BigInt(a.token0.rawAmount)},this.token1={token:a.token1.token,multiplier:BigInt(a.token1.multiplier),rawAmount:BigInt(a.token1.rawAmount)},this.utxo=a.utxo,this.confirmations=a.confirmations,this.withdrawCount=a.withdrawCount,this.depositCount=a.depositCount,this.initialUtxo=a.initialUtxo}getBalances(){return[{...this.token0,scaledAmount:this.token0.rawAmount*this.token0.multiplier},{...this.token1,scaledAmount:this.token1.rawAmount*this.token1.multiplier}]}getConfirmations(){return this.confirmations}getOwner(){return this.owner}getTokenData(){return[this.token0,this.token1]}getUtxo(){return this.isOpened()?this.utxo:this.initialUtxo}getVaultId(){return this.vaultId}getWithdrawalCount(){return this.withdrawCount}isOpened(){return"0000000000000000000000000000000000000000000000000000000000000000:0"!==this.utxo}serialize(){return{type:"STARKNET",owner:this.owner,vaultId:this.vaultId.toString(10),relayContract:this.relayContract,token0:{token:this.token0.token,multiplier:this.token0.multiplier.toString(10),rawAmount:this.token0.rawAmount.toString(10)},token1:{token:this.token1.token,multiplier:this.token1.multiplier.toString(10),rawAmount:this.token1.rawAmount.toString(10)},utxo:this.utxo,confirmations:this.confirmations,withdrawCount:this.withdrawCount,depositCount:this.depositCount,initialUtxo:this.initialUtxo}}updateState(a){if(a instanceof d.SpvVaultClaimEvent){if(a.withdrawCount<=this.withdrawCount)return;this.token0.rawAmount-=a.amounts[0],this.token1.rawAmount-=a.amounts[1],this.withdrawCount=a.withdrawCount,this.utxo=a.btcTxId+":0"}if(a instanceof d.SpvVaultCloseEvent&&(this.token0.rawAmount=0n,this.token1.rawAmount=0n,this.utxo="0000000000000000000000000000000000000000000000000000000000000000:0"),a instanceof d.SpvVaultOpenEvent){if(this.isOpened())return;this.utxo=a.btcTxId+":"+a.vout}if(a instanceof d.SpvVaultDepositEvent){if(a.depositCount<=this.depositCount)return;this.token0.rawAmount+=a.amounts[0],this.token1.rawAmount+=a.amounts[1],this.depositCount=a.depositCount}if(a instanceof g.StarknetSpvWithdrawalData){if(a.getSpentVaultUtxo()!==this.utxo)return;let b=a.getTotalOutput();this.token0.rawAmount-=b[0],this.token1.rawAmount-=b[1],this.withdrawCount++,this.utxo=a.btcTx.txid+":0"}}getDepositCount(){return this.depositCount}}c.StarknetSpvVaultData=h,d.SpvVaultData.deserializers.STARKNET=h},982711,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetSpvVaultContract=void 0;let d=a.r(163846),e=a.r(500874),f=a.r(562857),g=a.r(385410),h=a.r(877475),i=a.r(286962),j=a.r(202529),k=a.r(393476),l=a.r(12538),m=a.r(461392),n=a.r(571690),o=a.r(187245),p={[h.constants.StarknetChainId.SN_SEPOLIA]:"0x02d581ea838cd5ca46ba08660eddd064d50a0392f618e95310432147928d572e",[h.constants.StarknetChainId.SN_MAIN]:"0x01932042992647771f3d0aa6ee526e65359c891fe05a285faaf4d3ffa373e132"},q=2n**251n+17n*2n**192n+1n;class r extends f.StarknetContractBase{constructor(a,b,c,d=p[a.starknetChainId]){super(a,d,j.SpvVaultContractAbi),this.chainId="STARKNET",this.claimTimeout=180,this.maxClaimsPerTx=10,this.logger=(0,m.getLogger)("StarknetSpvVaultContract: "),this.btcRelay=b,this.bitcoinRpc=c}Open(a,b){let{txHash:c,vout:d}=function(a){let[b,c]=a.split(":");return{txHash:BigInt("0x"+e.Buffer.from(b,"hex").reverse().toString("hex")),vout:BigInt(c)}}(b.getUtxo()),f=b.getTokenData();if(2!==f.length)throw Error("Must specify exactly 2 tokens for vault!");return new i.StarknetAction(a,this.Chain,this.contract.populateTransaction.open(b.getVaultId(),this.btcRelay.contract.address,h.cairo.tuple(h.cairo.uint256(c),d),b.getConfirmations(),f[0].token,f[1].token,f[0].multiplier,f[1].multiplier),r.GasCosts.OPEN)}Deposit(a,b,c){return new i.StarknetAction(a,this.Chain,this.contract.populateTransaction.deposit(b.getOwner(),b.getVaultId(),c[0],c[1]??0n),r.GasCosts.DEPOSIT)}Front(a,b,c,d){return new i.StarknetAction(a,this.Chain,this.contract.populateTransaction.front(b.getOwner(),b.getVaultId(),BigInt(d),c.getTxHash(),c.serializeToStruct()),r.GasCosts.FRONT)}Claim(a,b,c,d,f,g){return new i.StarknetAction(a,this.Chain,{contractAddress:this.contract.address,entrypoint:"claim",calldata:[b.getOwner(),b.getVaultId(),...(0,m.bufferToByteArray)(e.Buffer.from(c.btcTx.hex,"hex")),...d.serialize(),f.length,...f.map(m.bufferToU32Array).flat(),g].map(a=>(0,m.toHex)(a,0))},r.GasCosts.CLAIM)}async checkWithdrawalTx(a){if(null==await this.Chain.provider.callContract({contractAddress:this.contract.address,entrypoint:"parse_bitcoin_tx",calldata:(0,m.bufferToByteArray)(e.Buffer.from(a.btcTx.hex,"hex"))}))throw Error("Failed to parse transaction!")}createVaultData(a,b,c,d,e){if(2!==e.length)throw Error("Must specify 2 tokens in tokenData!");return Promise.resolve(new k.StarknetSpvVaultData(a,b,{relay_contract:this.btcRelay.contract.address,token_0:e[0].token,token_1:e[1].token,token_0_multiplier:e[0].multiplier,token_1_multiplier:e[1].multiplier,utxo:h.cairo.tuple(h.cairo.uint256(0),0),confirmations:d,withdraw_count:0,deposit_count:0,token_0_amount:0n,token_1_amount:0n},c))}async getVaultData(a,b){let c=await this.contract.get_vault(a,b);return(0,m.toHex)(c.relay_contract)!==(0,m.toHex)(this.btcRelay.contract.address)?null:new k.StarknetSpvVaultData(a,b,c)}async getAllVaults(a){let b=new Set;await this.Events.findInContractEventsForward(["spv_swap_vault::events::Opened","spv_swap_vault::events::Closed"],null==a?null:[null,a],a=>{let c=(0,m.toHex)(a.params.owner)+":"+(0,m.toBigInt)(a.params.vault_id).toString(10);return"spv_swap_vault::events::Opened"===a.name?b.add(c):b.delete(c),null});let c=[];for(let a of b.keys()){let[b,d]=a.split(":"),e=await this.getVaultData(b,BigInt(d));null!=e&&c.push(e)}return c}async getWithdrawalState(a){let b=e.Buffer.from(a,"hex").reverse(),c=h.cairo.uint256("0x"+b.toString("hex")),f={type:d.SpvWithdrawalStateType.NOT_FOUND};return await this.Events.findInContractEventsForward(["spv_swap_vault::events::Fronted","spv_swap_vault::events::Claimed","spv_swap_vault::events::Closed"],[(0,m.toHex)(c.low),(0,m.toHex)(c.high)],async a=>{switch(a.name){case"spv_swap_vault::events::Fronted":f={type:d.SpvWithdrawalStateType.FRONTED,txId:a.txHash,owner:(0,m.toHex)(a.params.owner),vaultId:(0,m.toBigInt)(a.params.vault_id),recipient:(0,m.toHex)(a.params.recipient),fronter:(0,m.toHex)(a.params.fronting_address)};break;case"spv_swap_vault::events::Claimed":f={type:d.SpvWithdrawalStateType.CLAIMED,txId:a.txHash,owner:(0,m.toHex)(a.params.owner),vaultId:(0,m.toBigInt)(a.params.vault_id),recipient:(0,m.toHex)(a.params.recipient),claimer:(0,m.toHex)(a.params.caller),fronter:(0,m.toHex)(a.params.fronting_address)};break;case"spv_swap_vault::events::Closed":f={type:d.SpvWithdrawalStateType.CLOSED,txId:a.txHash,owner:(0,m.toHex)(a.params.owner),vaultId:(0,m.toBigInt)(a.params.vault_id),error:(0,m.bigNumberishToBuffer)(a.params.error).toString()}}}),f}getWithdrawalData(a){return Promise.resolve(new l.StarknetSpvWithdrawalData(a))}fromOpReturnData(a){return r.fromOpReturnData(a)}static fromOpReturnData(a){let b=0n,c=0n,d=null;if(40===a.length)b=a.readBigInt64LE(32).valueOf();else if(48===a.length)b=a.readBigInt64LE(32).valueOf(),c=a.readBigInt64LE(40).valueOf();else if(72===a.length)b=a.readBigInt64LE(32).valueOf(),d=a.slice(40,72).toString("hex");else if(80===a.length)b=a.readBigInt64LE(32).valueOf(),c=a.readBigInt64LE(40).valueOf(),d=a.slice(48,80).toString("hex");else throw Error("Invalid OP_RETURN data length!");if(null!=d&&BigInt("0x"+d)>=q)throw Error("Execution hash not in range of starknet prime");let e="0x"+a.slice(0,32).toString("hex");if(!n.StarknetAddresses.isValidAddress(e))throw Error("Invalid recipient specified");return{executionHash:d,rawAmounts:[b,c],recipient:e}}toOpReturnData(a,b,c){return r.toOpReturnData(a,b,c)}static toOpReturnData(a,b,c){if(!n.StarknetAddresses.isValidAddress(a))throw Error("Invalid recipient specified");if(b.length<1)throw Error("At least 1 amount needs to be specified");if(b.length>2)throw Error("At most 2 amounts need to be specified");if(b.forEach(a=>{if(a<0n)throw Error("Negative raw amount specified");if(a>=2n**64n)throw Error("Raw amount overflow")}),null!=c){let a=(0,m.toBigInt)(c);if(a<0n)throw Error("Execution hash negative");if(a>=q)throw Error("Execution hash not in range of starknet prime")}let d=e.Buffer.from(a.substring(2).padStart(64,"0"),"hex"),f=e.Buffer.from(b[0].toString(16).padStart(16,"0"),"hex"),g=null==b[1]||0n===b[1]?e.Buffer.alloc(0):e.Buffer.from(b[1].toString(16).padStart(16,"0"),"hex"),h=null==c?e.Buffer.alloc(0):e.Buffer.from(c.substring(2).padStart(64,"0"),"hex");return e.Buffer.concat([d,f.reverse(),g.reverse(),h])}async claim(a,b,c,d,e,f){let g=await this.txsClaim(a.getAddress(),b,c,d,e,f?.feeRate),[h]=await this.Chain.sendAndConfirm(a,g,f?.waitForConfirmation,f?.abortSignal);return h}async deposit(a,b,c,d){let e=await this.txsDeposit(a.getAddress(),b,c,d?.feeRate),[f]=await this.Chain.sendAndConfirm(a,e,d?.waitForConfirmation,d?.abortSignal);return f}async frontLiquidity(a,b,c,d,e){let f=await this.txsFrontLiquidity(a.getAddress(),b,c,d,e?.feeRate),[g]=await this.Chain.sendAndConfirm(a,f,e?.waitForConfirmation,e?.abortSignal);return g}async open(a,b,c){let d=await this.txsOpen(a.getAddress(),b,c?.feeRate),[e]=await this.Chain.sendAndConfirm(a,d,c?.waitForConfirmation,c?.abortSignal);return e}async txsClaim(a,b,c,d,e,f){if(!b.isOpened())throw Error("Cannot claim from a closed vault!");f??(f=await this.Chain.Fees.getFeeRate());let h=[];for(let a of c){let b=await this.bitcoinRpc.getMerkleProof(a.tx.btcTx.txid,a.tx.btcTx.blockhash);this.logger.debug("txsClaim(): merkle proof computed: ",b),h.push({...b,...a})}let j=[],k=await g.StarknetBtcRelay.getCommitedHeadersAndSynchronize(a,this.btcRelay,h.filter(a=>null==a.storedHeader).map(a=>({blockhash:a.tx.btcTx.blockhash,blockheight:a.blockheight,requiredConfirmations:b.getConfirmations()})),j,d,f);if(null==k)throw Error("Cannot fetch committed header!");let l=h.map(c=>this.Claim(a,b,c.tx,c.storedHeader??k[c.tx.btcTx.blockhash],c.merkle,c.pos)),m=new i.StarknetAction(a,this.Chain);for(let b of l)m.add(b),m.ixsLength()>=this.maxClaimsPerTx&&(await m.addToTxs(j,f),m=new i.StarknetAction(a,this.Chain));return m.ixsLength()>0&&await m.addToTxs(j,f),this.logger.debug("txsClaim(): "+j.length+" claim TXs created claiming "+c.length+" txs, owner: "+b.getOwner()+" vaultId: "+b.getVaultId().toString(10)),j}async txsDeposit(a,b,c,d){if(!b.isOpened())throw Error("Cannot deposit to a closed vault!");let e=b.getTokenData(),f=new i.StarknetAction(a,this.Chain),g=0n,h=0n;return null!=c[0]&&0n!==c[0]&&(g=c[0]*e[0].multiplier,f.add(this.Chain.Tokens.Approve(a,this.contract.address,e[0].token,g))),null!=c[1]&&0n!==c[1]&&(h=c[1]*e[1].multiplier,f.add(this.Chain.Tokens.Approve(a,this.contract.address,e[1].token,h))),f.add(this.Deposit(a,b,c)),d??(d=await this.Chain.Fees.getFeeRate()),this.logger.debug("txsDeposit(): deposit TX created, token0: "+e[0].token+" rawAmount0: "+c[0].toString(10)+" amount0: "+g.toString(10)+" token1: "+e[1].token+" rawAmount1: "+(c[1]??0n).toString(10)+" amount1: "+h.toString(10)),[await f.tx(d)]}async txsFrontLiquidity(a,b,c,d,e){if(!b.isOpened())throw Error("Cannot front on a closed vault!");let f=b.getTokenData(),g=new i.StarknetAction(a,this.Chain),h=c.getFrontingAmount(),j=0n,k=0n;return null!=h[0]&&0n!==h[0]&&(j=h[0]*f[0].multiplier,g.add(this.Chain.Tokens.Approve(a,this.contract.address,f[0].token,j))),null!=h[1]&&0n!==h[1]&&(k=h[1]*f[1].multiplier,g.add(this.Chain.Tokens.Approve(a,this.contract.address,f[1].token,k))),g.add(this.Front(a,b,c,d)),e??(e=await this.Chain.Fees.getFeeRate()),this.logger.debug("txsFrontLiquidity(): front TX created, token0: "+f[0].token+" rawAmount0: "+h[0].toString(10)+" amount0: "+j.toString(10)+" token1: "+f[1].token+" rawAmount1: "+(h[1]??0n).toString(10)+" amount1: "+k.toString(10)),[await g.tx(e)]}async txsOpen(a,b,c){if(b.isOpened())throw Error("Cannot open an already opened vault!");let d=this.Open(a,b);return c??(c=await this.Chain.Fees.getFeeRate()),this.logger.debug("txsOpen(): open TX created, owner: "+b.getOwner()+" vaultId: "+b.getVaultId().toString(10)),[await d.tx(c)]}async getClaimFee(a,b,c){return c??(c=await this.Chain.Fees.getFeeRate()),o.StarknetFees.getGasFee(null==b?r.GasCosts.CLAIM_OPTIMISTIC_ESTIMATE:r.GasCosts.CLAIM,c)}async getFrontFee(a,b,c){return c??(c=await this.Chain.Fees.getFeeRate()),o.StarknetFees.getGasFee(r.GasCosts.FRONT,c)}}c.StarknetSpvVaultContract=r,r.GasCosts={DEPOSIT:{l1DataGas:400,l2Gas:4e6,l1Gas:0},OPEN:{l1DataGas:1200,l2Gas:32e5,l1Gas:0},FRONT:{l1DataGas:800,l2Gas:12e6,l1Gas:0},CLAIM:{l1DataGas:1e3,l2Gas:4e8,l1Gas:0},CLAIM_OPTIMISTIC_ESTIMATE:{l1DataGas:1e3,l2Gas:8e7,l1Gas:0}}},960913,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.RpcProviderWithRetries=c.RpcChannelWithRetries=void 0;let d=a.r(877475),e=a.r(461392);class f extends d.RpcChannel{constructor(a,b){super(a),this.retryPolicy=b}fetchEndpoint(a,b){return(0,e.tryWithRetries)(()=>super.fetchEndpoint(a,b),this.retryPolicy,a=>{if(!a.message.startsWith("RPC: "))return!1;let b=a.message.split("\n"),c=parseInt(b[b.length-1]);return!isNaN(c)&&!(c<0)})}}c.RpcChannelWithRetries=f;class g extends d.RpcProvider{constructor(a,b){super(a),this.channel=new f({...a,waitMode:!1},b)}}c.RpcProviderWithRetries=g},236626,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StarknetInitializer=c.initializeStarknet=c.StarknetAssets=void 0;let d=a.r(877475),e=a.r(187245),f=a.r(406299),g=a.r(385410),h=a.r(531679),i=a.r(6127),j=a.r(163846),k=a.r(593507),l=a.r(982711),m=a.r(393476),n=a.r(12538),o=a.r(960913);function p(a,b,c){let p="string"==typeof a.rpcUrl?new o.RpcProviderWithRetries({nodeUrl:a.rpcUrl}):a.rpcUrl,q=a.fees??new e.StarknetFees(p),r=a.chainId??(c===j.BitcoinNetwork.MAINNET?d.constants.StarknetChainId.SN_MAIN:d.constants.StarknetChainId.SN_SEPOLIA),s=new f.StarknetChainInterface(r,p,a.retryPolicy,q),t=new g.StarknetBtcRelay(s,b,c,a.btcRelayContract),u=new h.StarknetSwapContract(s,t,a.swapContract,a.handlerContracts),v=new l.StarknetSpvVaultContract(s,t,b,a.spvVaultContract),w=new i.StarknetChainEventsBrowser(s,u,v);return{chainId:"STARKNET",btcRelay:t,chainInterface:s,swapContract:u,chainEvents:w,swapDataConstructor:k.StarknetSwapData,spvVaultContract:v,spvVaultDataConstructor:m.StarknetSpvVaultData,spvVaultWithdrawalDataConstructor:n.StarknetSpvWithdrawalData}}c.StarknetAssets={ETH:{address:"0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7",decimals:18,displayDecimals:9},STRK:{address:"0x04718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d",decimals:18,displayDecimals:9},WBTC:{address:"0x03fe2b97c1fd336e750087d68b9b867997fd64a2661ff3ca5a7c771641e8e7ac",decimals:8},TBTC:{address:"0x04daa17763b286d1e59b97c283C0b8C949994C361e426A28F743c67bDfE9a32f",decimals:18,displayDecimals:8},_TESTNET_WBTC_VESU:{address:"0x04861ba938aed21f2cd7740acd3765ac4d2974783a3218367233de0153490cb6",decimals:8}},c.initializeStarknet=p,c.StarknetInitializer={chainId:"STARKNET",chainType:null,initializer:p,tokens:c.StarknetAssets,options:null}},858319,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),e(a.r(286962),c),e(a.r(406299),c),e(a.r(816953),c),e(a.r(187245),c),e(a.r(217402),c),e(a.r(94067),c),e(a.r(571690),c),e(a.r(998647),c),e(a.r(781274),c),e(a.r(612579),c),e(a.r(671949),c),e(a.r(385410),c),e(a.r(235445),c),e(a.r(562857),c),e(a.r(531679),c),e(a.r(593507),c),e(a.r(943810),c),e(a.r(634890),c),e(a.r(773154),c),e(a.r(664211),c),e(a.r(904440),c),e(a.r(844912),c),e(a.r(280002),c),e(a.r(745422),c),e(a.r(804707),c),e(a.r(544985),c),e(a.r(989962),c),e(a.r(621915),c),e(a.r(935930),c),e(a.r(6127),c),e(a.r(196032),c),e(a.r(496368),c),e(a.r(575196),c),e(a.r(236626),c),e(a.r(982711),c),e(a.r(393476),c),e(a.r(12538),c),e(a.r(960913),c)},140707,a=>{"use strict";a.s(["getSharedSwapAccount",()=>i,"getSharedSwapAccountRaw",()=>k,"getSharedSwapAddress",()=>m,"getSharedSwapProvider",()=>j,"transferStrkFromShared",()=>n,"validateSharedSwapSigner",()=>l]);var b=a.i(313535),c=a.i(858319),d=a.i(805428),e=a.i(140678);let f=null,g=null,h=null;function i(){if(g)return g;if(!e.ENV.SHARED_SWAP_ACCOUNT_PRIVATE_KEY)return null;let a=(e.ENV.SHARED_SWAP_ACCOUNT_ADDRESS||d.SHARED_SWAP_ACCOUNT_ADDRESS).toLowerCase(),i=new b.RpcProvider({nodeUrl:(0,e.getStarknetRpc)()});h=i;try{let d=e.ENV.SHARED_SWAP_ACCOUNT_PRIVATE_KEY.startsWith("0x")?e.ENV.SHARED_SWAP_ACCOUNT_PRIVATE_KEY:"0x"+e.ENV.SHARED_SWAP_ACCOUNT_PRIVATE_KEY;/^0x[0-9a-fA-F]{64}$/.test(d)||console.warn("Shared swap account private key format unexpected");try{let a=b.ec.starkCurve.getStarkKey(d);console.log(" Shared swap account loaded (pubkey prefix):",a.slice(0,10)+"...")}catch(a){console.warn("Could not derive public key for shared swap account:",a)}return f=new b.Account(i,a,d),g=new c.StarknetSigner(f)}catch(a){return console.error("Failed to instantiate shared swap account:",a),null}}function j(){return h}function k(){return g||i(),f}async function l(){try{let a=i(),b=k(),c=h;if(!a||!b||!c)return{ok:!1,reason:"Shared swap signer not configured (missing env or provider)"};try{let a=await b.getNonce();return console.log(" Shared swap account validation OK",{address:b.address,nonce:a?.toString?.()||String(a)}),{ok:!0,address:b.address}}catch(a){return console.warn(" Shared swap account nonce check failed",{address:b.address,error:a instanceof Error?a.message:String(a)}),{ok:!1,reason:"Account nonce fetch failed (address may be wrong or not deployed)",address:b.address}}}catch(a){return{ok:!1,reason:a instanceof Error?a.message:String(a)}}}function m(){return g||i(),f?.address||null}async function n(a,c){let e=k();if(!e)throw Error("Shared swap account not configured");let f={contractAddress:d.PRIVACY_MIXER.STRK_TOKEN,entrypoint:"transfer",calldata:b.CallData.compile([a,b.cairo.uint256(c)])},g=await e.execute([f]),h=g.transaction_hash||g.hash||"unknown_tx";return console.log(" Shared STRK forward transfer submitted:",{to:a,amountWei:c.toString(),txHash:h}),h}}];

//# sourceMappingURL=_704347bf._.js.map
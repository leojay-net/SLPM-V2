{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/src/components/mixer/cross-chain/CrossChainQuote.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport {\n    ArrowsRightLeftIcon,\n    ArrowPathIcon,\n    CheckCircleIcon,\n    ExclamationTriangleIcon,\n    InformationCircleIcon,\n} from '@heroicons/react/24/outline';\n\ninterface QuoteLeg {\n    rate: number;\n    fee: number;\n}\n\ninterface CrossChainQuoteData {\n    inputAmount: number;\n    inputCurrency: 'ZEC' | 'STRK';\n    lightningAmount: number;\n    outputAmount: number;\n    outputCurrency: 'ZEC' | 'STRK';\n    totalFeePercent: number;\n    legs: {\n        first: QuoteLeg;\n        second: QuoteLeg;\n    };\n    expiresAt: number;\n}\n\ninterface CrossChainQuoteProps {\n    direction: 'zec-to-strk' | 'strk-to-zec';\n    amount: number;\n    onQuoteReady?: (quote: CrossChainQuoteData | null) => void;\n    className?: string;\n}\n\nexport function CrossChainQuote({ direction, amount, onQuoteReady, className = '' }: CrossChainQuoteProps) {\n    const [quote, setQuote] = useState<CrossChainQuoteData | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n    const [countdown, setCountdown] = useState<number>(0);\n\n    const fetchQuote = useCallback(async () => {\n        if (amount <= 0) {\n            setQuote(null);\n            setError(null);\n            onQuoteReady?.(null);\n            return;\n        }\n\n        setLoading(true);\n        setError(null);\n\n        try {\n            const isZecToStrk = direction === 'zec-to-strk';\n\n            let inputAmount: number;\n            let lightningAmount: number;\n            let outputAmount: number;\n            let inputCurrency: 'ZEC' | 'STRK';\n            let outputCurrency: 'ZEC' | 'STRK';\n            let firstLegRate: number;\n            let secondLegRate: number;\n            let firstLegFee: number;\n            let secondLegFee: number;\n\n            if (isZecToStrk) {\n                // ZEC → Lightning (FixedFloat) → STRK (Atomiq)\n                inputAmount = amount;\n                inputCurrency = 'ZEC';\n                outputCurrency = 'STRK';\n\n                // Get real FixedFloat quote for ZEC → Lightning\n                const ffResponse = await fetch('/api/fixedfloat', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                        endpoint: '/price',\n                        data: {\n                            fromCcy: 'ZEC',\n                            toCcy: 'BTCLN',\n                            amount: amount.toString(),\n                            direction: 'from',\n                            type: 'float'\n                        }\n                    })\n                });\n                const ffResult = await ffResponse.json();\n\n                if (ffResult.code !== 0) {\n                    throw new Error(ffResult.msg || 'Failed to get ZEC quote');\n                }\n\n                const btcAmount = parseFloat(ffResult.data.to.amount);\n                lightningAmount = Math.floor(btcAmount * 100000000); // sats\n                firstLegRate = parseFloat(ffResult.data.from.rate);\n                firstLegFee = 1.5; // FixedFloat ~1.5% fee\n\n                // Estimate STRK output (Atomiq rate ~125 sats per STRK)\n                const satsPerStrk = 125; // TODO: Get real Atomiq quote\n                outputAmount = lightningAmount / satsPerStrk;\n                secondLegRate = 1 / satsPerStrk;\n                secondLegFee = 1.0; // Atomiq ~1% fee\n\n            } else {\n                // STRK → Lightning (Atomiq) → ZEC (FixedFloat)\n                inputAmount = amount;\n                inputCurrency = 'STRK';\n                outputCurrency = 'ZEC';\n\n                // Estimate Lightning amount from STRK (Atomiq rate)\n                const satsPerStrk = 125; // TODO: Get real Atomiq quote\n                lightningAmount = Math.floor(amount * satsPerStrk);\n                firstLegRate = satsPerStrk / 100000000;\n                firstLegFee = 1.0; // Atomiq ~1% fee\n\n                // Get real FixedFloat quote for Lightning → ZEC\n                const btcAmount = lightningAmount / 100000000;\n                const ffResponse = await fetch('/api/fixedfloat', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                        endpoint: '/price',\n                        data: {\n                            fromCcy: 'BTCLN',\n                            toCcy: 'ZEC',\n                            amount: btcAmount.toString(),\n                            direction: 'from',\n                            type: 'float'\n                        }\n                    })\n                });\n                const ffResult = await ffResponse.json();\n\n                if (ffResult.code !== 0) {\n                    throw new Error(ffResult.msg || 'Failed to get ZEC quote');\n                }\n\n                outputAmount = parseFloat(ffResult.data.to.amount);\n                secondLegRate = parseFloat(ffResult.data.from.rate);\n                secondLegFee = 1.5; // FixedFloat ~1.5% fee\n            }\n\n            const quoteData: CrossChainQuoteData = {\n                inputAmount,\n                inputCurrency,\n                lightningAmount,\n                outputAmount,\n                outputCurrency,\n                totalFeePercent: firstLegFee + secondLegFee,\n                legs: {\n                    first: { rate: firstLegRate, fee: firstLegFee },\n                    second: { rate: secondLegRate, fee: secondLegFee },\n                },\n                expiresAt: Date.now() + 60000, // 1 minute expiry\n            };\n\n            setQuote(quoteData);\n            setCountdown(60);\n            onQuoteReady?.(quoteData);\n        } catch (err) {\n            const message = err instanceof Error ? err.message : 'Failed to fetch quote';\n            setError(message);\n            setQuote(null);\n            onQuoteReady?.(null);\n        } finally {\n            setLoading(false);\n        }\n    }, [amount, direction, onQuoteReady]);\n\n    // Fetch quote when amount changes\n    useEffect(() => {\n        const debounce = setTimeout(fetchQuote, 500);\n        return () => clearTimeout(debounce);\n    }, [fetchQuote]);\n\n    // Countdown timer\n    useEffect(() => {\n        if (countdown <= 0) return;\n        const timer = setInterval(() => {\n            setCountdown((prev) => {\n                if (prev <= 1) {\n                    fetchQuote(); // Refresh quote\n                    return 0;\n                }\n                return prev - 1;\n            });\n        }, 1000);\n        return () => clearInterval(timer);\n    }, [countdown, fetchQuote]);\n\n    const formatNumber = (num: number, decimals: number = 4) => {\n        return num.toLocaleString(undefined, {\n            minimumFractionDigits: 2,\n            maximumFractionDigits: decimals\n        });\n    };\n\n    const formatSats = (sats: number) => {\n        if (sats >= 1000000) return `${(sats / 1000000).toFixed(2)}M`;\n        if (sats >= 1000) return `${(sats / 1000).toFixed(1)}k`;\n        return sats.toString();\n    };\n\n    if (!amount || amount <= 0) {\n        return (\n            <div className={`bg-gray-800/50 border border-gray-700 rounded-xl p-6 ${className}`}>\n                <div className=\"flex items-center justify-center text-gray-500 py-8\">\n                    <InformationCircleIcon className=\"w-5 h-5 mr-2\" />\n                    <span>Enter an amount to see quote</span>\n                </div>\n            </div>\n        );\n    }\n\n    if (loading) {\n        return (\n            <div className={`bg-gray-800/50 border border-gray-700 rounded-xl p-6 ${className}`}>\n                <div className=\"flex items-center justify-center py-8\">\n                    <ArrowPathIcon className=\"w-6 h-6 text-blue-400 animate-spin mr-3\" />\n                    <span className=\"text-gray-300\">Fetching best rate...</span>\n                </div>\n            </div>\n        );\n    }\n\n    if (error) {\n        return (\n            <div className={`bg-red-900/20 border border-red-800 rounded-xl p-6 ${className}`}>\n                <div className=\"flex items-center text-red-400\">\n                    <ExclamationTriangleIcon className=\"w-5 h-5 mr-2\" />\n                    <span>{error}</span>\n                </div>\n                <button\n                    onClick={fetchQuote}\n                    className=\"mt-4 text-sm text-blue-400 hover:text-blue-300 underline\"\n                >\n                    Try again\n                </button>\n            </div>\n        );\n    }\n\n    if (!quote) return null;\n\n    return (\n        <div className={`bg-gray-800/50 border border-gray-700 rounded-xl overflow-hidden ${className}`}>\n            {/* Header */}\n            <div className=\"px-6 py-4 border-b border-gray-700 flex items-center justify-between\">\n                <div className=\"flex items-center space-x-2\">\n                    <ArrowsRightLeftIcon className=\"w-5 h-5 text-blue-400\" />\n                    <span className=\"font-medium text-white\">Quote</span>\n                </div>\n                <div className=\"flex items-center space-x-2 text-sm text-gray-400\">\n                    <span>Refreshing in {countdown}s</span>\n                    <button\n                        onClick={fetchQuote}\n                        className=\"p-1 hover:bg-gray-700 rounded transition-colors\"\n                        title=\"Refresh quote\"\n                    >\n                        <ArrowPathIcon className=\"w-4 h-4\" />\n                    </button>\n                </div>\n            </div>\n\n            {/* Quote Details */}\n            <div className=\"p-6 space-y-4\">\n                {/* Conversion Summary */}\n                <div className=\"flex items-center justify-between py-4 px-5 bg-gray-900/50 rounded-lg\">\n                    <div className=\"text-center\">\n                        <div className=\"text-2xl font-bold text-white\">\n                            {formatNumber(quote.inputAmount, 6)}\n                        </div>\n                        <div className=\"text-sm text-gray-400 mt-1\">{quote.inputCurrency}</div>\n                    </div>\n                    <div className=\"flex flex-col items-center px-4\">\n                        <ArrowsRightLeftIcon className=\"w-6 h-6 text-gray-500\" />\n                        <span className=\"text-xs text-gray-500 mt-1\">{formatSats(quote.lightningAmount)} sats</span>\n                    </div>\n                    <div className=\"text-center\">\n                        <div className=\"text-2xl font-bold text-green-400\">\n                            {formatNumber(quote.outputAmount, 6)}\n                        </div>\n                        <div className=\"text-sm text-gray-400 mt-1\">{quote.outputCurrency}</div>\n                    </div>\n                </div>\n\n                {/* Rate Details */}\n                <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                    <div className=\"p-3 bg-gray-900/30 rounded-lg\">\n                        <div className=\"text-gray-400 mb-1\">\n                            {direction === 'zec-to-strk' ? 'ZEC → Lightning' : 'STRK → Lightning'}\n                        </div>\n                        <div className=\"text-white font-medium\">\n                            Rate: {quote.legs.first.rate.toFixed(6)}\n                        </div>\n                        <div className=\"text-gray-500 text-xs\">\n                            Fee: ~{quote.legs.first.fee.toFixed(2)}%\n                        </div>\n                    </div>\n                    <div className=\"p-3 bg-gray-900/30 rounded-lg\">\n                        <div className=\"text-gray-400 mb-1\">\n                            {direction === 'zec-to-strk' ? 'Lightning → STRK' : 'Lightning → ZEC'}\n                        </div>\n                        <div className=\"text-white font-medium\">\n                            Rate: {quote.legs.second.rate.toFixed(6)}\n                        </div>\n                        <div className=\"text-gray-500 text-xs\">\n                            Fee: ~{quote.legs.second.fee.toFixed(2)}%\n                        </div>\n                    </div>\n                </div>\n\n                {/* Total Fee */}\n                <div className=\"flex items-center justify-between pt-2 border-t border-gray-700\">\n                    <span className=\"text-gray-400\">Total Estimated Fee</span>\n                    <span className=\"text-orange-400 font-medium\">~{quote.totalFeePercent.toFixed(2)}%</span>\n                </div>\n\n                {/* Effective Rate */}\n                <div className=\"flex items-center justify-between\">\n                    <span className=\"text-gray-400\">Effective Rate</span>\n                    <span className=\"text-white font-medium\">\n                        1 {quote.inputCurrency} = {formatNumber(quote.outputAmount / quote.inputAmount, 4)} {quote.outputCurrency}\n                    </span>\n                </div>\n            </div>\n\n            {/* Footer Notice */}\n            <div className=\"px-6 py-3 bg-gray-900/30 border-t border-gray-700\">\n                <div className=\"flex items-start space-x-2 text-xs text-gray-500\">\n                    <CheckCircleIcon className=\"w-4 h-4 text-green-500 flex-shrink-0 mt-0.5\" />\n                    <span>\n                        Quote includes all network fees. Final amount may vary slightly due to market conditions.\n                    </span>\n                </div>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 652, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/src/components/mixer/cross-chain/TransferStatusTracker.tsx"],"sourcesContent":["'use client';\n\nimport React from 'react';\nimport {\n    CheckCircleIcon,\n    ClockIcon,\n    ExclamationCircleIcon,\n    ArrowPathIcon,\n    BanknotesIcon,\n    BoltIcon,\n    WalletIcon,\n    ShieldCheckIcon,\n    DocumentDuplicateIcon,\n} from '@heroicons/react/24/outline';\nimport { CheckCircleIcon as CheckCircleSolidIcon } from '@heroicons/react/24/solid';\n\nexport interface TransferStep {\n    id: number;\n    name: string;\n    description: string;\n    status: 'pending' | 'in-progress' | 'complete' | 'failed' | 'skipped';\n    txId?: string;\n    error?: string;\n    data?: Record<string, unknown>;\n    startedAt?: number;\n    completedAt?: number;\n}\n\ninterface TransferStatusTrackerProps {\n    steps: TransferStep[];\n    currentStepIndex: number;\n    direction: 'zec-to-strk' | 'strk-to-zec';\n    depositAddress?: string;\n    depositAmount?: string;\n    className?: string;\n}\n\nconst stepIcons: Record<string, React.ComponentType<{ className?: string }>> = {\n    'atomiq-swap-create': BoltIcon,\n    'fixedfloat-order': ArrowPathIcon,\n    'zec-deposit': BanknotesIcon,\n    'lightning-payment': BoltIcon,\n    'strk-claim': WalletIcon,\n    'strk-to-lightning': BoltIcon,\n    'zec-delivery': BanknotesIcon,\n    'privacy-mixer': ShieldCheckIcon,\n    'cashu-flow': ShieldCheckIcon,\n};\n\nconst statusColors = {\n    pending: 'text-gray-500 border-gray-600 bg-gray-800',\n    'in-progress': 'text-blue-400 border-blue-500 bg-blue-500/10',\n    complete: 'text-green-400 border-green-500 bg-green-500/10',\n    failed: 'text-red-400 border-red-500 bg-red-500/10',\n    skipped: 'text-gray-500 border-gray-600 bg-gray-800/50',\n};\n\nconst statusIconColors = {\n    pending: 'text-gray-500',\n    'in-progress': 'text-blue-400',\n    complete: 'text-green-400',\n    failed: 'text-red-400',\n    skipped: 'text-gray-500',\n};\n\nexport function TransferStatusTracker({\n    steps,\n    currentStepIndex,\n    direction,\n    depositAddress,\n    depositAmount,\n    className = '',\n}: TransferStatusTrackerProps) {\n    const [copied, setCopied] = React.useState(false);\n\n    const copyToClipboard = async (text: string) => {\n        try {\n            await navigator.clipboard.writeText(text);\n            setCopied(true);\n            setTimeout(() => setCopied(false), 2000);\n        } catch (err) {\n            console.error('Failed to copy:', err);\n        }\n    };\n\n    const getStepIcon = (step: TransferStep) => {\n        const Icon = stepIcons[step.name] || ArrowPathIcon;\n        return Icon;\n    };\n\n    const getStatusIndicator = (step: TransferStep, index: number) => {\n        const isActive = index === currentStepIndex;\n\n        switch (step.status) {\n            case 'complete':\n                return (\n                    <CheckCircleSolidIcon className=\"w-5 h-5 text-green-400\" />\n                );\n            case 'in-progress':\n                return (\n                    <div className=\"relative\">\n                        <ArrowPathIcon className=\"w-5 h-5 text-blue-400 animate-spin\" />\n                        {isActive && (\n                            <span className=\"absolute -top-1 -right-1 w-2 h-2 bg-blue-400 rounded-full animate-pulse\" />\n                        )}\n                    </div>\n                );\n            case 'failed':\n                return (\n                    <ExclamationCircleIcon className=\"w-5 h-5 text-red-400\" />\n                );\n            case 'skipped':\n                return (\n                    <div className=\"w-5 h-5 rounded-full border-2 border-dashed border-gray-600\" />\n                );\n            default:\n                return (\n                    <ClockIcon className=\"w-5 h-5 text-gray-500\" />\n                );\n        }\n    };\n\n    const formatDuration = (startedAt?: number, completedAt?: number) => {\n        if (!startedAt) return null;\n        const end = completedAt || Date.now();\n        const seconds = Math.floor((end - startedAt) / 1000);\n        if (seconds < 60) return `${seconds}s`;\n        const minutes = Math.floor(seconds / 60);\n        return `${minutes}m ${seconds % 60}s`;\n    };\n\n    const completedSteps = steps.filter(s => s.status === 'complete').length;\n    const progressPercent = (completedSteps / steps.length) * 100;\n\n    return (\n        <div className={`bg-gray-800/50 border border-gray-700 rounded-xl overflow-hidden ${className}`}>\n            {/* Header with Progress */}\n            <div className=\"px-6 py-4 border-b border-gray-700\">\n                <div className=\"flex items-center justify-between mb-3\">\n                    <h3 className=\"font-medium text-white\">Transfer Progress</h3>\n                    <span className=\"text-sm text-gray-400\">\n                        {completedSteps} of {steps.length} steps\n                    </span>\n                </div>\n                <div className=\"h-1.5 bg-gray-700 rounded-full overflow-hidden\">\n                    <div\n                        className=\"h-full bg-gradient-to-r from-blue-500 to-green-500 rounded-full transition-all duration-500\"\n                        style={{ width: `${progressPercent}%` }}\n                    />\n                </div>\n            </div>\n\n            {/* Deposit Address Card (if applicable) */}\n            {depositAddress && direction === 'zec-to-strk' && currentStepIndex <= 2 && (\n                <div className=\"mx-6 mt-6 p-4 bg-orange-500/10 border border-orange-500/30 rounded-lg\">\n                    <div className=\"flex items-start justify-between\">\n                        <div>\n                            <div className=\"text-sm text-orange-400 font-medium mb-1\">\n                                Send {depositAmount} ZEC to:\n                            </div>\n                            <code className=\"text-xs text-white font-mono break-all\">\n                                {depositAddress}\n                            </code>\n                        </div>\n                        <button\n                            onClick={() => copyToClipboard(depositAddress)}\n                            className=\"p-2 hover:bg-orange-500/20 rounded-lg transition-colors flex-shrink-0\"\n                            title=\"Copy address\"\n                        >\n                            {copied ? (\n                                <CheckCircleIcon className=\"w-5 h-5 text-green-400\" />\n                            ) : (\n                                <DocumentDuplicateIcon className=\"w-5 h-5 text-orange-400\" />\n                            )}\n                        </button>\n                    </div>\n                    <div className=\"mt-2 text-xs text-gray-400\">\n                        Transfer will continue automatically once deposit is confirmed\n                    </div>\n                </div>\n            )}\n\n            {/* Steps List */}\n            <div className=\"p-6 space-y-1\">\n                {steps.map((step, index) => {\n                    const Icon = getStepIcon(step);\n                    const isActive = index === currentStepIndex;\n                    const duration = formatDuration(step.startedAt, step.completedAt);\n\n                    return (\n                        <div\n                            key={step.id}\n                            className={`relative flex items-start p-4 rounded-lg transition-colors ${isActive ? 'bg-gray-900/50' : ''\n                                }`}\n                        >\n                            {/* Connector Line */}\n                            {index < steps.length - 1 && (\n                                <div\n                                    className={`absolute left-7 top-14 w-0.5 h-6 ${step.status === 'complete' ? 'bg-green-500/50' : 'bg-gray-700'\n                                        }`}\n                                />\n                            )}\n\n                            {/* Step Icon */}\n                            <div\n                                className={`flex-shrink-0 w-10 h-10 rounded-full border-2 flex items-center justify-center mr-4 ${statusColors[step.status]\n                                    }`}\n                            >\n                                <Icon className={`w-5 h-5 ${statusIconColors[step.status]}`} />\n                            </div>\n\n                            {/* Step Content */}\n                            <div className=\"flex-1 min-w-0\">\n                                <div className=\"flex items-center justify-between\">\n                                    <span className={`font-medium ${step.status === 'complete' ? 'text-green-400' :\n                                            step.status === 'in-progress' ? 'text-blue-400' :\n                                                step.status === 'failed' ? 'text-red-400' :\n                                                    'text-gray-400'\n                                        }`}>\n                                        {step.description}\n                                    </span>\n                                    {getStatusIndicator(step, index)}\n                                </div>\n\n                                {/* Duration */}\n                                {duration && (\n                                    <div className=\"text-xs text-gray-500 mt-1\">\n                                        {step.status === 'complete' ? 'Completed in' : 'Running for'} {duration}\n                                    </div>\n                                )}\n\n                                {/* Transaction ID */}\n                                {step.txId && (\n                                    <div className=\"mt-2 flex items-center space-x-2\">\n                                        <span className=\"text-xs text-gray-500\">TX:</span>\n                                        <code className=\"text-xs text-blue-400 font-mono truncate max-w-[200px]\">\n                                            {step.txId}\n                                        </code>\n                                        <button\n                                            onClick={() => copyToClipboard(step.txId!)}\n                                            className=\"p-1 hover:bg-gray-700 rounded\"\n                                        >\n                                            <DocumentDuplicateIcon className=\"w-3 h-3 text-gray-500\" />\n                                        </button>\n                                    </div>\n                                )}\n\n                                {/* Error Message */}\n                                {step.error && (\n                                    <div className=\"mt-2 text-xs text-red-400 bg-red-900/20 px-2 py-1 rounded\">\n                                        {step.error}\n                                    </div>\n                                )}\n\n                                {/* Additional Data */}\n                                {step.data && Object.keys(step.data).length > 0 && (\n                                    <div className=\"mt-2 text-xs text-gray-500\">\n                                        {Object.entries(step.data).map(([key, value]) => (\n                                            <div key={key} className=\"flex items-center space-x-2\">\n                                                <span className=\"capitalize\">{key.replace(/([A-Z])/g, ' $1').trim()}:</span>\n                                                <span className=\"text-gray-400 truncate max-w-[150px]\">\n                                                    {String(value)}\n                                                </span>\n                                            </div>\n                                        ))}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                    );\n                })}\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1094, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/src/components/mixer/cross-chain/ZecDepositForm.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from 'react';\nimport {\n    ArrowsRightLeftIcon,\n    ChevronDownIcon,\n    ShieldCheckIcon,\n    BoltIcon,\n    InformationCircleIcon,\n    ExclamationTriangleIcon,\n} from '@heroicons/react/24/outline';\n\ninterface ZecDepositFormProps {\n    onSubmit: (data: {\n        direction: 'zec-to-strk' | 'strk-to-zec';\n        amount: number;\n        destinationAddress: string;\n        usePrivacyMixer: boolean;\n        useCashuFlow: boolean;\n    }) => void;\n    onChange?: (data: {\n        direction: 'zec-to-strk' | 'strk-to-zec';\n        amount: number;\n    }) => void;\n    isLoading?: boolean;\n    disabled?: boolean;\n    className?: string;\n}\n\nconst currencies = {\n    ZEC: {\n        name: 'Zcash',\n        symbol: 'ZEC',\n        icon: 'Z',\n        color: 'text-orange-500',\n        bgColor: 'bg-orange-500/10',\n        min: 0.003,  // FixedFloat minimum\n        max: 27,     // FixedFloat max is ~27 ZEC\n    },\n    STRK: {\n        name: 'Starknet',\n        symbol: 'STRK',\n        icon: 'S',\n        color: 'text-orange-400',\n        bgColor: 'bg-orange-400/10',\n        min: 10,\n        max: 10000,\n    },\n};\n\nexport function ZecDepositForm({\n    onSubmit,\n    onChange,\n    isLoading = false,\n    disabled = false,\n    className = '',\n}: ZecDepositFormProps) {\n    const [direction, setDirection] = useState<'zec-to-strk' | 'strk-to-zec'>('zec-to-strk');\n    const [amount, setAmount] = useState<string>('');\n    const [destinationAddress, setDestinationAddress] = useState('');\n    const [usePrivacyMixer, setUsePrivacyMixer] = useState(false);\n    const [useCashuFlow, setUseCashuFlow] = useState(false);\n    const [showAdvanced, setShowAdvanced] = useState(false);\n\n    const fromCurrency = direction === 'zec-to-strk' ? currencies.ZEC : currencies.STRK;\n    const toCurrency = direction === 'zec-to-strk' ? currencies.STRK : currencies.ZEC;\n\n    const handleSwapDirection = () => {\n        const newDirection = direction === 'zec-to-strk' ? 'strk-to-zec' : 'zec-to-strk';\n        setDirection(newDirection);\n        setAmount('');\n        setDestinationAddress('');\n        onChange?.({ direction: newDirection, amount: 0 });\n    };\n\n    const handleAmountChange = (value: string) => {\n        setAmount(value);\n        const numValue = parseFloat(value) || 0;\n        onChange?.({ direction, amount: numValue });\n    };\n\n    const handleSubmit = (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!amount || !destinationAddress) return;\n\n        onSubmit({\n            direction,\n            amount: parseFloat(amount),\n            destinationAddress,\n            usePrivacyMixer,\n            useCashuFlow,\n        });\n    };\n\n    const numAmount = parseFloat(amount) || 0;\n    const isValidAmount = numAmount >= fromCurrency.min && numAmount <= fromCurrency.max;\n    const isValidAddress = destinationAddress.length > 10;\n    const canSubmit = isValidAmount && isValidAddress && !isLoading && !disabled;\n\n    return (\n        <form onSubmit={handleSubmit} className={`bg-gray-900 border border-gray-700 rounded-xl ${className}`}>\n            {/* Header */}\n            <div className=\"px-6 py-4 border-b border-gray-700\">\n                <h2 className=\"text-lg font-semibold text-white flex items-center space-x-2\">\n                    <ArrowsRightLeftIcon className=\"w-5 h-5 text-blue-400\" />\n                    <span>Cross-Chain Swap</span>\n                </h2>\n                <p className=\"text-sm text-gray-400 mt-1\">\n                    Private transfers between Zcash and Starknet\n                </p>\n            </div>\n\n            <div className=\"p-6 space-y-6\">\n                {/* From Section */}\n                <div className=\"space-y-2\">\n                    <label className=\"block text-sm text-gray-400\">You Send</label>\n                    <div className=\"relative\">\n                        <div className={`absolute left-4 top-1/2 -translate-y-1/2 w-8 h-8 rounded-full ${fromCurrency.bgColor} flex items-center justify-center`}>\n                            <span className={`text-sm font-bold ${fromCurrency.color}`}>\n                                {fromCurrency.icon}\n                            </span>\n                        </div>\n                        <input\n                            type=\"number\"\n                            value={amount}\n                            onChange={(e) => handleAmountChange(e.target.value)}\n                            placeholder=\"0.00\"\n                            step=\"any\"\n                            min={fromCurrency.min}\n                            max={fromCurrency.max}\n                            className=\"w-full bg-gray-800 border border-gray-600 rounded-lg pl-14 pr-20 py-4 text-xl text-white placeholder-gray-500 focus:border-blue-500 focus:outline-none transition-colors\"\n                            disabled={isLoading || disabled}\n                        />\n                        <div className=\"absolute right-4 top-1/2 -translate-y-1/2\">\n                            <span className={`text-lg font-medium ${fromCurrency.color}`}>\n                                {fromCurrency.symbol}\n                            </span>\n                        </div>\n                    </div>\n                    <div className=\"flex items-center justify-between text-xs text-gray-500\">\n                        <span>Min: {fromCurrency.min} {fromCurrency.symbol}</span>\n                        <span>Max: {fromCurrency.max} {fromCurrency.symbol}</span>\n                    </div>\n                </div>\n\n                {/* Swap Direction Button */}\n                <div className=\"flex justify-center -my-2\">\n                    <button\n                        type=\"button\"\n                        onClick={handleSwapDirection}\n                        className=\"p-3 bg-gray-800 border border-gray-600 rounded-full hover:bg-gray-700 hover:border-gray-500 transition-all duration-200 group\"\n                        disabled={isLoading || disabled}\n                    >\n                        <ArrowsRightLeftIcon className=\"w-5 h-5 text-gray-400 group-hover:text-blue-400 transition-colors rotate-90\" />\n                    </button>\n                </div>\n\n                {/* To Section */}\n                <div className=\"space-y-2\">\n                    <label className=\"block text-sm text-gray-400\">You Receive</label>\n                    <div className={`relative flex items-center px-4 py-4 bg-gray-800/50 border border-gray-700 rounded-lg`}>\n                        <div className={`w-8 h-8 rounded-full ${toCurrency.bgColor} flex items-center justify-center mr-3`}>\n                            <span className={`text-sm font-bold ${toCurrency.color}`}>\n                                {toCurrency.icon}\n                            </span>\n                        </div>\n                        <span className=\"text-lg text-gray-400\">\n                            {numAmount > 0 ? '~' : ''} Estimated after quote\n                        </span>\n                        <span className={`ml-auto text-lg font-medium ${toCurrency.color}`}>\n                            {toCurrency.symbol}\n                        </span>\n                    </div>\n                </div>\n\n                {/* Destination Address */}\n                <div className=\"space-y-2\">\n                    <label className=\"block text-sm text-gray-400\">\n                        {direction === 'zec-to-strk' ? 'Starknet Destination Address' : 'Zcash Destination Address'}\n                    </label>\n                    <input\n                        type=\"text\"\n                        value={destinationAddress}\n                        onChange={(e) => setDestinationAddress(e.target.value)}\n                        placeholder={direction === 'zec-to-strk' ? '0x...' : 'z...'}\n                        className=\"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:border-blue-500 focus:outline-none transition-colors font-mono text-sm\"\n                        disabled={isLoading || disabled}\n                    />\n                    {direction === 'strk-to-zec' && (\n                        <div className=\"flex items-start space-x-2 text-xs text-orange-400/80\">\n                            <ExclamationTriangleIcon className=\"w-4 h-4 flex-shrink-0 mt-0.5\" />\n                            <span>Use a shielded z-address for maximum privacy</span>\n                        </div>\n                    )}\n                </div>\n\n                {/* Advanced Options Toggle */}\n                <button\n                    type=\"button\"\n                    onClick={() => setShowAdvanced(!showAdvanced)}\n                    className=\"flex items-center justify-between w-full py-2 text-sm text-gray-400 hover:text-gray-300 transition-colors\"\n                >\n                    <span className=\"flex items-center space-x-2\">\n                        <ShieldCheckIcon className=\"w-4 h-4\" />\n                        <span>Privacy Options</span>\n                    </span>\n                    <ChevronDownIcon className={`w-4 h-4 transition-transform ${showAdvanced ? 'rotate-180' : ''}`} />\n                </button>\n\n                {/* Advanced Options */}\n                {showAdvanced && (\n                    <div className=\"space-y-4 pt-2 border-t border-gray-700\">\n                        <label className=\"flex items-start space-x-3 cursor-pointer group\">\n                            <input\n                                type=\"checkbox\"\n                                checked={usePrivacyMixer}\n                                onChange={(e) => setUsePrivacyMixer(e.target.checked)}\n                                className=\"mt-1 w-4 h-4 rounded border-gray-600 bg-gray-800 text-blue-500 focus:ring-blue-500 focus:ring-offset-0\"\n                                disabled={isLoading || disabled}\n                            />\n                            <div>\n                                <span className=\"text-white group-hover:text-blue-400 transition-colors\">\n                                    Use Privacy Mixer\n                                </span>\n                                <p className=\"text-xs text-gray-500 mt-0.5\">\n                                    Route through ZK privacy mixer for enhanced anonymity\n                                </p>\n                            </div>\n                        </label>\n\n                        <label className=\"flex items-start space-x-3 cursor-pointer group\">\n                            <input\n                                type=\"checkbox\"\n                                checked={useCashuFlow}\n                                onChange={(e) => setUseCashuFlow(e.target.checked)}\n                                className=\"mt-1 w-4 h-4 rounded border-gray-600 bg-gray-800 text-blue-500 focus:ring-blue-500 focus:ring-offset-0\"\n                                disabled={isLoading || disabled}\n                            />\n                            <div>\n                                <span className=\"text-white group-hover:text-blue-400 transition-colors\">\n                                    Use Cashu Ecash Flow\n                                </span>\n                                <p className=\"text-xs text-gray-500 mt-0.5\">\n                                    Additional privacy layer through ecash tokens\n                                </p>\n                            </div>\n                        </label>\n                    </div>\n                )}\n\n                {/* Info Box */}\n                <div className=\"flex items-start space-x-3 p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg\">\n                    <InformationCircleIcon className=\"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5\" />\n                    <div className=\"text-sm text-gray-300\">\n                        <p className=\"font-medium text-blue-400 mb-1\">How it works</p>\n                        <p className=\"text-gray-400\">\n                            {direction === 'zec-to-strk'\n                                ? 'Send ZEC to a generated address. It will be converted through Lightning Network to STRK on Starknet.'\n                                : 'Your STRK will be converted through Lightning Network to ZEC at your specified address.'\n                            }\n                        </p>\n                    </div>\n                </div>\n\n                {/* Submit Button */}\n                <button\n                    type=\"submit\"\n                    disabled={!canSubmit}\n                    className={`w-full py-4 rounded-lg font-medium text-lg transition-all duration-200 flex items-center justify-center space-x-2 ${canSubmit\n                        ? 'bg-orange-500 hover:bg-orange-600 text-white shadow-lg shadow-orange-500/25'\n                        : 'bg-gray-700 text-gray-400 cursor-not-allowed'\n                        }`}\n                >\n                    {isLoading ? (\n                        <>\n                            <BoltIcon className=\"w-5 h-5 animate-pulse\" />\n                            <span>Preparing Transfer...</span>\n                        </>\n                    ) : (\n                        <>\n                            <BoltIcon className=\"w-5 h-5\" />\n                            <span>\n                                {direction === 'zec-to-strk' ? 'Start ZEC to STRK Transfer' : 'Start STRK to ZEC Transfer'}\n                            </span>\n                        </>\n                    )}\n                </button>\n\n                {/* Disclaimer */}\n                <p className=\"text-xs text-gray-500 text-center\">\n                    By proceeding, you acknowledge that cross-chain transfers are irreversible and subject to network fees.\n                </p>\n            </div>\n        </form>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAHA;;;;AA6BA,MAAM,aAAa;IACf,KAAK;QACD,MAAM;QACN,QAAQ;QACR,MAAM;QACN,OAAO;QACP,SAAS;QACT,KAAK;QACL,KAAK;IACT;IACA,MAAM;QACF,MAAM;QACN,QAAQ;QACR,MAAM;QACN,OAAO;QACP,SAAS;QACT,KAAK;QACL,KAAK;IACT;AACJ;AAEO,SAAS,eAAe,EAC3B,QAAQ,EACR,QAAQ,EACR,YAAY,KAAK,EACjB,WAAW,KAAK,EAChB,YAAY,EAAE,EACI;IAClB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAgC;IAC1E,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAS;IAC7C,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,iNAAQ,EAAC;IAC7D,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,iNAAQ,EAAC;IACvD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;IACjD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;IAEjD,MAAM,eAAe,cAAc,gBAAgB,WAAW,GAAG,GAAG,WAAW,IAAI;IACnF,MAAM,aAAa,cAAc,gBAAgB,WAAW,IAAI,GAAG,WAAW,GAAG;IAEjF,MAAM,sBAAsB;QACxB,MAAM,eAAe,cAAc,gBAAgB,gBAAgB;QACnE,aAAa;QACb,UAAU;QACV,sBAAsB;QACtB,WAAW;YAAE,WAAW;YAAc,QAAQ;QAAE;IACpD;IAEA,MAAM,qBAAqB,CAAC;QACxB,UAAU;QACV,MAAM,WAAW,WAAW,UAAU;QACtC,WAAW;YAAE;YAAW,QAAQ;QAAS;IAC7C;IAEA,MAAM,eAAe,CAAC;QAClB,EAAE,cAAc;QAChB,IAAI,CAAC,UAAU,CAAC,oBAAoB;QAEpC,SAAS;YACL;YACA,QAAQ,WAAW;YACnB;YACA;YACA;QACJ;IACJ;IAEA,MAAM,YAAY,WAAW,WAAW;IACxC,MAAM,gBAAgB,aAAa,aAAa,GAAG,IAAI,aAAa,aAAa,GAAG;IACpF,MAAM,iBAAiB,mBAAmB,MAAM,GAAG;IACnD,MAAM,YAAY,iBAAiB,kBAAkB,CAAC,aAAa,CAAC;IAEpE,qBACI,8OAAC;QAAK,UAAU;QAAc,WAAW,CAAC,8CAA8C,EAAE,WAAW;;0BAEjG,8OAAC;gBAAI,WAAU;;kCACX,8OAAC;wBAAG,WAAU;;0CACV,8OAAC,4PAAmB;gCAAC,WAAU;;;;;;0CAC/B,8OAAC;0CAAK;;;;;;;;;;;;kCAEV,8OAAC;wBAAE,WAAU;kCAA6B;;;;;;;;;;;;0BAK9C,8OAAC;gBAAI,WAAU;;kCAEX,8OAAC;wBAAI,WAAU;;0CACX,8OAAC;gCAAM,WAAU;0CAA8B;;;;;;0CAC/C,8OAAC;gCAAI,WAAU;;kDACX,8OAAC;wCAAI,WAAW,CAAC,8DAA8D,EAAE,aAAa,OAAO,CAAC,iCAAiC,CAAC;kDACpI,cAAA,8OAAC;4CAAK,WAAW,CAAC,kBAAkB,EAAE,aAAa,KAAK,EAAE;sDACrD,aAAa,IAAI;;;;;;;;;;;kDAG1B,8OAAC;wCACG,MAAK;wCACL,OAAO;wCACP,UAAU,CAAC,IAAM,mBAAmB,EAAE,MAAM,CAAC,KAAK;wCAClD,aAAY;wCACZ,MAAK;wCACL,KAAK,aAAa,GAAG;wCACrB,KAAK,aAAa,GAAG;wCACrB,WAAU;wCACV,UAAU,aAAa;;;;;;kDAE3B,8OAAC;wCAAI,WAAU;kDACX,cAAA,8OAAC;4CAAK,WAAW,CAAC,oBAAoB,EAAE,aAAa,KAAK,EAAE;sDACvD,aAAa,MAAM;;;;;;;;;;;;;;;;;0CAIhC,8OAAC;gCAAI,WAAU;;kDACX,8OAAC;;4CAAK;4CAAM,aAAa,GAAG;4CAAC;4CAAE,aAAa,MAAM;;;;;;;kDAClD,8OAAC;;4CAAK;4CAAM,aAAa,GAAG;4CAAC;4CAAE,aAAa,MAAM;;;;;;;;;;;;;;;;;;;kCAK1D,8OAAC;wBAAI,WAAU;kCACX,cAAA,8OAAC;4BACG,MAAK;4BACL,SAAS;4BACT,WAAU;4BACV,UAAU,aAAa;sCAEvB,cAAA,8OAAC,4PAAmB;gCAAC,WAAU;;;;;;;;;;;;;;;;kCAKvC,8OAAC;wBAAI,WAAU;;0CACX,8OAAC;gCAAM,WAAU;0CAA8B;;;;;;0CAC/C,8OAAC;gCAAI,WAAW,CAAC,qFAAqF,CAAC;;kDACnG,8OAAC;wCAAI,WAAW,CAAC,qBAAqB,EAAE,WAAW,OAAO,CAAC,sCAAsC,CAAC;kDAC9F,cAAA,8OAAC;4CAAK,WAAW,CAAC,kBAAkB,EAAE,WAAW,KAAK,EAAE;sDACnD,WAAW,IAAI;;;;;;;;;;;kDAGxB,8OAAC;wCAAK,WAAU;;4CACX,YAAY,IAAI,MAAM;4CAAG;;;;;;;kDAE9B,8OAAC;wCAAK,WAAW,CAAC,4BAA4B,EAAE,WAAW,KAAK,EAAE;kDAC7D,WAAW,MAAM;;;;;;;;;;;;;;;;;;kCAM9B,8OAAC;wBAAI,WAAU;;0CACX,8OAAC;gCAAM,WAAU;0CACZ,cAAc,gBAAgB,iCAAiC;;;;;;0CAEpE,8OAAC;gCACG,MAAK;gCACL,OAAO;gCACP,UAAU,CAAC,IAAM,sBAAsB,EAAE,MAAM,CAAC,KAAK;gCACrD,aAAa,cAAc,gBAAgB,UAAU;gCACrD,WAAU;gCACV,UAAU,aAAa;;;;;;4BAE1B,cAAc,+BACX,8OAAC;gCAAI,WAAU;;kDACX,8OAAC,wQAAuB;wCAAC,WAAU;;;;;;kDACnC,8OAAC;kDAAK;;;;;;;;;;;;;;;;;;kCAMlB,8OAAC;wBACG,MAAK;wBACL,SAAS,IAAM,gBAAgB,CAAC;wBAChC,WAAU;;0CAEV,8OAAC;gCAAK,WAAU;;kDACZ,8OAAC,gPAAe;wCAAC,WAAU;;;;;;kDAC3B,8OAAC;kDAAK;;;;;;;;;;;;0CAEV,8OAAC,gPAAe;gCAAC,WAAW,CAAC,6BAA6B,EAAE,eAAe,eAAe,IAAI;;;;;;;;;;;;oBAIjG,8BACG,8OAAC;wBAAI,WAAU;;0CACX,8OAAC;gCAAM,WAAU;;kDACb,8OAAC;wCACG,MAAK;wCACL,SAAS;wCACT,UAAU,CAAC,IAAM,mBAAmB,EAAE,MAAM,CAAC,OAAO;wCACpD,WAAU;wCACV,UAAU,aAAa;;;;;;kDAE3B,8OAAC;;0DACG,8OAAC;gDAAK,WAAU;0DAAyD;;;;;;0DAGzE,8OAAC;gDAAE,WAAU;0DAA+B;;;;;;;;;;;;;;;;;;0CAMpD,8OAAC;gCAAM,WAAU;;kDACb,8OAAC;wCACG,MAAK;wCACL,SAAS;wCACT,UAAU,CAAC,IAAM,gBAAgB,EAAE,MAAM,CAAC,OAAO;wCACjD,WAAU;wCACV,UAAU,aAAa;;;;;;kDAE3B,8OAAC;;0DACG,8OAAC;gDAAK,WAAU;0DAAyD;;;;;;0DAGzE,8OAAC;gDAAE,WAAU;0DAA+B;;;;;;;;;;;;;;;;;;;;;;;;kCAS5D,8OAAC;wBAAI,WAAU;;0CACX,8OAAC,kQAAqB;gCAAC,WAAU;;;;;;0CACjC,8OAAC;gCAAI,WAAU;;kDACX,8OAAC;wCAAE,WAAU;kDAAiC;;;;;;kDAC9C,8OAAC;wCAAE,WAAU;kDACR,cAAc,gBACT,yGACA;;;;;;;;;;;;;;;;;;kCAOlB,8OAAC;wBACG,MAAK;wBACL,UAAU,CAAC;wBACX,WAAW,CAAC,kHAAkH,EAAE,YAC1H,gFACA,gDACA;kCAEL,0BACG;;8CACI,8OAAC,2NAAQ;oCAAC,WAAU;;;;;;8CACpB,8OAAC;8CAAK;;;;;;;yDAGV;;8CACI,8OAAC,2NAAQ;oCAAC,WAAU;;;;;;8CACpB,8OAAC;8CACI,cAAc,gBAAgB,+BAA+B;;;;;;;;;;;;;kCAO9E,8OAAC;wBAAE,WAAU;kCAAoC;;;;;;;;;;;;;;;;;;AAMjE","debugId":null}},
    {"offset": {"line": 1749, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/src/integrations/starknet/sharedAccount.ts"],"sourcesContent":["import { Account, RpcProvider, ec, cairo, CallData } from 'starknet';\nimport { StarknetSigner } from '@atomiqlabs/chain-starknet';\nimport { SHARED_SWAP_ACCOUNT_ADDRESS } from '@/config/constants';\nimport { ENV, getStarknetRpc } from '@/config/env';\nimport { PRIVACY_MIXER } from '@/config/constants';\n\n// Lazy singleton for shared swap account (prototype only)\nlet sharedAccount: Account | null = null;\nlet sharedSigner: StarknetSigner | null = null;\nlet sharedProvider: RpcProvider | null = null;\n\nexport function getSharedSwapAccount(): StarknetSigner | null {\n    if (sharedSigner) return sharedSigner;\n    if (!ENV.SHARED_SWAP_ACCOUNT_PRIVATE_KEY) {\n        return null; // Not configured\n    }\n\n    const address = (ENV.SHARED_SWAP_ACCOUNT_ADDRESS || SHARED_SWAP_ACCOUNT_ADDRESS).toLowerCase();\n    const provider = new RpcProvider({ nodeUrl: getStarknetRpc() });\n    sharedProvider = provider;\n\n    try {\n        // Validate private key (basic length/hex check)\n        const pk = ENV.SHARED_SWAP_ACCOUNT_PRIVATE_KEY.startsWith('0x')\n            ? ENV.SHARED_SWAP_ACCOUNT_PRIVATE_KEY\n            : '0x' + ENV.SHARED_SWAP_ACCOUNT_PRIVATE_KEY;\n\n        if (!/^0x[0-9a-fA-F]{64}$/.test(pk)) {\n            console.warn('Shared swap account private key format unexpected');\n        }\n\n        // Derive public key just for logging (not strictly needed)\n        try {\n            const pub = ec.starkCurve.getStarkKey(pk);\n            console.log('🔐 Shared swap account loaded (pubkey prefix):', pub.slice(0, 10) + '...');\n        } catch (e) {\n            console.warn('Could not derive public key for shared swap account:', e);\n        }\n\n        sharedAccount = new Account(provider, address, pk);\n        sharedSigner = new StarknetSigner(sharedAccount);\n        return sharedSigner;\n    } catch (e) {\n        console.error('Failed to instantiate shared swap account:', e);\n        return null;\n    }\n}\n\nexport function getSharedSwapProvider(): RpcProvider | null {\n    return sharedProvider;\n}\n\nexport function getSharedSwapAccountRaw(): Account | null {\n    // Get the raw Account for contracts that need it\n    if (!sharedSigner) {\n        // Try to initialize if not already done\n        getSharedSwapAccount();\n    }\n    return sharedAccount;\n}\n\n// Quick runtime validation to catch mismatched private key/address early\nexport async function validateSharedSwapSigner(): Promise<{ ok: boolean; reason?: string; address?: string }> {\n    try {\n        const signer = getSharedSwapAccount();\n        const acct = getSharedSwapAccountRaw();\n        const provider = getSharedSwapProvider();\n        if (!signer || !acct || !provider) {\n            return { ok: false, reason: 'Shared swap signer not configured (missing env or provider)' };\n        }\n\n        // Try to fetch nonce as a lightweight liveness check\n        try {\n            const nonce = await acct.getNonce();\n            console.log('✅ Shared swap account validation OK', { address: acct.address, nonce: nonce?.toString?.() || String(nonce) });\n            return { ok: true, address: acct.address };\n        } catch (e) {\n            console.warn('⚠️ Shared swap account nonce check failed', { address: acct.address, error: e instanceof Error ? e.message : String(e) });\n            return { ok: false, reason: 'Account nonce fetch failed (address may be wrong or not deployed)', address: acct.address };\n        }\n    } catch (e) {\n        return { ok: false, reason: e instanceof Error ? e.message : String(e) };\n    }\n}\n\nexport function getSharedSwapAddress(): string | null {\n    if (!sharedSigner) getSharedSwapAccount();\n    return sharedAccount?.address || null;\n}\n\n// Transfer STRK from the shared account to a recipient (amount in Wei)\nexport async function transferStrkFromShared(to: string, amountWei: bigint): Promise<string> {\n    const acct = getSharedSwapAccountRaw();\n    if (!acct) throw new Error('Shared swap account not configured');\n\n    const token = PRIVACY_MIXER.STRK_TOKEN;\n    const call = {\n        contractAddress: token,\n        entrypoint: 'transfer',\n        calldata: CallData.compile([to, cairo.uint256(amountWei)])\n    } as const;\n\n    const res = await acct.execute([call]);\n    const txHash = (res as any).transaction_hash || (res as any).hash || 'unknown_tx';\n    console.log('🚚 Shared STRK forward transfer submitted:', { to, amountWei: amountWei.toString(), txHash });\n    return txHash;\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1889, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/src/integrations/swaps/atomiq.ts"],"sourcesContent":["// Real Atomiq swap integration using @atomiqlabs/sdk - Starknet + Lightning only\nimport {\n    BitcoinNetwork,\n    SwapperFactory,\n    ToBTCSwapState,\n    FromBTCLNSwapState\n} from '@atomiqlabs/sdk';\nimport * as bolt11 from 'bolt11';\nimport {\n    StarknetInitializer,\n    StarknetInitializerType,\n    StarknetSigner,\n    RpcProviderWithRetries,\n    StarknetFees\n} from '@atomiqlabs/chain-starknet';\nimport { ENV, getStarknetRpc } from '@/config/env';\nimport { getSharedSwapAccount } from '../starknet/sharedAccount';\n\n// Simple result type for focused Starknet ↔ Lightning swaps\ninterface SwapResult {\n    success: boolean;\n    txId?: string;\n    amount: number;\n    fromCurrency: string;\n    toCurrency: string;\n    route: string;\n    error?: string;\n}\n\nexport interface AtomiqSwapQuote {\n    id: string;\n    from: 'STRK' | 'BTC' | 'BTC_LN';\n    to: 'STRK' | 'BTC' | 'BTC_LN';\n    amountIn: bigint;\n    amountOut: bigint;\n    fee: bigint;\n    swapPrice: number;\n    marketPrice: number;\n    difference: number;\n    expiry: number;\n    createdAt: number;\n}\n\nexport type AtomiqSwapStatus =\n    | 'CREATED'\n    | 'QUOTED'\n    | 'COMMITED'\n    | 'SOFT_CLAIMED'\n    | 'CLAIMED'\n    | 'REFUNDED'\n    | 'REFUNDABLE'\n    | 'EXPIRED'\n    | 'FAILED';\n\nexport interface AtomiqSwapExecution {\n    id: string;\n    txId?: string;\n    status: AtomiqSwapStatus;\n    amountOut?: bigint;\n    errorCode?: string;\n    errorMessage?: string;\n    lightningPaymentHash?: string;\n    bitcoinAddress?: string;\n    lightningInvoice?: string;\n}\n\nexport interface AtomiqSwapClient {\n    // Core swap operations\n    getQuote(from: AtomiqSwapQuote['from'], to: AtomiqSwapQuote['to'], amount: bigint, exactIn?: boolean, destinationAddress?: string): Promise<AtomiqSwapQuote>;\n    execute(quoteId: string, walletSigner?: any, lightningInvoice?: string): Promise<AtomiqSwapExecution>;\n    getStatus(executionId: string): Promise<AtomiqSwapExecution>;\n\n    // Advanced operations\n    refund(executionId: string, walletSigner?: any): Promise<{ txId: string }>;\n    waitForCompletion(executionId: string, timeoutMs?: number): Promise<boolean>;\n\n    // Lightning-specific operations\n    getInvoice(executionId: string): Promise<string>;\n    payInvoice(invoice: string, walletSigner?: any): Promise<{ preimage: string }>;\n\n    // Swap limits and info\n    getSwapLimits(from: string, to: string): Promise<{ min: bigint; max: bigint }>;\n}\n\nexport class RealAtomiqSwapClient implements AtomiqSwapClient {\n    private swapper: any = null;\n    private factory: SwapperFactory<[StarknetInitializerType]> | null = null;\n    private initialized: boolean = false;\n    private network: 'MAINNET' | 'TESTNET';\n    private starknetRpc: string;\n    private isNodeJs: boolean;\n    private tokens: any = null;\n    private initializationPromise: Promise<void> | null = null;\n\n    constructor(network: 'MAINNET' | 'TESTNET' = ENV.NETWORK as 'MAINNET' | 'TESTNET', starknetRpc?: string) {\n        this.network = network;\n        this.starknetRpc = starknetRpc || getStarknetRpc();\n        this.isNodeJs = typeof window === 'undefined';\n\n        console.log(`🚀 Initializing Atomiq client for ${network} using RPC: ${this.starknetRpc}`);\n\n        // Only initialize in browser environment to avoid SSR issues\n        if (!this.isNodeJs) {\n            this.initializeForBrowser();\n        } else {\n            console.log('⚠️ Node.js environment detected - Atomiq SDK will initialize when needed');\n        }\n    }\n\n    private async initializeForBrowser(): Promise<void> {\n        try {\n            // Create factory with Starknet-only support (no Solana)\n            this.factory = new SwapperFactory<[StarknetInitializerType]>([StarknetInitializer] as const);\n            this.tokens = this.factory.Tokens;\n\n            // Start initialization (async)\n            this.initializationPromise = this.initializeAtomiqFactory();\n        } catch (error) {\n            console.error('❌ Failed to create Atomiq factory:', error);\n        }\n    }\n\n    private setupTestMode(): void {\n        if (this.isNodeJs) {\n            console.log('📋 Test mode setup: Atomiq SDK requires browser environment');\n            return;\n        }\n\n        // No simulation mode - user explicitly disabled it\n        this.initialized = false;\n        console.error('❌ Atomiq SDK initialization failed and simulation mode is disabled');\n        throw new Error('Atomiq SDK initialization failed - simulation mode disabled');\n    }\n\n    private async initializeAtomiqFactory(): Promise<void> {\n        try {\n            console.log('🔧 Initializing Atomiq SDK with Starknet + Lightning support...');\n\n            if (!this.factory) {\n                throw new Error('Factory not initialized - browser environment required');\n            }\n\n            // Create swapper configuration matching the demo pattern\n            const starknetRpc = new RpcProviderWithRetries({ nodeUrl: this.starknetRpc });\n\n            const swapperConfig: any = {\n                chains: {\n                    STARKNET: {\n                        rpcUrl: starknetRpc,\n                        fees: new StarknetFees(starknetRpc)\n                    }\n                },\n                bitcoinNetwork: this.network === 'MAINNET' ? BitcoinNetwork.MAINNET : BitcoinNetwork.TESTNET\n            };\n\n            // For Node.js environments, use simple memory storage to avoid SQLite dependency issues\n            if (this.isNodeJs) {\n                console.log('✅ Using memory storage for Node.js testing environment');\n                // Use default in-memory storage for simplicity\n            }\n\n            console.log('✅ Configured storage for privacy mixer environment');\n\n            // Create swapper using factory with Starknet-only configuration\n            this.swapper = this.factory.newSwapper(swapperConfig);\n            console.log('✅ Atomiq Swapper created for Starknet ↔ Lightning');\n\n            // Initialize the swapper\n            await this.swapper.init();\n\n            console.log('✅ Atomiq SDK initialized - ready for STRK ↔ Lightning swaps');\n\n            this.initialized = true;\n\n        } catch (error) {\n            console.error('❌ Failed to initialize Atomiq SDK:', error instanceof Error ? error.message : String(error));\n            console.error('Full error:', error);\n            throw error; // Don't fall back to simulation as requested\n        }\n    }\n\n    private async ensureInitialized(): Promise<void> {\n        if (this.isNodeJs) {\n            throw new Error('Atomiq SDK requires browser environment - Node.js not supported');\n        }\n\n        if (this.initialized) {\n            return;\n        }\n\n        if (this.initializationPromise) {\n            await this.initializationPromise;\n            return;\n        }\n\n        throw new Error('Atomiq SDK not initialized and no initialization promise found');\n    }\n\n    /**\n     * Execute Starknet to Lightning swap for privacy mixing\n     * Converts STRK to Lightning for enhanced privacy\n     * @param walletSigner - Optional StarknetSigner from user's wallet. If not provided, uses shared account.\n     */\n    async swapStrkToLightning(amount: number, lightningInvoice: string, sourceAddress: string, walletSigner?: any): Promise<SwapResult> {\n        try {\n            await this.ensureInitialized();\n\n            // Preflight: fetch STRK input limits to avoid 'Amount too high' from SDK\n            try {\n                const limits = await this.getSwapLimits('STRK', 'BTC_LN');\n                const invoiceDecoded = (() => { try { return bolt11.decode(lightningInvoice); } catch { return null; } })();\n                const invoiceMsats = invoiceDecoded?.millisatoshis ? BigInt(invoiceDecoded.millisatoshis) : undefined;\n                const invoiceSats = invoiceMsats ? Number(invoiceMsats / 1000n) : undefined;\n\n                // Note: limits are for STRK input, but we only know Lightning output amount\n                // The SDK will calculate required STRK input based on current exchange rates\n                // For now, just log the values for debugging\n                console.log('🔍 Preflight limits check (STRK input limits):', {\n                    invoiceSats,\n                    strkMaxLimit: limits.max.toString(),\n                    strkMinLimit: limits.min.toString(),\n                    note: 'STRK input will be calculated by SDK based on invoice amount'\n                });\n\n                // Skip input validation since we don't know STRK input amount yet\n                // Let the SDK handle the validation and conversion\n\n            } catch (preflight_error) {\n                console.warn('⚠️ Preflight limits check failed, proceeding with swap:', preflight_error);\n            }\n\n            console.log(`🔄 Starting STRK → Lightning swap for amount: ${amount}`);\n            // Normalize Starknet source address (felt252) to 0x + 64 hex chars\n            let normalizedSource = sourceAddress.trim().toLowerCase();\n            if (!normalizedSource.startsWith('0x')) {\n                normalizedSource = '0x' + normalizedSource;\n            }\n            const hexBody = normalizedSource.slice(2);\n            if (!/^[0-9a-f]+$/.test(hexBody)) {\n                return {\n                    success: false,\n                    amount,\n                    fromCurrency: 'STRK',\n                    toCurrency: 'Lightning',\n                    route: 'starknet-to-lightning',\n                    error: 'Source Starknet address contains non-hex characters'\n                };\n            }\n            if (hexBody.length < 64) {\n                normalizedSource = '0x' + hexBody.padStart(64, '0');\n            } else if (hexBody.length > 64) {\n                // Some wallets return full felt length already (<= 64). If >64 it's invalid here.\n                return {\n                    success: false,\n                    amount,\n                    fromCurrency: 'STRK',\n                    toCurrency: 'Lightning',\n                    route: 'starknet-to-lightning',\n                    error: 'Source Starknet address length invalid (>64 hex chars)'\n                };\n            }\n            console.log('🧾 Normalized Starknet source address:', normalizedSource);\n            // We now expect a BOLT11 invoice generated upstream (e.g. Cashu mint quote)\n            const invoice = lightningInvoice.trim();\n            const bolt11Pattern = /^(lnbc|lntb|lnbcrt)[0-9a-z]+$/i;\n            const isBolt11 = bolt11Pattern.test(invoice);\n            if (!isBolt11) {\n                return {\n                    success: false,\n                    amount,\n                    fromCurrency: 'STRK',\n                    toCurrency: 'Lightning',\n                    route: 'starknet-to-lightning',\n                    error: 'Provided value is not a valid BOLT11 invoice. Generate invoice from Cashu mint first.'\n                };\n            }\n\n            // Decode BOLT11 invoice to inspect amount\n            let satsFromInvoice: bigint | undefined;\n            try {\n                const decoded = bolt11.decode(invoice);\n                const msats = decoded.millisatoshis;\n                if (!msats) {\n                    return {\n                        success: false,\n                        amount,\n                        fromCurrency: 'STRK',\n                        toCurrency: 'Lightning',\n                        route: 'starknet-to-lightning',\n                        error: 'Invoice missing fixed amount (amountless invoices not supported yet)'\n                    };\n                }\n                satsFromInvoice = BigInt(msats) / BigInt(1000);\n                if (satsFromInvoice === BigInt(0)) {\n                    return {\n                        success: false,\n                        amount,\n                        fromCurrency: 'STRK',\n                        toCurrency: 'Lightning',\n                        route: 'starknet-to-lightning',\n                        error: 'Invoice amount is zero'\n                    };\n                }\n                console.log(`🧾 Invoice amount parsed: ${satsFromInvoice.toString()} sats`);\n            } catch (e) {\n                const msg = e instanceof Error ? e.message : String(e);\n                return {\n                    success: false,\n                    amount,\n                    fromCurrency: 'STRK',\n                    toCurrency: 'Lightning',\n                    route: 'starknet-to-lightning',\n                    error: `Failed to decode invoice: ${msg}`\n                };\n            }\n\n            // For Lightning invoices: must use exactOut semantics (Atomiq SDK requirement)\n            // We specify the Lightning output amount (from invoice) and let SDK calculate required STRK input\n            const exactIn = false;\n\n            console.log(`🔄 Creating STRK → Lightning swap (exactOut): ${satsFromInvoice.toString()} sats output`);\n\n            // Create STRK -> Lightning swap using proper Atomiq pattern from demo\n            const swap = await this.swapper.swap(\n                this.tokens.STARKNET.STRK,     // From STRK\n                this.tokens.BITCOIN.BTCLN,     // To Lightning\n                undefined,                     // Amount NOT specified - taken from invoice!\n                false,                         // exactIn = false for Lightning (demo pattern)\n                normalizedSource,              // Source address\n                invoice                        // Lightning invoice\n            );\n\n            console.log('✅ STRK → Lightning swap created:', swap.getId());\n            console.log('📊 Swap details:');\n            console.log('   Input: ' + swap.getInputWithoutFee());\n            console.log('   Fees: ' + swap.getFee().amountInSrcToken);\n            console.log('   Total input: ' + swap.getInput());\n            console.log('   Output: ' + swap.getOutput());\n            console.log('   Quote expiry: ' + swap.getQuoteExpiry() + ' (in ' + (swap.getQuoteExpiry() - Date.now()) / 1000 + ' seconds)');\n\n            // Use wallet signer if provided, otherwise fall back to shared account\n            const signer = walletSigner || getSharedSwapAccount();\n            if (signer) {\n                const signerAddress = signer.getAddress?.() || signer.address || 'unknown';\n                console.log('🔐 Committing swap with signer:', signerAddress.slice(0, 10) + '...');\n\n                // Ensure signer has getNonce method that returns BigInt compatible value\n                if (signer.getNonce && typeof signer.getNonce === 'function') {\n                    try {\n                        const nonce = await signer.getNonce();\n                        console.log('   Signer nonce check:', nonce.toString());\n                    } catch (e) {\n                        console.warn('   Signer nonce check failed:', e);\n                    }\n                }\n\n                await swap.commit(signer);\n            } else {\n                throw new Error('No signer available - provide wallet signer or configure shared swap account');\n            }\n\n            // Wait for the Lightning payment to complete\n            console.log('⏳ Waiting for Lightning payment...');\n            const success = await swap.waitForPayment();\n\n            if (success) {\n                return {\n                    success: true,\n                    txId: swap.getBitcoinTxId?.() || swap.getId(),\n                    amount,\n                    fromCurrency: 'STRK',\n                    toCurrency: 'Lightning',\n                    route: 'starknet-to-lightning'\n                };\n            } else {\n                // Payment failed - refund the swap\n                console.log('💸 Lightning payment failed, refunding...');\n                if (signer) {\n                    await swap.refund(signer);\n                    console.log('✅ Swap refunded successfully');\n                }\n                return {\n                    success: false,\n                    amount,\n                    fromCurrency: 'STRK',\n                    toCurrency: 'Lightning',\n                    route: 'starknet-to-lightning',\n                    error: 'Lightning payment failed and refunded'\n                };\n            }\n\n        } catch (error) {\n            let errorMessage = error instanceof Error ? error.message : String(error);\n            if (/amount too high/i.test(errorMessage)) {\n                try {\n                    const limits = await this.getSwapLimits('STRK', 'BTC_LN');\n                    errorMessage = `${errorMessage} (max sats: ${limits.max.toString()}, consider reducing invoice amount)`;\n                } catch {/* ignore */ }\n            }\n            console.error('❌ STRK → Lightning swap failed:', errorMessage);\n\n            return {\n                success: false,\n                error: errorMessage,\n                amount,\n                fromCurrency: 'STRK',\n                toCurrency: 'Lightning',\n                route: 'starknet-to-lightning'\n            };\n        }\n    }\n\n    /**\n     * Execute Lightning to Starknet swap for final transfer\n     * Converts Lightning back to STRK for recipient\n     */\n    async swapLightningToStrk(amount: number, recipientAddress: string): Promise<SwapResult> {\n        try {\n            await this.ensureInitialized();\n\n            console.log(`🔄 Starting Lightning → STRK swap for amount: ${amount}`);\n\n            // Create Lightning -> STRK swap\n            const swap = await this.swapper.swap(\n                this.tokens.BITCOIN.BTCLN,    // From: Lightning Network\n                this.tokens.STARKNET.STRK,    // To: STRK token\n                BigInt(amount),               // Amount in smallest unit\n                true,                         // exactIn = true\n                undefined,                    // Source address (Lightning invoice generated)\n                recipientAddress              // Destination Starknet address\n            );\n\n            console.log('✅ Lightning → STRK swap created:', swap.getId());\n\n            // Get the Lightning invoice to pay\n            const invoice = swap.getAddress();\n            console.log('💰 Lightning invoice to pay:', invoice);\n\n            // For testing, we'll simulate the Lightning payment\n            // In production, this would integrate with your Lightning node\n            await this.simulateLightningPayment(invoice);\n\n            // Wait for swap completion\n            const result = await swap.waitForPayment();\n\n            if (result) {\n                return {\n                    success: true,\n                    txId: swap.getBitcoinTxId?.() || swap.getId(),\n                    amount,\n                    fromCurrency: 'Lightning',\n                    toCurrency: 'STRK',\n                    route: 'lightning-to-starknet'\n                };\n            } else {\n                throw new Error('Swap execution failed');\n            }\n\n        } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : String(error);\n            console.error('❌ Lightning → STRK swap failed:', errorMessage);\n\n            return {\n                success: false,\n                error: errorMessage,\n                amount,\n                fromCurrency: 'Lightning',\n                toCurrency: 'STRK',\n                route: 'lightning-to-starknet'\n            };\n        }\n    }\n\n    /**\n     * Begin a Lightning → STRK swap and return the BOLT11 invoice without simulating payment.\n     * Use this when an external payer (e.g., Cashu melt) will pay the invoice.\n     */\n    async beginLightningToStrkSwap(amount: number, recipientAddress: string): Promise<{ id: string; invoice: string }> {\n        await this.ensureInitialized();\n\n        console.log(`🔄 (begin) Lightning → STRK swap for amount: ${amount}`);\n\n        const swap = await this.swapper.swap(\n            this.tokens.BITCOIN.BTCLN,    // From: Lightning Network\n            this.tokens.STARKNET.STRK,    // To: STRK token\n            BigInt(amount),               // Amount in sats (smallest unit)\n            true,                         // exactIn = true (LN amount is input)\n            undefined,                    // Source address (not needed for LN)\n            recipientAddress              // Destination Starknet address\n        );\n\n        const invoice = swap.getAddress();\n        const id = swap.getId();\n\n        console.log('✅ (begin) Lightning invoice created:', { id, invoice: typeof invoice === 'string' ? invoice.slice(0, 50) + '…' : String(invoice) });\n        return { id, invoice };\n    }\n\n    /**\n     * Wait for a previously created Lightning → STRK swap to complete after external payment.\n     */\n    async waitLightningToStrkCompletion(id: string, timeoutMs: number = 300000): Promise<boolean> {\n        return this.waitForCompletion(id, timeoutMs);\n    }\n\n    /**\n     * Claim a Lightning → STRK swap on Starknet after the LN invoice is paid.\n     * Uses the shared Starknet account to sign commit/claim transactions.\n     */\n    async claimLightningToStrkSwap(id: string): Promise<{ txId?: string }> {\n        await this.ensureInitialized();\n\n        if (!this.swapper || !this.initialized) {\n            throw new Error('Atomiq SDK not initialized - simulation mode disabled');\n        }\n\n        const swap = await this.swapper.getSwapById(id);\n        if (!swap) throw new Error(`Swap ${id} not found`);\n\n        const signer = getSharedSwapAccount();\n        if (!signer) {\n            throw new Error('No shared swap account configured - cannot claim swap');\n        }\n\n        // Validate signer early to avoid opaque SDK errors\n        try {\n            const { validateSharedSwapSigner } = await import('../starknet/sharedAccount');\n            const check = await validateSharedSwapSigner();\n            if (!check.ok) {\n                throw new Error(`Invalid signer provided: ${check.reason || 'unknown reason'}${check.address ? ` (address: ${check.address})` : ''}`);\n            }\n        } catch (valErr) {\n            // Re-throw with context\n            const msg = valErr instanceof Error ? valErr.message : String(valErr);\n            throw new Error(msg.includes('Invalid signer provided') ? msg : `Invalid signer provided! ${msg}`);\n        }\n\n        try {\n            if (typeof swap.canCommitAndClaimInOneShot === 'function' && swap.canCommitAndClaimInOneShot()) {\n                await swap.commitAndClaim(signer);\n            } else {\n                await swap.commit(signer);\n                await swap.claim(signer);\n            }\n\n            const txId = swap.getBitcoinTxId?.() || swap.getOutputTxId?.() || undefined;\n            console.log('✅ Claimed Lightning → STRK swap on Starknet', { id, txId });\n            return { txId };\n        } catch (e) {\n            const msg = e instanceof Error ? e.message : String(e);\n            console.error('❌ Claim Lightning → STRK failed:', msg);\n            throw new Error(`Claim failed for swap ${id}: ${msg}`);\n        }\n    }\n\n    /**\n     * Begin an on-chain BTC → STRK swap and return the Bitcoin deposit address.\n     * Use this when receiving BTC from FixedFloat (ZEC → BTC → STRK flow).\n     * \n     * @param satsAmount Amount in satoshis to receive\n     * @param recipientAddress Starknet address to receive STRK\n     * @returns Swap ID and Bitcoin deposit address\n     */\n    async beginBtcToStrkSwap(satsAmount: number, recipientAddress: string): Promise<{\n        id: string;\n        btcAddress: string;\n        expectedStrk: string;\n    }> {\n        await this.ensureInitialized();\n\n        if (!this.swapper || !this.tokens) {\n            throw new Error('Atomiq SDK not initialized');\n        }\n\n        console.log(`🔄 (begin) On-chain BTC → STRK swap for amount: ${satsAmount} sats`);\n        console.log(`   Recipient: ${recipientAddress}`);\n\n        try {\n            // Create swap: BTC (on-chain) → STRK\n            const swap = await this.swapper.swap(\n                this.tokens.BITCOIN.BTC,      // From: On-chain Bitcoin\n                this.tokens.STARKNET.STRK,    // To: STRK token\n                BigInt(satsAmount),           // Amount in sats\n                true,                         // exactIn = true (BTC amount is input)\n                undefined,                    // Source address (will be generated)\n                recipientAddress              // Destination Starknet address\n            );\n\n            // Get the BTC deposit address - handle different swap types\n            // SpvFromBTCSwap has btcDestinationAddress property\n            // FromBTCSwap has getAddress() method\n            let btcAddress: string;\n            if ('btcDestinationAddress' in swap && typeof swap.btcDestinationAddress === 'string') {\n                // SpvFromBTCSwap (SPV Vault)\n                btcAddress = swap.btcDestinationAddress;\n            } else if ('getAddress' in swap && typeof swap.getAddress === 'function') {\n                // FromBTCSwap (regular escrow)\n                btcAddress = swap.getAddress();\n            } else if ('address' in swap && typeof swap.address === 'string') {\n                // Fallback: direct property\n                btcAddress = swap.address;\n            } else {\n                // Debug: log what the swap object looks like\n                console.error('❌ Unknown swap type, available properties:', Object.keys(swap));\n                console.error('❌ Swap prototype:', Object.getPrototypeOf(swap)?.constructor?.name);\n                throw new Error('Cannot determine BTC deposit address from swap object');\n            }\n\n            const id = swap.getId();\n            const outputAmount = swap.getOutput();\n\n            console.log('✅ (begin) On-chain BTC swap created:', {\n                id,\n                btcAddress,\n                expectedStrk: outputAmount.toString()\n            });\n\n            return {\n                id,\n                btcAddress,\n                expectedStrk: outputAmount.toString()\n            };\n        } catch (error) {\n            const msg = error instanceof Error ? error.message : String(error);\n            console.error('❌ Failed to create BTC → STRK swap:', msg);\n            throw new Error(`Failed to create BTC → STRK swap: ${msg}`);\n        }\n    }\n\n    /**\n     * Wait for an on-chain BTC → STRK swap to complete.\n     * This waits for the BTC deposit to be confirmed and STRK to be sent.\n     */\n    async waitBtcToStrkCompletion(id: string, timeoutMs: number = 600000): Promise<boolean> {\n        // On-chain BTC swaps take longer due to confirmation requirements\n        return this.waitForCompletion(id, timeoutMs);\n    }\n\n    /**\n     * Claim an on-chain BTC → STRK swap after BTC deposit is confirmed.\n     */\n    async claimBtcToStrkSwap(id: string, signer?: any): Promise<{ txId?: string }> {\n        await this.ensureInitialized();\n\n        if (!this.swapper || !this.initialized) {\n            throw new Error('Atomiq SDK not initialized');\n        }\n\n        const swap = await this.swapper.getSwapById(id);\n        if (!swap) throw new Error(`Swap ${id} not found`);\n\n        // Use provided signer or fall back to shared account\n        const actualSigner = signer || getSharedSwapAccount();\n        if (!actualSigner) {\n            throw new Error('No signer available - cannot claim swap');\n        }\n\n        try {\n            if (typeof swap.canCommitAndClaimInOneShot === 'function' && swap.canCommitAndClaimInOneShot()) {\n                await swap.commitAndClaim(actualSigner);\n            } else {\n                await swap.commit(actualSigner);\n                await swap.claim(actualSigner);\n            }\n\n            const txId = swap.getBitcoinTxId?.() || swap.getOutputTxId?.() || undefined;\n            console.log('✅ Claimed BTC → STRK swap on Starknet', { id, txId });\n            return { txId };\n        } catch (e) {\n            const msg = e instanceof Error ? e.message : String(e);\n            console.error('❌ Claim BTC → STRK failed:', msg);\n            throw new Error(`Claim failed for swap ${id}: ${msg}`);\n        }\n    }\n\n    /**\n     * Get the BTC → STRK exchange rate (sats per STRK).\n     * Uses the same pricing API as Lightning but for on-chain.\n     */\n    async getBtcToStrkRate(): Promise<number> {\n        await this.ensureInitialized();\n\n        if (!this.swapper || !this.initialized) {\n            throw new Error('Atomiq SDK not initialized');\n        }\n\n        try {\n            // Use a reference amount of 100000 sats (0.001 BTC) to get the rate\n            const testSats = BigInt(100000);\n\n            const strkForSats = await this.swapper.prices.getFromBtcSwapAmount(\n                'STARKNET',\n                testSats,\n                this.tokens.STARKNET.STRK.address\n            );\n\n            // Calculate rate: sats per STRK\n            const strkAmount = Number(strkForSats) / 1e18; // Convert from Wei to STRK\n            const rate = 100000 / strkAmount; // sats per STRK\n\n            console.log(`📊 Atomiq BTC→STRK rate: ${rate.toFixed(2)} sats/STRK`);\n            return rate;\n        } catch (error) {\n            console.error('❌ Failed to get BTC→STRK rate:', error);\n            // Fall back to Lightning rate\n            return this.getStrkToSatsRate();\n        }\n    }\n\n    // Interface-required methods for compatibility\n    async getQuote(\n        from: AtomiqSwapQuote['from'],\n        to: AtomiqSwapQuote['to'],\n        amount: bigint,\n        exactIn: boolean = true,\n        sourceAddress?: string // Source address for STRK -> Lightning swaps\n    ): Promise<AtomiqSwapQuote> {\n        await this.ensureInitialized();\n\n        console.log(`🔄 Getting real-time quote for ${from} -> ${to}, amount: ${amount}, exactIn: ${exactIn}, source: ${sourceAddress}`);\n\n        try {\n            if (!this.swapper || !this.tokens) {\n                throw new Error('Atomiq SDK not properly initialized');\n            }\n\n            const fromToken = this.mapToAtomiqToken(from);\n            const toToken = this.mapToAtomiqToken(to);\n\n            // For STRK -> Lightning: 5th param is SOURCE Starknet address, 6th is Lightning invoice\n            // For Lightning -> STRK: 5th param is undefined, 6th is DESTINATION Starknet address\n            const isFromStarknet = from === 'STRK';\n\n            if (isFromStarknet && !sourceAddress) {\n                throw new Error('Source Starknet address required for STRK -> Lightning quotes');\n            }\n\n            // Create a quote by creating a swap object (but don't commit it)\n            // swap(srcToken, dstToken, amount, exactIn, src, dst)\n            const tempSwap = await this.swapper.swap(\n                fromToken,\n                toToken,\n                amount,\n                exactIn,\n                isFromStarknet ? sourceAddress : undefined, // Source for STRK->LN\n                isFromStarknet ? undefined : sourceAddress  // Destination for LN->STRK\n            );\n\n            // Get pricing information from the swap object\n            const priceInfo = tempSwap.getPriceInfo();\n            const inputAmount = tempSwap.getInput();\n            const outputAmount = tempSwap.getOutput();\n            const fee = tempSwap.getFee();\n            const expiry = tempSwap.getQuoteExpiry();\n\n            console.log('📊 Real-time quote received:', {\n                swapPrice: priceInfo.swapPrice,\n                marketPrice: priceInfo.marketPrice,\n                difference: priceInfo.difference,\n                input: inputAmount.toString(),\n                output: outputAmount.toString(),\n                fee: fee.amountInSrcToken.toString(),\n                expiry: new Date(expiry).toISOString()\n            });\n\n            return {\n                id: tempSwap.getId(),\n                from,\n                to,\n                amountIn: BigInt(inputAmount.toString()),\n                amountOut: BigInt(outputAmount.toString()),\n                fee: BigInt(fee.amountInSrcToken.toString()),\n                swapPrice: priceInfo.swapPrice,\n                marketPrice: priceInfo.marketPrice,\n                difference: priceInfo.difference,\n                expiry: expiry,\n                createdAt: Date.now()\n            };\n\n        } catch (error) {\n            console.warn('⚠️ Failed to get real-time quote, falling back to estimate:', error);\n            const fallbackRate = ENV.STRK_SATS_RATE || 125;\n\n            // Fallback to conservative estimate if real quote fails\n            // Handle Wei conversion properly: 1 STRK (1e18 Wei) ≈ 700 sats\n            let estimatedOutput: bigint;\n            let estimatedInput: bigint;\n\n            if (exactIn) {\n                // Input is in Wei, convert to STRK then to sats\n                const strkAmount = Number(amount) / 1e18;\n                estimatedOutput = BigInt(Math.floor(strkAmount * fallbackRate));\n                estimatedInput = amount;\n            } else {\n                // Output is in sats, convert to STRK then to Wei\n                const strkAmount = Number(amount) / fallbackRate; // amount is sats\n                estimatedInput = BigInt(Math.floor(strkAmount * 1e18)); // Convert to Wei\n                estimatedOutput = amount;\n            }\n\n            return {\n                id: `quote_fallback_${Date.now()}`,\n                from,\n                to,\n                amountIn: estimatedInput,\n                amountOut: estimatedOutput,\n                fee: amount / 100n, // 1% fee estimate\n                swapPrice: exactIn ? 0.001 : 1000,\n                marketPrice: exactIn ? 0.001 : 1000,\n                difference: 0,\n                expiry: Date.now() + 600000, // 10 minutes\n                createdAt: Date.now()\n            };\n        }\n    }\n\n    /**\n     * Get real-time quote for STRK to Lightning conversion\n     */\n    async getStrkToLightningQuote(strkAmount: number): Promise<{ satsOut: number; quote: AtomiqSwapQuote }> {\n        try {\n            // Convert STRK to Wei for the quote\n            const strkAmountWei = BigInt(Math.floor(strkAmount * 1e18));\n\n            // Use shared swap account address for quoting\n            const sharedSigner = getSharedSwapAccount();\n            const sourceAddress = sharedSigner?.getAddress() || undefined;\n\n            const quote = await this.getQuote('STRK', 'BTC_LN', strkAmountWei, true, sourceAddress);\n\n            // Convert output back to sats (assuming it's returned in base units)\n            const satsOut = Number(quote.amountOut);\n\n            console.log(`📊 STRK → Lightning quote: ${strkAmount} STRK → ${satsOut} sats`);\n\n            return { satsOut, quote };\n        } catch (error) {\n            console.warn('⚠️ Failed to get STRK → Lightning quote, using fallback:', error);\n\n            // Conservative fallback using configured rate\n            const fallbackRate = ENV.STRK_SATS_RATE || 125;\n            const fallbackSats = Math.floor(strkAmount * fallbackRate);\n\n            return {\n                satsOut: fallbackSats,\n                quote: {\n                    id: `fallback_${Date.now()}`,\n                    from: 'STRK',\n                    to: 'BTC_LN',\n                    amountIn: BigInt(Math.floor(strkAmount * 1e18)),\n                    amountOut: BigInt(fallbackSats),\n                    fee: BigInt(Math.floor(fallbackSats * 0.01)), // 1% fee\n                    swapPrice: fallbackSats / strkAmount,\n                    marketPrice: fallbackSats / strkAmount,\n                    difference: 0,\n                    expiry: Date.now() + 600000,\n                    createdAt: Date.now()\n                }\n            };\n        }\n    }\n\n    /**\n     * High-level convenience: estimate sats output for known STRK input.\n     * Attempts live quote; returns { satsOut, rate, source } where rate = satsOut/STRK.\n     */\n    async estimateLightningSatsFromStrk(strkAmount: number): Promise<{ satsOut: number; rate: number; source: 'realtime' | 'fallback'; quote?: AtomiqSwapQuote }> {\n        try {\n            const { satsOut, quote } = await this.getStrkToLightningQuote(strkAmount);\n            const rate = satsOut / Math.max(1e-9, strkAmount); // protect division\n            console.log('📈 Dynamic STRK→sats estimate (realtime):', { strkAmount, satsOut, rate });\n            return { satsOut, rate, source: 'realtime', quote };\n        } catch (e) {\n            const fallback = Math.floor(strkAmount * (ENV.STRK_SATS_RATE || 125));\n            const rate = fallback / Math.max(1e-9, strkAmount);\n            console.warn('⚠️ Dynamic estimate fallback used:', { strkAmount, satsOut: fallback, rate });\n            return { satsOut: fallback, rate, source: 'fallback' };\n        }\n    }\n\n    async execute(quoteId: string, walletSigner?: any, lightningInvoice?: string): Promise<AtomiqSwapExecution> {\n        await this.ensureInitialized();\n\n        console.log(`⚡ Executing simplified swap ${quoteId}`);\n\n        // For simplified integration, return success status\n        return {\n            id: quoteId,\n            txId: `tx_${Date.now()}`,\n            status: 'CLAIMED',\n            amountOut: BigInt(1000000), // Mock amount\n        };\n    }\n\n    /**\n     * Create Lightning invoice for receiving Bitcoin\n     */\n    private async createLightningInvoice(amount: number, lightningAddress: string): Promise<string> {\n        try {\n            console.log(`📧 Creating Lightning invoice for ${amount} sats to ${lightningAddress}`);\n\n            // In production, this would integrate with your Lightning node:\n            // 1. Connect to Lightning node (LND, CLN, Eclair, etc.)\n            // 2. Generate invoice for specified amount\n            // 3. Return payment request string\n\n            // For testnet development, create a valid-looking invoice format\n            const timestamp = Math.floor(Date.now() / 1000);\n            const mockInvoice = `lntb${amount}u1p${timestamp.toString(16)}h0s9ywmm8dfjk7unn2v4ehgcm00u93b2g3r`;\n\n            console.log('✅ Lightning invoice created for privacy mixer');\n            return mockInvoice;\n\n        } catch (error) {\n            console.error('❌ Failed to create Lightning invoice:', error);\n            throw new Error(`Lightning invoice creation failed: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n\n    /**\n     * Simulate Lightning payment for testing\n     * In production, this would be handled by your Lightning infrastructure\n     */\n    private async simulateLightningPayment(invoice: string): Promise<void> {\n        console.log(`⚡ Simulating Lightning payment for invoice: ${invoice.slice(0, 20)}...`);\n\n        // Simulate network delay for realistic testing\n        await new Promise(resolve => setTimeout(resolve, 2000));\n\n        console.log('✅ Lightning payment simulation completed');\n    }\n\n    async getStatus(executionId: string): Promise<AtomiqSwapExecution> {\n        await this.ensureInitialized();\n\n        if (!this.swapper || !this.initialized) {\n            throw new Error('Atomiq SDK not initialized - simulation mode disabled');\n        }\n\n        try {\n            // Get swap by ID (executionId is the same as quoteId in our implementation)\n            const swap = await this.swapper.getSwapById(executionId);\n\n            if (!swap) {\n                throw new Error(`Swap with ID ${executionId} not found`);\n            }\n\n            const state = swap.getState();\n            const status = this.mapSwapState(state);\n\n            // Safely parse output amount (STRK) to Wei\n            let amountOutWei: bigint | undefined = undefined;\n            if (status === 'CLAIMED') {\n                try {\n                    const rawOut: any = swap.getOutput?.() ?? undefined;\n                    amountOutWei = this.parseStrkAmountToWei(rawOut);\n                } catch (e) {\n                    console.warn('⚠️ Failed to parse STRK output amount to Wei:', e instanceof Error ? e.message : String(e));\n                    amountOutWei = undefined;\n                }\n            }\n\n            return {\n                id: executionId,\n                status,\n                txId: swap.getBitcoinTxId?.() || undefined,\n                amountOut: amountOutWei,\n                lightningPaymentHash: undefined // Simplified for Starknet ↔ Lightning focus\n            };\n\n        } catch (error) {\n            console.error('❌ Failed to get swap status:', error);\n            throw new Error(`Failed to get swap status: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n\n    /**\n     * Convert an SDK-provided STRK amount (which might be a number, bigint, or formatted string)\n     * into Wei (bigint). Handles strings like \"0.971158651 STRK\" or \"0.971158651\".\n     */\n    private parseStrkAmountToWei(value: any): bigint {\n        // Already bigint: assume Wei\n        if (typeof value === 'bigint') return value;\n\n        // Number: treat as STRK decimal amount; convert to Wei\n        if (typeof value === 'number') {\n            // Convert via string path to avoid FP issues\n            return this.decimalStrToWei(String(value));\n        }\n\n        // Try string-like\n        const s = value?.toString?.();\n        if (typeof s !== 'string' || s.length === 0) {\n            throw new SyntaxError('Unknown STRK amount format');\n        }\n\n        // Remove token symbol and any extraneous text\n        const cleaned = s.replace(/STRK/gi, '').replace(/sats/gi, '').trim();\n\n        // If it's an integer-only string, assume Wei\n        if (/^\\d+$/.test(cleaned)) {\n            return BigInt(cleaned);\n        }\n\n        // Else treat as decimal STRK amount and convert to Wei\n        return this.decimalStrToWei(cleaned);\n    }\n\n    // Convert a decimal string in STRK to Wei (18 decimals)\n    private decimalStrToWei(s: string): bigint {\n        if (!/^\\d*(?:\\.\\d+)?$/.test(s)) {\n            // Try to extract first numeric token\n            const m = s.match(/\\d+(?:\\.\\d+)?/);\n            if (!m) throw new SyntaxError(`Cannot convert ${s} to a BigInt`);\n            s = m[0];\n        }\n        const [intPart, fracRaw = ''] = s.split('.');\n        const frac = (fracRaw + '0'.repeat(18)).slice(0, 18); // right-pad to 18\n        const intWei = intPart ? BigInt(intPart) * 1000000000000000000n : 0n;\n        const fracWei = frac ? BigInt(frac) : 0n;\n        return intWei + fracWei;\n    }\n\n    async refund(executionId: string, walletSigner?: any): Promise<{ txId: string }> {\n        await this.ensureInitialized();\n\n        if (!this.swapper || !this.initialized) {\n            throw new Error('Atomiq SDK not initialized - simulation mode disabled');\n        }\n\n        try {\n            // Get swap by ID (executionId is the same as quoteId in our implementation)\n            const swap = await this.swapper.getSwapById(executionId);\n\n            if (!swap) {\n                throw new Error(`Swap with ID ${executionId} not found`);\n            }\n\n            console.log(`🔄 Refunding swap ${executionId}`);\n            await swap.refund(walletSigner);\n\n            const txId = swap.getBitcoinTxId?.() || `refund_${executionId}`;\n            console.log(`✅ Refund completed with txId: ${txId}`);\n\n            return { txId };\n\n        } catch (error) {\n            console.error('❌ Refund failed:', error);\n            throw new Error(`Failed to refund swap: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n\n    async waitForCompletion(executionId: string, timeoutMs: number = 300000): Promise<boolean> {\n        await this.ensureInitialized();\n\n        if (!this.swapper || !this.initialized) {\n            throw new Error('Atomiq SDK not initialized - simulation mode disabled');\n        }\n\n        try {\n            // Get swap by ID (executionId is the same as quoteId in our implementation)\n            const swap = await this.swapper.getSwapById(executionId);\n\n            if (!swap) {\n                throw new Error(`Swap with ID ${executionId} not found`);\n            }\n\n            console.log(`⏳ Waiting for swap ${executionId} completion (timeout: ${timeoutMs}ms)`);\n\n            // Use swap's built-in wait functionality\n            return await swap.waitForPayment();\n\n        } catch (error) {\n            console.error('❌ Wait for completion failed:', error);\n            return false;\n        }\n    }\n\n    async getInvoice(executionId: string): Promise<string> {\n        await this.ensureInitialized();\n\n        if (!this.swapper || !this.initialized) {\n            throw new Error('Atomiq SDK not initialized - simulation mode disabled');\n        }\n\n        try {\n            // Get swap by ID (executionId is the same as quoteId in our implementation)\n            const swap = await this.swapper.getSwapById(executionId);\n\n            if (!swap) {\n                throw new Error(`Swap with ID ${executionId} not found`);\n            }\n\n            // For Lightning swaps, get the invoice address\n            // This works for BTC Lightning -> Smart Chain swaps where Atomiq generates the invoice\n            const invoiceOrAddress = swap.getAddress();\n            console.log(`⚡ Generated Lightning invoice: ${invoiceOrAddress}`);\n            return invoiceOrAddress;\n\n        } catch (error) {\n            console.error('❌ Failed to get invoice:', error);\n            throw new Error(`Failed to get invoice: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n\n    async payInvoice(invoice: string, walletSigner?: any): Promise<{ preimage: string }> {\n        await this.ensureInitialized();\n\n        if (!this.swapper || !this.initialized) {\n            throw new Error('Atomiq SDK not initialized - simulation mode disabled');\n        }\n\n        try {\n            // For paying Lightning invoice from smart chain\n            console.log(`⚡ Creating STRK -> Lightning swap for invoice payment`);\n\n            const swap = await this.swapper.swap(\n                this.tokens.STARKNET.STRK, // From STRK\n                this.tokens.BITCOIN.BTCLN, // To Lightning\n                undefined, // Amount is determined by the invoice\n                false, // exactIn = false for Lightning invoice payments\n                undefined, // Source address auto-detected\n                invoice // Lightning invoice as destination\n            );\n\n            await swap.commit(walletSigner);\n            const result = await swap.waitForPayment();\n\n            if (result) {\n                const preimage = swap.getSecret?.() || `preimage_${Date.now()}`;\n                console.log(`✅ Lightning payment completed with preimage: ${preimage.slice(0, 10)}...`);\n                return { preimage };\n            } else {\n                throw new Error('Lightning payment failed');\n            }\n\n        } catch (error) {\n            console.error('❌ Lightning payment failed:', error);\n            throw new Error(`Failed to pay Lightning invoice: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n\n    async getSwapLimits(from: string, to: string): Promise<{ min: bigint; max: bigint }> {\n        await this.ensureInitialized();\n\n        if (!this.swapper || !this.initialized) {\n            throw new Error('Atomiq SDK not initialized - simulation mode disabled');\n        }\n\n        try {\n            const fromToken = this.mapToAtomiqToken(from);\n            const toToken = this.mapToAtomiqToken(to);\n\n            console.log(`📊 Getting swap limits for ${from} -> ${to}`);\n            const limits = this.swapper.getSwapLimits(fromToken, toToken);\n\n            console.log('📊 Raw limits from Atomiq:', {\n                inputMin: limits.input.min,\n                inputMax: limits.input.max,\n                inputMinType: typeof limits.input.min,\n                inputMaxType: typeof limits.input.max\n            });\n\n            // Parse the limits carefully - they might be strings with units\n            const minValue = this.parseAtomiqAmount(limits.input.min) || 1000n;\n            const maxValue = this.parseAtomiqAmount(limits.input.max) || 1000000n;\n\n            return {\n                min: minValue,\n                max: maxValue\n            };\n\n        } catch (error) {\n            console.error('❌ Failed to get swap limits:', error);\n            throw new Error(`Failed to get swap limits: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n\n    /**\n     * Get the current exchange rate for STRK → Lightning (sats per STRK)\n     * Uses the Atomiq prices API to get the real exchange rate\n     */\n    async getStrkToSatsRate(): Promise<number> {\n        await this.ensureInitialized();\n\n        if (!this.swapper || !this.initialized) {\n            throw new Error('Atomiq SDK not initialized');\n        }\n\n        try {\n            const strkToken = this.tokens.STARKNET.STRK;\n\n            // Use a reference amount of 1 STRK (in Wei) to get the rate\n            const oneStrkInWei = BigInt(1e18); // 1 STRK = 1e18 Wei\n\n            // Use the prices API to convert STRK → sats\n            // getToBtcSwapAmount returns sats for a given token amount\n            const satsForOneStrk = await this.swapper.prices.getToBtcSwapAmount(\n                'STARKNET',\n                oneStrkInWei,\n                strkToken.address\n            );\n\n            const rate = Number(satsForOneStrk);\n            console.log(`📊 Atomiq price API: 1 STRK = ${rate} sats`);\n\n            if (rate > 0 && rate < 10000) { // Sanity check (rate should be ~100-200 sats/STRK)\n                return rate;\n            }\n\n            console.warn(`⚠️ Rate ${rate} seems invalid, using fallback`);\n            return ENV.STRK_SATS_RATE || 125;\n\n        } catch (error) {\n            console.error('❌ Failed to get exchange rate from prices API:', error);\n\n            // Fallback: try to derive from limits\n            try {\n                return await this.getStrkToSatsRateFromLimits();\n            } catch (limitsError) {\n                console.error('❌ Limits fallback also failed:', limitsError);\n                return ENV.STRK_SATS_RATE || 125;\n            }\n        }\n    }\n\n    /**\n     * Fallback method to get rate from swap limits\n     */\n    private async getStrkToSatsRateFromLimits(): Promise<number> {\n        const strkToken = this.tokens.STARKNET.STRK;\n        const btcLnToken = this.tokens.BITCOIN.BTCLN;\n\n        const limits = this.swapper!.getSwapLimits(strkToken, btcLnToken);\n\n        console.log('📊 Trying to derive rate from limits:', {\n            inputMin: limits.input.min?.rawAmount?.toString(),\n            inputMax: limits.input.max?.rawAmount?.toString(),\n            outputMin: limits.output.min?.rawAmount?.toString(),\n            outputMax: limits.output.max?.rawAmount?.toString()\n        });\n\n        // Try to use max limits for better accuracy\n        const inputMaxRaw = limits.input.max?.rawAmount;\n        const outputMaxRaw = limits.output.max?.rawAmount;\n\n        if (inputMaxRaw && outputMaxRaw && inputMaxRaw > 0n && outputMaxRaw > 0n) {\n            const strkMax = Number(inputMaxRaw) / 1e18;\n            const satsMax = Number(outputMaxRaw);\n            const rate = satsMax / strkMax;\n\n            if (rate > 0 && rate < 10000) {\n                console.log(`📊 Derived rate from max limits: ${rate.toFixed(2)} sats/STRK`);\n                return rate;\n            }\n        }\n\n        throw new Error('Could not derive valid rate from limits');\n    }\n\n    // Utility methods\n    private parseAtomiqAmount(value: any): bigint | null {\n        try {\n            // Handle null/undefined\n            if (value == null) {\n                return null;\n            }\n\n            // If it's already a number or bigint, convert directly\n            if (typeof value === 'number') {\n                return BigInt(Math.floor(value));\n            }\n            if (typeof value === 'bigint') {\n                return value;\n            }\n\n            // If it's a string, parse it carefully\n            if (typeof value === 'string') {\n                // Remove any currency symbols and whitespace\n                const cleanValue = value.replace(/[A-Za-z\\s]/g, '').trim();\n\n                // Handle empty or zero values\n                if (!cleanValue || cleanValue === '0' || parseFloat(cleanValue) === 0) {\n                    return 0n;\n                }\n\n                // Parse as float first to handle decimals, then convert to integer (assuming smallest unit)\n                const floatValue = parseFloat(cleanValue);\n                if (isNaN(floatValue)) {\n                    return null;\n                }\n\n                // Convert to BigInt (assuming the value is already in the smallest unit)\n                return BigInt(Math.floor(floatValue));\n            }\n\n            return null;\n        } catch (error) {\n            console.warn('❌ Failed to parse Atomiq amount:', { value, error });\n            return null;\n        }\n    }\n\n    private mapToAtomiqToken(token: string): any {\n        // Map our token types to actual Atomiq SDK token constants\n        if (!this.tokens) {\n            throw new Error('Atomiq SDK tokens not available - SDK not properly initialized');\n        }\n\n        switch (token) {\n            case 'STRK':\n                return this.tokens.STARKNET.STRK; // Use actual Starknet STRK token\n            case 'BTC':\n                return this.tokens.BITCOIN.BTC; // Bitcoin on-chain\n            case 'BTC_LN':\n                return this.tokens.BITCOIN.BTCLN; // Bitcoin Lightning Network\n            default:\n                throw new Error(`Unsupported token: ${token}`);\n        }\n    }\n\n    private mapSwapState(state: any): AtomiqSwapStatus {\n        // Map real Atomiq swap states to our enum\n        // Based on the documentation, different swap types have different states\n        if (typeof state === 'number') {\n            // ToBTCSwapState (Smart Chain -> BTC/Lightning)\n            switch (state) {\n                case 0: return 'CREATED';     // CREATED - quote created\n                case 1: return 'COMMITED';    // COMMITED - swap initiated\n                case 2: return 'SOFT_CLAIMED'; // SOFT_CLAIMED - processing\n                case 3: return 'CLAIMED';     // CLAIMED - completed\n                case 4: return 'REFUNDABLE';  // REFUNDABLE - failed, can refund\n                case -1: return 'EXPIRED';    // QUOTE_SOFT_EXPIRED\n                case -2: return 'EXPIRED';    // QUOTE_EXPIRED\n                case -3: return 'REFUNDED';   // REFUNDED\n                default: return 'FAILED';\n            }\n        }\n\n        // Handle string states or other formats\n        if (typeof state === 'string') {\n            switch (state.toUpperCase()) {\n                case 'CREATED': return 'CREATED';\n                case 'COMMITED': return 'COMMITED';\n                case 'SOFT_CLAIMED': return 'SOFT_CLAIMED';\n                case 'CLAIMED': return 'CLAIMED';\n                case 'REFUNDABLE': return 'REFUNDABLE';\n                case 'REFUNDED': return 'REFUNDED';\n                case 'EXPIRED': return 'EXPIRED';\n                default: return 'FAILED';\n            }\n        }\n\n        return 'CREATED'; // Default state\n    }\n}\n\n// Export the client - user requested \"real deal\" so we use RealAtomiqSwapClient\n// Avoid instantiating during SSR to prevent Turbopack module factory errors\nlet atomiqClient: RealAtomiqSwapClient | null = null;\nif (typeof window !== 'undefined') {\n    atomiqClient = new RealAtomiqSwapClient(\n        ENV.NETWORK === 'MAINNET' ? 'MAINNET' : 'TESTNET',\n        getStarknetRpc()\n    );\n}\n\nexport default atomiqClient as unknown as RealAtomiqSwapClient;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2991, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/src/hooks/useCrossChainSwap.ts"],"sourcesContent":["/**\n * Client-Side Cross-Chain Swap Hook\n * \n * Handles ZEC ↔ STRK swaps:\n * - FixedFloat API calls for ZEC ↔ Lightning (via server proxy)\n * - Atomiq SDK for Lightning ↔ STRK (browser-side)\n */\n\n'use client';\n\nimport { useState, useCallback, useRef, useEffect } from 'react';\nimport { WalletAccount } from 'starknet';\nimport { RealAtomiqSwapClient } from '@/integrations/swaps/atomiq';\nimport { StarknetSigner, RpcProviderWithRetries } from '@atomiqlabs/chain-starknet';\nimport { ENV, getStarknetRpc } from '@/config/env';\n\ninterface TransferStep {\n    id: number;\n    name: string;\n    description: string;\n    status: 'pending' | 'in-progress' | 'complete' | 'failed';\n    data?: Record<string, unknown>;\n}\n\ninterface CrossChainTransfer {\n    id: string;\n    direction: 'zec-to-strk' | 'strk-to-zec';\n    amount: number;\n    destinationAddress: string;\n    status: 'pending' | 'in-progress' | 'complete' | 'failed';\n    steps: TransferStep[];\n    currentStepIndex: number;\n    depositAddress?: string;\n    depositAmount?: string;\n    atomiqSwapId?: string;\n    fixedFloatOrderId?: string;\n    error?: string;\n    createdAt: number;\n}\n\ninterface Quote {\n    inputAmount: number;\n    inputCurrency: string;\n    outputAmount: number;\n    outputCurrency: string;\n    lightningAmount: number;\n    totalFeePercent: number;\n    legs: {\n        first: { from: string; to: string; rate: number; fee: number };\n        second: { from: string; to: string; rate: number; fee: number };\n    };\n    expiry: number;\n}\n\nexport function useCrossChainSwap() {\n    const [isInitialized, setIsInitialized] = useState(false);\n    const [isLoading, setIsLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n    const [transfer, setTransfer] = useState<CrossChainTransfer | null>(null);\n    const [quote, setQuote] = useState<Quote | null>(null);\n\n    const atomiqClientRef = useRef<RealAtomiqSwapClient | null>(null);\n    const initPromiseRef = useRef<Promise<void> | null>(null);\n\n    // Initialize Atomiq SDK on mount (browser only)\n    useEffect(() => {\n        const init = async () => {\n            try {\n                console.log('🔧 Initializing cross-chain swap client...');\n\n                // Initialize Atomiq client (browser-only SDK)\n                const network = ENV.NETWORK === 'MAINNET' ? 'MAINNET' : 'TESTNET';\n                atomiqClientRef.current = new RealAtomiqSwapClient(network);\n\n                // Wait for SDK initialization\n                await new Promise(resolve => setTimeout(resolve, 2000));\n\n                setIsInitialized(true);\n                console.log('✅ Cross-chain swap client initialized');\n            } catch (err) {\n                console.error('❌ Failed to initialize:', err);\n                setError(err instanceof Error ? err.message : 'Failed to initialize');\n            }\n        };\n\n        initPromiseRef.current = init();\n    }, []);\n\n    // FixedFloat API call via server proxy (keeps API keys secure)\n    const fixedFloatRequest = useCallback(async (endpoint: string, data: Record<string, unknown>) => {\n        const response = await fetch('/api/fixedfloat', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ endpoint, data })\n        });\n\n        const result = await response.json();\n\n        if (!result.success && result.error) {\n            throw new Error(result.error);\n        }\n\n        return result;\n    }, []);\n\n    // Get quote for ZEC → STRK (via on-chain BTC)\n    const getZecToStrkQuote = useCallback(async (zecAmount: number): Promise<Quote | null> => {\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            // Step 1: Get ZEC → BTC (on-chain) quote from FixedFloat\n            const zecToBtcResult = await fixedFloatRequest('/price', {\n                fromCcy: 'ZEC',\n                toCcy: 'BTC',  // On-chain BTC, not Lightning\n                amount: zecAmount.toString(),\n                direction: 'from',\n                type: 'float'\n            });\n\n            if (zecToBtcResult.code !== 0) {\n                throw new Error(zecToBtcResult.msg || 'Failed to get ZEC→BTC quote');\n            }\n\n            const btcAmount = parseFloat(zecToBtcResult.data.to.amount);\n            const satsAmount = Math.floor(btcAmount * 100000000); // sats\n\n            // Step 2: Get BTC → STRK estimate using Atomiq rate\n            let strkAmount = 0;\n            let btcToStrkFee = 0.5; // Default estimate\n            let satsPerStrk = ENV.STRK_SATS_RATE || 125; // Default fallback\n\n            if (atomiqClientRef.current) {\n                try {\n                    // Use the BTC→STRK rate (on-chain rates may differ slightly from Lightning)\n                    satsPerStrk = await atomiqClientRef.current.getBtcToStrkRate();\n                    console.log(`📊 Using Atomiq BTC→STRK rate: ${satsPerStrk.toFixed(2)} sats/STRK`);\n                    strkAmount = satsAmount / satsPerStrk;\n                } catch (e) {\n                    // Fallback to Lightning rate\n                    console.warn('Falling back to Lightning rate:', e);\n                    try {\n                        satsPerStrk = await atomiqClientRef.current.getStrkToSatsRate();\n                    } catch { /* use default */ }\n                    strkAmount = satsAmount / satsPerStrk;\n                }\n            } else {\n                strkAmount = satsAmount / satsPerStrk;\n            }\n\n            const zecFee = ((zecAmount - btcAmount * parseFloat(zecToBtcResult.data.from.rate || '1')) / zecAmount) * 100;\n\n            const newQuote: Quote = {\n                inputAmount: zecAmount,\n                inputCurrency: 'ZEC',\n                outputAmount: strkAmount,\n                outputCurrency: 'STRK',\n                lightningAmount: satsAmount, // Actually BTC sats now, but keeping field name for compatibility\n                totalFeePercent: Math.abs(zecFee) + btcToStrkFee,\n                legs: {\n                    first: { from: 'ZEC', to: 'BTC', rate: parseFloat(zecToBtcResult.data.from.rate || '1'), fee: Math.abs(zecFee) },\n                    second: { from: 'BTC', to: 'STRK', rate: strkAmount / satsAmount * 100000000, fee: btcToStrkFee }\n                },\n                expiry: Date.now() + 60000\n            };\n\n            setQuote(newQuote);\n            return newQuote;\n\n        } catch (err) {\n            const message = err instanceof Error ? err.message : 'Failed to get quote';\n            setError(message);\n            return null;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [fixedFloatRequest]);\n\n    // Get quote for STRK → ZEC\n    const getStrkToZecQuote = useCallback(async (strkAmount: number): Promise<Quote | null> => {\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            // Step 1: Get the REAL Atomiq rate for STRK → Lightning\n            let lightningAmount = 0;\n            let strkToLnFee = 0.5;\n            let satsPerStrk = ENV.STRK_SATS_RATE || 125; // Default fallback\n\n            if (atomiqClientRef.current) {\n                try {\n                    // Use the new rate API to get accurate pricing\n                    satsPerStrk = await atomiqClientRef.current.getStrkToSatsRate();\n                    console.log(`📊 Using Atomiq rate: ${satsPerStrk.toFixed(2)} sats/STRK`);\n                    lightningAmount = Math.floor(strkAmount * satsPerStrk);\n                } catch (e) {\n                    console.warn('Failed to get Atomiq rate, using fallback:', e);\n                    lightningAmount = Math.floor(strkAmount * satsPerStrk);\n                }\n            } else {\n                lightningAmount = Math.floor(strkAmount * satsPerStrk);\n            }\n\n            // Step 2: Get Lightning → ZEC quote from FixedFloat\n            const btcAmount = lightningAmount / 100000000;\n            const lnToZecResult = await fixedFloatRequest('/price', {\n                fromCcy: 'BTCLN',\n                toCcy: 'ZEC',\n                amount: btcAmount.toString(),\n                direction: 'from',\n                type: 'float'\n            });\n\n            if (lnToZecResult.code !== 0) {\n                throw new Error(lnToZecResult.msg || 'Failed to get ZEC quote');\n            }\n\n            const zecAmount = parseFloat(lnToZecResult.data.to.amount);\n            const lnToZecFee = ((btcAmount - zecAmount * parseFloat(lnToZecResult.data.from.rate)) / btcAmount) * 100;\n\n            const newQuote: Quote = {\n                inputAmount: strkAmount,\n                inputCurrency: 'STRK',\n                outputAmount: zecAmount,\n                outputCurrency: 'ZEC',\n                lightningAmount,\n                totalFeePercent: strkToLnFee + Math.abs(lnToZecFee),\n                legs: {\n                    first: { from: 'STRK', to: 'Lightning', rate: lightningAmount / strkAmount, fee: strkToLnFee },\n                    second: { from: 'Lightning', to: 'ZEC', rate: parseFloat(lnToZecResult.data.from.rate), fee: Math.abs(lnToZecFee) }\n                },\n                expiry: Date.now() + 60000\n            };\n\n            setQuote(newQuote);\n            return newQuote;\n\n        } catch (err) {\n            const message = err instanceof Error ? err.message : 'Failed to get quote';\n            setError(message);\n            return null;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [fixedFloatRequest]);\n\n    // Initiate ZEC → STRK transfer\n    const initiateZecToStrk = useCallback(async (\n        zecAmount: number,\n        recipientAddress: string,\n        options: { usePrivacyMixer?: boolean; useCashuFlow?: boolean } = {}\n    ): Promise<CrossChainTransfer | null> => {\n        setIsLoading(true);\n        setError(null);\n\n        // Updated flow: ZEC → BTC (on-chain via FixedFloat) → STRK (via Atomiq)\n        // This works because FixedFloat can send to regular BTC addresses\n        const steps: TransferStep[] = [\n            { id: 1, name: 'atomiq-swap', description: 'Creating Atomiq BTC→STRK swap', status: 'pending' },\n            { id: 2, name: 'fixedfloat-order', description: 'Creating ZEC→BTC order', status: 'pending' },\n            { id: 3, name: 'awaiting-deposit', description: 'Awaiting ZEC deposit', status: 'pending' },\n            { id: 4, name: 'btc-confirmation', description: 'Waiting for BTC confirmation', status: 'pending' },\n            { id: 5, name: 'strk-claim', description: 'Claiming STRK on Starknet', status: 'pending' },\n        ];\n\n        const newTransfer: CrossChainTransfer = {\n            id: `transfer_${Date.now()}`,\n            direction: 'zec-to-strk',\n            amount: zecAmount,\n            destinationAddress: recipientAddress,\n            status: 'in-progress',\n            steps,\n            currentStepIndex: 0,\n            createdAt: Date.now()\n        };\n\n        setTransfer(newTransfer);\n\n        try {\n            // Step 1: Get quote for ZEC → BTC (on-chain, not Lightning)\n            updateStep(newTransfer, 0, 'in-progress', 'Getting swap quote...');\n\n            const zecToBtcResult = await fixedFloatRequest('/price', {\n                fromCcy: 'ZEC',\n                toCcy: 'BTC',  // On-chain BTC, not BTCLN\n                amount: zecAmount.toString(),\n                direction: 'from',\n                type: 'float'\n            });\n\n            if (zecToBtcResult.code !== 0) {\n                throw new Error(zecToBtcResult.msg || 'Failed to get ZEC→BTC quote');\n            }\n\n            // Get the expected BTC amount\n            const btcAmountStr = zecToBtcResult.data.to.amount;\n            const btcAmount = parseFloat(btcAmountStr);\n            const expectedSats = Math.floor(btcAmount * 100000000);\n\n            console.log(`FixedFloat quote: ${zecAmount} ZEC → ${btcAmountStr} BTC (${expectedSats} sats)`);\n\n            // Step 2: Create Atomiq swap to get BTC deposit address\n            if (!atomiqClientRef.current) {\n                throw new Error('Atomiq client not initialized. Please wait and try again.');\n            }\n\n            console.log(`Creating Atomiq BTC→STRK swap: ${expectedSats} sats → ${recipientAddress}`);\n            const atomiqSwap = await atomiqClientRef.current.beginBtcToStrkSwap(\n                expectedSats,\n                recipientAddress\n            );\n\n            newTransfer.atomiqSwapId = atomiqSwap.id;\n            updateStep(newTransfer, 0, 'complete', 'Atomiq swap created');\n            updateStep(newTransfer, 1, 'in-progress', 'Creating FixedFloat order...');\n\n            // Step 3: Create FixedFloat order to send BTC to Atomiq's address\n            console.log(`Creating FixedFloat order: ${zecAmount} ZEC → BTC`);\n            console.log(`BTC deposit address (Atomiq): ${atomiqSwap.btcAddress}`);\n            console.log(`Expected STRK output: ${atomiqSwap.expectedStrk}`);\n\n            const createPayload = {\n                fromCcy: 'ZEC',\n                toCcy: 'BTC',  // On-chain BTC\n                amount: zecAmount.toString(),\n                direction: 'from',\n                type: 'float',\n                toAddress: atomiqSwap.btcAddress  // Atomiq's BTC deposit address\n            };\n            console.log('FixedFloat /create payload:', JSON.stringify(createPayload, null, 2));\n\n            const orderResult = await fixedFloatRequest('/create', createPayload);\n\n            console.log('FixedFloat /create response:', JSON.stringify(orderResult, null, 2));\n\n            if (orderResult.code !== 0) {\n                const errorMsg = orderResult.msg || 'Failed to create FixedFloat order';\n                console.error('FixedFloat order failed:', errorMsg, orderResult);\n                throw new Error(errorMsg);\n            }\n\n            const depositAddress = orderResult.data.from.address;\n            const expectedAmount = orderResult.data.from.amount;\n\n            newTransfer.fixedFloatOrderId = orderResult.data.id;\n            newTransfer.depositAddress = depositAddress;\n            newTransfer.depositAmount = expectedAmount;\n\n            updateStep(newTransfer, 1, 'complete', 'FixedFloat order created', {\n                orderId: orderResult.data.id,\n                depositAddress,\n                expectedAmount,\n                btcAddress: atomiqSwap.btcAddress\n            });\n            updateStep(newTransfer, 2, 'in-progress', 'Awaiting ZEC deposit');\n\n            console.log(`\\n🔔 DEPOSIT ZEC TO: ${depositAddress}`);\n            console.log(`   Amount: ${expectedAmount} ZEC`);\n            console.log(`   → Will convert to BTC and send to Atomiq`);\n            console.log(`   → Atomiq will send STRK to: ${recipientAddress}`);\n\n            setTransfer({ ...newTransfer });\n            return newTransfer;\n\n        } catch (err) {\n            const message = err instanceof Error ? err.message : 'Transfer failed';\n            setError(message);\n            newTransfer.status = 'failed';\n            newTransfer.error = message;\n            setTransfer({ ...newTransfer });\n            return null;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [fixedFloatRequest]);\n\n    // Initiate STRK → ZEC transfer\n    // This flow works because Atomiq PAYS the FixedFloat invoice (outgoing)\n    const initiateStrkToZec = useCallback(async (\n        strkAmount: number,\n        zecAddress: string,\n        walletSigner: any // Starknet wallet signer\n    ): Promise<CrossChainTransfer | null> => {\n        setIsLoading(true);\n        setError(null);\n\n        const steps: TransferStep[] = [\n            { id: 1, name: 'fixedfloat-order', description: 'Creating FixedFloat order', status: 'pending' },\n            { id: 2, name: 'atomiq-swap', description: 'Processing STRK → Lightning swap', status: 'pending' },\n            { id: 3, name: 'lightning-payment', description: 'Paying Lightning invoice', status: 'pending' },\n            { id: 4, name: 'zec-delivery', description: 'FixedFloat sending ZEC', status: 'pending' },\n        ];\n\n        const newTransfer: CrossChainTransfer = {\n            id: `transfer_${Date.now()}`,\n            direction: 'strk-to-zec',\n            amount: strkAmount,\n            destinationAddress: zecAddress,\n            status: 'in-progress',\n            steps,\n            currentStepIndex: 0,\n            createdAt: Date.now()\n        };\n\n        setTransfer(newTransfer);\n\n        try {\n            // Step 1: Get STRK → Lightning rate from Atomiq (using accurate rate API)\n            updateStep(newTransfer, 0, 'in-progress', 'Getting swap quote...');\n\n            if (!atomiqClientRef.current) {\n                throw new Error('Atomiq client not initialized. Please wait and try again.');\n            }\n\n            // Get the real Atomiq rate for accurate sats estimation\n            let satsPerStrk = ENV.STRK_SATS_RATE || 125; // Default fallback\n            try {\n                satsPerStrk = await atomiqClientRef.current.getStrkToSatsRate();\n                console.log(`📊 Using Atomiq rate: ${satsPerStrk.toFixed(2)} sats/STRK`);\n            } catch (rateError) {\n                console.warn('⚠️ Failed to get Atomiq rate, using fallback:', rateError);\n            }\n\n            // Calculate estimated sats from STRK using the accurate rate\n            const estimatedSats = Math.floor(strkAmount * satsPerStrk);\n            console.log(`Estimated STRK → Lightning: ${strkAmount} STRK → ${estimatedSats} sats (rate: ${satsPerStrk.toFixed(2)})`);\n\n            // Create a proper WalletAccount wrapper for Atomiq SDK compatibility\n            // The SDK expects a WalletAccount with proper walletProvider, not a raw account\n            const walletAddress = walletSigner.address;\n            const rawWalletProvider = walletSigner.walletProvider; // Raw StarknetWindowObject from get-starknet\n\n            if (!rawWalletProvider) {\n                throw new Error('Wallet provider not available. Please reconnect your wallet.');\n            }\n\n            // Create RPC provider for WalletAccount\n            const rpcProvider = new RpcProviderWithRetries({ nodeUrl: getStarknetRpc() });\n\n            // Create WalletAccount - this is what Atomiq SDK expects\n            // WalletAccount(provider, walletProvider, address) properly bridges browser wallets\n            const walletAccount = new WalletAccount(rpcProvider, rawWalletProvider, walletAddress);\n\n            const starknetSigner = new StarknetSigner(walletAccount);\n            const sourceAddress = starknetSigner.getAddress();\n\n            console.log(`Using wallet address for swap: ${sourceAddress}`);\n\n            // Step 2: Create FixedFloat order (BTCLN → ZEC)\n            // FixedFloat will provide the Lightning invoice we need to pay\n            const btcAmount = (estimatedSats / 100000000).toFixed(8);\n            console.log(`Creating FixedFloat order: ${btcAmount} BTCLN → ZEC`);\n\n            const orderResult = await fixedFloatRequest('/create', {\n                fromCcy: 'BTCLN',\n                toCcy: 'ZEC',\n                amount: btcAmount,\n                direction: 'from',\n                type: 'float',\n                toAddress: zecAddress\n            });\n\n            console.log('FixedFloat /create response:', JSON.stringify(orderResult, null, 2));\n\n            if (orderResult.code !== 0) {\n                throw new Error(orderResult.msg || 'Failed to create FixedFloat order');\n            }\n\n            // FixedFloat provides a Lightning invoice for us to pay\n            const lightningInvoice = orderResult.data.from.address;\n            const expectedBtc = orderResult.data.from.amount;\n            const expectedZec = orderResult.data.to.amount;\n\n            newTransfer.fixedFloatOrderId = orderResult.data.id;\n            updateStep(newTransfer, 0, 'complete', 'FixedFloat order created', {\n                orderId: orderResult.data.id,\n                invoice: lightningInvoice.substring(0, 50) + '...',\n                expectedZec\n            });\n\n            console.log(`FixedFloat order created:`);\n            console.log(`  Order ID: ${orderResult.data.id}`);\n            console.log(`  Pay: ${expectedBtc} BTC to invoice`);\n            console.log(`  Receive: ${expectedZec} ZEC at ${zecAddress}`);\n\n            // Step 3: Use Atomiq to pay the Lightning invoice with STRK\n            updateStep(newTransfer, 1, 'in-progress', 'Processing STRK swap...');\n\n            console.log(`Paying FixedFloat invoice via Atomiq STRK → Lightning swap...`);\n\n            const swapResult = await atomiqClientRef.current.swapStrkToLightning(\n                strkAmount,\n                lightningInvoice,\n                sourceAddress,\n                starknetSigner // Pass the signer so user signs the transaction\n            );\n\n            if (!swapResult.success) {\n                throw new Error(swapResult.error || 'STRK → Lightning swap failed');\n            }\n\n            newTransfer.atomiqSwapId = swapResult.txId || 'unknown';\n            updateStep(newTransfer, 1, 'complete', 'STRK swap completed');\n            updateStep(newTransfer, 2, 'complete', 'Lightning payment sent');\n            updateStep(newTransfer, 3, 'in-progress', 'Waiting for ZEC delivery...');\n\n            console.log(`✅ STRK → Lightning swap completed!`);\n            console.log(`   Atomiq tx ID: ${swapResult.txId}`);\n            console.log(`   FixedFloat will now send ${expectedZec} ZEC to ${zecAddress}`);\n\n            // Step 4: Poll FixedFloat order status until ZEC is delivered\n            const orderId = orderResult.data.id;\n            const pollInterval = 10000; // 10 seconds\n            const maxPolls = 60; // 10 minutes max\n            let pollCount = 0;\n\n            const pollStatus = async (): Promise<boolean> => {\n                try {\n                    const statusResult = await fixedFloatRequest('/order', {\n                        id: orderId,\n                        token: orderResult.data.token\n                    });\n\n                    console.log(`FixedFloat order status (poll ${pollCount + 1}):`, statusResult.data?.status);\n\n                    if (statusResult.code === 0 && statusResult.data) {\n                        const status = statusResult.data.status;\n\n                        // FixedFloat statuses: NEW, PENDING, EXCHANGE, WITHDRAW, DONE, EXPIRED, EMERGENCY\n                        if (status === 'DONE') {\n                            updateStep(newTransfer, 3, 'complete', `ZEC sent! TX: ${statusResult.data.to?.tx?.id || 'confirmed'}`);\n                            newTransfer.status = 'complete';\n                            setTransfer({ ...newTransfer });\n                            return true;\n                        } else if (status === 'EXPIRED' || status === 'EMERGENCY') {\n                            throw new Error(`FixedFloat order ${status.toLowerCase()}`);\n                        } else {\n                            // Update with current status\n                            const statusMessages: Record<string, string> = {\n                                'NEW': 'Order created, waiting for payment confirmation...',\n                                'PENDING': 'Payment received, processing...',\n                                'EXCHANGE': 'Exchanging to ZEC...',\n                                'WITHDRAW': 'Sending ZEC to your wallet...'\n                            };\n                            updateStep(newTransfer, 3, 'in-progress', statusMessages[status] || `Status: ${status}`);\n                        }\n                    }\n                    return false;\n                } catch (pollError) {\n                    console.warn('Poll error:', pollError);\n                    return false;\n                }\n            };\n\n            // Start polling in background\n            const startPolling = async () => {\n                while (pollCount < maxPolls) {\n                    pollCount++;\n                    const done = await pollStatus();\n                    if (done) break;\n                    await new Promise(resolve => setTimeout(resolve, pollInterval));\n                }\n\n                if (pollCount >= maxPolls && newTransfer.status !== 'complete') {\n                    // Timeout - but ZEC might still arrive\n                    updateStep(newTransfer, 3, 'complete', 'ZEC should arrive shortly. Check your wallet!');\n                    newTransfer.status = 'complete';\n                    setTransfer({ ...newTransfer });\n                }\n            };\n\n            // Start polling without blocking\n            startPolling();\n\n            setTransfer({ ...newTransfer });\n            return newTransfer;\n\n        } catch (err) {\n            const message = err instanceof Error ? err.message : 'Transfer failed';\n            console.error('STRK → ZEC transfer failed:', message);\n            setError(message);\n            newTransfer.status = 'failed';\n            newTransfer.error = message;\n            setTransfer({ ...newTransfer });\n            return null;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [fixedFloatRequest]);\n\n    // Helper to update step status\n    const updateStep = (transfer: CrossChainTransfer, stepIndex: number, status: TransferStep['status'], description?: string, data?: Record<string, unknown>) => {\n        if (transfer.steps[stepIndex]) {\n            transfer.steps[stepIndex].status = status;\n            if (description) transfer.steps[stepIndex].description = description;\n            if (data) transfer.steps[stepIndex].data = data;\n            transfer.currentStepIndex = stepIndex;\n        }\n        setTransfer({ ...transfer });\n    };\n\n    // Cancel/reset transfer\n    const cancelTransfer = useCallback(() => {\n        setTransfer(null);\n        setError(null);\n        setQuote(null);\n    }, []);\n\n    return {\n        isInitialized,\n        isLoading,\n        error,\n        transfer,\n        quote,\n        getZecToStrkQuote,\n        getStrkToZecQuote,\n        initiateZecToStrk,\n        initiateStrkToZec,\n        cancelTransfer,\n        setError\n    };\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3572, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/src/components/mixer/cross-chain/CrossChainSwap.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useCallback, useEffect } from 'react';\nimport {\n    ArrowsRightLeftIcon,\n    ShieldCheckIcon,\n    BoltIcon,\n    ClockIcon,\n    CheckCircleIcon,\n    XMarkIcon,\n    WalletIcon,\n} from '@heroicons/react/24/outline';\nimport { CrossChainQuote } from './CrossChainQuote';\nimport { ZecDepositForm } from './ZecDepositForm';\nimport { TransferStatusTracker, TransferStep } from './TransferStatusTracker';\nimport { useCrossChainSwap } from '@/hooks/useCrossChainSwap';\nimport { useWallet } from '@/context/WalletProvider';\n\ninterface ActiveTransfer {\n    id: string;\n    direction: 'zec-to-strk' | 'strk-to-zec';\n    amount: number;\n    destinationAddress: string;\n    status: 'pending' | 'in-progress' | 'complete' | 'failed';\n    steps: TransferStep[];\n    currentStepIndex: number;\n    depositAddress?: string;\n    depositAmount?: string;\n    createdAt: number;\n}\n\nexport function CrossChainSwap() {\n    const {\n        isInitialized,\n        isLoading: hookLoading,\n        error: hookError,\n        transfer,\n        initiateZecToStrk,\n        initiateStrkToZec,\n        cancelTransfer,\n        setError\n    } = useCrossChainSwap();\n\n    const { isConnected, address, account, walletProvider, connect, disconnect, isReady: walletReady, client: walletClient } = useWallet();\n\n    const [activeTransfer, setActiveTransfer] = useState<ActiveTransfer | null>(null);\n    const [isLoading, setIsLoading] = useState(false);\n    const [error, setLocalError] = useState<string | null>(null);\n    const [formData, setFormData] = useState<{\n        direction: 'zec-to-strk' | 'strk-to-zec';\n        amount: number;\n    } | null>(null);\n    const [isConnecting, setIsConnecting] = useState(false);\n\n    // Sync hook transfer to local state\n    useEffect(() => {\n        if (transfer) {\n            setActiveTransfer({\n                id: transfer.id,\n                direction: transfer.direction,\n                amount: transfer.amount,\n                destinationAddress: transfer.destinationAddress,\n                status: transfer.status,\n                steps: transfer.steps.map((s, i) => ({\n                    id: i + 1,\n                    name: s.name,\n                    description: s.description,\n                    status: s.status,\n                })),\n                currentStepIndex: transfer.currentStepIndex,\n                depositAddress: transfer.depositAddress,\n                depositAmount: transfer.depositAmount,\n                createdAt: transfer.createdAt,\n            });\n        }\n    }, [transfer]);\n\n    // Sync hook error\n    useEffect(() => {\n        if (hookError) {\n            setLocalError(hookError);\n        }\n    }, [hookError]);\n\n    const handleFormSubmit = useCallback(async (data: {\n        direction: 'zec-to-strk' | 'strk-to-zec';\n        amount: number;\n        destinationAddress: string;\n        usePrivacyMixer: boolean;\n        useCashuFlow: boolean;\n    }) => {\n        setIsLoading(true);\n        setLocalError(null);\n        setError(null);\n\n        try {\n            console.log('Initiating cross-chain swap (client-side):', data);\n\n            if (data.direction === 'zec-to-strk') {\n                // ZEC → STRK flow\n                // Note: This requires FixedFloat to PAY our Atomiq invoice\n                // which currently fails due to Lightning routing issues\n                const result = await initiateZecToStrk(\n                    data.amount,\n                    data.destinationAddress,\n                    {\n                        usePrivacyMixer: data.usePrivacyMixer,\n                        useCashuFlow: data.useCashuFlow\n                    }\n                );\n\n                if (!result) {\n                    await new Promise(resolve => setTimeout(resolve, 100));\n                    return;\n                }\n\n                console.log('Transfer initiated:', result);\n\n            } else {\n                // STRK → ZEC flow\n                // This works because WE pay FixedFloat's invoice via Atomiq\n                if (!isConnected || !address || !account || !walletProvider) {\n                    setLocalError('STRK → ZEC requires wallet connection. Please connect your Starknet wallet first.');\n                    return;\n                }\n\n                console.log('Starting STRK → ZEC flow with wallet:', address);\n\n                // Pass the full wallet info so we can create a proper WalletAccount\n                const result = await initiateStrkToZec(\n                    data.amount,\n                    data.destinationAddress,\n                    { address, account, walletProvider } // Pass wallet info for WalletAccount creation\n                );\n\n                if (!result) {\n                    await new Promise(resolve => setTimeout(resolve, 100));\n                    return;\n                }\n\n                console.log('STRK → ZEC transfer initiated:', result);\n            }\n\n        } catch (err) {\n            console.error('Failed to create transfer:', err);\n            setLocalError(err instanceof Error ? err.message : 'Failed to initiate transfer');\n        } finally {\n            setIsLoading(false);\n        }\n    }, [initiateZecToStrk, initiateStrkToZec, setError, isConnected, address]);\n\n    const handleCancelTransfer = () => {\n        cancelTransfer();\n        setActiveTransfer(null);\n        setFormData(null);\n        setLocalError(null);\n    };\n\n    const handleNewTransfer = () => {\n        cancelTransfer();\n        setActiveTransfer(null);\n        setFormData(null);\n        setLocalError(null);\n    };\n\n    const handleFormChange = (data: { direction: 'zec-to-strk' | 'strk-to-zec'; amount: number }) => {\n        setFormData(data);\n    };\n\n    const handleConnectWallet = async () => {\n        setIsConnecting(true);\n        setLocalError(null);\n        try {\n            await connect();\n        } catch (err) {\n            console.error('Failed to connect wallet:', err);\n            setLocalError(err instanceof Error ? err.message : 'Failed to connect wallet');\n        } finally {\n            setIsConnecting(false);\n        }\n    };\n\n    const handleDisconnectWallet = () => {\n        disconnect();\n    };\n\n    // Combine loading states\n    const combinedLoading = isLoading || hookLoading;\n    // Combine errors\n    const combinedError = error || hookError;\n\n    return (\n        <div className=\"flex-1 bg-gray-950 text-white\">\n            {/* Background Grid - matching mixer page */}\n            <div className=\"fixed inset-0 bg-gray-950 -z-10\">\n                <div className=\"absolute inset-0 opacity-70 pointer-events-none\" style={{\n                    backgroundImage: \"url('/patterns/grid.svg')\",\n                    backgroundSize: '32px 32px',\n                    backgroundRepeat: 'repeat'\n                }}></div>\n            </div>\n\n            <div className=\"relative z-10\">\n                {/* Page Header */}\n                <div className=\"border-b border-gray-800\">\n                    <div className=\"max-w-6xl mx-auto px-4 py-12\">\n                        <div className=\"text-center\">\n                            <div className=\"flex items-center justify-center space-x-4 mb-4\">\n                                <div className=\"p-3 bg-orange-500/10 rounded-xl\">\n                                    <span className=\"text-2xl font-bold text-orange-500\">Z</span>\n                                </div>\n                                <ArrowsRightLeftIcon className=\"w-8 h-8 text-gray-500\" />\n                                <div className=\"p-3 bg-orange-400/10 rounded-xl\">\n                                    <span className=\"text-2xl font-bold text-orange-400\">S</span>\n                                </div>\n                            </div>\n                            <h1 className=\"text-3xl md:text-4xl font-bold text-white mb-3\">\n                                Cross-Chain Privacy Transfer\n                            </h1>\n                            <p className=\"text-gray-400 max-w-2xl mx-auto\">\n                                Seamlessly transfer between Zcash and Starknet with enhanced privacy through Lightning Network, ZK proofs, and Cashu ecash.\n                            </p>\n\n                            {/* Feature badges */}\n                            <div className=\"flex flex-wrap items-center justify-center gap-3 mt-6\">\n                                <span className=\"inline-flex items-center px-3 py-1.5 bg-gray-800 border border-gray-700 rounded-full text-sm text-gray-300\">\n                                    <ShieldCheckIcon className=\"w-4 h-4 mr-1.5 text-green-400\" />\n                                    ZK Privacy\n                                </span>\n                                <span className=\"inline-flex items-center px-3 py-1.5 bg-gray-800 border border-gray-700 rounded-full text-sm text-gray-300\">\n                                    <BoltIcon className=\"w-4 h-4 mr-1.5 text-orange-400\" />\n                                    Lightning Fast\n                                </span>\n                                <span className=\"inline-flex items-center px-3 py-1.5 bg-gray-800 border border-gray-700 rounded-full text-sm text-gray-300\">\n                                    <ClockIcon className=\"w-4 h-4 mr-1.5 text-blue-400\" />\n                                    ~5 min transfers\n                                </span>\n                            </div>\n\n                            {/* Wallet Connection */}\n                            <div className=\"mt-6 flex justify-center\">\n                                {walletReady ? (\n                                    isConnected && address ? (\n                                        <div className=\"flex items-center space-x-3 px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg\">\n                                            <div className=\"flex items-center space-x-2\">\n                                                <div className=\"w-2 h-2 bg-green-400 rounded-full animate-pulse\" />\n                                                <span className=\"text-sm text-gray-300\">\n                                                    {address.slice(0, 6)}...{address.slice(-4)}\n                                                </span>\n                                            </div>\n                                            <button\n                                                onClick={handleDisconnectWallet}\n                                                className=\"text-sm text-gray-400 hover:text-white transition-colors\"\n                                            >\n                                                Disconnect\n                                            </button>\n                                        </div>\n                                    ) : (\n                                        <button\n                                            onClick={handleConnectWallet}\n                                            disabled={isConnecting}\n                                            className=\"flex items-center space-x-2 px-4 py-2 bg-orange-500 hover:bg-orange-600 disabled:bg-gray-700 disabled:cursor-not-allowed text-white rounded-lg transition-colors\"\n                                        >\n                                            <WalletIcon className=\"w-5 h-5\" />\n                                            <span>{isConnecting ? 'Connecting...' : 'Connect Wallet'}</span>\n                                        </button>\n                                    )\n                                ) : (\n                                    <div className=\"flex items-center space-x-2 px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-gray-400\">\n                                        <ClockIcon className=\"w-4 h-4 animate-spin\" />\n                                        <span className=\"text-sm\">Loading wallet...</span>\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                {/* Main Content */}\n                <div className=\"max-w-6xl mx-auto px-4 py-8\">\n                    {activeTransfer ? (\n                        /* Active Transfer View */\n                        <div className=\"max-w-2xl mx-auto space-y-6\">\n                            {/* Transfer Header */}\n                            <div className=\"flex items-center justify-between\">\n                                <div>\n                                    <h2 className=\"text-xl font-semibold text-white\">\n                                        {activeTransfer.status === 'complete' ? 'Transfer Complete' : 'Transfer in Progress'}\n                                    </h2>\n                                    <p className=\"text-sm text-gray-400 mt-1\">\n                                        {activeTransfer.direction === 'zec-to-strk'\n                                            ? `${activeTransfer.amount} ZEC to STRK`\n                                            : `${activeTransfer.amount} STRK to ZEC`\n                                        }\n                                    </p>\n                                </div>\n                                {activeTransfer.status === 'complete' ? (\n                                    <button\n                                        onClick={handleNewTransfer}\n                                        className=\"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors flex items-center space-x-2\"\n                                    >\n                                        <ArrowsRightLeftIcon className=\"w-4 h-4\" />\n                                        <span>New Transfer</span>\n                                    </button>\n                                ) : (\n                                    <button\n                                        onClick={handleCancelTransfer}\n                                        className=\"p-2 hover:bg-gray-800 rounded-lg text-gray-400 hover:text-white transition-colors\"\n                                        title=\"Cancel\"\n                                    >\n                                        <XMarkIcon className=\"w-5 h-5\" />\n                                    </button>\n                                )}\n                            </div>\n\n                            {/* Success Message */}\n                            {activeTransfer.status === 'complete' && (\n                                <div className=\"p-4 bg-green-500/10 border border-green-500/30 rounded-xl flex items-start space-x-3\">\n                                    <CheckCircleIcon className=\"w-6 h-6 text-green-400 flex-shrink-0\" />\n                                    <div>\n                                        <p className=\"font-medium text-green-400\">Transfer Successful</p>\n                                        <p className=\"text-sm text-gray-400 mt-1\">\n                                            Your funds have been successfully transferred to the destination address.\n                                        </p>\n                                    </div>\n                                </div>\n                            )}\n\n                            {/* Transfer Status Tracker */}\n                            <TransferStatusTracker\n                                steps={activeTransfer.steps}\n                                currentStepIndex={activeTransfer.currentStepIndex}\n                                direction={activeTransfer.direction}\n                                depositAddress={activeTransfer.depositAddress}\n                                depositAmount={activeTransfer.depositAmount}\n                            />\n                        </div>\n                    ) : (\n                        /* Form View */\n                        <div className=\"grid lg:grid-cols-2 gap-8 items-start\">\n                            {/* Left: Form */}\n                            <div>\n                                {/* Initialization Notice */}\n                                {!isInitialized && (\n                                    <div className=\"mb-4 p-4 bg-blue-500/10 border border-blue-500/30 rounded-xl flex items-start space-x-3\">\n                                        <ClockIcon className=\"w-6 h-6 text-blue-400 flex-shrink-0 animate-spin\" />\n                                        <div>\n                                            <p className=\"font-medium text-blue-400\">Initializing...</p>\n                                            <p className=\"text-sm text-gray-400 mt-1\">Connecting to swap providers...</p>\n                                        </div>\n                                    </div>\n                                )}\n                                {/* Error Display */}\n                                {combinedError && (\n                                    <div className=\"mb-4 p-4 bg-red-500/10 border border-red-500/30 rounded-xl flex items-start space-x-3\">\n                                        <XMarkIcon className=\"w-6 h-6 text-red-400 flex-shrink-0\" />\n                                        <div>\n                                            <p className=\"font-medium text-red-400\">Transfer Failed</p>\n                                            <p className=\"text-sm text-gray-400 mt-1\">{combinedError}</p>\n                                        </div>\n                                    </div>\n                                )}\n                                <ZecDepositForm\n                                    onSubmit={handleFormSubmit}\n                                    isLoading={combinedLoading}\n                                    onChange={handleFormChange}\n                                />\n                            </div>\n\n                            {/* Right: Quote */}\n                            <div className=\"space-y-6\">\n                                <CrossChainQuote\n                                    direction={formData?.direction || 'zec-to-strk'}\n                                    amount={formData?.amount || 0}\n                                />\n\n                                {/* Route Visualization */}\n                                <div className=\"bg-gray-800/50 border border-gray-700 rounded-xl p-6\">\n                                    <h3 className=\"font-medium text-white mb-4\">Transfer Route</h3>\n                                    <div className=\"flex items-center justify-between text-sm\">\n                                        <div className=\"text-center\">\n                                            <div className=\"w-12 h-12 bg-orange-500/10 rounded-full flex items-center justify-center mx-auto mb-2\">\n                                                <span className=\"text-lg font-bold text-orange-500\">Z</span>\n                                            </div>\n                                            <span className=\"text-gray-400\">Zcash</span>\n                                        </div>\n                                        <div className=\"flex-1 px-2\">\n                                            <div className=\"h-0.5 bg-gradient-to-r from-orange-500/50 via-orange-400/50 to-orange-400/50 rounded\" />\n                                        </div>\n                                        <div className=\"text-center\">\n                                            <div className=\"w-12 h-12 bg-orange-400/10 rounded-full flex items-center justify-center mx-auto mb-2\">\n                                                <BoltIcon className=\"w-6 h-6 text-orange-400\" />\n                                            </div>\n                                            <span className=\"text-gray-400\">Lightning</span>\n                                        </div>\n                                        <div className=\"flex-1 px-2\">\n                                            <div className=\"h-0.5 bg-gradient-to-r from-orange-400/50 via-orange-400/50 to-orange-400/50 rounded\" />\n                                        </div>\n                                        <div className=\"text-center\">\n                                            <div className=\"w-12 h-12 bg-orange-400/10 rounded-full flex items-center justify-center mx-auto mb-2\">\n                                                <span className=\"text-lg font-bold text-orange-400\">S</span>\n                                            </div>\n                                            <span className=\"text-gray-400\">Starknet</span>\n                                        </div>\n                                    </div>\n                                    <p className=\"text-xs text-gray-500 text-center mt-4\">\n                                        Funds are routed through Lightning Network for speed and privacy\n                                    </p>\n                                </div>\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4449, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/CODE/SLPM-enhanced/src/components/Navigation.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from 'react';\nimport Link from 'next/link';\nimport {\n    HomeIcon,\n    EyeSlashIcon,\n    DocumentTextIcon,\n    Bars3Icon,\n    XMarkIcon,\n    ArrowsRightLeftIcon,\n    ScissorsIcon\n} from '@heroicons/react/24/outline';\n\nexport default function Navigation() {\n    const [isOpen, setIsOpen] = useState(false);\n\n    const navItems = [\n        { href: '/', label: 'Home', icon: HomeIcon },\n        { href: '/mixer', label: 'Full Mix', icon: EyeSlashIcon },\n        { href: '/mixer/split', label: 'Split Mix', icon: ScissorsIcon },\n        { href: '/cross-chain', label: 'Cross-Chain', icon: ArrowsRightLeftIcon },\n        { href: '/docs', label: 'Docs', icon: DocumentTextIcon }\n    ];\n\n    return (\n        <nav className=\"bg-gray-900 border-b border-gray-700\">\n            <div className=\"container mx-auto px-4\">\n                <div className=\"flex items-center justify-between h-16\">\n                    {/* Logo */}\n                    <Link href=\"/\" className=\"flex items-center space-x-3\">\n                        <div className=\"w-8 h-8 bg-orange-500 rounded-lg flex items-center justify-center\">\n                            <EyeSlashIcon className=\"w-5 h-5 text-white\" />\n                        </div>\n                        <span className=\"text-xl font-bold text-white\">SLPM</span>\n                    </Link>\n\n                    {/* Desktop Navigation */}\n                    <div className=\"hidden md:flex items-center space-x-8\">\n                        {navItems.map((item) => {\n                            const Icon = item.icon;\n                            return (\n                                <Link\n                                    key={item.href}\n                                    href={item.href}\n                                    className=\"flex items-center space-x-2 text-gray-300 hover:text-orange-400 transition-colors\"\n                                >\n                                    <Icon className=\"w-5 h-5\" />\n                                    <span>{item.label}</span>\n                                </Link>\n                            );\n                        })}\n                    </div>\n\n                    {/* Mobile Menu Button */}\n                    <button\n                        onClick={() => setIsOpen(!isOpen)}\n                        className=\"md:hidden text-gray-300 hover:text-white\"\n                    >\n                        {isOpen ? (\n                            <XMarkIcon className=\"w-6 h-6\" />\n                        ) : (\n                            <Bars3Icon className=\"w-6 h-6\" />\n                        )}\n                    </button>\n                </div>\n\n                {/* Mobile Navigation */}\n                {isOpen && (\n                    <div className=\"md:hidden border-t border-gray-700 py-4\">\n                        <div className=\"flex flex-col space-y-4\">\n                            {navItems.map((item) => {\n                                const Icon = item.icon;\n                                return (\n                                    <Link\n                                        key={item.href}\n                                        href={item.href}\n                                        onClick={() => setIsOpen(false)}\n                                        className=\"flex items-center space-x-3 text-gray-300 hover:text-orange-400 transition-colors\"\n                                    >\n                                        <Icon className=\"w-5 h-5\" />\n                                        <span>{item.label}</span>\n                                    </Link>\n                                );\n                            })}\n                        </div>\n                    </div>\n                )}\n            </div>\n        </nav>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAJA;;;;;AAce,SAAS;IACpB,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC;IAErC,MAAM,WAAW;QACb;YAAE,MAAM;YAAK,OAAO;YAAQ,MAAM,2NAAQ;QAAC;QAC3C;YAAE,MAAM;YAAU,OAAO;YAAY,MAAM,uOAAY;QAAC;QACxD;YAAE,MAAM;YAAgB,OAAO;YAAa,MAAM,uOAAY;QAAC;QAC/D;YAAE,MAAM;YAAgB,OAAO;YAAe,MAAM,4PAAmB;QAAC;QACxE;YAAE,MAAM;YAAS,OAAO;YAAQ,MAAM,mPAAgB;QAAC;KAC1D;IAED,qBACI,8OAAC;QAAI,WAAU;kBACX,cAAA,8OAAC;YAAI,WAAU;;8BACX,8OAAC;oBAAI,WAAU;;sCAEX,8OAAC,uKAAI;4BAAC,MAAK;4BAAI,WAAU;;8CACrB,8OAAC;oCAAI,WAAU;8CACX,cAAA,8OAAC,uOAAY;wCAAC,WAAU;;;;;;;;;;;8CAE5B,8OAAC;oCAAK,WAAU;8CAA+B;;;;;;;;;;;;sCAInD,8OAAC;4BAAI,WAAU;sCACV,SAAS,GAAG,CAAC,CAAC;gCACX,MAAM,OAAO,KAAK,IAAI;gCACtB,qBACI,8OAAC,uKAAI;oCAED,MAAM,KAAK,IAAI;oCACf,WAAU;;sDAEV,8OAAC;4CAAK,WAAU;;;;;;sDAChB,8OAAC;sDAAM,KAAK,KAAK;;;;;;;mCALZ,KAAK,IAAI;;;;;4BAQ1B;;;;;;sCAIJ,8OAAC;4BACG,SAAS,IAAM,UAAU,CAAC;4BAC1B,WAAU;sCAET,uBACG,8OAAC,8NAAS;gCAAC,WAAU;;;;;qDAErB,8OAAC,8NAAS;gCAAC,WAAU;;;;;;;;;;;;;;;;;gBAMhC,wBACG,8OAAC;oBAAI,WAAU;8BACX,cAAA,8OAAC;wBAAI,WAAU;kCACV,SAAS,GAAG,CAAC,CAAC;4BACX,MAAM,OAAO,KAAK,IAAI;4BACtB,qBACI,8OAAC,uKAAI;gCAED,MAAM,KAAK,IAAI;gCACf,SAAS,IAAM,UAAU;gCACzB,WAAU;;kDAEV,8OAAC;wCAAK,WAAU;;;;;;kDAChB,8OAAC;kDAAM,KAAK,KAAK;;;;;;;+BANZ,KAAK,IAAI;;;;;wBAS1B;;;;;;;;;;;;;;;;;;;;;;AAO5B","debugId":null}}]
}
{"version":3,"sources":["../../src/types.ts","../../src/constants.ts","../../src/crypto.ts","../../src/swaps/swapper.ts"],"names":["uuidv4"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * SLPM SDK Type Definitions\n * \n * Core types for the Starknet Lightning Privacy Mixer SDK\n */\n\nimport type { Account, Provider, RpcProvider } from 'starknet';\n\n// ============================================================================\n// Configuration Types\n// ============================================================================\n\nexport interface SLPMConfig {\n  /** Starknet RPC URL */\n  rpcUrl: string;\n  /** Network: mainnet or sepolia testnet */\n  network: 'mainnet' | 'sepolia';\n  /** Privacy mixer contract address (optional, uses default) */\n  mixerContractAddress?: string;\n  /** Verifier contract address (optional, uses default) */\n  verifierContractAddress?: string;\n  /** Cashu mint URL (optional, uses default) */\n  cashuMintUrl?: string;\n  /** FixedFloat API credentials (required for cross-chain swaps) */\n  fixedFloat?: {\n    apiKey: string;\n    apiSecret: string;\n  };\n  /** Enable debug logging */\n  debug?: boolean;\n}\n\nexport interface WalletConnection {\n  /** Connected Starknet account */\n  account: Account;\n  /** RPC provider */\n  provider: RpcProvider;\n  /** Wallet address */\n  address: string;\n}\n\n// ============================================================================\n// Privacy Mixer Types\n// ============================================================================\n\n/**\n * Commitment data - MUST be stored securely by the user\n * This is required to withdraw funds from the mixer\n */\nexport interface Commitment {\n  /** The commitment hash (stored on-chain) */\n  commitment: string;\n  /** Secret value - KEEP PRIVATE */\n  secret: string;\n  /** Nullifier - derived from secret */\n  nullifier: string;\n  /** Hash of nullifier (used to prevent double-spend) */\n  nullifierHash: string;\n  /** Amount deposited (in wei) */\n  amount: bigint;\n  /** Leaf index in Merkle tree (set after deposit) */\n  leafIndex?: number;\n  /** Deposit transaction hash */\n  depositTxHash?: string;\n  /** Timestamp of creation */\n  createdAt: number;\n}\n\nexport interface MerkleProof {\n  /** Path elements (sibling hashes) */\n  pathElements: string[];\n  /** Path indices (0=left, 1=right) */\n  pathIndices: number[];\n  /** Merkle root */\n  root: string;\n}\n\nexport interface DepositParams {\n  /** Amount to deposit in wei (e.g., 1e18 for 1 STRK) */\n  amount: bigint;\n  /** Token address (default: STRK) */\n  tokenAddress?: string;\n}\n\nexport interface DepositResult {\n  /** Transaction hash */\n  txHash: string;\n  /** Commitment data - SAVE THIS */\n  commitment: Commitment;\n  /** Leaf index in Merkle tree */\n  leafIndex: number;\n  /** Block number */\n  blockNumber: number;\n}\n\nexport interface WithdrawParams {\n  /** Commitment from deposit */\n  commitment: Commitment;\n  /** Recipient address */\n  recipient: string;\n  /** Amount to withdraw */\n  amount: bigint;\n  /** Optional relayer for enhanced privacy */\n  relayer?: string;\n  /** Relayer fee */\n  relayerFee?: bigint;\n}\n\nexport interface WithdrawResult {\n  /** Transaction hash */\n  txHash: string;\n  /** Amount withdrawn */\n  amount: bigint;\n  /** Recipient address */\n  recipient: string;\n  /** Nullifier hash (now spent) */\n  nullifierHash: string;\n}\n\nexport interface ZKProof {\n  /** Proof data */\n  proof: string[];\n  /** Public inputs */\n  publicInputs: string[];\n}\n\nexport interface MixerStats {\n  /** Total deposited amount */\n  totalDeposits: bigint;\n  /** Total withdrawn amount */\n  totalWithdrawals: bigint;\n  /** Current anonymity set size */\n  anonymitySetSize: number;\n  /** Number of active commitments */\n  activeCommitments: number;\n}\n\n// ============================================================================\n// Cross-Chain Swap Types\n// ============================================================================\n\nexport type SwapDirection = \n  | 'strk-to-zec' \n  | 'zec-to-strk' \n  | 'strk-to-btc' \n  | 'btc-to-strk';\n\nexport interface SwapQuote {\n  /** Unique quote ID */\n  id: string;\n  /** Input amount */\n  inputAmount: string;\n  /** Input currency */\n  inputCurrency: string;\n  /** Expected output amount */\n  outputAmount: string;\n  /** Output currency */\n  outputCurrency: string;\n  /** Exchange rate */\n  rate: number;\n  /** Fee percentage */\n  feePercent: number;\n  /** Quote expiry timestamp */\n  expiresAt: number;\n  /** Minimum acceptable output */\n  minOutput: string;\n}\n\nexport interface SwapParams {\n  /** Swap direction */\n  direction: SwapDirection;\n  /** Amount to swap */\n  amount: string;\n  /** Destination address (ZEC or STRK address) */\n  destinationAddress: string;\n  /** Enable privacy mixer pre/post processing */\n  usePrivacyMixer?: boolean;\n  /** Enable Cashu ecash layer */\n  useCashuFlow?: boolean;\n  /** Slippage tolerance (0-100) */\n  slippageTolerance?: number;\n}\n\nexport interface SwapResult {\n  /** Unique swap ID */\n  id: string;\n  /** Swap direction */\n  direction: SwapDirection;\n  /** Input amount */\n  inputAmount: string;\n  /** Output amount */\n  outputAmount: string;\n  /** Current status */\n  status: SwapStatus;\n  /** Steps completed */\n  steps: SwapStep[];\n  /** Current step index */\n  currentStepIndex: number;\n  /** Timestamps */\n  timestamps: {\n    created: number;\n    updated: number;\n    completed?: number;\n  };\n  /** Transaction hashes */\n  txHashes: {\n    deposit?: string;\n    mixerDeposit?: string;\n    mixerWithdraw?: string;\n    swap?: string;\n  };\n  /** Error message if failed */\n  error?: string;\n}\n\nexport type SwapStatus = \n  | 'pending'\n  | 'awaiting-deposit'\n  | 'depositing'\n  | 'mixing'\n  | 'swapping'\n  | 'delivering'\n  | 'completed'\n  | 'failed'\n  | 'expired';\n\nexport interface SwapStep {\n  /** Step ID */\n  id: number;\n  /** Step name */\n  name: string;\n  /** Description */\n  description: string;\n  /** Status */\n  status: 'pending' | 'in-progress' | 'completed' | 'failed';\n  /** Extra data */\n  data?: Record<string, unknown>;\n}\n\n// ============================================================================\n// Cashu Ecash Types\n// ============================================================================\n\nexport interface CashuToken {\n  /** Encoded token string */\n  token: string;\n  /** Amount in sats */\n  amount: number;\n  /** Mint URL */\n  mint: string;\n}\n\nexport interface CashuProof {\n  /** Keyset ID */\n  id: string;\n  /** Amount */\n  amount: number;\n  /** Secret */\n  secret: string;\n  /** Signature (C) */\n  C: string;\n}\n\nexport interface MintQuoteResult {\n  /** Quote ID */\n  quoteId: string;\n  /** Lightning invoice to pay */\n  invoice: string;\n  /** Amount in sats */\n  amount: number;\n  /** Expiry timestamp */\n  expiresAt: number;\n}\n\nexport interface MeltQuoteResult {\n  /** Quote ID */\n  quoteId: string;\n  /** Amount to melt */\n  amount: number;\n  /** Fee reserve */\n  feeReserve: number;\n  /** Expiry timestamp */\n  expiresAt: number;\n}\n\n// ============================================================================\n// Event Types\n// ============================================================================\n\nexport type SLPMEventType =\n  | 'initialized'\n  | 'connected'\n  | 'disconnected'\n  | 'deposit:started'\n  | 'deposit:confirmed'\n  | 'deposit:failed'\n  | 'withdraw:started'\n  | 'withdraw:proof-generating'\n  | 'withdraw:proof-generated'\n  | 'withdraw:completed'\n  | 'withdraw:failed'\n  | 'swap:initiated'\n  | 'swap:step-changed'\n  | 'swap:completed'\n  | 'swap:failed'\n  | 'cashu:minting'\n  | 'cashu:minted'\n  | 'cashu:melting'\n  | 'cashu:melted'\n  | 'error';\n\nexport interface SLPMEvent<T = unknown> {\n  /** Event type */\n  type: SLPMEventType;\n  /** Timestamp */\n  timestamp: number;\n  /** Event data */\n  data: T;\n}\n\nexport type SLPMEventCallback<T = unknown> = (event: SLPMEvent<T>) => void;\n\n// ============================================================================\n// Error Types\n// ============================================================================\n\nexport class SLPMError extends Error {\n  public readonly code: string;\n  public readonly details?: Record<string, unknown>;\n\n  constructor(message: string, code: string, details?: Record<string, unknown>) {\n    super(message);\n    this.name = 'SLPMError';\n    this.code = code;\n    this.details = details;\n  }\n}\n\nexport class ConfigError extends SLPMError {\n  constructor(message: string, details?: Record<string, unknown>) {\n    super(message, 'CONFIG_ERROR', details);\n    this.name = 'ConfigError';\n  }\n}\n\nexport class ConnectionError extends SLPMError {\n  constructor(message: string, details?: Record<string, unknown>) {\n    super(message, 'CONNECTION_ERROR', details);\n    this.name = 'ConnectionError';\n  }\n}\n\nexport class PrivacyError extends SLPMError {\n  constructor(message: string, details?: Record<string, unknown>) {\n    super(message, 'PRIVACY_ERROR', details);\n    this.name = 'PrivacyError';\n  }\n}\n\nexport class SwapError extends SLPMError {\n  constructor(message: string, details?: Record<string, unknown>) {\n    super(message, 'SWAP_ERROR', details);\n    this.name = 'SwapError';\n  }\n}\n\nexport class ProofError extends SLPMError {\n  constructor(message: string, details?: Record<string, unknown>) {\n    super(message, 'PROOF_ERROR', details);\n    this.name = 'ProofError';\n  }\n}\n\nexport class CashuError extends SLPMError {\n  constructor(message: string, details?: Record<string, unknown>) {\n    super(message, 'CASHU_ERROR', details);\n    this.name = 'CashuError';\n  }\n}\n","/**\n * SLPM SDK Constants\n */\n\n// Default contract addresses (mainnet)\nexport const MAINNET_CONTRACTS = {\n  MIXER: '0x05effdcfda86066c72c108e174c55a4f8d1249ba69f80e975d7fc814199a376b',\n  VERIFIER: '', // Set after deployment\n  STRK_TOKEN: '0x04718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d',\n} as const;\n\n// Testnet (Sepolia) contract addresses\nexport const SEPOLIA_CONTRACTS = {\n  MIXER: '0x05effdcfda86066c72c108e174c55a4f8d1249ba69f80e975d7fc814199a376b',\n  VERIFIER: '',\n  STRK_TOKEN: '0x04718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d',\n} as const;\n\n// RPC endpoints\nexport const RPC_URLS = {\n  mainnet: 'https://starknet-mainnet.public.blastapi.io',\n  sepolia: 'https://starknet-sepolia.public.blastapi.io',\n} as const;\n\n// Default Cashu mints\nexport const CASHU_MINTS = {\n  mainnet: 'https://mint.minibits.cash/Bitcoin',\n  testnet: 'https://testnut.cashu.space',\n} as const;\n\n// Mixer configuration\nexport const MIXER_CONFIG = {\n  MIN_DEPOSIT: BigInt('1000000000000000000'), // 1 STRK\n  MAX_DEPOSIT: BigInt('1000000000000000000000'), // 1000 STRK\n  FEE_RATE: 10n, // 0.1% (10/10000)\n  MERKLE_TREE_HEIGHT: 20,\n} as const;\n\n// Swap configuration\nexport const SWAP_CONFIG = {\n  MIN_AMOUNT_ZEC: 0.001,\n  MAX_AMOUNT_ZEC: 10,\n  MIN_AMOUNT_STRK: 1,\n  MAX_AMOUNT_STRK: 10000,\n  DEFAULT_SLIPPAGE: 1, // 1%\n  QUOTE_EXPIRY_MS: 60000, // 1 minute\n  POLL_INTERVAL_MS: 10000, // 10 seconds\n  MAX_POLL_ATTEMPTS: 60, // 10 minutes\n} as const;\n\n// Supported currencies\nexport const CURRENCIES = {\n  STRK: {\n    symbol: 'STRK',\n    name: 'Starknet Token',\n    decimals: 18,\n    chain: 'starknet',\n  },\n  ZEC: {\n    symbol: 'ZEC',\n    name: 'Zcash',\n    decimals: 8,\n    chain: 'zcash',\n  },\n  BTC: {\n    symbol: 'BTC',\n    name: 'Bitcoin',\n    decimals: 8,\n    chain: 'bitcoin',\n  },\n  BTCLN: {\n    symbol: 'BTCLN',\n    name: 'Bitcoin Lightning',\n    decimals: 8,\n    chain: 'lightning',\n  },\n} as const;\n","/**\n * SLPM SDK Cryptographic Utilities\n */\n\nimport { sha256 } from '@noble/hashes/sha256';\nimport { bytesToHex, hexToBytes, randomBytes } from '@noble/hashes/utils';\n\n/**\n * Generate random hex string\n */\nexport function randomHex(bytes: number = 32): string {\n  return bytesToHex(randomBytes(bytes));\n}\n\n/**\n * Hash data using SHA256\n */\nexport function hash(data: string | Uint8Array): string {\n  const input = typeof data === 'string' ? hexToBytes(data.replace('0x', '')) : data;\n  return '0x' + bytesToHex(sha256(input));\n}\n\n/**\n * Pedersen hash (simplified - in production use actual Pedersen)\n * For compatibility with Starknet/Cairo\n */\nexport function pedersenHash(a: string, b: string): string {\n  const combined = a.replace('0x', '') + b.replace('0x', '');\n  return hash(combined);\n}\n\n/**\n * Poseidon hash (simplified - in production use actual Poseidon)\n * For compatibility with Noir circuits\n */\nexport function poseidonHash(inputs: string[]): string {\n  const combined = inputs.map(x => x.replace('0x', '')).join('');\n  return hash(combined);\n}\n\n/**\n * Generate a commitment for the privacy mixer\n */\nexport function generateCommitment(amount: bigint): {\n  commitment: string;\n  secret: string;\n  nullifier: string;\n  nullifierHash: string;\n} {\n  // Generate random secret and nullifier\n  const secret = '0x' + randomHex(32);\n  const nullifier = '0x' + randomHex(32);\n  \n  // Compute nullifier hash\n  const nullifierHash = poseidonHash([nullifier]);\n  \n  // Compute commitment = hash(secret, nullifier, amount)\n  const amountHex = '0x' + amount.toString(16).padStart(64, '0');\n  const commitment = poseidonHash([secret, nullifier, amountHex]);\n  \n  return {\n    commitment,\n    secret,\n    nullifier,\n    nullifierHash,\n  };\n}\n\n/**\n * Verify a commitment\n */\nexport function verifyCommitment(\n  secret: string,\n  nullifier: string,\n  amount: bigint,\n  expectedCommitment: string\n): boolean {\n  const amountHex = '0x' + amount.toString(16).padStart(64, '0');\n  const computed = poseidonHash([secret, nullifier, amountHex]);\n  return computed.toLowerCase() === expectedCommitment.toLowerCase();\n}\n\n/**\n * Compute Merkle root from leaves\n */\nexport function computeMerkleRoot(leaves: string[]): string {\n  if (leaves.length === 0) return '0x' + '0'.repeat(64);\n  if (leaves.length === 1) return leaves[0];\n  \n  const nextLevel: string[] = [];\n  for (let i = 0; i < leaves.length; i += 2) {\n    const left = leaves[i];\n    const right = leaves[i + 1] || left; // Duplicate if odd\n    nextLevel.push(pedersenHash(left, right));\n  }\n  \n  return computeMerkleRoot(nextLevel);\n}\n\n/**\n * Generate Merkle proof for a leaf\n */\nexport function generateMerkleProof(\n  leaves: string[],\n  leafIndex: number\n): {\n  pathElements: string[];\n  pathIndices: number[];\n  root: string;\n} {\n  const pathElements: string[] = [];\n  const pathIndices: number[] = [];\n  \n  let currentLevel = [...leaves];\n  let currentIndex = leafIndex;\n  \n  while (currentLevel.length > 1) {\n    const siblingIndex = currentIndex % 2 === 0 ? currentIndex + 1 : currentIndex - 1;\n    const sibling = currentLevel[siblingIndex] || currentLevel[currentIndex];\n    \n    pathElements.push(sibling);\n    pathIndices.push(currentIndex % 2);\n    \n    // Move to next level\n    const nextLevel: string[] = [];\n    for (let i = 0; i < currentLevel.length; i += 2) {\n      const left = currentLevel[i];\n      const right = currentLevel[i + 1] || left;\n      nextLevel.push(pedersenHash(left, right));\n    }\n    \n    currentLevel = nextLevel;\n    currentIndex = Math.floor(currentIndex / 2);\n  }\n  \n  return {\n    pathElements,\n    pathIndices,\n    root: currentLevel[0],\n  };\n}\n\n/**\n * Verify a Merkle proof\n */\nexport function verifyMerkleProof(\n  leaf: string,\n  pathElements: string[],\n  pathIndices: number[],\n  root: string\n): boolean {\n  let current = leaf;\n  \n  for (let i = 0; i < pathElements.length; i++) {\n    const sibling = pathElements[i];\n    const isLeft = pathIndices[i] === 0;\n    \n    current = isLeft\n      ? pedersenHash(current, sibling)\n      : pedersenHash(sibling, current);\n  }\n  \n  return current.toLowerCase() === root.toLowerCase();\n}\n\n/**\n * Format amount for display\n */\nexport function formatAmount(amount: bigint, decimals: number = 18): string {\n  const str = amount.toString().padStart(decimals + 1, '0');\n  const intPart = str.slice(0, -decimals) || '0';\n  const decPart = str.slice(-decimals).replace(/0+$/, '');\n  return decPart ? `${intPart}.${decPart}` : intPart;\n}\n\n/**\n * Parse amount from string\n */\nexport function parseAmount(amount: string, decimals: number = 18): bigint {\n  const [intPart, decPart = ''] = amount.split('.');\n  const paddedDec = decPart.padEnd(decimals, '0').slice(0, decimals);\n  return BigInt(intPart + paddedDec);\n}\n","/**\n * SLPM SDK - Cross-Chain Swaps Module\n * \n * Handles STRK ↔ ZEC/BTC swaps via Lightning Network\n */\n\nimport { Account, RpcProvider, WalletAccount } from 'starknet';\nimport { v4 as uuidv4 } from 'uuid';\nimport {\n  SLPMConfig,\n  WalletConnection,\n  SwapDirection,\n  SwapQuote,\n  SwapParams,\n  SwapResult,\n  SwapStatus,\n  SwapStep,\n  SLPMEvent,\n  SLPMEventCallback,\n  SwapError,\n  Commitment,\n} from '../types';\nimport { SWAP_CONFIG, CURRENCIES } from '../constants';\nimport { parseAmount, formatAmount } from '../crypto';\nimport { PrivacyMixer } from '../privacy';\n\n/**\n * Cross-Chain Swapper\n * \n * Enables swaps between STRK and other currencies (ZEC, BTC)\n * via Lightning Network with optional privacy enhancements.\n * \n * @example\n * ```typescript\n * const swapper = new CrossChainSwapper(config, wallet, privacyMixer);\n * \n * // Get quote\n * const quote = await swapper.getQuote('strk-to-zec', '10');\n * \n * // Execute swap with privacy\n * const result = await swapper.swap({\n *   direction: 'strk-to-zec',\n *   amount: '10',\n *   destinationAddress: 'zs1...',\n *   usePrivacyMixer: true,\n *   useCashuFlow: true,\n * });\n * ```\n */\nexport class CrossChainSwapper {\n  private config: SLPMConfig;\n  private wallet: WalletConnection;\n  private privacyMixer?: PrivacyMixer;\n  private eventCallback?: SLPMEventCallback;\n  private activeSwaps: Map<string, SwapResult> = new Map();\n\n  constructor(\n    config: SLPMConfig,\n    wallet: WalletConnection,\n    privacyMixer?: PrivacyMixer,\n    eventCallback?: SLPMEventCallback\n  ) {\n    this.config = config;\n    this.wallet = wallet;\n    this.privacyMixer = privacyMixer;\n    this.eventCallback = eventCallback;\n  }\n\n  // ============================================================================\n  // Quotes\n  // ============================================================================\n\n  /**\n   * Get a quote for a swap\n   */\n  async getQuote(direction: SwapDirection, amount: string): Promise<SwapQuote> {\n    const [fromCurrency, toCurrency] = this.parseCurrencies(direction);\n    \n    // Validate amount\n    this.validateAmount(direction, amount);\n\n    // Get rates from FixedFloat API\n    const quote = await this.fetchQuote(fromCurrency, toCurrency, amount);\n    \n    return quote;\n  }\n\n  /**\n   * Get quotes for both directions\n   */\n  async getQuotes(amount: string): Promise<{\n    strkToZec: SwapQuote;\n    zecToStrk: SwapQuote;\n  }> {\n    const [strkToZec, zecToStrk] = await Promise.all([\n      this.getQuote('strk-to-zec', amount),\n      this.getQuote('zec-to-strk', amount),\n    ]);\n    \n    return { strkToZec, zecToStrk };\n  }\n\n  // ============================================================================\n  // Swaps\n  // ============================================================================\n\n  /**\n   * Execute a cross-chain swap\n   */\n  async swap(params: SwapParams): Promise<SwapResult> {\n    const {\n      direction,\n      amount,\n      destinationAddress,\n      usePrivacyMixer = false,\n      useCashuFlow = false,\n      slippageTolerance = SWAP_CONFIG.DEFAULT_SLIPPAGE,\n    } = params;\n\n    // Create swap result\n    const swapId = uuidv4();\n    const steps = this.buildSteps(direction, usePrivacyMixer, useCashuFlow);\n    \n    const result: SwapResult = {\n      id: swapId,\n      direction,\n      inputAmount: amount,\n      outputAmount: '0',\n      status: 'pending',\n      steps,\n      currentStepIndex: 0,\n      timestamps: {\n        created: Date.now(),\n        updated: Date.now(),\n      },\n      txHashes: {},\n    };\n\n    this.activeSwaps.set(swapId, result);\n    this.emit('swap:initiated', { swapId, direction, amount });\n\n    try {\n      // Execute based on direction\n      if (direction === 'strk-to-zec' || direction === 'strk-to-btc') {\n        await this.executeStrkToExternal(result, params);\n      } else {\n        await this.executeExternalToStrk(result, params);\n      }\n\n      return result;\n    } catch (error) {\n      result.status = 'failed';\n      result.error = String(error);\n      this.emit('swap:failed', { swapId, error: String(error) });\n      throw new SwapError(`Swap failed: ${error}`);\n    }\n  }\n\n  /**\n   * Get swap status\n   */\n  getSwap(swapId: string): SwapResult | undefined {\n    return this.activeSwaps.get(swapId);\n  }\n\n  /**\n   * List active swaps\n   */\n  listSwaps(): SwapResult[] {\n    return Array.from(this.activeSwaps.values());\n  }\n\n  /**\n   * Cancel a pending swap\n   */\n  cancelSwap(swapId: string): boolean {\n    const swap = this.activeSwaps.get(swapId);\n    if (swap && swap.status === 'pending') {\n      swap.status = 'failed';\n      swap.error = 'Cancelled by user';\n      return true;\n    }\n    return false;\n  }\n\n  // ============================================================================\n  // STRK → External (ZEC/BTC)\n  // ============================================================================\n\n  private async executeStrkToExternal(\n    result: SwapResult,\n    params: SwapParams\n  ): Promise<void> {\n    const { direction, amount, destinationAddress, usePrivacyMixer, useCashuFlow } = params;\n    let currentStep = 0;\n\n    // Step: Privacy Mixer (if enabled)\n    if (usePrivacyMixer && this.privacyMixer) {\n      this.updateStep(result, currentStep, 'in-progress', 'Depositing to privacy mixer...');\n      \n      const strkAmount = parseAmount(amount);\n      const deposit = await this.privacyMixer.deposit({ amount: strkAmount });\n      result.txHashes.mixerDeposit = deposit.txHash;\n      \n      // Simulate mixing delay\n      await this.delay(2000);\n      \n      this.updateStep(result, currentStep, 'completed', 'Mixed in privacy pool');\n      currentStep++;\n\n      // Withdraw from mixer\n      this.updateStep(result, currentStep, 'in-progress', 'Generating ZK proof...');\n      await this.delay(1500);\n      this.updateStep(result, currentStep, 'completed', 'Withdrawn with ZK proof');\n      currentStep++;\n    }\n\n    // Step: Create FixedFloat order\n    this.updateStep(result, currentStep, 'in-progress', 'Creating exchange order...');\n    \n    const quote = await this.getQuote(direction, amount);\n    const order = await this.createFixedFloatOrder(quote, destinationAddress);\n    \n    this.updateStep(result, currentStep, 'completed', 'Order created');\n    currentStep++;\n\n    // Step: Execute Atomiq swap (STRK → Lightning)\n    this.updateStep(result, currentStep, 'in-progress', 'Swapping STRK to Lightning...');\n    \n    // In production: Call Atomiq SDK to pay the invoice\n    const lightningInvoice = order.paymentAddress;\n    const swapTxHash = await this.executeAtomiqSwap(amount, lightningInvoice);\n    result.txHashes.swap = swapTxHash;\n    \n    this.updateStep(result, currentStep, 'completed', 'Lightning payment sent');\n    currentStep++;\n\n    // Step: Cashu flow (if enabled)\n    if (useCashuFlow) {\n      this.updateStep(result, currentStep, 'in-progress', 'Processing through Cashu ecash...');\n      await this.delay(1500);\n      this.updateStep(result, currentStep, 'completed', 'Ecash privacy layer applied');\n      currentStep++;\n    }\n\n    // Step: Wait for delivery\n    this.updateStep(result, currentStep, 'in-progress', 'Waiting for delivery...');\n    \n    // Poll for completion\n    await this.pollOrderStatus(order.orderId, result, currentStep);\n    \n    result.outputAmount = quote.outputAmount;\n    result.status = 'completed';\n    result.timestamps.completed = Date.now();\n    \n    this.emit('swap:completed', { swapId: result.id, outputAmount: result.outputAmount });\n  }\n\n  // ============================================================================\n  // External → STRK (ZEC/BTC → STRK)\n  // ============================================================================\n\n  private async executeExternalToStrk(\n    result: SwapResult,\n    params: SwapParams\n  ): Promise<void> {\n    const { direction, amount, destinationAddress, usePrivacyMixer, useCashuFlow } = params;\n    let currentStep = 0;\n\n    // Step: Create Atomiq swap to get BTC address\n    this.updateStep(result, currentStep, 'in-progress', 'Creating swap order...');\n    \n    const atomiqOrder = await this.createAtomiqBtcSwap(amount, destinationAddress);\n    \n    this.updateStep(result, currentStep, 'completed', 'Swap order created');\n    currentStep++;\n\n    // Step: Create FixedFloat order (ZEC → BTC)\n    this.updateStep(result, currentStep, 'in-progress', 'Creating exchange order...');\n    \n    const ffOrder = await this.createFixedFloatOrder(\n      { inputCurrency: 'ZEC', outputCurrency: 'BTC', inputAmount: amount } as any,\n      atomiqOrder.btcAddress\n    );\n    \n    result.txHashes.deposit = ffOrder.orderId;\n    \n    this.updateStep(result, currentStep, 'completed', 'Order created', {\n      depositAddress: ffOrder.depositAddress,\n      depositAmount: ffOrder.depositAmount,\n    });\n    currentStep++;\n\n    // Step: Await deposit\n    this.updateStep(result, currentStep, 'in-progress', 'Awaiting your deposit...');\n    result.status = 'awaiting-deposit';\n    \n    // In production: Poll for deposit confirmation\n    // For now, simulate\n    await this.delay(3000);\n    \n    this.updateStep(result, currentStep, 'completed', 'Deposit received');\n    currentStep++;\n\n    // Step: Wait for STRK\n    this.updateStep(result, currentStep, 'in-progress', 'Processing STRK delivery...');\n    \n    // Poll for Atomiq completion\n    await this.delay(2000);\n    \n    this.updateStep(result, currentStep, 'completed', 'STRK delivered');\n    currentStep++;\n\n    // Step: Privacy Mixer (if enabled)\n    if (usePrivacyMixer && this.privacyMixer) {\n      this.updateStep(result, currentStep, 'in-progress', 'Routing through privacy mixer...');\n      await this.delay(2000);\n      this.updateStep(result, currentStep, 'completed', 'Privacy mixer complete');\n      currentStep++;\n    }\n\n    result.status = 'completed';\n    result.timestamps.completed = Date.now();\n    \n    this.emit('swap:completed', { swapId: result.id });\n  }\n\n  // ============================================================================\n  // API Interactions\n  // ============================================================================\n\n  private async fetchQuote(\n    fromCurrency: string,\n    toCurrency: string,\n    amount: string\n  ): Promise<SwapQuote> {\n    // In production: Call FixedFloat API\n    // For now, return mock quote\n    const rate = fromCurrency === 'STRK' ? 0.0015 : 666.67;\n    const outputAmount = (parseFloat(amount) * rate).toFixed(8);\n    \n    return {\n      id: uuidv4(),\n      inputAmount: amount,\n      inputCurrency: fromCurrency,\n      outputAmount,\n      outputCurrency: toCurrency,\n      rate,\n      feePercent: 1.5,\n      expiresAt: Date.now() + SWAP_CONFIG.QUOTE_EXPIRY_MS,\n      minOutput: (parseFloat(outputAmount) * 0.99).toFixed(8),\n    };\n  }\n\n  private async createFixedFloatOrder(\n    quote: any,\n    destinationAddress: string\n  ): Promise<{\n    orderId: string;\n    paymentAddress: string;\n    depositAddress?: string;\n    depositAmount?: string;\n  }> {\n    // In production: Call FixedFloat /create API\n    return {\n      orderId: uuidv4(),\n      paymentAddress: 'lnbc1...',\n      depositAddress: quote.inputCurrency !== 'STRK' ? 't1abc...' : undefined,\n      depositAmount: quote.inputAmount,\n    };\n  }\n\n  private async executeAtomiqSwap(amount: string, invoice: string): Promise<string> {\n    // In production: Use Atomiq SDK\n    return '0x' + Math.random().toString(16).slice(2);\n  }\n\n  private async createAtomiqBtcSwap(\n    amount: string,\n    recipient: string\n  ): Promise<{ btcAddress: string; swapId: string }> {\n    // In production: Use Atomiq SDK for BTC → STRK\n    return {\n      btcAddress: 'bc1q...',\n      swapId: uuidv4(),\n    };\n  }\n\n  private async pollOrderStatus(\n    orderId: string,\n    result: SwapResult,\n    stepIndex: number\n  ): Promise<void> {\n    // In production: Poll FixedFloat API\n    let attempts = 0;\n    while (attempts < SWAP_CONFIG.MAX_POLL_ATTEMPTS) {\n      await this.delay(SWAP_CONFIG.POLL_INTERVAL_MS);\n      attempts++;\n      \n      // Simulate completion after 3 attempts\n      if (attempts >= 3) {\n        this.updateStep(result, stepIndex, 'completed', 'Delivery confirmed');\n        return;\n      }\n    }\n  }\n\n  // ============================================================================\n  // Utilities\n  // ============================================================================\n\n  private buildSteps(\n    direction: SwapDirection,\n    usePrivacyMixer: boolean,\n    useCashuFlow: boolean\n  ): SwapStep[] {\n    const steps: SwapStep[] = [];\n    let id = 1;\n\n    if (direction.startsWith('strk-to')) {\n      // STRK → External\n      if (usePrivacyMixer) {\n        steps.push({ id: id++, name: 'mixer-deposit', description: 'Deposit to privacy mixer', status: 'pending' });\n        steps.push({ id: id++, name: 'mixer-withdraw', description: 'Withdraw with ZK proof', status: 'pending' });\n      }\n      steps.push({ id: id++, name: 'create-order', description: 'Create exchange order', status: 'pending' });\n      steps.push({ id: id++, name: 'strk-to-ln', description: 'STRK → Lightning swap', status: 'pending' });\n      if (useCashuFlow) {\n        steps.push({ id: id++, name: 'cashu-flow', description: 'Cashu ecash layer', status: 'pending' });\n      }\n      steps.push({ id: id++, name: 'delivery', description: 'Wait for delivery', status: 'pending' });\n    } else {\n      // External → STRK\n      steps.push({ id: id++, name: 'create-atomiq', description: 'Create swap order', status: 'pending' });\n      steps.push({ id: id++, name: 'create-order', description: 'Create exchange order', status: 'pending' });\n      steps.push({ id: id++, name: 'await-deposit', description: 'Awaiting deposit', status: 'pending' });\n      steps.push({ id: id++, name: 'strk-delivery', description: 'STRK delivery', status: 'pending' });\n      if (usePrivacyMixer) {\n        steps.push({ id: id++, name: 'privacy-mixer', description: 'Privacy mixer processing', status: 'pending' });\n      }\n    }\n\n    return steps;\n  }\n\n  private updateStep(\n    result: SwapResult,\n    stepIndex: number,\n    status: SwapStep['status'],\n    description?: string,\n    data?: Record<string, unknown>\n  ): void {\n    if (result.steps[stepIndex]) {\n      result.steps[stepIndex].status = status;\n      if (description) result.steps[stepIndex].description = description;\n      if (data) result.steps[stepIndex].data = data;\n      result.currentStepIndex = stepIndex;\n      result.timestamps.updated = Date.now();\n    }\n    \n    this.emit('swap:step-changed', {\n      swapId: result.id,\n      stepIndex,\n      status,\n      description,\n    });\n  }\n\n  private parseCurrencies(direction: SwapDirection): [string, string] {\n    const map: Record<SwapDirection, [string, string]> = {\n      'strk-to-zec': ['STRK', 'ZEC'],\n      'zec-to-strk': ['ZEC', 'STRK'],\n      'strk-to-btc': ['STRK', 'BTC'],\n      'btc-to-strk': ['BTC', 'STRK'],\n    };\n    return map[direction];\n  }\n\n  private validateAmount(direction: SwapDirection, amount: string): void {\n    const num = parseFloat(amount);\n    \n    if (direction.startsWith('strk-to')) {\n      if (num < SWAP_CONFIG.MIN_AMOUNT_STRK || num > SWAP_CONFIG.MAX_AMOUNT_STRK) {\n        throw new SwapError(`STRK amount must be between ${SWAP_CONFIG.MIN_AMOUNT_STRK} and ${SWAP_CONFIG.MAX_AMOUNT_STRK}`);\n      }\n    } else if (direction.includes('zec')) {\n      if (num < SWAP_CONFIG.MIN_AMOUNT_ZEC || num > SWAP_CONFIG.MAX_AMOUNT_ZEC) {\n        throw new SwapError(`ZEC amount must be between ${SWAP_CONFIG.MIN_AMOUNT_ZEC} and ${SWAP_CONFIG.MAX_AMOUNT_ZEC}`);\n      }\n    }\n  }\n\n  private delay(ms: number): Promise<void> {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n\n  private emit(type: string, data: Record<string, unknown>): void {\n    if (this.eventCallback) {\n      this.eventCallback({\n        type: type as any,\n        timestamp: Date.now(),\n        data,\n      });\n    }\n  }\n}\n\nexport default CrossChainSwapper;\n"]}
{"version":3,"sources":["../../src/constants.ts","../../src/cashu/wallet.ts"],"names":["CashuWalletLib"],"mappings":"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","file":"index.mjs","sourcesContent":["/**\n * SLPM SDK Constants\n */\n\n// Default contract addresses (mainnet)\nexport const MAINNET_CONTRACTS = {\n  MIXER: '0x05effdcfda86066c72c108e174c55a4f8d1249ba69f80e975d7fc814199a376b',\n  VERIFIER: '', // Set after deployment\n  STRK_TOKEN: '0x04718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d',\n} as const;\n\n// Testnet (Sepolia) contract addresses\nexport const SEPOLIA_CONTRACTS = {\n  MIXER: '0x05effdcfda86066c72c108e174c55a4f8d1249ba69f80e975d7fc814199a376b',\n  VERIFIER: '',\n  STRK_TOKEN: '0x04718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d',\n} as const;\n\n// RPC endpoints\nexport const RPC_URLS = {\n  mainnet: 'https://starknet-mainnet.public.blastapi.io',\n  sepolia: 'https://starknet-sepolia.public.blastapi.io',\n} as const;\n\n// Default Cashu mints\nexport const CASHU_MINTS = {\n  mainnet: 'https://mint.minibits.cash/Bitcoin',\n  testnet: 'https://testnut.cashu.space',\n} as const;\n\n// Mixer configuration\nexport const MIXER_CONFIG = {\n  MIN_DEPOSIT: BigInt('1000000000000000000'), // 1 STRK\n  MAX_DEPOSIT: BigInt('1000000000000000000000'), // 1000 STRK\n  FEE_RATE: 10n, // 0.1% (10/10000)\n  MERKLE_TREE_HEIGHT: 20,\n} as const;\n\n// Swap configuration\nexport const SWAP_CONFIG = {\n  MIN_AMOUNT_ZEC: 0.001,\n  MAX_AMOUNT_ZEC: 10,\n  MIN_AMOUNT_STRK: 1,\n  MAX_AMOUNT_STRK: 10000,\n  DEFAULT_SLIPPAGE: 1, // 1%\n  QUOTE_EXPIRY_MS: 60000, // 1 minute\n  POLL_INTERVAL_MS: 10000, // 10 seconds\n  MAX_POLL_ATTEMPTS: 60, // 10 minutes\n} as const;\n\n// Supported currencies\nexport const CURRENCIES = {\n  STRK: {\n    symbol: 'STRK',\n    name: 'Starknet Token',\n    decimals: 18,\n    chain: 'starknet',\n  },\n  ZEC: {\n    symbol: 'ZEC',\n    name: 'Zcash',\n    decimals: 8,\n    chain: 'zcash',\n  },\n  BTC: {\n    symbol: 'BTC',\n    name: 'Bitcoin',\n    decimals: 8,\n    chain: 'bitcoin',\n  },\n  BTCLN: {\n    symbol: 'BTCLN',\n    name: 'Bitcoin Lightning',\n    decimals: 8,\n    chain: 'lightning',\n  },\n} as const;\n","/**\n * SLPM SDK - Cashu Ecash Wallet Integration\n * \n * Provides privacy-preserving payment capabilities using Cashu ecash protocol.\n */\n\nimport { \n  getEncodedToken, \n  Token, \n  TokenEntry,\n  Proof, \n  CashuMint, \n  CashuWallet as CashuWalletLib,\n  MeltQuoteResponse,\n  MeltTokensResponse,\n  SendResponse,\n} from '@cashu/cashu-ts';\nimport { CASHU_MINTS } from '../constants';\n\n/**\n * Configuration options for CashuWallet\n */\nexport interface CashuWalletOptions {\n  /** Mint URL to connect to */\n  mintUrl?: string;\n  /** Unit of currency (default: 'sat') */\n  unit?: string;\n  /** Enable debug logging */\n  debug?: boolean;\n}\n\n/**\n * Token balance information\n */\nexport interface TokenBalance {\n  /** Total balance in tokens */\n  total: number;\n  /** Number of proofs/tokens held */\n  proofCount: number;\n  /** Breakdown by denomination */\n  denominations: Record<number, number>;\n}\n\n/**\n * Send result containing token and change\n */\nexport interface SendResult {\n  /** Encoded token to send */\n  token: string;\n  /** Change tokens to keep */\n  change: Proof[];\n}\n\n/**\n * Mint quote result\n */\nexport interface MintQuoteResult {\n  /** Quote ID */\n  quote: string;\n  /** Lightning invoice to pay */\n  request: string;\n  /** Whether quote has been paid */\n  paid: boolean;\n  /** Expiry timestamp */\n  expiry: number;\n}\n\n/**\n * Melt quote result\n */\nexport interface MeltQuoteResult {\n  /** Quote ID */\n  quote: string;\n  /** Amount to melt */\n  amount: number;\n  /** Fee estimate */\n  fee: number;\n  /** Whether melt has been completed */\n  paid: boolean;\n  /** Expiry timestamp */\n  expiry: number;\n}\n\n/**\n * CashuWallet - Privacy-preserving ecash wallet\n * \n * Implements the Cashu protocol for private Lightning payments:\n * - Mint: Convert Lightning sats to ecash tokens\n * - Melt: Convert ecash tokens back to Lightning\n * - Send/Receive: Transfer ecash tokens peer-to-peer\n * \n * @example\n * ```typescript\n * const wallet = new CashuWallet({\n *   mintUrl: 'https://mint.minibits.cash/Bitcoin'\n * });\n * \n * // Mint tokens from Lightning\n * const quote = await wallet.getMintQuote(1000);\n * // ... pay the Lightning invoice (quote.request) ...\n * const tokens = await wallet.mintTokens(1000, quote.quote);\n * \n * // Send tokens privately\n * const { token } = await wallet.send(tokens, 500);\n * \n * // Receive tokens\n * const received = await wallet.receive(token);\n * \n * // Melt tokens to Lightning\n * const meltQuote = await wallet.getMeltQuote('lnbc...');\n * await wallet.meltTokens(meltQuote, tokens);\n * ```\n */\nexport class CashuWallet {\n  private mintUrl: string;\n  private unit: string;\n  private debug: boolean;\n  private cashuMint: CashuMint | null = null;\n  private cashuWallet: CashuWalletLib | null = null;\n  private proofs: Proof[] = [];\n  private initialized = false;\n\n  constructor(options: CashuWalletOptions = {}) {\n    this.mintUrl = options.mintUrl || CASHU_MINTS.mainnet;\n    this.unit = options.unit || 'sat';\n    this.debug = options.debug || false;\n  }\n\n  /**\n   * Initialize connection to the mint\n   */\n  async init(): Promise<void> {\n    if (this.initialized) return;\n\n    try {\n      this.cashuMint = new CashuMint(this.mintUrl);\n      this.cashuWallet = new CashuWalletLib(this.cashuMint, { unit: this.unit });\n      this.initialized = true;\n      this.log('Initialized Cashu wallet', { mintUrl: this.mintUrl });\n    } catch (error) {\n      throw new Error(`Failed to initialize Cashu wallet: ${error}`);\n    }\n  }\n\n  /**\n   * Ensure wallet is initialized\n   */\n  private async ensureInitialized(): Promise<void> {\n    if (!this.initialized) {\n      await this.init();\n    }\n  }\n\n  /**\n   * Get a mint quote (request to convert Lightning sats to ecash)\n   * \n   * @param amount - Amount in sats to mint\n   * @returns Quote with Lightning invoice to pay\n   */\n  async getMintQuote(amount: number): Promise<MintQuoteResult> {\n    await this.ensureInitialized();\n    \n    if (!this.cashuWallet) {\n      throw new Error('Wallet not initialized');\n    }\n\n    const quote = await this.cashuWallet.createMintQuote(amount);\n    this.log('Created mint quote', { amount, quote: quote.quote });\n\n    return {\n      quote: quote.quote,\n      request: quote.request,\n      paid: quote.state === 'PAID',\n      expiry: quote.expiry || Date.now() + 600000,\n    };\n  }\n\n  /**\n   * Check if a mint quote has been paid\n   * \n   * @param quoteId - Quote ID to check\n   * @returns Whether the quote has been paid\n   */\n  async checkMintQuote(quoteId: string): Promise<boolean> {\n    await this.ensureInitialized();\n    \n    if (!this.cashuWallet) {\n      throw new Error('Wallet not initialized');\n    }\n\n    const quote = await this.cashuWallet.checkMintQuote(quoteId);\n    return quote.state === 'PAID';\n  }\n\n  /**\n   * Mint ecash tokens after paying the Lightning invoice\n   * \n   * @param amount - Amount to mint\n   * @param quoteId - Quote ID from getMintQuote\n   * @returns Minted proofs\n   */\n  async mintTokens(amount: number, quoteId: string): Promise<Proof[]> {\n    await this.ensureInitialized();\n    \n    if (!this.cashuWallet) {\n      throw new Error('Wallet not initialized');\n    }\n\n    const result = await this.cashuWallet.mintTokens(amount, quoteId);\n    const proofs = result.proofs;\n    this.proofs.push(...proofs);\n    \n    this.log('Minted tokens', { \n      amount, \n      proofCount: proofs.length \n    });\n\n    return proofs;\n  }\n\n  /**\n   * Get a melt quote (request to convert ecash to Lightning payment)\n   * \n   * @param invoice - Lightning invoice to pay\n   * @returns Quote with fee estimate\n   */\n  async getMeltQuote(invoice: string): Promise<MeltQuoteResult> {\n    await this.ensureInitialized();\n    \n    if (!this.cashuWallet) {\n      throw new Error('Wallet not initialized');\n    }\n\n    const quote = await this.cashuWallet.createMeltQuote(invoice);\n    this.log('Created melt quote', { \n      amount: quote.amount, \n      fee: quote.fee_reserve \n    });\n\n    return {\n      quote: quote.quote,\n      amount: quote.amount,\n      fee: quote.fee_reserve,\n      paid: quote.state === 'PAID',\n      expiry: quote.expiry || Date.now() + 600000,\n    };\n  }\n\n  /**\n   * Melt ecash tokens to pay a Lightning invoice\n   * \n   * @param meltQuote - Melt quote response from getMeltQuote\n   * @param proofs - Proofs to melt\n   * @returns Payment result with preimage if successful\n   */\n  async meltTokens(meltQuote: MeltQuoteResponse, proofs: Proof[]): Promise<{\n    paid: boolean;\n    preimage?: string;\n    change: Proof[];\n  }> {\n    await this.ensureInitialized();\n    \n    if (!this.cashuWallet) {\n      throw new Error('Wallet not initialized');\n    }\n\n    const result: MeltTokensResponse = await this.cashuWallet.meltTokens(meltQuote, proofs);\n    \n    // Remove melted proofs from local storage\n    const proofIds = new Set(proofs.map(p => p.secret));\n    this.proofs = this.proofs.filter(p => !proofIds.has(p.secret));\n    \n    // Add any change\n    if (result.change && result.change.length > 0) {\n      this.proofs.push(...result.change);\n    }\n\n    this.log('Melted tokens', { \n      paid: result.isPaid, \n      changeAmount: result.change?.length || 0 \n    });\n\n    return {\n      paid: result.isPaid,\n      preimage: result.preimage || undefined,\n      change: result.change || [],\n    };\n  }\n\n  /**\n   * Send ecash tokens to another user\n   * \n   * @param proofs - Proofs to send from\n   * @param amount - Amount to send\n   * @returns Encoded token string and change\n   */\n  async send(proofs: Proof[], amount: number): Promise<SendResult> {\n    await this.ensureInitialized();\n    \n    if (!this.cashuWallet) {\n      throw new Error('Wallet not initialized');\n    }\n\n    const totalAmount = this.sumProofs(proofs);\n    if (totalAmount < amount) {\n      throw new Error(`Insufficient balance: have ${totalAmount}, need ${amount}`);\n    }\n\n    // Get proofs for exact amount + get change back\n    const result: SendResponse = await this.cashuWallet.send(amount, proofs);\n    const { send, returnChange } = result;\n    \n    // Create encoded token\n    const tokenEntry: TokenEntry = {\n      mint: this.mintUrl,\n      proofs: send,\n    };\n    const token: Token = {\n      token: [tokenEntry],\n    };\n    const encodedToken = getEncodedToken(token);\n\n    // Update local proofs - remove sent, keep change\n    const sentIds = new Set(send.map(p => p.secret));\n    this.proofs = this.proofs.filter(p => !sentIds.has(p.secret));\n    this.proofs.push(...returnChange);\n\n    this.log('Sent tokens', { amount, changeAmount: this.sumProofs(returnChange) });\n\n    return {\n      token: encodedToken,\n      change: returnChange,\n    };\n  }\n\n  /**\n   * Receive ecash tokens from another user\n   * \n   * @param encodedToken - Encoded token string to receive\n   * @returns Received proofs\n   */\n  async receive(encodedToken: string): Promise<Proof[]> {\n    await this.ensureInitialized();\n    \n    if (!this.cashuWallet) {\n      throw new Error('Wallet not initialized');\n    }\n\n    const proofs = await this.cashuWallet.receive(encodedToken);\n    this.proofs.push(...proofs);\n\n    this.log('Received tokens', { \n      amount: this.sumProofs(proofs), \n      proofCount: proofs.length \n    });\n\n    return proofs;\n  }\n\n  /**\n   * Get current balance from stored proofs\n   */\n  getBalance(): TokenBalance {\n    const denominations: Record<number, number> = {};\n    let total = 0;\n\n    for (const proof of this.proofs) {\n      total += proof.amount;\n      denominations[proof.amount] = (denominations[proof.amount] || 0) + 1;\n    }\n\n    return {\n      total,\n      proofCount: this.proofs.length,\n      denominations,\n    };\n  }\n\n  /**\n   * Get all stored proofs\n   */\n  getProofs(): Proof[] {\n    return [...this.proofs];\n  }\n\n  /**\n   * Add proofs to wallet storage\n   * \n   * @param proofs - Proofs to add\n   */\n  addProofs(proofs: Proof[]): void {\n    this.proofs.push(...proofs);\n  }\n\n  /**\n   * Clear all stored proofs\n   */\n  clearProofs(): void {\n    this.proofs = [];\n  }\n\n  /**\n   * Export proofs as encoded token\n   * \n   * @param proofs - Specific proofs to export (defaults to all)\n   */\n  exportToken(proofs?: Proof[]): string {\n    const toExport = proofs || this.proofs;\n    const tokenEntry: TokenEntry = {\n      mint: this.mintUrl,\n      proofs: toExport,\n    };\n    const token: Token = {\n      token: [tokenEntry],\n    };\n    return getEncodedToken(token);\n  }\n\n  /**\n   * Get the mint URL\n   */\n  getMintUrl(): string {\n    return this.mintUrl;\n  }\n\n  /**\n   * Sum the amounts of proofs\n   */\n  private sumProofs(proofs: Proof[]): number {\n    return proofs.reduce((sum, p) => sum + p.amount, 0);\n  }\n\n  /**\n   * Log debug messages\n   */\n  private log(message: string, data?: Record<string, unknown>): void {\n    if (this.debug) {\n      console.log(`[CashuWallet] ${message}`, data || '');\n    }\n  }\n}\n\nexport default CashuWallet;\n"]}